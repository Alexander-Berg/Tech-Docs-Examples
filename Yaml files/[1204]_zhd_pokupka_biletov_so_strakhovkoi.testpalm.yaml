feature: ЖД
type: Страница заказа
description: >-
  Реквизиты тестовой карты: 5100003697253468, 12/20, 090 (не для асессоров, шаг
  оплаты намеренно будет пропущен).

  Перейти на вкладку ЖД билеты
specs:
  'ЖД: Покупка билетов со страховкой':
    - do: >-
        Перейти на выдачу Москва - Санкт-Петербург через месяц

        Для любого поезда кликнуть по кнопке покупки

        Выбрать 3 пассажиров - 1 взрослого, 1 ребенка от 5 до 10 лет, 1 ребенка
        без места

        Выбрать места №10 и №11

        Нажать на кнопку "Указать пассажиров"

        Заполнить все поля валидными данными

        В поле электронной почты указать почту на @yandex-team.ru

        Нажать по кнопке "Проверить заказ и купить"
    - assert: |-
        * Осуществился переход на страницу подтверждения
        * В таче внизу страницы, на десктопе справа есть корзинка со стоимостью билетов
        * В корзинке есть чекбокс для добавления страховки
    - do: Нажать на чекбокс
    - assert: >-
        * К итоговой сумме добавилась стоимость страховки
    - do: >-
        Нажать на кнопку "Ввести карту и оплатить"

        На странице оплаты ввести данные тестовой карты из описания кейса
        (асессоры пропускают)

        Нажать на кнопку "Оплатить" (асессоры пропускают, но ОР должен
        выполняться)

        На хэппи пейдж нажать на кнопку "Подробнее о заказе"
    - assert: >-
        * Открылась страница подробного заказа

        * На странице есть кнопка "Скачать билеты и страховку" (в тачах -
        "Скачать")

        * На почту пришло письмо о покупке (письмо может прийти в течение
        получаса, так как не будет чека) (асессоры пропускают и все шаги
        связанные с письмом)

        * Стоимость заказа в письме совпадает с итоговой суммой со страницы
        подтверждения (равна сумме за билеты + за страховки)

        * В письме есть блок "Страхование" с текстом "Стоимость страхового
        полиса: ... руб. Он включает страхование жизни и здоровья всех
        пассажиров и находится в том же файле, что и посадочный купон." и
        ссылкой "Подробнее об условиях"

        * Для каждого билета на странице успешной покупки есть пункт Страховка

        * При нажатии на иконку ? рядом с пунктом страховки появляется попап с
        текстом "Страхование жизни и здоровья от несчастных случаев." и ссылкой
        "Подробнее об условиях.", которая ведет на правила от Ренессанса

        * Сумма стоимостей страховки всех пассажиров совпадает с общей
        стоимостью на странице подтверждения

        * Для ребенка без места Цена билета и Сервисный сбор равны 0, Стоимость
        страховки равна 40
    - do: Нажать на кнопку "Скачать билеты и страховку" (в таче просто Скачать)
    - assert: >-
        * Произошло скачивание pdf-файла на десктопе. На таче могут быть
        вариации открытия/сохранения документа
    - do: Открыть файл
    - assert: >-
        * В файле есть электронные билеты для 3 пассажиров и страховки для 3
        пассажиров (3 разных бланка)
    - do: Кликнуть по ссылке "Подробнее об условиях" из письма
    - assert: >-
        * Открылась страница Ренессанс Страхования с подробными условиями
        страхования
    - do: Открыть чек из письма и со страницы заказа (асессоры пропускают шаг)
    - assert: >-
        * В чеке 3 позиции "Страхование поездки (страховая премия)"

        * Суммы за страховки и итоговая сумма в чеке совпадают с суммами в
        письме и на странице заказа

        * **В тестинге не проверить из-за заглушки у траста, поэтому просто
        проверить скачивание чека**
    - do: Открыть pdf-файл с билетами из письма
    - assert: >-
        * В файле есть электронные билеты для 3 пассажиров (2 бланка:
        взрослый+младенец, ребенок) и страховки для 3 пассажиров (3 разных
        бланка)
manual: true
Функциональность: Покупка
Устройство:
  - Десктоп
  - Тач
Страница: Страница заказа
Сервис: ЖД
Тестирование асессорами: Да
Окружение: Testing
Tag:
  - Smoke
  - Blocker
Автор: shenfeld
