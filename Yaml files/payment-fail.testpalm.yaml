feature: Отели
type: Бронирование отелей

specs:
    Ошибка оплаты - повторная оплата:
        - condition: Быть залогиненым.
        - do: Перейти на страницу бронирования для любого отеля, на любые даты
        - assert: Открылась страница бронирования.
        - assert: В корзинке есть галка "У меня есть промокод", по умолчанию выключена. Поле инпут для промокода и кнопка "Применить" не показывается.
        - do: Включить галку "У меня есть промокод"
        - do: В инпут написать промокод "AUTOTEST_PROMOCODE_200", нажать применить
        - assert: В блоке с промокодом появилась сумма скидки "−200₽"
        - do: Запомнить итоговую сумму
        - do: Заполнить информацию о гостях и контактную информацию любыми валидными данными.
        - do: Нажать оплатить.
        - assert: Открылась страница с формой оплаты.
        - assert: Сумма к оплате соответствует сумме с примененным промокодом
        - do: Оплатить заказ картой с ошибкой (указать CVN карты 228)
        - assert: Остались на странице с трастом
        - assert: Показался попап "Ошибка оплаты Проверьте данные карты, пополните баланс или используйте другую карту."
        - assert: В нем две кнопки - Отменить заказ, Попробовать еще раз
        - assert: Сумма c учетом промокода
        - do: Нажать на кнопку "Попробовать еще раз"
        - assert: Попап скрылся
        - assert: Открылась форма траста
        - do: Завершить оплату
        - assert: Открылась страница успешного заказа
        - do: Нажать на кнопку "Подробнее о заказе"
        - assert: Открылась страница заказа в личном кабинете
        - assert: Сумма соответствует сумме с учетом промокода
    Ошибка оплаты - отмена заказа:
        - condition: Быть залогиненым.
        - do: Перейти на страницу бронирования для любого отеля, на любые даты
        - assert: Открылась страница бронирования.
        - assert: В корзинке есть галка "У меня есть промокод", по умолчанию выключена. Поле инпут для промокода и кнопка "Применить" не показывается.
        - do: Включить галку "У меня есть промокод"
        - do: В инпут написать промокод "AUTOTEST_PROMOCODE_200", нажать применить
        - assert: В блоке с промокодом появилась сумма скидки "−200₽"
        - do: Запомнить итоговую сумму
        - do: Заполнить информацию о гостях и контактную информацию любыми валидными данными.
        - do: Нажать оплатить.
        - assert: Открылась страница с формой оплаты.
        - assert: Сумма к оплате соответствует сумме с примененным промокодом
        - do: Оплатить заказ картой с ошибкой (указать CVN карты 228)
        - assert: Остались на странице с трастом
        - assert: Показался попап "Ошибка оплаты Проверьте данные карты, пополните баланс или используйте другую карту."
        - assert: В нем две кнопки - Отменить заказ, Попробовать еще раз
        - assert: Сумма c учетом промокода
        - do: Нажать на кнопку "Отменить заказ"
        - assert: Попап закрылся
        - assert: Открылась страница бронирования
        - assert: Промокод не применен

files:
    - tests/common/hotels/book/errorFlow/payment-fail.hermione.ts

Сервис: Отели
Страница: Бронирование
Автор: tcheremnykh
Устройство:
    - Тач
    - Десктоп
Функциональность: Промокод
Окружение:
    - Testing
Тестирование асессорами: Нет
