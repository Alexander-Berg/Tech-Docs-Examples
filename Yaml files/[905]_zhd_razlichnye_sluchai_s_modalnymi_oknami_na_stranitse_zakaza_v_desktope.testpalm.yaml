feature: ЖД
type: Страница заказа
description: >-
  **Информация для асессоров: форма оплаты с полями ввода данных карты в
  тестинге намеренно пропускается, это нормально. Заказ должен оформляться без
  ввода карты.**


  Для заполнения форм на странице оплаты использовать тестовые карты, подробнее
  здесь: https://wiki.yandex-team.ru/TRUST/testdata/#operaciisbankovskimikartami


  Например:

  Номер карты: 5100003697253468

  CVN: 090

  Дата: 01/20

  Перейти на вкладку ЖД билеты

  Создать заказ для 1 взрослого на любую дату и любой поезд. Для этого перейти
  на любую выдачу, например, Москва - Санкт-Петербург и нажать на кнопку Выбрать
  место. Далее следовать по шагам покупки.
specs:
  'ЖД: Различные случаи с модальными окнами на странице заказа в десктопе':
    - do: Кликнуть по кнопке Сдать билет рядом с данными о пассажире
    - assert: >-
        * Появилось модальное окно для ввода смс

        * Страница за пределами модального окна затемнена

        * В модальном окне есть заголовок “Вы сдаёте билет. К возврату — [сумма
        к возврату] ₽”

        * Есть предупреждение “Восстановить покупку будет нельзя.”

        * Есть поле для ввода смс с текстом “Введите код, отправленный на номер
        [номер телефона, указанный при бронировании]”

        * На указанный при оформлении заказа номер пришла смс с кодом

        * Есть отсчет времени до отправки следующей смс, начинается с 60 секунд
    - do: Кликнуть по области вне окна
    - assert: '* Окно закрылось'
    - do: Снова кликнуть по кнопке Сдать билет
    - assert: |-
        * Открылось модальное окно для возврата
        * Отсчет времени не начался заново
    - do: Дождаться истечения времени
    - assert: '* Текст про время сменился на ссылку "Отправить код еще раз"'
    - do: Кликнуть по ссылке "Отправить код еще раз"
    - assert: |-
        * На указанный при оформлении билета номер пришла смс с новым кодом
        * Ссылка сменилась на текст с отсчетом времени
    - do: Кликнуть по крестику в правом верхнем углу окна
    - assert: '* Окно закрылось'
    - do: Снова кликнуть Сдать билет
    - assert: '* Открылось окно для возврата'
    - do: 'Ничего не вводя в поле, кликнуть Подтвердить'
    - assert: |-
        * Окно не закрылось
        * Поле для ввода подсвечивается красным
        * Появился попап с текстом "Необходимо ввести код"
    - do: |-
        Ввести неверный код
        Кликнуть Подтвердить
    - assert: |-
        * Окно не закрылось
        * Поле подствечивается красным
        * Появился попап с ошибкой "Неправильно введен код"
    - do: Кликнуть по кнопке "Отменить"
    - assert: '* Окно закрылось'
manual: true
Устройство: Десктоп
Страница: Страница заказа
Сервис: ЖД
Тестирование асессорами: Да
Окружение: Testing
Автор: shenfeld
