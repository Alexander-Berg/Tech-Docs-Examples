feature: ЖД
type: Оплата
description: >-
  - Дернуть ручку тестового контекста:
  https://api.travel-balancer-test.yandex.net/api/test_context/v1/train_token?insurancePricingOutcome=IPO_SUCCESS&insuranceCheckoutOutcome=ICO_SUCCESS&insuranceCheckoutConfirmOutcome=ICCO_SUCCESS&refundPricingOutcome=RPO_SUCCESS&refundCheckoutOutcome=RCO_SUCCESS&createReservationOutcome=RCRO_SUCCESS&confirmReservationOutcome=RCOO_FAILURE&officeReturnDelayInSeconds=0&officeAcquireDelayInSeconds=0&alwaysTimeoutAfterConfirmingInSeconds=0

  - В ответе запомнить токен из поля test_context_token
specs:
  'ТК ЖД: Ошибка подтверждения брони в ИМ':
    - do: >-
        Перейти на вкладку ЖД

        Перейти на поиск Москва - Санкт-Петербург через месяц

        Для любого поезда кликнуть по кнопке Выбрать место

        На странице выбора мест выбрать любое место в любом вагоне

        Нажать Указать пассажиров

        Добавить к урлу параметр trainTestContextToken со значением полученного
        токена

        Перейти по полученной ссылке

        Заполнить поля любыми валидными данными

        Нажать Проверить заказ и купить

        Нажать Ввести карту и оплатить

        Ввести данные тестовой карты

        Нажать Оплатить
    - assert: '- Появился лоадер загрузки'
    - do: Подождать несколько секунд
    - assert: >-
        - Появилось модальное окно с ошибкой "Что-то пошло не так

        Не удалось выкупить билет. Попробуйте ещё раз. Не волнуйтесь, деньги не
        списались. Если проблема повторяется, свяжитесь со службой поддержки по
        телефону 8 800 511-71-04."
    - do: Нажать "Выбрать места заново"
    - assert: '- Произошел переход на страницу выбора мест'
manual: true
Устройство:
  - Тач
  - Десктоп
Страница: Оплата
Сервис: ЖД
Тестирование асессорами: Нет
Окружение: Testing
Tag:
  - TK
  - orkestrator
Автор: shenfeld
