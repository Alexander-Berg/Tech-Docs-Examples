# "https://testpalm.yandex-team.ru/testcase/travel-1251"
feature: Отели
type: Бронирование отелей
description:
    Для генерации события soldout (все номера раскуплены) нужно дернуть ручку тестового контекста
    https://api.travel-balancer-test.yandex.net/api/test_context/v1/tokens?originalId=742&partnerId=PI_TRAVELLINE&occupancy=2&forceAvailability=true&cancellation=CR_NON_REFUNDABLE&pansionType=PT_BB&offerName=test&priceAmount=11&getOfferOutcome=OO_SOLD_OUT&createOrderOutcome=OO_SUCCESS&hotelDataLookupOutcome=HO_REAL&reservationOutcome=RO_SUCCESS&confirmationOutcome=CO_SUCCESS&refundOutcome=RF_SUCCESS&priceMismatchRate=1.1
    При ответе с кодом 200 в booking_page_url будет содержаться урл страницы брони.

specs:
    (ТЛ) Обработка солдаута при переходе на бронь:
        - do: Перейти на страницу брони по сгенерированному урлу с заездом-выездом на завтра-послезавтра
        - assert:
              Вместо страницы бронирования открылась страница с сообщением "Все номера такого типа уже забронированы" (пример https://jing.yandex-team.ru/files/iliasova/2020-04-24_16.40.55-ksz3k.png)
              | Ниже отображается информация об отеле
              | Название - Вега Измайлово
              | Адрес и рейтинг
              | Даты заезда и выезда - завтра и послезавтра
              | Кол-во гостей
              | Название оффера - test
              | Информация про питание
              | Информация про кровати
              | Справа от названия отеля есть фото отеля
              | Под фото название отеля от партнера и ссылка Описание отеля от партнера
              | В самом низу блока об отеле расположены две кнопки
              | Начать новый поиск и Найти номера в отеле

        - do: Кликнуть по ссылке Описание отеля от партнера
        - assert: Открылся модал
              | Модал содержит название отеля, фото, карту и описание от партнера
              | Вверху модала есть крестик для закрытия

        - do: Кликнуть по крестику над модалом
        - assert: Модал закрылся

        - do: Кликнуть по кнопке Начать новый поиск
        - assert: Произошел переход на выдачу отелей из гео-региона бронируемого отеля

        - do: Вернуться на предыдущую страницу
        - do: Кликнуть по Найти номера в отеле
        - assert: Открылась страница отеля Вега Измайлово с теми же параметрами дат и гостей

files:
    - tests/common/hotels/book/flowErrorsTravelline/getOfferSoldout.hermione.ts

Сервис: Отели
Автор: iliasova
Устройство:
    - Десктоп
    - Тач
Функциональность: Бронирование
Страница: Бронирование
Окружение:
    - Testing
tags: ТК
Тестирование асессорами: Нет
