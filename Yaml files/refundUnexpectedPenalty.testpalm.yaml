# https://testpalm.yandex-team.ru/testcase/travel-1263
feature: Отели
type: Бронирование отелей
description: Для генерации ошибки нужно дернуть ручку тестового контекста
    https://api.travel-balancer-test.yandex.net/api/test_context/v1/tokens?originalId=742&partnerId=PI_TRAVELLINE&occupancy=2&forceAvailability=true&cancellation=CR_PARTIALLY_REFUNDABLE&pansionType=PT_BB&offerName=test&priceAmount=11000&partiallyRefundRate=50&getOfferOutcome=OO_SUCCESS&createOrderOutcome=OO_SUCCESS&hotelDataLookupOutcome=HO_REAL&reservationOutcome=RO_SUCCESS&confirmationOutcome=CO_SUCCESS&refundOutcome=RF_UNEXPECTED_PENALTY&priceMismatchRate=2
    При ответе с кодом 200 в booking_page_url будет содержаться урл страницы брони.

specs:
    (ТЛ) Обработка ошибки при возврате:
        - do: Перейти на страницу брони по сгенерированному урлу с заездом-выездом на завтра-послезавтра
        - assert: Открылась страница бронирования

        - do: Заполнить данные гостей и контактные данные валидными значениями
        - do: Кликнуть по Оплатить (если будет шаг оплаты, ввести данные тестовой карты и оплатить)
        - assert: Произошел переход на хэппи пейдж
        - do: Нажать на кнопку "Подробнее о заказе"
        - assert: Произошел переход на страницу заказа в личном кабинете
        - assert: На странице есть кнопка "Отменить бронирование"
              | Кнопка кликабельна

        - do: Кликнуть по кнопке "Отменить бронирование"
        - do: В раскрывшемся попапе кликнуть "Отменить бронирование"
        - assert:
              Появился лоадер с текстом “Загрузка заказа Загружаем подробную информацию о заказе”
              | Далее открылась страница ошибки при возврате
              | Заголовок ошибки Не получилось отменить бронирование
              | Далее указан номер поддержки и номер заказа в формате YA-XXXX-XXXX-XXXX
              | Ниже отображается информация об отеле
              | Название - Вега Измайлово
              | Адрес
              | Даты заезда и выезда - завтра и послезавтра
              | Кол-во гостей - 2
              | Название оффера - test
              | Информация про питание - Завтрак включен
              | Информация про кровати
              | Справа есть фото отеля

files:
    - tests/common/hotels/book/flowErrorsTravelline/refundUnexpectedPenalty.hermione.ts

Сервис: Отели
Автор: iliasova
Устройство:
    - Десктоп
    - Тач
Окружение:
    - Testing
tags: ТК
Тестирование асессорами: Нет
