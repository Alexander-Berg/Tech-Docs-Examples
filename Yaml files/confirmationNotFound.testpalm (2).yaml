# https://testpalm.yandex-team.ru/testcase/travel-1261
feature: Отели
type: Бронирование отелей
description: Для генерации ошибки нужно дернуть ручку тестового контекста
    https://api.travel-balancer-test.yandex.net/api/test_context/v1/tokens?originalId=742&partnerId=PI_TRAVELLINE&checkinDate=2020-06-20&occupancy=2&forceAvailability=true&cancellation=CR_FULLY_REFUNDABLE&pansionType=PT_BB&offerName=test&priceAmount=11000&getOfferOutcome=OO_SUCCESS&createOrderOutcome=OO_SUCCESS&hotelDataLookupOutcome=HO_REAL&reservationOutcome=RO_SUCCESS&confirmationOutcome=CO_NOT_FOUND&refundOutcome=RF_SUCCESS&priceMismatchRate=1.1
    При ответе с кодом 200 в booking_page_url будет содержаться урл страницы брони.

specs:
    (ТЛ) Обработка ошибки при подтверждении брони:
        - do: Перейти на страницу брони по сгенерированному урлу с заездом-выездом на завтра-послезавтра
        - assert: Открылась страница бронирования

        - do: Заполнить данные гостей и контактные данные валидными значениями
        - do: Кликнуть по Оплатить (если будет шаг оплаты, ввести данные тестовой карты и оплатить)
        - assert:
              Появился лоадер с текстом "Создание заказа Создаем заказ и готовимся к оплате"
              | Элементы на странице задизейблены https://jing.yandex-team.ru/files/shenfeld/Yandeks.Puteshestviya__aviabilety_bilety_na_poezd_bronirovanie_otelei_2019-03-27_13-02-02.png
              | Далее произошел переход на страницу ошибки при бронировании
              | Заголовок ошибки Забронировать номер не получилось. Деньги вернутся в течение часа
              | Ниже информация для пользователя о том, куда обратиться
              | Ссылка на поддержку https://yandex.ru/support/travel/troubleshooting.html
              | Указан номер заказа в формате YA-XXXX-XXXX-XXXX
              | Ниже отображается информация об отеле
              | Название - Вега Измайлово
              | Адрес и рейтинг
              | Даты заезда и выезда - завтра и послезавтра
              | Кол-во гостей - 2
              | Название оффера - test
              | Информация про питание - завтрак включен
              | Информация про кровати
              | Справа от названия отеля есть фото отеля
              | Под фото название отеля от партнера и ссылка Описание отеля от партнера
              | В самом низу блока об отеле расположены две кнопки
              | Начать новый поиск и Найти номера в отеле

        - do: Кликнуть по ссылке Описание отеля от партнера
        - assert: Открылся модал
              | Модал содержит название отеля, фото, карту и описание от партнера
              | Вверху модала есть крестик для закрытия

        - do: Кликнуть по крестику над модалом
        - assert: Модал закрылся

        - do: Кликнуть по кнопке Начать новый поиск
        - assert: Произошел переход на выдачу отелей из гео-региона бронируемого отеля

        - do: Вернуться на предыдущую страницу
        - do: Кликнуть по Найти номера в отеле
        - assert: Открылась страница отеля Вега Измайлово с теми же параметрами дат и гостей

files:
    - tests/common/hotels/book/flowErrorsTravelline/confirmationNotFound.hermione.ts

Сервис: Отели
Автор: iliasova
Устройство:
    - Десктоп
    - Тач
Функциональность: Бронирование
Страница: Бронирование
Окружение:
    - Testing
tags: ТК
Тестирование асессорами: Нет
