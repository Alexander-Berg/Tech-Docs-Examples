feature: Удаление организации

description: |
  Организация с сотрудниками, админ (adm-org@yandex.ru =-123qwe), для кейса удаления организации с сотрудниками.
  Организация с ресурсами, админ (ui-adm-org-resources@yandex.ru =-123qwe), для кейса удаления организации с ресурсами.
  Организация с заполненной биллинговой информацией, админ (org-adm@yandex.ru =-123qwe), для кейса удаление организации с биллинговой информацией

import-steps:
  - tests/hermione/shared-steps/registration.testpalm.steps.yml

aliases:
  - &delete_from_profile
    - do: |
        перейти на страницу "Профиль организации" {{CONNECT_HOST}}/portal/profile
        нажать на кнопку "Удалить организацию"
  - &reopen_delete_popup
    - assert: попап закрылся
    - do: нажать на кнопку "Удалить организацию"
    - assert: открылся попап "Удаление организации"
  - &remove_flow_short
    - *delete_from_profile
    - assert: открылся попап "Удаление организации"
    - do: нажать на кнопку "Удалить"
    - assert: |
        открылся попап "Удаление организации..." со спинером
        выполнился переход на промо страницу Коннекта {{CONNECT_HOST}}

specs:
  1. Удаление организации без сотрудников:
    - do: авторизоваться под учеткой в паспорте у которой есть организация или зарегистрироваться и создать организацию
    - attach: Регистрация организации с промо коннекта
    - *delete_from_profile
    - screenshot: появился попап "Удаление организации" с крестиком и кнопками "Отмена", "Удалить" [modal]
    - do: нажать на крестик
    - *reopen_delete_popup
    - do: нажать на кнопку "Отменить"
    - *reopen_delete_popup
    - do: нажать на кнопку "Удалить"
    - screenshot: открылся попап "Удаление организации..." со спинером [modal-removing]
    - assert: выполнился переход на промо страницу Коннекта {{CONNECT_HOST}}
  2. Удаление организации с сотрудниками:
    - do: авторизоваться под учеткой админа из description (adm-org@yandex.ru)
    - *remove_flow_short
  3. Удаление организации с биллинговой информацией:
    - do: авторизоваться под учеткой админа из description (org-adm@yandex.ru)
    - *remove_flow_short
  4. Удаление организации с ресурсами:
    - do: авторизоваться под учеткой админа из description (ui-adm-org-resources@yandex.ru)
    - *remove_flow_short
  5. Удаление организации без сотрудников и с подтвержденным доменом:
    - do: авторизоваться под учеткой в паспорте у которой есть организация или зарегистрироваться и создать организацию
    - attach: Регистрация организации с промо коннекта с подтверждением домена
    - *remove_flow_short

files:
  - tests/hermione/suites/organization/delete.js

priority: blocker

tlds:
  - ru
  - com

tags:
  - smoke_test_assessors
  - regression
  - smoke_test
  - reviewed
  - smoke_test_mini
