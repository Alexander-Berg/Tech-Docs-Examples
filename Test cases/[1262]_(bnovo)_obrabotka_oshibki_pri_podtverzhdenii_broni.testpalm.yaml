feature: Отели
type: ''
description: >-
  Для генерации ошибки подтверждения брони нужно дернуть ручку тестового
  контекста

  https://api.travel-balancer-test.yandex.net/api/test_context/v1/tokens?originalId=1024&partnerId=PI_BNOVO&checkinDate=2020-06-20&occupancy=2&forceAvailability=true&cancellation=CR_FULLY_REFUNDABLE&pansionType=PT_BB&offerName=test&priceAmount=11000&getOfferOutcome=OO_SUCCESS&createOrderOutcome=OO_SUCCESS&hotelDataLookupOutcome=HO_REAL&reservationOutcome=RO_SUCCESS&confirmationOutcome=CO_NOT_FOUND&refundOutcome=RF_SUCCESS&priceMismatchRate=1.1


  При ответе с кодом 200 в booking_page_url будет содержаться урл страницы
  брони.

  Для тестовой оплаты использовать карту

  Карта для тестовой оплаты тестовой брони: 5100002767155462

  Месяц и год: 12/22

  CVV: 454
specs:
  (Bnovo) Обработка ошибки при подтверждении брони:
    - do: >-
        Перейти на страницу брони по сгенерированному урлу с заездом-выездом на
        завтра-послезавтра
    - assert: 'assert: Открылась страница бронирования'
    - do: Заполнить данные гостей и контактные данные валидными значениями
    - do: Кликнуть по Оплатить
    - assert: >-
        assert: Появился лоадер с текстом "Создание заказа Создаем заказ и
        готовимся к оплате"

        | Элементы на странице задизейблены:

        ![image](https://jing.yandex-team.ru/files/shenfeld/Yandeks.Puteshestviya__aviabilety_bilety_na_poezd_bronirovanie_otelei_2019-03-27_13-02-02.png)

        | Через какое-то время произошел переход на страницу оплаты
    - do: Выбрать Новая карта и ввести данные карты из описания кейса
    - do: Кликнуть Оплатить
    - assert: >-
        assert: Вместо блока ввода данных карты появился лоадер с текстом
        “Платеж производится. Пожалуйста, подождите”

        | Далее на всю страницу появился лоадер с текстом “Оплата заказа
        Оплачиваем заказ и готовим выписку”, все элементы на странице
        задизейблены

        | Далее произошел переход на страницу ошибки при бронировании

        | Заголовок ошибки Забронировать номер не получилось. Деньги вернутся в
        течение часа

        | Ниже информация для пользователя о том, куда обратиться:

        | Ссылка на поддержку
        https://yandex.ru/support/travel/troubleshooting.html

        | Указан номер заказа в формате YA-XXXX-XXXX-XXXX

        | Ниже отображается информация об отеле:

        | Название - Принцесса Элиза

        | Адрес и рейтинг

        | Даты заезда и выезда - завтра и послезавтра

        | Кол-во гостей - 2

        | Название оффера - test

        | Информация про питание - завтрак включен

        | Справа от названия отеля есть фото отеля

        | Под фото название отеля от партнера и ссылка Описание отеля от
        партнера

        | В самом низу блока об отеле расположены две кнопки:

        | Начать новый поиск и Найти номера в отеле
    - do: Кликнуть по ссылке Описание отеля от партнера
    - assert: |-
        assert: Открылся модал
        | Модал содержит название отеля, фото, карту и описание от партнера
        | Вверху модала есть крестик для закрытия
    - do: Кликнуть по крестику над модалом
    - assert: 'assert: Модал закрылся'
    - do: Кликнуть по кнопке Начать новый поиск
    - assert: >-
        assert: Произошел переход на выдачу отелей из гео-региона бронируемого
        отеля
    - do: Вернуться на предыдущую страницу
    - do: Кликнуть по Найти номера в отеле
    - assert: >-
        assert: Открылась страница с сообщением "Вы ищете номера в отеле
        Принцесса Элиза c 25 по 26 апреля 2020 года для двоих взрослых" (даты и
        кол-во гостей должны соответствовать актуальным для кейса)

        | Через некоторое время произошел переход на страницу отеля на серпе
        https://yandex.ru/profile/......
manual: true
Устройство:
  - Десктоп
  - Тач
Сервис: Отели
Тестирование асессорами: Нет
Окружение: Testing
Tag: TK
Автор: iliasova
