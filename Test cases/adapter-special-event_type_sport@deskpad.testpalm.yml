feature: Специальные события
type: ЧМФ - Главный экран

description: 'Примечание: В тестовых данных изображения футболок команд могут не соответствовать реальным.'

specs:
  Основные проверки:
    params:
      foreverdata: '2021415315'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: получена выдача по указанному запросу
      - assert: на выдаче присутствует колдунщик чемпионата мира по футболу
      - assert: в верхнем левом углу присутствует название колдунщика "Чемпионат мира по футболу 2018"
      - assert: в колдунщике присутствуют таблицы "Расписание матчей", "Турнирная таблица", "Статистика игроков"
      - assert: под таблицами присутствует галерея "Стадионы"
      - assert: под галереей "Стадионы" присутствует галерея "Другие турниры"
    Турнирная таблица - Таблица плей-офф:
      - do: кликнуть в кнопку "Таблица плей-офф" в таблице "Турнирная таблица"
      - assert: открылся попап "Плей-офф Чемпионата мира по футболу 2018"
      - tech: сработал счетчик '/wiz/special/event/chmf2018/standings/button'
      - screenshot: внешний вид [play-off]
      - assert: внешний вид соответствует скриншоту
      - do: кликнуть в любой матч в попапе
      - assert: в новой вкладке открылась выдача с колдунщиком выбранного матча
      - tech: сработал счетчик '/wiz/special/event/chmf2018'
      - do: вернуться на предыдущую вкладку
      - assert: отображается попап "Плей-офф Чемпионата мира по футболу 2018"
      - do: кликнуть в "Х" в правом верхнем углу
      - assert: попап закрылся
      - tech: сработал счетчик '/wiz/special/event/chmf2018/close'
    Турнирная таблица - табы и сборная:
      - assert: таб "Группа А" в таблице "Турнирная таблица" активен
      - do: кликнуть в таб "B"
      - assert: содержимое таблица обновилось
      - assert: в таблице присутствует информация о сборных группы "B"
      - assert: таб "B" активен
      - tech: сработал счетчик '/wiz/special/event/chmf2018/table/item'
      - screenshot: внешний вид [standings-group-b]
      - assert: внешний вид соответствует скриншоту
      - do: кликнуть в "Испания"
      - assert: получена выдача по новому запросу "Испания на ЧМ по футболу 2018"
      - tech: сработал счетчик '/$page/$top/$result/body/standings'
    Статистика игроков - листалка:
      - assert: таб "Бомбардиры" в таблице "Статистика игроков" активен
      - do: кликнуть в листалку ">"
      - assert: содержимое таблицы обновилось
      - assert: появилась листалка "<"
      - tech: сработал счетчик '/wiz/special/event/chmf2018/table/pager/next'
      - do: кликнуть в листалку "<"
      - assert: содержимое таблицы обновилось
      - assert: листалка "<" исчезла
      - tech: сработал счетчик '/wiz/special/event/chmf2018/table/pager/prev'
      - assertMetrics: '*'
  Блок новостей:
    params:
      foreverdata: '3373209713'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: колдунщик турнира "Лига чемпионов" присутствует на странице
      - screenshot: внешний вид новостей в колдунщике турнира [sport-{{PLATFORM}}__news >> news]
    Тайтл - Новости чемпионата:
      - label: sport-{{PLATFORM}}__news
      - screenshot: внешний вид новостей [news]
      - do: кликнуть в тайтл "Новости" над блоком новостей
      - assert: в новой вкладке открылся поиск по новостям с запросом "Лига чемпионов"
      - tech: сработал счетчик '/wiz/special/event/sport/football/news/title'
      - assertMetrics: '*'
    Новость - первая:
      - do: кликнуть в первую новость
      - assert: в новой вкладке открылся сервис Яндекс.Новости (проверяется сам факт перехода на сервис Яндекс.Новости. Отсутствующий сюжет на сервисе Я.Новости не является ошибкой теста)
      - tech: сработал счетчик '/wiz/special/event/sport/football/table/news,-row=0'
      - assertMetrics: '*'
    Новость - последняя:
      - do: кликнуть в последнюю новость
      - assert: в новой вкладке открылся выбранный новостной сюжет
      - tech: сработал счетчик '/wiz/special/event/sport/football/table/news,-row=2'
      - assertMetrics: '*'
    Кнопка - Все новости:
      - do: кликнуть в кнопку "Все новости" в нижней части новостного блока
      - assert: в новой вкладке открылся поиск по новостям с запросом "Лига чемпионов"
      - tech: сработал счетчик '/wiz/special/event/sport/football/news/button'
      - assertMetrics: '*'
  Новости - гринурл со слэшем:
    - params:
        user_time: '20190920'
        foreverdata: '3237460707'
        text: foreverdata
    - do: получить выдачу по запросу foreverdata
    - assert: на выдаче присутствует колдунщик турнира
    - do: подскроллить колдун вправо при необходимости вправо до блока новостей
    - screenshot: примерный внешний вид новостей [with-slashes-in-news]
    - assert: внешний вид гринурлов в новостях соответствует скриншоту
    - assertMetrics: '-'
  Расписание матчей - матч с неизвестным временем:
    - params:
        foreverdata: '3421546750'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик турнира присутствует на странице
    - screenshot: внешний вид [match-time-unknown]
  Видео тумба в расписании матчей:
    - params:
        foreverdata: '1677776543'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: открылась страница с колдунщиком ЧМФ
    - assert: в таблице "Расписание матчей" есть матчи с видео
    - screenshot: внешний вид таблицы [timetable-row-video]
    - do: нажать на видео второго матча в таблице "Расписание матчей"
    - tech: сработал счетчик '/wiz/special/event/chmf2018/table/timetable/video/'
    - assert: во фрейме открылся сервис "Яндекс Эфир" (само видео может отсутствовать на сервисе, это не ошибка, а тестовые данные)
    - do: нажать "Х" в верхнем правом углу
    - assert: фрейм закрылся
    - assertMetrics: '*'
  Матчи в разных статусах:
    params:
      foreverdata: '195608074'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: колдунщик ЧМФ присутствует на странице
    Идет сейчас - один матч в таблице с трансляцией:
      - do: кликнуть в таб "Финал" таблицы "Расписание матчей"
      - assert: содержимое таблицы обновилось
      - assert: под счетом отображается статус матча "Идет сейчас" с иконкой трансляции
      - screenshot: внешний вид [match-in-progress]
      - assert: внешний вид соответствует скриншоту
      - do: кликнуть в статус матча
      - assert: во фрейме открылся сервис "Яндекс Эфир" (само видео может отсутствовать на сервисе, это не ошибка, а тестовые данные)
      - tech: сработал счетчик '/wiz/special/event/chmf2018/table/timetable/icon'
      - assertMetrics: '*'
    Идет сейчас - один матч в таблице:
      - do: кликнуть в таб "3-е место" таблицы "Расписание матчей"
      - assert: содержимое таблицы обновилось
      - assert: под счетом отображается статус матча "Идет сейчас"
      - screenshot: внешний вид [match-in-progress-no-translation]
      - assert: внешний вид соответствует скриншоту
      - assertMetrics: '*'
    Идет сейчас - два матча в таблице:
      - assert: под счетом отображается статус матча "Идет сейчас"
      - screenshot: внешний вид [match-double]
      - assert: внешний вид соответствует скриншоту
      - assertMetrics: '*'
    Матчи в списке с разными статусами:
      - do: кликнуть в таб "Групповой этап" таблицы "Расписание матчей"
      - assert: содержимое таблицы обновилось
      - assert: в таблице отображается список матчей в статусах "Идет сейчас" с иконкой трансляции, "Завершен", "Идет сейчас" и "Отменен"
      - screenshot: внешний вид [match-list-statuses]
      - assert: внешний вид соответствует скриншоту
    Матчи в списке с разными статусами - иконка трансляции:
      - do: кликнуть в таб "Групповой этап" таблицы "Расписание матчей"
      - assert: содержимое таблицы обновилось
      - do: кликнуть в иконку трансляции этого же матча
      - assert: в новой вкладке открылся сервис "Яндекс.Спорт" (само видео может отличаться от ожидаемого или отсутствовать на сервисе, это не ошибка, а тестовые данные)
      - tech: сработал счетчик '/wiz/special/event/chmf2018/table/timetable/icon'
    Завершен и в процессе - по пенальти:
      - do: кликнуть в таб "1/4" таблицы "Расписание матчей"
      - assert: содержимое таблицы обновилось
      - assert: в таблице присутствуют завершенные матчи, для которых указан счет по пенальти, и матч со статусом "Идет сейчас"
      - screenshot: внешний вид [match-penalty]
      - assert: внешний вид соответствует скриншоту
      - assertMetrics: '*'
    Матч завершен - с доступной трансляцией - иконка:
      - do: кликнуть в таб "Групповой этап" таблицы "Расписание матчей"
      - assert: содержимое таблицы обновилось
      - assert: в таблице в числе прочих отображается матч в статусе "Завершен" с иконкой доступной трансляции
      - screenshot: внешний вид [finished-with-translation]
      - assert: внешний вид соответствует скриншоту
      - do: кликнуть в иконку трансляции матча в статусе Завершен
      - assert: в новой вкладке открылся сервис "Кинопоиск", вкладка "Спорт", в адресной строке присутствует url https://yandex.ru/sport/live/event... (само видео может отличаться от ожидаемого или отсутствовать на сервисе, это не ошибка, а тестовые данные)
      - tech: сработал счетчик '/wiz/special/event/chmf2018/table/timetable/icon'
  Двузначный счет:
    - params:
        foreverdata: '644324147'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на странице
    - assert: в таблице "Расписание матчей" присутствует матч с двузначным счетом
    - screenshot: колдунщик [semifinal-double-digit]
    - assert: внешний вид соответствует скриншоту
    - assertMetrics: '*'
  Таблица плей-офф - параметр source в ссылке матча:
    - tags:
        - no_assessors
    - params:
        foreverdata: '1386873366'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на странице
    - do: нажать на кнопку "Таблица плей-офф" в подвале Турнирной таблицы
    - assert: открылся большой попап плей-офф
    - do: нажать на карточку 1/4 финала Россия-Исландия
    - assert: открылась вкладка с матчем
    - assert: в адресе открывшейся страницы есть параметр source=sport-serp
    - assertMetrics: '*'
  Расписание матчей - финал - параметр source в ссылке:
    - tags:
        - no_assessors
    - params:
        foreverdata: '1386873366'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на странице
    - assert: таб "Финал" в таблице "Расписание матчей" активен
    - do: кликнуть в левый флаг в таблице "Расписание матчей"
    - tech: сработал счетчик '/wiz/special/event/chmf2018_team/table/team/p0'
    - assert: страница обновилась аяксом
    - assert: в адресе страницы есть параметр source=sport-serp
    - assertMetrics: '*'
  Расписание матчей - матч без стадиона:
    - params:
        foreverdata: '3933177740'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на странице
    - screenshot: внешний вид [plain-without-stadium]
    - assertMetrics: '*'
  Внешний вид - баскетбол:
    - params:
        foreverdata: '1168721721'
    - do: получить выдачу по запросу 'foreverdata'
    - screenshot: внешний вид [plain-basketball]
    - assertMetrics: '*'
  Нажатие на кнопку "Билеты":
    - params:
        foreverdata: '3536125769'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на странице
    - assert: в таблице "Расписание матчей" присутствует матч с кнопкой "Билеты"
    - screenshot: внешний вид [with-afisha-button]
    - do: кликнуть в кнопку "Билеты"
    - assert: открылся сервис "Яндекс.Афиша" в новой вкладке
    - tech: сработал счетчик '/wiz/special/event/football/table/timetable/afisha'
    - assertMetrics: '*'
  Блок новостей - новость с гринурлом:
    - params:
        foreverdata: '1486335751'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на странице
    - screenshot: внешний вид новостей с гринурлами [news]
    - do: кликнуть в первую новость
    - assert: в новой вкладке открылся выбранный новостной сюжет
    - tech: сработал счетчик '/wiz/special/event/football/table/news,-row=0'
    - do: вернуться на вкладку с колдунщиком
    - do: кликнуть в гринурл первой новости
    - assert: в новой вкладке открылся выбранный новостной сюжет
    - tech: сработал счетчик '/wiz/special/event/football/table/news/urlnav,-row=0'
    - assertMetrics: '*'
  Обводка флага национальных сборных:
    - params:
        foreverdata: '3464937401'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на странице
    - screenshot: внешний вид таблицы "Расписание матчей" [schedule]
    - assert: внешний вид соответствует скриншоту
    - assert: в расписании матчей флаги выделены серой полупрозрачной рамочкой
    - assertMetrics: '*'
  Внешний вид для Украины:
    - params:
        foreverdata: '635598146'
        user_time: '20181121'
        l10n: uk
        tld: ua
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на выдаче
    - screenshot: внешний вид [plain-ua]
    - assert: все тексты в колдунщике на русском языке
    - assertMetrics: '*'
  Внешний вид ссылки на внешнимй источник - по данным ФИФА:
    - params:
        foreverdata: '2280823140'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на выдаче
    - screenshot: внешний вид [with-source-link]
    - assert: справа снизу видна ссылка "По данным ФИФА"
    - do: нажать на ссылку
    - assert: открылась новая страница с соответствующим сайтом
    - teсh: сработал счетчик '/wiz/special/event/football/source'
    - assertMetrics: '*'
  Видео в песочнице:
    params:
      foreverdata: '1737682961'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче присутствует колдунщик чемпионата
    Трансляция:
      - assert: ссылка на большой тумбе трансляции содержит 'https://yastatic.net/video-player/0x7c14eb8199/pages-common/default/default.html'
      - do: нажать на тумбу
      - assert: открылся фрейм с видео (видео может быть недоступно, это не ошибка, суть проверки в открытии оверлея)
      - tech: сработал счетчик '/wiz/special/event/sport/football/translation'
      - assertMetrics: '-'
  Сокрытие счета:
    Проверка работы:
      - params:
          foreverdata: '927831754'
      - do: почистить куки и получить выдачу по запросу 'foreverdata'
      - assert: колдунщик присутствует на выдаче
      - assert: в правом верхнем углу присутствует кнопка сокрытия счета и тултип с подсказкой "Результаты матча можно скрывать"
      - screenshot: внешний вид [with-button-and-tooltip]
      - do: нажать на кнопку сокрытия счета
      - assert: тултип с подсказкой закрылся
      - assert: кнопка стала активной
      - assert: в таблице расписаний скрылся счет у матчей
      - tech: сработал счетчик '/$page/$top/$result/hide_goals/button'
      - screenshot: внешний вид [with-hidden-score]
      - do: обновить выдачу (заново получить выдачу по тому же запросу)
      - assert: на выдаче присутствует колдунщик
      - assert: отсутствует тултип с сообщением "Результаты матча можно скрывать"
      - assert: счет матчей скрыт под звездочками
      - assert: кнопка скрытия счета во включенном состоянии
      - do: нажать на кнопку сокрытия счета
      - assert: кнопка стала неактивной
      - assert: счет отобразился для всех матчей
      - do: обновить выдачу (заново получить выдачу по тому же запросу)
      - assert: на выдаче присутствует колдунщик матча
      - assert: отсутствует тултип с сообщением "Результаты матча можно скрывать"
      - assert: счет матча отображается
      - assert: кнопка скрытия счета матча в выключенном состоянии
      - assertMetrics: '*'
    На табике "Полуфинал":
      - params:
          foreverdata: '185236845'
      - do: почистить куки и получить выдачу по запросу 'foreverdata'
      - assert: колдунщик присутствует на выдаче
      - assert: в правом верхнем углу присутствует кнопка сокрытия счета и тултип с подсказкой "Результаты матча можно скрывать"
      - screenshot: внешний вид [button-and-tooltip-semifinal]
      - do: нажать на кнопку сокрытия счета
      - assert: тултип с подсказкой закрылся
      - assert: кнопка стала активной
      - assert: в таблице расписаний скрылся счет у матчей
      - tech: сработал счетчик '/$page/$top/$result/hide_goals/button'
      - screenshot: внешний вид [hidden-score-semifinal]
      - do: обновить выдачу (заново получить выдачу по тому же запросу)
      - assert: на выдаче присутствует колдунщик
      - assert: отсутствует тултип с сообщением "Результаты матча можно скрывать"
      - assert: счет матчей скрыт под звездочками
      - assert: кнопка скрытия счета во включенном состоянии
      - do: нажать на кнопку сокрытия счета
      - assert: кнопка стала неактивной
      - assert: счет отобразился для всех матчей
      - do: обновить выдачу (заново получить выдачу по тому же запросу)
      - assert: на выдаче присутствует колдунщик матча
      - assert: отсутствует тултип с сообщением "Результаты матча можно скрывать"
      - assert: счет матча отображается
      - assert: кнопка скрытия счета матча в выключенном состоянии
      - assertMetrics: '*'
  Баскетбол - трехзначный счет:
    - params:
        foreverdata: '3259223073'
    - do: получить выдачу по запросу "foreverdata"
    - assert: колдунщик присутствует на выдаче
    - screenshot: внешний вид таблицы расписания [long-score]

tlds:
  - ru
  - by
  - uz
  - kz
  - uz

tags:
  - sport
  - reviewed
  - skip_e2e_check # разнесено по папкам с конкретными видами спорта

files:
  - features/adapter-special-event/adapter-special-event_type_sport/adapter-special-event_type_sport@deskpad.hermione.js

v-team: Sport

counter: /$page/$main/$result[@wizard_name="special/event" and @subtype="sport/football"]/title
