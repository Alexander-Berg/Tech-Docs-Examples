feature: Добавление пользователя

aliases:
  - &open_user_form
    - do: переходим в админку по ссылке "{{CONNECT_HOST}}/portal/admin"
    - do: нажимаем кнопку "+ Добавить" в футере корневого отдела
    - do: выбираем первый пункт "Добавить сотрудника" в выпадающем меню
    - assert: открылся попап "Новый сотрудник"

specs:
  beforeEach:
    - do: авторизоваться под учеткой администратора, логин ad12@yandex.ru пароль 8Vb-dqR-KkK-vuM
  Положительные:
    1. Доступность формы "Добавление сотрудника" с дашборда:
      - do: переходим на дашборд по ссылке "{{CONNECT_HOST}}/portal/home"
      - do: нажимаем на экшен "+ Добавить сотрудника" на плитке "Админка"
      - assert: |
          выполнился переход в админку
          открылся попап "Новый сотрудник"
      - screenshot: скриншот попапа "Новый сотрудник" [new-user-form]
    2. Доступность формы "Добавление сотрудника" в админке:
      - *open_user_form
    3. Пользователь создается, заполнены обязательные поля:
      - *open_user_form
      - do: заполняем обязательные поля Фамилия, Имя, Логин, Пароль, Еще раз
      - screenshot: форма создания сотрудника с заполненными обязательными полями [required-filled-form]
      - do: нажать на кнопку "Добавить"
      - assert: появилась нотификация "Пользователь создан", попап закрылся
      - screenshot: отображается сообщение "Пользователь создан" [notification]
      - do: нажать на крестик в нотификации
      - assert: открыта карточка сотрудника "{{CONNECT_HOST}}/portal/admin/users/{{uid}}"
      - assert: новый сотрудник отображается в составе отдела
      - do: проверяем что имя и фамилия в карточке пользователя совпадают с теми что заполнили ранее в попапе "Новый сотрудник"
    4. Пользователь создается, заполнены все поля:
      - *open_user_form
      - do: |
          в поле "Фамилия*" ввести произвольное корректное значение
          в поле "Имя*" ввести произвольное корректное значение
          в поле "Отчество" ввести произвольное корректное значение
          в поле "Должность" ввести произвольное корректное значение
          в поле "Язык" выбрать из выпадающего списка любой язык
          в поле "Часовой пояс" выбрать из выпадающего списка любой часовой пояс
          в поле "Дата рождения" ввести корректную дату рождения, месяц выбрать из выпадающего списка
          в поле "Пол" выбрать через переключатель пол
          в поле "Логин*" ввести произвольное корректное значение
          в поле "Пароль*" ввести произвольное корректное значение
          в поле "Еще раз*" ввести произвольное корректное значение
          в поле "Почта" ввести произвольное корректное значение
          нажать кнопку "+ Добавить"
          в выпадающем списке выбрать "Skype"
          в поле "Skype" ввести произвольное корректное значение
          в поле "Отдел" нажать на крестик возле "Все сотрудники"
          в поле "Отдел" ввести отдел "Тест"
          выбрать отдел "Тест" из саджеста
      - screenshot: форма создания сотрудника с заполненными полями [filled-form]
      - do: нажать на кнопку "Добавить"
      - assert: появилась нотификация "Пользователь создан", попап закрылся
      - do: нажать на крестик в нотификации
      - assert: открыта карточка сотрудника "{{CONNECT_HOST}}/portal/admin/users/{{uid}}"
      - assert: новый сотрудник отображается в составе отдела
      - do: проверяем что данные в карточке пользователя совпадают с теми что заполнили ранее в попапе "Новый сотрудник"
      - screenshot: данные заполнены как на скриншоте [user-card]
  Отрицательные:
    1. Закрытие формы по нажатию на крестик:
      - *open_user_form
      - do: нажимаем на крестик в верхнем правом углу формы
      - assert: попап закрылся
    2. Закрытие формы по нажатию на кнопку "Отменить":
      - *open_user_form
      - do: нажимаем на кнопку "Отменить"
      - assert: попап закрылся
    3. Проверка валидации при незаполненных обязательных полях:
      - *open_user_form
      - do: нажать на кнопку "Добавить"
      - assert: |
          под полем "Фамилия*" отображается сообщение "Нужно указать фамилию сотрудника."
          под полем "Имя*" отображается сообщение "Вы забыли указать имя."
          под полем "Логин*" отображается сообщение "Сотруднику обязательно нужен логин."
          под полем "Пароль*" отображается сообщение "Вы забыли про пароль."
          под полем "Еще раз*" отображается сообщение "Повторите пароль."
      - screenshot: отображаются сообщения около незаполненных обязательных полей [errors]

files:
  - tests/hermione/suites/user/create.js

priority: critical

tlds:
 - ru
 - com

tags:
  - smoke_test_assessors
  - regression
  - smoke_test
  - reviewed
  - smoke_test_mini
