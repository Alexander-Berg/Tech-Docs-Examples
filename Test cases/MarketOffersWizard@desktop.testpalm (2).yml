feature: Маркет. Офферный колдунщик в центре

specs:
  Внешний вид:
    - params:
        foreverdata: '3854672498'
        text: 'iphone'
    - assert: в выдаче есть колдунщик Маркета
    - screenshot: внешний вид [plain]
    - do: проскроллить до конца карусели
    - assert: в конце карусели должна быть карточка-лоадер (карточка без наполнения)
    - screenshot: внешний вид [loader]
    - do: подождать дозагрузки карточек
    - assert: |
        появились новые карточки
        наполнение дозагруженных карточек может отличаться от дозагруженных карточек на скриншотах
    - do: проскроллить до конца карусели
    - assert: в конце карусели есть карточка "Ещё предложения"
    - screenshot: внешний вид [after-load]

  Отображение попапа с экстралинками:
    - tags: [organic]
    - params:
        foreverdata: '416986862'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: в результатах поисковой выдачи присутствует колдунщик Маркета
    - do: клик по троеточию в конце гринурла
    - assert: отобразился попап с экстралинками
    - screenshot: внешний вид [extralinks_popup]
    - do: повторно кликнуть по троеточию в конце гринурла
    - assert: попап с экстралинками исчез

  Дозагрузка без скролла, когда пришло 3 карточки и меньше:
    - params:
        foreverdata: '1882370093'
        text: 'iphone'
    - assert: в выдаче есть колдунщик Маркета
    - assert: в конце карусели присутствует карточка-лоадер (карточка без наполнения)
    - screenshot: внешний вид [with-autoload-loader]
    - do: дождаться конца загрузки
    - assert: |
        появились новые карточки
        наполнение дозагруженных карточек может отличаться от дозагруженных карточек на скриншотах
    - screenshot: внешний вид [with-autoload-loaded]
    - do: проскроллить до конца карусели
    - assert: в конце карусели есть карточка "Ещё предложения"
    - screenshot: внешний вид [with-autoload-full]

  Если карточек изначально больше двух, isTheEnd=true - показываем кнопку "Еще предложения":
    - params:
        foreverdata: '3491423774'
        text: 'iphone'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: в результатах поисковой выдачи присутствует неявный колдунщик, в конце есть кнопка "Еще предложения"
    - screenshot: внешний вид [with-more-arrow]

  Если карточек изначально три, isTheEnd=true - не показываем кнопку "Еще предложения":
    - params:
        foreverdata: '3659887570'
        text: 'iphone'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: в результатах поисковой выдачи присутствует неявный колдунщик, в конце нет кнопки "Еще предложения"
    - screenshot: внешний вид [without-more-arrow]

  Бесконечная карусель, ссылка с бэка:
    - params:
        foreverdata: '1440582004'
    - assert: в выдаче есть колдунщик Маркета
    - screenshot: внешний вид [plain]
    - do: проскроллить до конца карусели
    - assert: в конце карусели должна быть карточка-лоадер (карточка без наполнения)
    - screenshot: внешний вид [loader]
    - do: подождать дозагрузки карточек
    - assert: |
        появились новые карточки
        наполнение дозагруженных карточек может отличаться от дозагруженных карточек на скриншотах
    - do: проскроллить до конца карусели
    - assert: в конце карусели есть карточка "Ещё предложения"
    - screenshot: внешний вид [full]

  Бесконечная карусель в дебрендированном колдунщике:
    - params:
        foreverdata: '3854672498'
        text: 'iphone'
    - assert: в выдаче есть колдунщик Маркета
    - screenshot: внешний вид [plain]
    - do: проскроллить до конца карусели
    - assert: в конце карусели должна быть карточка-лоадер (карточка без наполнения)
    - screenshot: внешний вид [loader]
    - do: подождать дозагрузки карточек
    - assert: |
        появились новые карточки
        наполнение дозагруженных карточек может отличаться от дозагруженных карточек на скриншотах
    - do: проскроллить до конца карусели
    - assert: в конце карусели отсутствует карточка "Ещё предложения"
    - screenshot: внешний вид [after-load]

  Подзаголовок из значения флага:
    - params:
        foreverdata: '3356472073'
        exp_flags:
          - 'PRODUCTS_offers_wizard_subtitle=%D0%9F%D0%BE%D0%B4%D0%B7%D0%B0%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BE%D0%BA'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: |
        в выдаче есть колдунщик Маркета
        у колдунщика есть подзаголовок с текстом "Подзаголовок"

  Внешний вид с увеличенными миниатюрами:
    - params:
        foreverdata: '3356472073'
        exp_flags:
          - 'PRODUCTS_with_enlarged_thumbs=1'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: в выдаче есть колдунщик Маркета
    - screenshot: внешний вид [with_enlarged_thumbs]

  Зажигание заголовка, всегда и только его:
    - params:
        foreverdata: '3356472073'
        exp_flags:
          - 'PRODUCTS_title_only_hover=1'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: в выдаче есть колдунщик Маркета
    - do: навести курсор на карточку товара
    - assert: заголовок карточки подсвечивается красным цветом, независимо от того, на каком элементе курсор внутри карточки

  Увеличение миниатюр при наведении на товар:
    - params:
        foreverdata: '3356472073'
        exp_flags:
          - 'PRODUCTS_animate_thumbs_on_hover=1'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: в выдаче есть колдунщик Маркета
    - do: навести курсор на карточку товара
    - assert: миниатюра товара увеличилась

  Не рендерить сниппет при отсутствии контента внутри в правой колонке:
    - params:
        foreverdata: '2187942577'
    - do: открыть выдачу по запросу 'foreverdata'
    - assert: справа от выдачи НЕТ галереи с предложениями от магазинов

  Проверка ссылки:
    В кнопке «ещё»:
      - params:
          foreverdata: '2284006376'
      - do: |
          открыть выдачу по запросу 'foreverdata'
          проскроллить до конца вправо
      - tech: в ссылке «Ещё предложения» есть параметр rs
      - do: нажать на ссылку «Ещё предложения»
      - tech: |
          открылась новая вкладка по ссылке `https://yandex.ru/products/search`
          в нажатую на выдаче ссылку добавились параметры parent-reqid и utm_source_service

files:
  - src/features/Market/Market.features/MarketOffersWizard/MarketOffersWizard.test/MarketOffersWizard@desktop.hermione.js

v-team: Goods

tlds: [ru]

tags:
  - react
