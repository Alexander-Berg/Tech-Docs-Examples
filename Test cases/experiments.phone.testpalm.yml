feature: Исследовательское тестирование

description: Тестирование экспериментов и отдельных компонентов сервиса

specs-integration:
  старой страницы экспорта отдает 404 без ошибок:
    - do: перейти по ссылке https://news.stable.priemka.yandex.ru/news/export
    - assert: отобразилась страница 404 (Не удалось отобразить сюжет), ошибок нет

  старой страницы регионов отдает 404 без ошибок:
    - do: перейти по ссылке https://news.stable.priemka.yandex.ru/news/regions
    - assert: отобразилась страница 404 (Не удалось отобразить сюжет), ошибок нет

specs:
# для ручных проверок оставлены кейсы с тегом NOTruntime для прогона индексатора, то же самое проверяется тестами е2е на приемке (то есть в релизах - и на релизных шаблонах, и в новом рантайме)
  проблемных функциональностей [manual]:
    - tags:
        - NOTruntime
        - backend_news
        - back_only
        - smoke_zen
    - do: перейти на тестовый стенд по ссылке на залипание из рана
    - do: в той же вкладке открыть https://yandex.ru/news/story/a--1 (сломанный url)
    - assert: |
        открылась страница с блоком "Не удалось отобразить сюжет",
        нет белой страницы
    - do: в той же вкладке открыть https://yandex.ru/news/yandsearch?cl4url=www.interfax.ru/sport/419977&lang=ru&lr=10747 (архивный поиск)
    - assert: |
        открылась страница с блоком "Не удалось отобразить сюжет",
        нет белой страницы
    - do: в той же вкладке открыть https://yandex.ru/news/rubric/person  (несуществующая страница рубрики)
    - assert: |
        открылась страница с блоком "Не удалось отобразить сюжет",
        нет белой страницы
    - do: в той же вкладке открыть https://yandex.ru/news/story/aaaa-1 (несуществующая страница сюжета)
    - assert: |
        открылась страница с блоком "Не удалось отобразить сюжет",
        нет белой страницы
    - do: в той же вкладке открыть https://yandex.ru/news/404
    - assert: |
        открылась страница с блоком "Не удалось отобразить сюжет",
        нет белой страницы
    - do: в той же вкладке открыть https://yandex.ru/news/story/Sevastopol_mogut_perevesti_na_pochasovuyu_podachu_vody--477f51f6e403c15e260efc3313256660 (сюжет без картинок и источников)
    - assert: |
        открылась страница архивного сюжета без картинок и видео,
        нет белой страницы

  спецрубрики в зарубежной локации [manual]:
    - tags:
        - backend_news
        - brow_only
        - back_only
        - smoke_zen
    - do: перейти на тестовый стенд по ссылке на залипание из рана
    - do: авторизоваться любым аккаунтом
    - assert: аккаунт на новостях авторизован, в шапке есть юзерпик
    - do: в отдельной вкладке открыть https://yandex.ru/tune и установить любой не российский город (например, Париж)
    - do: в первой вкладке открыть https://yandex.ru/news/rubric/koronavirus
    - assert: |
        открылась страница рубрики "Коронавирус",
        залогин сохранен - в шапке виден юзерпик, выделена рубрика "Коронавирус",
        сверху только 2 коронавирусных виджета (а не 3),
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2021-10-26_16-13-17.png
    - assert: |
        страница НЕ тыквится,
        (признаки, что вместо рантайма отвечает тыква - слетает залогин и вместо юзерпика кнопка "Войти",
        сверху три виджета),
        внешний вид тыквы - https://jing.yandex-team.ru/files/nightsonne/2021-10-26_14-57-17.png

  проблемных функциональностей на нацдоменах (только индексатор) [manual]:
    - tags:
        - NOTruntime
        - backend_news
        - no_assessors
    - do: в залипании перейти по ссылке https://yandex.ua/news/rubric/army
    - assert: | 
        если произошел серверный редирект на домен ru - пропустить шаг,
        если открылся нужный домен - нет 500х ошибок, отобразилась надпись "Не удалось отобразить сюжет"
    - do: перейти по ссылке https://yandex.kz/news/theme/Pandemiya_koronavirusa--522
    - assert: нет 500х ошибок, открылась страница темы
    - do: перейти по ссылке https://yandex.by/news/region/moscow
    - assert: нет 500х ошибок, открылась страница новостей Москвы

# для ручных проверок оставлены кейсы с тегом NOTruntime для прогона индексатора, то же самое проверяется тестами е2е на приемке (то есть в релизах - и на релизных шаблонах, и в новом рантайме)
# е2е тут news/features/news/expcases/expcases.phone.hermione.e2e.js
  страниц в нерпе [manual]:
    - tags:
        - NOTruntime
        - backend_news
        - back_only
        - smoke_zen
    - do: перейти по ссылке https://yandex.ru/news/regions
    - assert: |
        происходит редирект на https://yandex.ru/news/region/moscow?modal=regions,
        нет белой страницы
    - do: перейти по ссылке https://yandex.ru/news/export
    - assert: |
        открылась главная страница сервиса,
        нет белой страницы

# кейс оставляем ручным только для прогонов индексатора, рантайм и шаблоны покрыты автотестами в news/features/news/smi
  страницы 'Наши партнеры' [manual]:
    - tags:
        - NOTruntime
        - backend_news
        - back_only
        - smoke_zen
    - do: перейти на тестовый стенд по ссылке на залипание и в той же вкладке перейти по ссылке https://yandex.ru/news/smi
    - assert: |
        открылась страница "Наши партнеры",
        на странице есть описание и инпут "Название издания"
    - do: написать в инпуте название любого СМИ, например, "РИА", и тапнуть на кнопку поиска (лупа)
    - assert: |
        открылась страница "Наши партнеры" с результатами поиска,
        урл содержит параметр "?name=РИА",
        Обратите внимание! В урле параметр в адресной строке может отображаться в ASCII кодировке ?name=%D0%A0%D0%98%D0%90 - Заводить баг на такое не нужно, это ок!
        выдача релевантна запросу

# кейс оставляем ручным только для прогонов индексатора, рантайм и шаблоны покрыты автотестами в news/features/news/smi
  страницы издания [manual]:
    - tags:
        - NOTruntime
        - backend_news
        - back_only
        - smoke_zen
    - do: перейти на тестовый стенд по ссылке на залипание и в той же вкладке перейти по ссылке https://yandex.ru/news/smi
    - assert: |
        открылась страница "Наши партнеры",
        на странице есть описание и инпут "Название издания"
    - do: написать в инпуте название любого СМИ, например, "РИА", и тапнуть на кнопку поиска (лупа)
    - assert: открылась страница "Наши партнеры" с результатами поиска
    - do: кликнуть по любому названию издания, например, "РИА Новости"
    - assert: |
        открылась страница "База данных СМИ" с данными об издании,
        внешний вид - https://jing.yandex-team.ru/files/nightsonne/2022-05-16_13-41-25.png

  проверка рекламы на HUAWEI P40 lite [manual]:
    - tags:
        - no_assessors
    - do: открыть встроенную ленту новостей или в эмуляторе http://yandex.ru/news?screen_news=1
    - do: поскроллить ленту
    - assert: в ленте большинство карточек новостей с картинками, отображаются блоки рекламы
    - do: тапнуть на любой сюжет (следить, чтобы праметр из урла не потерялся)
    - assert: открывается сюжет, под рубрикатором отображается блок с рекламой
    - do: перейти в любую рубрику в рубрикаторе
    - do: тапнуть на любой сюжет в рубрике
    - assert: открывается сюжет, под рубрикатором отображается блок с рекламой

  основного функционала на новостях [manual]:
    - tags:
        - polyfills
        - no_assessors
    - do: открыть "Главную" страницу сервиса Яндекс.Новости
    - do: поскролить страницу
    - assert: |
        страница подгружает карточки,
        на странице отображаются карточки с сюжетами
    - do: тапнуть на любую карточку (кроме спортивной)
    - assert: осуществляется переход на страницу сюжета в этой же вкладке
    - do: поскролить страницу
    - assert: |
        данные в сюжете отображаются корректно,
        нет белого экрана,
        при скролле подгружается порция новых карточек
    - do: поскролить вверх к началу сюжета
    - do: тапнуть на блок "Подробнее о событии"
    - assert: |
        открывается список источников в блоке "Подробнее о событии",
        под списком источников есть кнопка "Больше результатов"
    - do: Нажать на кнопку "Больше результатов"
    - assert: |
        в той же вкладке подгружаются еще источники,
        нет белого экрана
    - do: проскроллить страницу вниз до конца
    - assert: отображается 2 страница источников

  основных рубрик на новостях [manual]:
    - tags:
        - polyfills
        - no_assessors
    - do: перейти в рубрику Коронавирус
    - assert: открывается страница рубрики, нет белого экрана
    - do: перейти в рубрику Видео
    - assert: открывается страница рубрики, нет белого экрана
    - do: перейти в рубрику Общество
    - assert: открывается страница рубрики, нет белого экрана
    - do: поскроллить рубрику
    - assert: подгружается новая порция карточек
    - do: перейти в подрубрику Здоровье
    - assert: открывается страница рубрики, нет белого экрана
    - do: далее перейти во все оставшиеся рубрики, кроме рубрики "Спорт"
    - assert: открывается страница рубрики, нет белого экрана
    - assert: перейти на страницу темы по ссылке https://yandex.ru/news/theme/Vybory_deputatov_Gosudarstvennoj_dumy_RF_VIII_sozyva--876
    - assert: открывается страница темы, нет белого экрана

  поиска на новостях [manual]:
    - tags:
        - polyfills
        - no_assessors
    - do: открыть "Главную" страницу сервиса Яндекс. Новости
    - do: в поисковой строке ввести "самолет" и тапнуть "Найти"
    - assert:
        происходит переход на страницу поиска по новостям,
        нет белого экрана
    - do: поскроллить ленту поиска вниз
    - assert: у каждой новости есть заголовок, наименование издания
    - do: в конце списка нажать на кнопку "Больше результатов" в конце списка
    - assert: |
        загружается вторая страница выдачи,
        нет белого экрана
    - do: тапнуть по любому заголовку в выдаче
    - assert: осуществляется переход на страницу соответствующего сюжета в новой вкладке

  отображения популярных реакций и количества отреагировавших на новость:
    - tags:
        - polyfills
        - no_assessors
    - do: авторизоваться на сервисе
    - do: перейти в сюжет с проставленными эмоджи
    - assert: |
        нет белого экрана,
         отображается топ из самых популярных эмоджи, кнопка Оценить и количество оценивших '(N)K' (например, 2,2K)
    - do: навести курсор мыши на кнопку 'Оценить'
    - assert: |
        меняется стиль курсора и слова 'Оценить',
        появляется блок с доступными эмоджи
    - do: тапнуть по любой эмоджи в появившемся блоке
    - assert: |
        блок с доступными эмоджи пропадает,
        выбранная эмоджи появляется справа от трех популярных эмоджи,
        'Оценить' меняется на "Вы +NK" (Вы - черным шрифтом, +NK - серым),
        количество N не изменилось
    - do: обновить страницу
    - assert: |
        нет белого экрана,
        количество N не изменилось
    - do: навести курсор мыши на кнопку 'Вы +NK'
    - assert: |
        меняется стиль курсора и 'Вы +NK',
        блок с доступными эмоджи не появляется
    - do: тапнуть по 'Вы +NK'
    - assert: |
        нет белого экрана,
        выбранная эмоджи пропала,
        'Вы +NK' меняется на 'Оценить' +NK

  отображения Избранных источников [manual]:
    - tags:
        - polyfills
        - no_assessors
    - do: авторизоваться на сервисе
    - do: открыть любой сюжет кроме спортивного
    - do: в блоке "Подробнее о событии" нажать на кнопку настройки источников
    - assert: |
        раскрылось модальное окно настроек с анимацией,
        отображаются вкладки Мои источники, Нежелательные и желтая кнопка Добавить источник
    - do: если отобразилась заглушка 'Подпишитесь на издания', добавить издания с помощью 'Добавить источник'
    - do: тапнуть на вкладку 'Нежелательные'
    - do: если отобразилась заглушка 'Добавьте нежелательные издания', добавить издания с помощью 'Добавить источник'
    - do: тапнуть на кнопку 'Добавить источник'
    - assert: отобразился саджест
    - do: ввести 'le'
    - assert: отобразились источники

  страницы котировок [manual]:
    - tags:
        - polyfills
        - no_assessors
    - do: открыть "Главную" страницу сервиса Яндекс. Новости
    - do: открыть страницу котировок в рубрике "Экономика"
    - assert: отобразилась главная страница котировок
    - do: тапнуть по любому названию котировок из раздела Сырьё
    - assert: |
        отобразился график с заголовком, соотвествующим выбранным котировкам,
        блок графика корректно отображается,
        нет белого экрана

  страницы регионов [manual]:
    - tags:
        - polyfills
        - no_assessors
    - do: после перехода на тестовый стенд в той же вкладке открыть страницу региональных новостей https://yandex.ru/news/region/moscow
    - assert: |
        отобразились "Новости Москвы",
        на странице отображаются новстоные карточки
    - do: поскролить страницу
    - assert: |
        страница подгружает новые карточки,
        на странице отображаются карточки с сюжетами
    - do: поскролить страницу вначало
    - do: тапнуть по Другие регионы
    - assert: открывается модальное окно со списком российских регионов
    - do: тапнуть по Украина
    - assert: открывается модальное окно со списком украинских регионов
    - do: тапнуть по Зарубежные новости
    - assert: открывается модальное окно со списком стран

files:
   - features/news/expcases/expcases.phone.hermione.e2e.js

tags:
  - neo

manager: Glushneva

qa-engineer: terenandrevna

tlds:
  - ru
  - by
  - kz
  - uz
  - ua
  - com
