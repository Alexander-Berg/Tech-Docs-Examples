feature: Мои роли. Таб "Отчёты"

specs:
  Мои роли. Таб "Отчёты":
    - do: запустить в Runner сценарий "Мои роли. Таб "Отчёты"" (https://github.yandex-team.ru/pixel/idm-runner)
    - do: отправить запрос "Вкладка "Отчёты"" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: ответ на запрос "Вкладка "Отчёты"" должен содержать поля [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-03%2019-37-13.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Вкладка "Отчёты". Фильтр по системе и роли" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: ответ на запрос "Вкладка "Отчёты". Фильтр по системе и роли" должен содержать поля [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-03%2019-38-31.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Вкладка "Отчёты". Фильтр по системе и действиям" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: в ответе на запрос "Вкладка "Отчёты". Фильтр по системе и действиям" все поля "action" должны иметь значения "approve" или "request", а поле "slug" у "system" - "direct-mod-dev" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-03%2019-41-18.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Вкладка "Отчёты". Фильтр по id действия" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: ответ на запрос "Вкладка "Отчёты". Фильтр по id действия" должен содержать только одну запись с id=4386342011 [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-03%2019-42-25.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"

priority: critical

files:
  - idm/tests/api/frontend/test_action.py

tags:
  - reviewed
  - no_assessors
  - postman_automation
  - fitcher:idm-www:test/e2e/my-roles-actions-tab/**
  - fitcher:idm-www:test/auto/my-roles-actions-tab/**
  - fitcher:idm-www:blocks/desktop/filters/**
  - fitcher:idm-www:blocks/desktop/table/**
  - fitcher:idm_backend_palmsync:idm/tests/api/frontend/test_action.py
  - fitcher:idm_backend_palmsync:idm/core/models/action.py
  - fitcher:idm_backend_palmsync:idm/core/models/role.py
  - fitcher:idm_backend_palmsync:idm/core/models/rolefield.py
  - fitcher:idm_backend_palmsync:idm/core/models/transfer.py
  - fitcher:idm_backend_palmsync:idm/core/models/groupmembershipsystemrelation.py
  - fitcher:idm_backend_palmsync:idm/core/constants/system.py
  - fitcher:idm_backend_palmsync:idm/inconsistencies/models.py
  - fitcher:idm_backend_palmsync:idm/users/models.py
  - fitcher:idm_backend_palmsync:idm/tests/utils.py
  