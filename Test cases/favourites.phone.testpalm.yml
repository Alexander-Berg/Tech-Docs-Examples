feature: Избранные источники Яндекс.Новостей

specs-integration:
  предоставляют возможность искать источник по названию:
    - do: перейти по ссылке https://yandex.ru/news/
    - do: авторизоваться на сервисе
    - do: тапнуть на аватарку пользователя, выбрать в меню 'Настройка источников'
    - assert: раскрылось модальное окно настроек
    - do: тапнуть на 'Добавить источник'
    - do: заполнить поле ввода значением 'lenta'
    - assert: проверить, что в списке источников появилась Lenta.ru

  сохраняют позицию скролла на странице:
    - do: перейти по ссылке https://yandex.ru/news/story/a--610812c0f87e8a974343121e421fede1
    - do: проскролить до следующего сюжета
    - do: тапнуть на три точки
    - do: тапнуть на пункт Настроить источники
    - do: закрыть окно с настройками источников
    - assert: во видимой области экрана всё тот же второй сюжет, из которого мы настройку источников открывали

specs:
  корректно отображаются:
  - do: авторизоваться на сервисе
  - do: тапнуть на аватарку пользователя, выбрать в меню 'Настройка источников'
  - assert: |
      раскрылось модальное окно настроек с анимацией,
      отображаются вкладки Мои источники, Нежелательные и желтая кнопка Добавить источник
  - do: если отобразилась заглушка 'Подпишитесь на издания', добавить издания с помощью 'Добавить источник'
  - screenshot: внешний вид соответствует скриншоту (список источников может отличаться) [favorites]
  - do: тапнуть на вкладку 'Нежелательные'
  - do: если отобразилась заглушка 'Добавьте нежелательные издания', добавить издания с помощью 'Добавить источник'
  - screenshot: внешний вид соответствует скриншоту [ignored]
  - do: тапнуть на кнопку 'Добавить источник'
  - assert: отобразился саджест
  - do: ввести 'le'
  - assert: отобразились источники
  - screenshot: внешний вид соответствует скриншоту [suggest]

  выделяются для авторизованного пользователя иконкой-индикатором над заголовком в сюжете и в рубрике [manual]:
    - tags:
        - smoke
        - backend_news
        - smoke_zen
    - do: авторизоваться на сервисе
    - do: кликнуть на аватарку пользователя, выбрать в меню 'Настройка источников'
    - assert: |
        открылось модальное окно настроек,
        отображаются описание, поле поиска 'Найти источник', список источников,
        напротив источников имеются кнопки добавления в избранные, и в нежелательные,
        внешний вид https://jing.yandex-team.ru/files/an-smirn0v/shot_210412_165939.png (набор источников может отличаться)
    - do: если есть добавленные источники - тапнуть на каждую желтую звездочку
    - assert: отображается всплывающие сообщение 'Удалено из избранного', звездочки больше не желтые
    - do: нажать на поле поиска 'Найти источник'
    - assert: появилась строка инпута для ввода названия источника https://jing.yandex-team.ru/files/an-smirn0v/shot_210412_170722.png
    - do: ввести название 'Lenta.ru'
    - assert: появляется саджест с похожими названиями источников
    - do: кликнуть по звездочке возле источника 'Lenta.ru'
    - assert: отображается всплывающие сообщение 'Добавлено в избранное', звездочка прокрашена желтым
    - do: нажать на кнопку стрелочки (назад) в поле поиска 'Найти источник'
    - assert: отображается модальное окно настроек, звездочка напротив источника 'Lenta.ru' прокрашена желтым
    - do: закрыть окно настроек и перейти в любую рубрику, например, в Общество
    - do: скроллить ленту рубрики
    - assert: |
        в ленте рубрики есть карточки от источника 'Lenta.ru' (весь топ-5 может быть от этого источника),
        в каждой карточке от источника 'Lenta.ru' отображается желтая точка у иконки источника,
        внешний вид https://jing.yandex-team.ru/files/an-smirn0v/shot_210414_164521.png
    - do: перейти в любой неспортивный сюжет от источника 'Lenta.ru' кликом по заголовку в карточке
    - assert: |
        в сюжете над заголовком источник - 'Lenta.ru',
        возле иконки источника отображается желтая точка,
        внешний вид https://jing.yandex-team.ru/files/an-smirn0v/shot_210414_164610.png
    - do: тапнуть по источнику с точкой у иконки
    - assert: в новой странице открывается статья в источнике 'Lenta.ru'

  отображаются в шторке, которая имеет вид на узком экране:
    - do: открыть любой неспортивный сюжет на устройстве с экраном 320х480 px и разлогиниться
    - do: тапнуть на иконку настройки источников под медиаблоком в блоке 'Подробнее о событии'
    - assert: |
        раскрылось модальное окно настроек с анимацией,
        кнопка Войти не наезжает на текст в окне

  источник открывается в той же вкладке [manual]:
    - tags:
        - smoke
        - backend_news
    - do: авторизоваться на сервисе
    - do: перейти в любой сюжет
    - assert: |
        открывается сюжет,
        в сюжете есть иконка над темой сюжета,
        присуствует блок 'Подробнее о событии' с источниками
        внешний вид (может отлчаться) https://jing.yandex-team.ru/files/an-smirn0v/shot_210702_164319.png
    - do: тапнуть на заголовок сюжета или на иконку источника
    - assert: |
        в новой вкладке открывается источник с таким же наименованием как у сюжета,
        в редких случаях, если источник сменил оглавление, текст может различаться (проверьте пару других сюжетов и если проблема повторяется для всех - заводите баг, а если проблема повторяется только для одного сюжета - это ок, заводить баг не нужно)
    - do: нажать на аппаратную или браузерную кнопку 'назад'
    - assert: произошел возврат на страницу сюжета, с которого ранее вы перешли на страницу источника
    - do: в блоке 'Подробнее о событии' нажать на любой источник
    - assert: в новой вкладке открывается выбранный источник

  корректно отображаются в темной теме:
    - do: открыть шторку избранного в любом сюжете
    - assert: шторка отображается корректно


files:
  - features/news/favourites/favourites.phone.hermione.js
  - features/news/favourites/favourites.phone.hermione.e2e.js

qa-engineer: nightsonne

manager: mrwhite

tags:
  - neo
  - favourites

tlds:
  - ru
  - by
  - kz
  - uz
  - ua
  - com
