feature: ЖД
type: Страница заказа
description: >-
  **Информация для асессоров: форма оплаты с полями ввода данных карты в
  тестинге намеренно пропускается. Шаги в кейсе, где требуется ввести данные
  карты и нажать кнопку Оплатить, нужно пропустить.**


  Если тестируем тач-версию, кнопки Распечатать на странице не будет, это
  нормально.

  Для тача кнопку для возврата билетов можно найти, кликнув по гамбургеру рядом
  с информацией о пассажире (три точки).


  Для заполнения форм на странице оплаты использовать тестовые карты.


  Например:

  Номер карты: 5100003697253468

  CVN: 090

  Дата: 12/24


  При прохождении кейса указывать действующий номер телефона (на него будут
  приходить коды через СМС)

  Перейти на главную сервиса

  Перейти на вкладку Ж/Д билеты
specs:
  'Поочередный возврат билетов (дубль 1202)':
    - do: Открыть выдачу Москва - Санкт-Петербург через месяц
    - do: >-
        Для одного из поездов кликнуть по кнопке покупки (кнопка может называть
        по разному, сейчас - "Выбрать место")
    - assert: Осуществился переход на страницу выбора мест
    - do: >-
        В блоке "Укажите количество билетов" выбрать 1 взрослого, 1 ребенка от 5
        до 10 лет и 1 ребенка до 5 лет
    - do: Выбрать любой вагон и 2 места в нем
    - do: >-
        Кликнуть по кнопке  перехода на следущий шаг покупки. (Кнопка может
        называться по разному, сейчас называется "Указать пассажиров"
    - do: Заполнить всю информацию валидными данными
    - do: >-
        Кликнуть по кнопке перехода на следущий шаг покупки. (Кнопка может
        называться по разному, сейчас называется “Проверить заказ”)
    - do: >-
        Кликнуть по кнопке перехода на следущий шаг покупки. (Кнопка может
        называться по разному, сейчас называется “Перейти к оплате”
    - do: Заполнить всю информацию корректными данными
    - do: >-
        Кликнуть по кнопке перехода на следущий шаг покупки. (Кнопка может
        называться по-разному, сейчас называется “Оплатить”
    - assert: >-
        * Через некоторое время произошел переход на страницу заказа

        * Для каждого билета есть кнопка Сдать билет

        * Взрослый билет и билет ребенка без места объединены в один блок

        * Для этих билетов одна кнопка Сдать билет

        * Вверху страницы есть кнопки “Распечатать”, “Скачать”, “Сдать все
        билеты”, “…”
    - do: >-
        Кликнуть по кнопке "Сдать билет" для взрослого пассажира и ребенка без
        места (объединенных в один блок)
    - assert: >-
        * Появилось модальное окно для ввода смс

        * Страница за пределами модального окна затемнена

        * В модальном окне есть заголовок "Вы сдаёте билет. К возврату — [сумма
        к возврату] ₽"

        * Есть предупреждение "Имейте в виду: если ребёнку не исполнилось 10,
        его не пустят в поезд одного."

        * Есть предупреждение "Восстановить покупку будет нельзя."

        * Есть поле для ввода смс с текстом "Введите код, отправленный на номер
        [номер телефона, указанный при бронировании]"

        * На указанный при оформлении заказа номер пришла смс с кодом

        * Есть отсчет времени до отправки следующей смс, начинается с 60 секунд
    - do: 'Ввести код из смс, кликнуть "Подтвердить"'
    - assert: >-
        * На модальном окне появился лоадер

        * Через какое-то время модальное окно закрылось

        * Появилась красная надпись для этих билетов “Возврат”

        * Появился лоадер загрузки квитанции

        * Через некоторое время лоадер пропал, вместо него появилась ссылка
        “Скачать квитанцию” и ссылка "Скачать чек" (у асессоров может не быть
        ссылки на чек - это нормально, так как шаг оплаты пропускается)

        * Рядом со ссылками есть указание суммы к возврату

        * Текст информации для сданных билетов окрасился в серый цвет

        * Вверху страницы есть кнопки “Распечатать” (только в десктопе, в таче
        нет), “Скачать”, “Сдать билет" (название кнопки должно смениться, раньше
        было "Сдать все билеты")
    - do: Кликнуть "Сдать билет" для детского билета с местом
    - assert: >-
        * Появилось модальное окно для ввода смс

        * Страница за пределами модального окна затемнена

        * В модальном окне есть заголовок “Вы сдаёте билет. К возврату — [сумма
        к возврату] ₽”

        * Нет предупреждения “Имейте в виду: если ребёнку не исполнилось 10, его
        не пустят в поезд одного.”

        * Есть предупреждение “Восстановить покупку будет нельзя.”

        * Есть поле для ввода смс с текстом “Введите код, отправленный на номер
        [номер телефона, указанный при бронировании]”

        * На указанный при оформлении заказа номер пришла смс с кодом

        * Есть отсчет времени до отправки следующей смс, начинается с 60 секунд
    - do: 'Ввести код из смс, кликнуть “Подтвердить”'
    - assert: >-
        * На модальном окне появился лоадер

        * Через какое-то время модальное окно закрылось

        * Появилась красная надпись для этого билета “Возврат”

        * Появился лоадер загрузки квитанции

        * Через некоторое время лоадер пропал, вместо него появилась ссылка
        “Скачать квитанцию” и ссылка “Скачать чек”  (у асессоров может не быть
        ссылки на чек - это нормально, так как шаг оплаты пропускается)

        * Рядом со ссылками есть указание суммы к возврату

        * Текст информации для сданного билета окрасился в серый цвет

        * Вверху страницы пропали кнопки “Распечатать”(только в десктопе, в таче
        нет), “Скачать”, “Сдать билет”
manual: true
Устройство:
  - Десктоп
  - Тач
Страница: Страница заказа
Сервис: ЖД
Тестирование асессорами: Да
Окружение: Testing
Автор: shenfeld
