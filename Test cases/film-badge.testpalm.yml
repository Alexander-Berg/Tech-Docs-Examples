feature: Объектный ответ
type: Карточка фильма
counter: /$page/$parallel/$result[@wizard_name="entity-search"]/tabs/main/object-badge/trailer

specs:
  Рейтинг:
    - tags: oo_rating
    - label: entity-search_film-card-{{SET_NAME}}
    - do: получить выдачу по запросу 'матрица фильм 1999'
    - screenshot: пример внешнего вида [plain]
    - assert: |
        отображается ОО,
        в ОО есть рейтинг фильма Кинопоиск и IMDB
    - do: нажать на ссылку первого рейтинга
    - assert: открывается страница с источником рейтинга в новом табе
    - tech: проверить счетчик первого рейтинга
    - assertMetrics: '*'
  Широкая тумба Видео и Постер:
    beforeEach:
      - do: открыть выдачу по запросу 'Легенда №17 фильм'
      - assert: появляется карточка объектного ответа, пример внешнего вида [todo plain] # SERP-107331
    Основные проверки:
      - tags:
          - smoke_extended
      - do: проверить ссылку тумбы Видео
      - assert: ссылка ведёт на страницу Видео
      - tech: проверить счетчик тумбы Видео
      - do: проверить ссылку Постера
      - assert: ссылка ведёт на страницу Кинопоиска с корректным постером
      - do: проверить внешний вид тумбы Видео
      - assert: под тумбой Видео есть кнопка 'Трейлер'
      - assertMetrics: '*'
  Широкая тумба Видео без Постера:
    - params:
        foreverdata: '1933666890'
    - tags:
        - smoke_extended
    - do: открыть выдачу по запросу 'foreverdata'
    - screenshot: пример внешнего вида [no-poster]
    - assert: |
        появился объектный ответ,
        в объектном ответе трейлер и справа от него нет постера (изображения)
    - assertMetrics: '*'
  Широкая тумба Трейлера и Постер:
    beforeEach:
      #- params:
          #foreverdata: '3406404779' форевердата не подходит эта
      - do: открыть выдачу неавторизованным пользователем по запросу 'к-911 ' (альтернативные запросы 'к-9', 'земля до начала времён 14 путешествие сердца')
      - assert: появился объектный ответ (тумба с фильмом может отсутствовать, главн)
      # - screenshot: пример внешнего вида [entity-search_film-card-{{SET_NAME}} >> plain]
      # скриншот не подходит
    Тумба Трейлера и просмотр трейлера на Серпе:
      - tags:
          - smoke_extended
      - do: нажать на тумбу Трейлера
      - assert: |
          началось воспроизведение трейлера
      - tech: проверить счетчик тумбы Трейлера
      - tech: атрибут src iframe совпадает с href ссылки тумбы
      - assertMetrics: '*'
    Кнопки под тумбой Трейлера:
      - tags:
          - smoke_extended
      - do: проверить кнопки под тумбой Трейлера
      - assert: |
          под тумбой кнопка 'Трейлер' отсутствует
      - assertMetrics: '*'
  Галерея (без кнопок):
    - params:
        foreverdata: '78034229'
    - label: entity-seach_film_no-buttons-{{SET_NAME}}
    - do: открыть выдачу по запросу 'foreverdata' с параметром ento=0oCglraW4wMzM2MDcSD3J1dzExMTI1Ny1hc3NvYxgCN6-YSg
    - screenshot: пример внешнего вида [no-buttons]
    - assert: |
        отображается объектный ответ,
        под Галереей нет кнопок
    - assertMetrics: '*'
  Одиночный Постер:
    - label: entity-search_film_solo-poster-{{PLATFORM}}-{{BROWSER_TYPE}}
    - do: открыть выдачу по запросу 'Приключения маленького принца' (альтернативные запросы "нина и ваня фильм 2016", "родительская суббота фильм 2017")
    - screenshot: отображается карточка объектного ответа с единственным постером [solo-poster]
    - assertMetrics: '*'
  Одиночный Постер без описания:
    - label: entity-search_film_solo-poster-no-description-{{PLATFORM}}-{{BROWSER_TYPE}}
    - do: открыть выдачу по запросу 'Современные киноманы'
    - screenshot: отображается карточка объектного ответа без описания с единственным постером [solo-poster-no-description]
    - assertMetrics: '*'
  Одиночный Постер без описания с отзывами:
    - label: entity-search_film_solo-poster-no-description-tabs-{{PLATFORM}}-{{BROWSER_TYPE}}
    - params:
        foreverdata: '336920865'
    - do: получить выдачу по запросу 'foreverdata'
    - screenshot: отображается карточка объектного ответа с табиками и без описания с единственным постером [solo-poster-no-description-tabs]
    - assertMetrics: '*'
  С фактовым ответом в центральной колонке:
    - params:
        foreverdata: '2689573698'
    - do: получить выдачу по 'foreverdata'
    - assert: |
        отображается фактовый ответ в центральной колонке
        в объектном ответе в правой колонке есть кнопки "Коллекции" и "Новости", нет широкой тумбы
        пример внешнего вида [https://jing.yandex-team.ru/files/litsyuk/fact_OO.png]
    - assertMetrics: '*'
  Предлагаем купить фильм на .ru:
    - do: открыть выдачу по запросу 'собачья жизнь' (некоторые фильмы могут входить в подписку поэтому попробуйте альтернативные запросы "Бладшот", "Аватар")
    - assert: |
        отображается объектный ответ,
        показывается тумба с кнопкой "Смотреть за ... Р"
    - assertMetrics: '*'
  Предлагаем купить фильм на .kz:
    - tags: [no_assessors] #проводится эксп с отрывом смотрения EXPERIMENTS-103954
    - do: открыть выдачу по запросу 'собачья жизнь' (некоторые фильмы могут входить в подписку поэтому попробуйте альтернативные запросы "Бладшот", "Аватар")
    - assert: |
        отображается объектный ответ,
        показывается тумба с кнопкой "Смотреть за ... Р"
    - assertMetrics: '*'

files:
  - features/deskpad/z-entity-search/film-badge/film-badge.hermione.js

v-team: Video

tlds: ['ru', 'ua', 'by', 'kz', 'com.tr']

tags:
  - reviewed
  - oo_film
