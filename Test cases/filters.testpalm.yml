feature: yandex / Фильтры

specs:
  beforeEach:
    - do: Открыть страницу с поиском для сайта с параметром '/search/site/?searchid=2321186'
    - assert: |
          Под поисковой стрелкой отображается блок с фильтрами
          По умолчанию фильтры не активны
  Cортировка по разделам [manual]:
    - do: Нажать на ссылку 'любой' в фильтре по разделам
    - assert: |
          Появился попап с выбором разделов
          У попапа есть крестик в правом верхнем углу
    - do: Нажать на крестик в попапе
    - assert: |
          Попап закрылся
          Фильтр не применился
    - do: Нажать на ссылку 'любой' в фильтре по разделам
    - do: Нажать за пределами попапа
    - assert: |
          Попап закрылся
          Фильтр не применился
    - do: Нажать на ссылку 'любой' в фильтре по разделам
    - do: Нажать на название раздела в попапе
    - assert: |
          Попап закрылся
          Страница перезагружается
          В фильтре по разделам отображается выбранный раздел
          В выдаче присутствуют только те результаты, которые удволетворяют выбранному фильтру
    - do: Нажать на название выбранного раздела в фильтре по разделам
    - assert: |
          Появился попап с выбором разделов
          На первую строчку добавился вариант 'любой'
          Выбранный раздел выделен (не подчеркнут)
    - do: Нажать на название выбранного раздела в попапе
    - assert: |
          Попап не закрылся
          Ничего не изменилось
    - do: Нажать на название другого раздела в попапе
    - assert: |
          Попап закрылся
          Страница перезагружается
          В фильтре по разделам отображается выбранный раздел
          В выдаче присутствуют только те результаты, которые удволетворяют выбранному фильтру
    - do: Нажать на название выбранного раздела в фильтре
    - do: В попапе нажать на 'любой'
    - assert: |
          Попап закрылся
          Страница перезагружается
          В фильтре по разделам отображается 'любой'
          В выдаче присутствуют все результаты
  Сортировака по дате [manual]:
    - do: Нажать на ссылку 'любое число' в фильтре по дате
    - assert: Появился попап с выбором даты
    - do: Нажать на ссылку 'сегодня'
    - assert: В поля ввода подставлена сегодняшняя дата
    - do: Нажать на кнопку 'ОК' в попапе
    - assert: |
          Попап закрылся
          Страница перезагружается
          В фильтре по дате отображается сегодняшняя дата
          В выдаче присутствуют только те результаты, которые удволетворяют выбранному фильтру
    - do: Нажать на фильтр по дате
    - do: Нажать на ссылку 'вчера' в попапе
    - assert: В поля ввода подставилась вчерашняя дата
    - do: Нажать на кнопку 'ОК' в попапе
    - assert: |
          Попап закрылся
          Страница перезагружается
          В фильтре по разделам отображается промежуток с вчерашними датами
          В выдаче присутствуют только те результаты, которые удволетворяют выбранному фильтру
    - do: Нажать на фильтр по дате
    - do: Нажать на ссылку 'неделю'
    - assert: В первое поле ввода подставилась дата неделю назад, во второе - сегодняшняя
    - do: Нажать на ссылку 'месяц' в попапе
    - assert: В первое поле ввода подставилась дата месяц назад, во второе - сегодняшняя
    - do: Нажать на ссылку 'год' в попапе
    - assert: В первое поле ввода подставилась дата год назад, во второе - сегодняшняя
    - do: Закрыть попап по крестику
    - assert: |
          Попап закрылся
          Последний фильтр не применился
          В фильтре отображается ссылка с вчерашними датами
  Ввод невалидной даты [manual]:
    - do: Нажать на фильтр по дате
    - assert: |
          Появился попап с выбором даты
          Поля ввода пустые
    - do: Ввести в поле ввода буквы
    - assert: Буквы пропадают сразу после ввода
    - do: Ввести в поле ввода спецсимволы
    - assert: Спецсимволы пропадают сразу после ввода
    - do: Ввести в первое поле ввода одну цифру
    - assert: Кнопка 'ОК' дизейблится
    - do: Нажать на кнопку 'ОК'
    - assert: Ничего не происходит
    - do: Ввести в первое поле ввода корректную дату (например, 3.10.2011)
    - assert: Кнопка 'ОК' задизейблена
    - do: Ввести во второе поле ввода дату в неверном формате (например, 3.13.2011)
    - assert: Кнопка 'ОК' задизейблена
    - do: Ввести в поля корректные даты, чтобы первая дата была позже второй (например, 12.12.2001 и 12.10.2000)
    - assert: Кнопка 'ОК' задизейблена
  Вводе валидной даты [manual]:
    - do: Нажать на фильтр по дате
    - do: Ввести корректные даты (например, 3.10.2011 и 3.12.2011)
    - assert: Кнопка 'ОК' активна
    - do: Нажать на кнопку 'ОК'
    - assert: |
          Попап закрылся
          Страница перезагружается
          В фильтре по разделам отображается промежуток выбранными датами
          В выдаче присутствуют только те результаты, которые удволетворяют выбранному фильтру
  Сортировка по ключевым словам [manual]:
    - do: Нажать на ссылку 'нет' в фильтре по ключевым словам
    - assert: |
          Появился попап с ключевыми словами
          По умолчанию ни один чекбокс не выбран
    - do: Нажать на любой чекбокс в попапе
    - assert: Чекбокс становится активным
    - do: Нажать на кнопку 'ОК'
    - assert: |
          Попап закрылся
          Страница перезагружается
          В фильтре по ключевым словам отображается выбранное слово
          В выдаче присутствуют только те результаты, которые удволетворяют выбранному фильтру
    - do: Нажать на ссылку в фильтре по ключевым словам
    - assert: |
          Появился попап с ключевыми словами
          Рядом с выбранным ключевым словом есть активный чекбокс
    - do: Нажать на любой другой чекбокс в попапе
    - assert: |
          Чекбокс стал активным
          Галочка с предыдущего выбранного чексбокса не снялась
    - do: Нажать на кнопку 'ОК'
    - assert: |
          Попап закрылся
          Страница перезагружается
          В фильтре по ключевым словам отображается два выбранных слова через запятую
          В выдаче присутствуют только те результаты, которые удволетворяют выбранным фильтрам
    - do: Нажать на ссылку в фильтре по ключевым словам
    - do: В попапе снять галочку с одного из выбранных чекбоксов
    - assert: Галочка снята
    - do: В попапе поставить галочку еще у двух чекбоксов
    - do: Нажать на кнопку 'ОК'
    - assert: |
          Попап закрылся
          Страница перезагружается
          В фильтре по ключевым словам отображается два выбранных слова через запятую и многоточние
          В выдаче присутствуют только те результаты, которые удволетворяют выбранным фильтрам
    - do: Нажать на ссылку в фильтре по ключевым словам
    - do: В попапе снять галочку со всех выбранных чекбоксов
    - do: Нажать на кнопку 'ОК'
    - assert: |
          Попап закрылся
          Страница перезагружается
          В фильтре по ключевым словам отображается 'нет'
  Сохранение при обновлении вкладки [manual]:
    - do: Выбрать фильтры по разделу, по дате, по ключевым словам, 'Разное'
    - assert: Все фильтры применились
    - do: Обновить страницу
    - assert: |
          Страница перезагрузилась
          Все выбранные фильтры сохранились
          Выдача соответствует выбранным фильтрам
  Сброс фильтров [manual]:
    - do: Выбрать фильтры по разделу, по дате, по ключевым словам, 'Разное'
    - do: Нажать на ссылку 'сбросить фильтры'
    - assert:
          Страница перезагрузилась
          Все выбранные фильтры сбросились до значений по умолчанию

files: [] # TODO: добавить .hermione.js

tags:
  - filters
