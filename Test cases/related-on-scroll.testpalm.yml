feature: Связанные запросы над выдачей при отскролле назад

specs:
  При отскролле назад:
    - tags:
        - smoke_extended
    - do: |
        получить выдачу Поиска по запросу 'микеланджело давид' (альтернативные запросы 'шайло джоли-питт', 'столица канады')
        cкролл вниз до конца страницы
        cкролл обратно на самый верх
    - assert: появились переформулировки над выдачей
    - screenshot: текст и количество переформулировок может отличаться [related-above]
    - do: кликнуть на первую переформулировку
    - assert: открылась выдача по этому запросу

  Удаляются после обновления выдачи через ajax:
    - tags: no_assessors
    - do: |
        получить выдачу Поиска по запросу 'пепе футболист'
        cкролл вниз до конца страницы
        cкролл обратно на самый верх
    - assert: появились переформулировки над выдачей
    - do: вбить в консоль window.BEM.blocks['serp-request'].navigateTo('?text=музыка')
    - assert: выдача обновилась и переформулировки пропали

  Можно получить после обновления выдачи через ajax:
    - tags: no_assessors
    - do: |
        получить выдачу Поиска по запросу 'как открыть вино'
        cкролл вниз до конца страницы
        cкролл обратно на самый верх
    - assert: появились переформулировки над выдачей
    - do: |
        вбить в консоль window.BEM.blocks['serp-request'].navigateTo('?text=музыка')
        cкролл вниз до конца страницы
        cкролл обратно на самый верх
    - assert: появились переформулировки над выдачей

  События при отскролле назад:
    - tags: no_assessors
    - do: |
        получить выдачу Поиска по запросу 'как открыть вино'
        cкролл вниз до конца страницы
        cкролл обратно на самый верх
    - assert: появились переформулировки над выдачей
    - tech: отправилось DOM событие resize после появления переформулировок
    - tech: main блок отправил событие resize до появления

  При отскролле назад и карусели ОО:
    - tags: no_assessors
    - do: |
        получить выдачу Поиска по запросу 'фильмы 2017'
        cкролл вниз до конца страницы
        cкролл обратно на самый верх
    - assert: не появились переформулировки над выдачей

  При отскролле назад - мало подсказок:
    - tags: no_assessors
    - do: |
        получить выдачу Поиска по запросу 'клиника фэмили костанай'
        cкролл вниз до конца страницы
        cкролл обратно на самый верх
    - assert: появились переформулировки над выдачей
    - screenshot: текст и количество переформулировок может отличаться [related-above]
    - do: кликнуть на первую переформулировку
    - assert: открылась выдача по этому запросу

  Не появляются после появления переформулировок при возврате:
    - tags:
        - smoke_extended
    - do: |
        открыть браузер в режиме инкогнито
        получить выдачу Поиска по запросу 'холодильник купить' (альтернативные запросы 'мои документы как пройти', 'паспорт поменять в 45 лет')
        нажать на сниппет, расположенный в середине выдачи
        вернуться на выдачу
    - assert: появились переформулировки под сниппетом
    - do: cкролл обратно на самый верх
    - assert: переформулировки над выдачей не появились

files:
  - features/desktop/related/related-on-scroll.hermione.js

v-team: UniAnswer

tags:
  - uni_answer

tlds: [ru, by, ua, kz, uz, com.tr, com]

priority: high
