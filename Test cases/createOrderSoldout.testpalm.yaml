# https://testpalm.yandex-team.ru/testcase/travel-1252
feature: Отели
type: Бронирование отелей
description:
    Для генерации события soldout (все номера раскуплены) на этапе создания заказа нужно дернуть ручку тестового контекста
    https://api.travel-balancer-test.yandex.net/api/test_context/v1/tokens?originalId=1221&partnerId=PI_BNOVO&occupancy=2&forceAvailability=true&cancellation=CR_FULLY_REFUNDABLE&pansionType=PT_BB&offerName=test&priceAmount=11000&getOfferOutcome=OO_SUCCESS&createOrderOutcome=OO_SOLD_OUT&hotelDataLookupOutcome=HO_REAL&reservationOutcome=RO_SUCCESS&confirmationOutcome=CO_SUCCESS&refundOutcome=RF_SUCCESS&priceMismatchRate=1.1
    При ответе с кодом 200 в booking_page_url будет содержаться урл страницы брони.

specs:
    (Bnovo) Обработка события солдаут при создании брони:
        - do: Перейти на страницу брони по сгенерированному урлу с заездом-выездом на завтра-послезавтра
        - assert: Открылась страница бронирования

        - do: Заполнить данные гостей и контактные данные валидными значениями
        - do: Кликнуть по Оплатить
        - assert:
              Появился лоадер с текстом "Создание заказа Создаем заказ и готовимся к оплате"
              | Элементы на странице задизейблены https://jing.yandex-team.ru/files/shenfeld/Yandeks.Puteshestviya__aviabilety_bilety_na_poezd_bronirovanie_otelei_2019-03-27_13-02-02.png
              | Через какое-то время произошел переход на страницу с сообщением Все номера такого типа уже забронированы
              | Ниже отображается информация об отеле
              | Название - Амай
              | Адрес и рейтинг
              | Даты заезда и выезда - завтра и послезавтра
              | Кол-во гостей - 2
              | Название оффера - test
              | Информация про питание - Завтрак включен
              | Справа от названия отеля есть фото отеля
              | Под фото название отеля от партнера и ссылка Описание отеля от партнера
              | В самом низу блока об отеле расположены две кнопки
              | Начать новый поиск и Найти номера в отеле

        - do: Кликнуть по ссылке Описание отеля от партнера
        - assert: Открылся модал
              | Модал содержит название отеля и карту
              | Вверху модала есть крестик для закрытия

        - do: Кликнуть по крестику над модалом
        - assert: Модал закрылся

        - do: Кликнуть по кнопке Начать новый поиск
        - assert: Произошел переход на выдачу отелей из гео-региона бронируемого отеля

        - do: Вернуться на предыдущую страницу
        - assert: Произошел переход на страницу бронирования (особенность Тестового Контекста)

        - do: Кликнуть по Оплатить
        - assert: Произошел переход на страницу с сообщением Все номера такого типа уже забронированы

        - do: Кликнуть по Найти номера в отеле
        - assert: Открылась страница отеля Амай с теми же параметрами дат и гостей

files:
    - tests/common/hotels/book/flowErrorsBnovo/createOrderSoldout.hermione.ts

Сервис: Отели
Автор: iliasova
Устройство:
    - Десктоп
    - Тач
Функциональность: Бронирование
Страница: Бронирование
Окружение:
    - Testing
tags: ТК
Тестирование асессорами: Нет
