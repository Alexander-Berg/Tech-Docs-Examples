feature: Голосовой поиск
type: Помощник для Chrome

specs:
  beforeEach:
    - do: удостовериться, что в настройках контента браузера отсутствует доступ к микрофону для yandex.ru
    - assert: настройки микрофона выглядят как на скриншоте
    - screenshot: внешний вид настроек микрофона [https://jing.yandex-team.ru/files/kseverina/chrome_KS1fPWVd39.png]
    - do: очистить куки браузера
    - do: получить выдачу по запросу "погода в москве"
    - assert: кнопка голосового поиска отображается 
    - screenshot: примерный внешний вид поисковой строчки и кнопки голосового поиска [https://jing.yandex-team.ru/files/karinatsay/2022-04-05T06%3A46%3A36Z.3059e4e.png]
    - do: кликнуть в микрофон
    - assert: появилась подсказка с запросом на разрешение доступа к микрофону
  Закрыть попап [manual]:
    - automation: SERP-85896
    - do: нажать на крестик в браузерном попапе
    - assert: браузерный попап исчез
    - assert: появился попап "Вы заблокировали доступ к микрофону"
    - assert: появилась желтая стрелка, указываюшая в верхний правый угол страницы
    - do: нажать на крестик в попапе
    - assert: попап исчез
    - assertMetrics: '*'
  Заблокировать микрофон [manual]:
    - automation: SERP-85896
    - do: нажать "Блокировать" в браузерном попапе
    - assert: браузерный попап исчез
    - assert: появился попап "Вы заблокировали доступ к микрофону"
    - assert: появилась желтая стрелка, указываюшая в верхний правый угол страницы
    - do: нажать на крестик в попапе
    - assert: попап исчез
    - assertMetrics: '*'
  Разрешить доступ к микрофону [manual]:
    - automation: SERP-85896
    - do: нажать "Разрешить" в браузерном попапе
    - assert: браузерный попап исчез
    - assert: появился попап "Говорите..."
    - assertMetrics: '*'

files: []

tags:
  - voice
  - popup
  - ajax
  - input
  - reviewed
  - skip_e2e_check
# Голосовой поиск поиск никак не зависит от данных и от запроса пользователя, т.е. он контекстнонезависимый.
# Таким образом, целесообразнее проводить функциональное тестирование, e2e никакого профита не принесет.
  - skip_manual_check # В Гермионе нет возможности проверить работу микрофона. SERP-85896

description: Попап, который указывает на кнопку активации микрофона, работает только в хроме

v-team: Beauty

priority: high

tlds:
  - ru
  - by
  - kz
  - ua
  - uz

browsers:
  - chrome-desktop

counter: /header/microphone
