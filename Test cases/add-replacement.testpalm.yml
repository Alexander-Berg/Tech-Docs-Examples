feature: Дежурства 

aliases:
  - &addAsServiceManager
    - do: (PREPARE) открыть сервис "autotest-service-for-duty-replacements" (/services/autotest-service-for-duty-replacements) 
    - do: (PREPARE) кликнуть на иконку карандашика рядом с надписью "Управляющие" 
    - screenshot: (PREPARE) карандашик рядом с надписью "Управляющие" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-04-26%2013-03-35.png]
    - do: (PREPARE) в модалке "Редактирование управляющих" в поле "Добавить сотрудника" ввести свои имя и фамилию 
    - do: (PREPARE) под полем появился выпадающий список вариантов 
    - do: (PREPARE) выбрать в выпадающем списке себя 
    - assert: (PREPARE) в блоке "Управляющие" появился выбранный сотрудник 
    - do: (PREPARE) кликнуть на кнопку "Сохранить"  

  - &openModalForSettingReplacement
    - do: открыть график дежурств "duty-for-replacements" в сервисе "autotest-service-for-duty-replacements" (/services/autotest-service-for-duty-replacements/duty)
    - do: кликнуть на любую доступную смену в графике
    - assert: |
            появилась модалка "Редактирование дежурства"
            в модалке есть дежурный из смены, даты начала и конца смены, есть надпись "Добавить временную замену" 
    - do: кликнуть на надпись "Добавить временную замену"
    - assert: появился блок "Временный дежурный" с именем дежурного и полями для ввода периода замены 
    - screenshot: примерный вид модалки "Редактирование дежурства" с добавлением временного дежурного [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202020-12-29%2016-25-03.png]
    - do: кликнуть в поле "Имя"
    - assert: появился выпадающий список с доступными для замены текущего дежурного
    - do: кликнуть по любому дежурному для замены
    - assert: выпадающий список скрылся, в поле "Имя" подставился выбранный дежурный
    - do: кликнуть в первое поле в блоке "Даты"
    - assert: |
            появился выпадающий календарь
            в календаре доступны для выбора только те даты, которые попадают на смену, в которой делается замена

  - &deleteAsServiceManager
    - do: (PREPARE) открыть сервис "autotest-service-for-duty-replacements" (/services/autotest-service-for-duty-replacements) 
    - do: (PREPARE) кликнуть на иконку карандашика рядом с надписью "Управляющие" 
    - screenshot: (PREPARE) карандашик рядом с надписью "Управляющие" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-04-26%2013-03-35.png]
    - do: (PREPARE) в модалке "Редактирование управляющих" найти своего пользователя
    - do: (PREPARE) кликнуть напротив своего пользователя на иконку корзины
    - do: (PREPARE) кликнуть на кнопку "Сохранить"  

specs:
  beforeEach:
    - tech: залогиниться под пользователем robot-abc-002 
  
  Положительные:
    1. Создание временной замены на один день:
      - automation: ABC-10096
      - *addAsServiceManager 
      - *openModalForSettingReplacement
      - do: кликнуть на день для замены
      - assert: календарь скрылся, в первое поле подставилась выбранная дата в формате "ДД месяц ГГГГ"
      - do: кликнуть во второе поле в блоке "Даты"
      - assert: |
              появился выпадающий календарь
              в календаре доступны для выбора только те даты, которые попадают на смену, в которой делается замена
      - do: кликнуть на тот же день для замены, который был выбран для первого поля
      - assert: календарь скрылся, во второе поле подставилась выбранная дата в формате "ДД месяц ГГГГ"
      - do: кликнуть на кнопку "Сохранить"
      - assert: |
              модалка "Редактирование дежурства" скрылась
              на смене добавилась замена на один выбранный день
      - screenshot: замена на смене показана пересекающимися стрелочками и шахматной раскраской [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202020-12-29%2016-41-02.png]
      - do: навести курсор на смену с заменой
      - screenshot: появился попап с информацией о смене - дежурный, период дежурства, наличие временной замены, замещающий и период замены [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202020-12-29%2016-43-33.png]
      - do: (PREPARE) кликнуть на смену с заменой
      - assert: (PREPARE) появилась модалка "Редактирование дежурства"
      - do: (PREPARE) кликнуть на иконку корзины рядом с временной заменой
      - do: (PREPARE) кликнуть на кнопку "Сохранить"
      - assert: (PREPARE) модалка закрылась, временная замена удалилась
      - screenshot: (PREPARE) примерный внешний вид смены без временной замены, отмеченной шахматной раскраской [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-04-26%2015-18-52.png]
      - *deleteAsServiceManager

    2. Перенос всей смены на другого дежурного:
      - automation: ABC-10846
      - do: (PREPARE) открыть сервис "autotest-move-shifts" (/services/autotest-move-shifts) 
      - do: (PREPARE) кликнуть на иконку карандашика рядом с надписью "Управляющие" 
      - screenshot: (PREPARE) карандашик рядом с надписью "Управляющие" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-05-31%2014-43-50.png]
      - do: (PREPARE) в модалке "Редактирование управляющих" в поле "Добавить сотрудника" ввести свои имя и фамилию 
      - do: (PREPARE) под полем появился выпадающий список вариантов 
      - do: (PREPARE) выбрать в выпадающем списке себя 
      - assert: (PREPARE) в блоке "Управляющие" появился выбранный сотрудник 
      - do: (PREPARE) кликнуть на кнопку "Сохранить"   
      - do: открыть график дежурств "duty-for-replacements" в сервисе "autotest-move-shifts" (/services/autotest-move-shifts/duty)
      - do: кликнуть на любую доступную смену в графике
      - assert: |
              появилась модалка "Редактирование дежурства"
              в модалке есть имя и фамилия дежурного из смены, даты начала и конца смены, есть надпись "Добавить временную замену"
      - do: кликнуть в модалке на имя/фамилию дежурного
      - screenshot: поле с именем дежурного очистилось, появился выпадающий список с другими дежурными [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-05-31%2014-50-53.png]
      - do: кликнуть по имени любого дежурного из списка, кроме текущего
      - assert: имя/фамилия выбранного дежурного подставились в поле
      - do: кликнуть в модалке на кнопку "Сохранить"
      - assert: |
             модалка скрылась
             смена перенеслась на нового дежурного, стала подтверждённой (закрашена зелёным)

    3. Создание временной замены на несколько дней:
      - automation: ABC-10096
      - *addAsServiceManager
      - *openModalForSettingReplacement
      - do: кликнуть на первый доступный в календаре день для замены
      - assert: календарь скрылся, в первое поле подставилась выбранная дата в формате "ДД месяц ГГГГ"
      - do: кликнуть во второе поле в блоке "Даты"
      - assert: |
              появился выпадающий календарь
              в календаре доступны для выбора только те даты, которые попадают на смену, в которой делается замена
      - do: кликнуть в календаре на день через 2 дня от выбранного на предыдущем шаге
      - assert: календарь скрылся, во второе поле подставилась выбранная дата в формате "ДД месяц ГГГГ"
      - screenshot: примерный вид заполненных для замены полей [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-10-08%2018-48-51.png]
      - do: кликнуть на кнопку "Сохранить"
      - assert: |
              модалка "Редактирование дежурства" скрылась
              на смене добавилась замена на выбранный период
      - screenshot: замена на смене показана пересекающимися стрелочками и шахматной раскраской [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-10-08%2018-50-11.png]
      - do: навести курсор на смену с заменой
      - screenshot: появился попап с информацией о смене - дежурный, период дежурства, наличие временной замены, замещающий и период замены [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-10-08%2018-50-42.png]
      - do: (PREPARE) кликнуть на смену с заменой
      - assert: (PREPARE) появилась модалка "Редактирование дежурства"
      - do: (PREPARE) кликнуть на иконку корзины рядом с временной заменой
      - do: (PREPARE) кликнуть на кнопку "Сохранить"
      - assert: (PREPARE) модалка закрылась, временная замена удалилась
      - screenshot: (PREPARE) примерный внешний вид смены без временной замены, отмеченной шахматной раскраской [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-04-26%2015-18-52.png]
      - *deleteAsServiceManager

files: []

priority: critical

tags:
  - reviewed
