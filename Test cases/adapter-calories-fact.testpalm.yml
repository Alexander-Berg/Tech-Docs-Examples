feature: Факт
type: Калории

specs:
  С картинкой:
    - do: получить выдачу Поиска по запросу 'сколько калорий в дайконе' _ALTERNATIVE_SEARCH_QUERIES_
    - screenshot: на первой позиции выдачи есть Фактовый ответ с картинкой [image]
    - assertMetrics: '*'
    - tech: проверить счетчик на показ селекта
    - do: |
        запомнить текущее значение калорий в Фактовом ответе
        выбрать в селекте другое значение
    - tech: сработал динамический счетчик
    - assert: количество калорий изменилось
    - screenshot: количество калорий изменилось [image-after-select]
    - tech: проверить счетчик в картинке
    - do: навести курсор мыши на картинку
    - assert: картинка стала менее яркой
    - do: кликнуть на картинку в Фактовом ответе
    - assert: в новой вкладке открылись Я.Картинки по искомому запросу
    - tech: проверить счетчик в ссылке 'Источник данных'
    - do: навести курсор мыши на ссылку 'Источник данных' под Фактовым ответом
    - assert: ссылка окрасилась в красный цвет
    - do: кликнуть на ссылку 'Источник данных'
    - assert: |
        в новой вкладке открылся сайт-источник данных на странице запрашиваемого продукта
        ссылка 'Источник данных' после клика не перекрасилась
    - assertMetrics: '*'
  Без картинки:
    - params:
        foreverdata: '2502167777'
    - do: получить выдачу по запросу 'foreverdata'
    - screenshot: на первой позиции выдачи есть Фактовый ответ без картинки [without-image]
    - tech: пример внешнего вида фактового ответа без картинки и данных о питательных веществах (селект может отсутствовать или быть неактивным) [adapters/adapter-calories-fact/no-nutrients plain]
    - assertMetrics: '*'
    - tech: проверить счетчик в первой хлебной крошке
    - do: навести курсор мыши на первую хлебную крошку
    - assert: хлебная крошка окрасилась в красный цвет
    - do: кликнуть по первой хлебной крошке
    - assert: |
        произошел аякс-перезапрос к серпу в той же вкладке
        запрос в поисковой строке изменился
    - assertMetrics: '*'
  С единственным объемом:
    - params:
        foreverdata: '189261704'
    - do: получить выдачу Поиска по запросу 'foreverdata'
    - screenshot: на первой позиции выдачи есть Фактовый ответ [one-select]
    - assertMetrics: '*'

specs-integration:
  Проверка показа блоков:
    - do: получить выдачу Поиска по запросу 'сколько калорий в дайконе' _ALTERNATIVE_SEARCH_QUERIES_
    - assert: на первой позиции выдачи есть Фактовый ответ
    - counter: /$page/$main/$result[@wizard_name="calories_fact"]

files:
  - features/desktop/adapter-calories-fact/adapter-calories-fact.hermione.js
  - features/adapter-calories-fact/adapter-calories-fact@common.hermione.e2e.js

counter: /$page/$main/$result[@wizard_name="calories_fact"]/tabs/controls/select

v-team: Facts

tlds:
  - ru
  - by
  - ua
  - kz
  - uz
  - com.tr
  - com
