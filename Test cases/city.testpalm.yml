feature: Колдунщик топонимов
type: Город

params:
  # колдунщик топонимов отключен на стороне данных, этот флаг возвращает колдун
  srcparams: 'UPPER:rearr=scheme_Local/ToponymWizard/Enabled=1'

specs-integration:
  Проверка показа колдунщика и ссылки:
    - do: получить выдачу по запросу 'москва на карте'
    - assert: на выдаче есть колдунщик, отображается карта
    - do: тапнуть по карте
    - assert: в новой вкладке открылся сервис Яндекс.Карты с Москвой на карте

specs:
  params:
    rearr: EntitySearch_off
  beforeEach:
    - do: получить выдачу по запросу 'москва на карте'
    - assert: в результатах поиска есть колдунщик топонимов с картой
  Проверить внешний вид колдунщика:
    - screenshot: Внешний вид колдунщика топонимов [plain]
  Проверить ссылку и счётчик в тайтле:
    - tags:
        - title
        - maps
    - do: перейти по ссылке в тайтле
    - assert: в новой вкладке открылся сервис Яндекс.Карты с Москвой на карте
    - assertMetrics: '*'
  Проверяем кнопку расхлопа:
    - tags:
        - maps
    - do: кликнуть по кнопке в верхнем правом углу карты
    - assert: в новой вкладке открылся сервис Яндекс.Карты с Москвой на карте
    - assertMetrics: '*'

files:
  - features/touch-phone/adapter-maps/city.hermione.js
  - features/touch-phone/adapter-maps/city.hermione.e2e.js

tlds: all

v-team: VanillaGeo

counter: /$page/$main/$result[@wizard_name="maps" and @subtype="province"]/title

tags:
  - hasE2E

priority: high
