feature: ЖД
type: Оплата
description: 'Не для асессоров, нужен шаг оплаты.'
specs:
  'ЖД: Ошибка подтверждения заказа у партнера после оплаты':
    - do: |-
        Перейти на вкладку ЖД билеты
        Перейти на любой поиск, например, Москва - Екатеринбург
        Для любого поезда кликнуть по кнопке покупки Выбрать место
        Выбрать любое место в вагоне
        Нажать Указать пассажиров
        Ввести ФИО: Коддва Ошибкаим Подтверждение
        Остальные поля заполнить любыми валидными данными
        Нажать Проверить заказ и купить
        Нажать Перейти к оплате
        Ввести данные тестовой карты (например, 5100003697253468, 12/20, 090)
        Нажать Оплатить
    - assert: >-
        * Появился лоадер с текстом "Подождите, идет оплата билетов"

        * Через 30 секунд сообщение сменилось на "Процесс оплаты занимает больше
        времени, чем обычно. Подождите ещё 3 минуты"

        * Количество минут уменьшается соответственно прошедшему времени

        * После сообщения, что осталась 1 минута, цикл начинается заново
    - do: |-
        Перейти на созданный заказ в админке
        Перейти на заказ по ссылке
    - assert: >-
        * Нет действий по заказу (скачать, распечатать, сдать билет, отменить
        ЭР)
    - do: >-
        Дождаться, когда статус в админке поменяется на Отменен (15 минут, но
        может быть больше)
    - assert: >-
        * На странице оплаты появилось модальное окно с сообщением "Не удалось
        выкупить билет. Попробуйте ещё раз. Не волнуйтесь, деньги не списались.
        Если проблема повторяется, свяжитесь со службой поддержки по номеру 8
        800 511-71-04 или через форму обратной связи." (для МО другой телефон)
    - do: Нажать Выбрать места заново
    - assert: '* Произошел переход на страницу выбора мест'
manual: true
Устройство:
  - Десктоп
  - Тач
Страница: Оплата
Сервис: ЖД
Тестирование асессорами: Нет
Окружение: Testing
Автор: shenfeld
