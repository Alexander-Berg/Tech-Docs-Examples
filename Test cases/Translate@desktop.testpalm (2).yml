feature: Колдунщик переводов

specs:
  Общие проверки:
    Проверка тултипа копирования:
      - do: получить выдачу по запросу 'перевод hello'
      - do: кликнуть в кнопку копирования
      - assert: появился тултип рядом с кнопкой копирования
      - screenshot: к-к перевода с тултипом копирования [transalateAfterCoping]
      - screenshot: тултиип копирования [copyTooltip]
    Перенос строки по нажатию Shift+Enter:
      - do: получить выдачу по запросу 'перевод кот с русского на английский онлайн'
      - do: в поле ввода нажать Sift+Enter и дописать 'кот'
      - assert: в поле ввода 2 строки, состоящие из слова 'кот'
    Проверка саджестов:
      - do: получить выдачу по запросу 'переводчик онлайн с русского на английский'
      - assert: появился пустой колдунщик переводов
      - do: ввести в поле ввода 'hel'
      - assert: появилась подсказка 'help'
      - do: кликнуть на подсказку
      - assert: подставилось слово 'help' в поле ввода
      - do: очистить поле ввода
      - do: ввести в поле ввода 'hel'
      - assert: появилась подсказка 'help'
      - do: нажать enter
      - assert: подставилось слово 'help' в поле ввода
    Проверка саджестов с разделителем:
      - do: получить выдачу по запросу 'переводчик онлайн с русского на английский'
      - assert: появился пустой колдунщик переводов
      - do: ввести в поле ввода 'hello helpi'
      - assert: появилась подсказка 'helping'
      - do: кликнуть на подсказку
      - assert: строка 'hello helping' подставилась в поле ввода
      - do: очистить поле ввода
      - do: ввести в поле ввода 'hello.helpi'
      - assert: появилась подсказка 'helping'
      - do: нажать enter
      - assert: строка 'hello.helping' подставилась в поле ввода
    Длинные названия в контролах:
      - do: получить выдачу по запросу 'перевод'
      - assert: появляется колдунщик переводов с пустым полем ввода текста
      - do: вставить в поле ввода текст 'Forbye twa Cdan o Sheena Blackhall singin Bothy Ballads an raedin i iain poesy ann Oot o \' Kist. Nae tae be a dhìth airson Sheena an maist kenspecklet \' esan o\'oor preisent dey Makars.'
      - assert: язык в селекте исходного языка меняется на 'Шотландский (гэльский) (автоопределение)'
      - do: в правом селекте выбрать 'Португальский'
      - assert: названия языков в селектах обрезаются многоточием
      - screenshot: контролы [plain]
    Проверка внешнего вида языкового попапа:
      - do: получить выдачу по запросу 'кот перевод'
      - do: нажать на левую кнопку выбора языка
      - screenshot: левый языковой попап [sourceSelectPopup]
      - do: нажать на правую кнопку выбора языка
      - screenshot: правый языковой попап [targetSelectPopup]
    Прерывание нажатием на значок микрофона:
      Озвучки исходного текста:
        - do: получить выдачу по запросу 'кот перевод с русского на английский онлайн'
        - do: нажать на озвучку исходного текста
        - do: нажать на значок микрофона
        - assert: озвучка прекратилась
      Озвучки перевода:
        - do: получить выдачу по запросу 'кот перевод с русского на английский онлайн'
        - do: нажать на озвучку перевода
        - do: нажать на значок микрофона
        - assert: озвучка прекратилась
    Проверки с контролами:
      beforeEach:
        - do: получить выдачу по запросу 'перевод'
        - assert: появляется колдунщик перевода
        - do: вставить в поле ввода слово 'friend'
        - assert: появляется результат с переводом слова
      Проверка ховера иконок:
        - do: получить выдачу 'кот перевод'
        - do: навести курсор на иконки динамика, копирования, крестика, микрофона, смены направления переводов, иконки источника примеров
        - assert: иконки меняют цвет на черный, не меняют размера
      При выборе языка, с которого переводим, результат с переводом обновляется:
        - tags: smoke_extended
        - do: кликнуть в первый селект с языком
        - tech: проверить динамический счётчик в первом селекте с языком
        - assert: появляется выпадающее меню с языками
        - do: кликнуть по первому элементу селекта
        - assert: результат с переводом обновляется
      При выборе языка, на который переводим, результат с переводом обновляется:
        - tags: smoke_extended
        - do: кликнуть во второй селект с языком
        - tech: проверить динамический счётчик во втором селекте с языком
        - assert: появляется выпадающее меню с языками
        - do: кликнуть по первому элементу селекта
        - assert: результат с переводом обновляется
      Кнопка перезагрузки работает:
        - do: получить выдачу по запросу 'перевод'
        - tech: замокать ручку перевода
        - do: записать в поле ввода 'кот' и дождаться сообщения об ошибке
        - screenshot: внешний вид с ошибкой [error]
        - tech: размокать ручку перевода
        - do: нажать на кнопку перезагрузки
        - assert: появится спиннер и перевод
        - screenshot: внешний вид с переводом [afterError]
      Закрытие попапа с языками по второму нажатию на селект:
        - do: получить выдачу по запросу 'перевод'
        - do: кликнуть по правому селекту с языками
        - assert: должен открыться попап с языками
        - do: кликнуть еще раз по правому селекту с языками
        - assert: попап с языками должен закрыться и не открываться без дополнительного нажатия
    Проверки с контролами (без текста):
      Смена языка текста на язык перевода:
        - do: получить выдачу по запросу 'перевод на английский'
        - assert: появляется колдунщик перевода
        - assert: в левом селекте выбран язык 'Русский'
        - assert: в правом селекте выбран язык 'Английский'
        - do: кликнуть в левый селект с языком
        - assert: появляется выпадающее меню с языками
        - do: выбрать язык 'Английский'
        - assert: в левом селекте язык меняется на 'Английский'
        - assert: в правом селекте язык меняется на 'Русский'
        - tech: проверить счётчики смены языков
      Смена языка перевода на язык текста:
        - do: получить выдачу по запросу 'перевод'
        - assert: появляется колдунщик перевода
        - assert: в левом селекте выбран язык 'Английский'
        - assert: в правом селекте выбран язык 'Русский'
        - do: кликнуть в правый селект с языком
        - assert: появляется выпадающее меню с языками
        - do: выбрать язык 'Английский'
        - assert: в правом селекте язык меняется на 'Английский'
        - assert: в левом селекте язык меняется на 'Русский'
        - tech: проверить счётчики смены языков
      При смене языков в пустом колдунщике языки меняются местами:
        - do: получить выдачу по запросу 'перевод'
        - assert: появляется колдунщик перевода
        - assert: в левом селекте выбран язык 'Английский'
        - assert: в правом селекте выбран язык 'Русский'
        - do: кликнуть по кнопке смены языков
        - assert: языки оригинала и перевода обновились
  Автоопределение и смена целевого языка:
    beforeEach:
      - do: получить выдачу по запросу 'перевод онлайн'
      - assert: появляется колдунщик переводов с пустым полем ввода текста
      - do: вставить в поле ввода текст 'مرحبا'
      - assert: исходный язык меняется на 'Арабский (автоопределение)'
      - tech: проверить технический счётчик смена языка
      - do: кликнуть во второй селект с языком
      - assert: появляется выпадающее меню с языками
    На любой, кроме автоопределенного:
      - do: выбрать любой язык, кроме арабского, отличный от текущего целевого
      - tech: проверить динамический счётчик смены целевого языка
      - assert: целевой язык изменяется на выбранный
      - assert: в кнопке исходного языка 'Арабский (автоопределение)'
    На автоопределенный:
      - do: выбрать арабский язык
      - assert: целевой язык изменяется на арабский
      - assert: в кнопке исходного языка нет слова '(автоопределение)'
      - tech: проверить счётчики смены языков
  Озвучка:
    beforeEach:
      - do: получить выдачу по запросу 'перевод some people can fly'
      - assert: появляется колдунщик перевода с текстои 'перевод some people can fly' и переводом
    Динамик введённого текста выключается при нажатии на динамик перевода:
      - do: кликнуть по динамику введённого текста
      - assert: динамик введённого текста активировался
      - do: кликнуть по динамику перевода
      - assert: динамик перевода активировался
      - assert: динамик введённого текста деактивировался
      - browsers:
          notFor:
            - firefox
    Динамик перевода выключается при нажатии на динамик введённого текста:
      - do: кликнуть по динамику перевода
      - assert: динамик перевода активировался
      - do: кликнуть по динамику введённого текста
      - assert: динамик введённого текста активировался
      - assert: динамик перевода деактивировался
      - browsers:
          notFor:
            - firefox
  К-к фотоперевода:
    params:
      foreverdata: '1000286293'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: должен появиться колдунщик фотоперевода
    Внешний вид к-ка фотоперевода:
      - screenshot: колдунщик фотоперевода [ocrTranslate]

  Метрики:
    beforeEach:
      - do: получить выдачу по запросу 'кот перевод'
      - tech: проверить метрики
    Клик в микрофон:
      - do: кликнуть в микрофон
      - assert: проверить метрики
    Выбор исходного языка:
      - do: кликнуть в селект выбора исходного языка
      - do: выбрать португальский язык
      - tech: проверить счечтик
      - tech: проверить метрики
    Выбор целевого языка:
      - do: кликнуть в селект выбора целевого языка
      - do: выбрать арабский язык
      - tech: проверить счечтик
      - tech: проверить метрики
    Двойной клик в Селект:
      - do: дважды кликнуть в Селект
      - tech: проверить метрики
    Проверка неактивных кнопок:
      - do: кликнуть в выбор исходного языка
      - do: выбрать "Марийский"
      - do: кликнуть в выбор языка перевода
      - do: выбрать "Армянский"
      - do: кликнуть в "микрофончик"
      - do: кликнуть в верхний "динамик"
      - assert: результат с переводом появляется справа от поля ввода текста
      - do: кликнуть в нижний "динамик"
      - assert: проверить метрики
    Смена направления перевода:
      - do: кликнуть в кнопку смены направления перевода
      - tech: проверить счечтик
      - tech: проверить метрики
    Клик в словарную статью:
      - do: кликнуть в результат перевода
      - tech: проверить счечтик
      - tech: проверить метрики
  Отступ между контролами и словарем:
    - do: получить выдачу по запросу 'breit перевод с немецкого'
    - assert: появляется колдунщик перевода
    - assert: появляется словарь
    - screenshot: словарь и контролы [plain]
  Проверка, что в словаре не едет верстка, когда пришли разные слова:
    - do: получить выдачу по запросу 'перевод croissant'
    - assert: в словаре отображается 2 ровные колонки
    - sreenshots: словарь [dictColumns]
  Отправка статистики при инициализации:
    С пустым колдунщиком:
      - tags: [no_assessors]
      - do: получить выдачу по запросу 'перевод'
      - assert: должен появиться колдунщик переводов
      - tech: проверить счётчик инициализации
    С предзаполненным колдунщиком:
      - tags: [no_assessors]
      - do: получить выдачу по запросу 'код перевод'
      - assert: должен появиться колдунщик переводов
      - tech: проверить счётчик инициализации
  Счётчики дополнительные:
    beforeEach:
      - do: получить выдачу по запросу 'перевод'
      - assert: появляется колдунщик перевода
    При клике на область ввода:
      - do: кликнуть по полю ввода
      - tech: сработал динамический счётчик на области ввода
    # При клике на перевод из словаря:
    #   - do: вставить в поле ввода слово 'doggie'
    #   - assert: появляется результат с переводом
    #   - tech: сработал динамический счётчик на переводе из словаря
  Проверка внешнего вида наведения на ссылки в фактовом к-ке для перевода из словаря:
    - tags: no_assessors
    - params:
        foreverdata: '3122732455'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: должен появиться фактовый колдунщик переводов c переводом 'Облако'
    - do: Навести на ответ
    - screenshot: внешний вид [translate-answer-hover]
    - do: Навести на ссылку источника
    - screenshot: внешний вид [translate-link-hover]
    - do: Навести на ссылку сообщения об ошибке
    - screenshot: внешний вид [translate-footer-hover]

files:
  - src/features/Translate/Translate.test/Translate@desktop.hermione.js

counter: /$page/$main/$result[@wizard_name="translate"]

v-team: Translations_misspell

tags:
  - no_assessors

tlds: [ru, by, kz, uz, ua, com.tr, com]
