feature: Специальные события
type: ЧМФ - Главный экран

specs:
  Стадионы:
    - params:
        foreverdata: '1999354534'
    - do: получать выдачу по запросу 'foreverdata'
    - assert: получена выдача по указанному запросу
    - assert: на выдаче присутствует колдунщик ЧМФ с галереей стадионов
    - screenshot: примерный внешний вид [plain]
  Состав сборной:
    - params:
        foreverdata: '3648476703'
    - do: получать выдачу по запросу 'foreverdata'
    - assert: получена выдача по указанному запросу
    - assert: на выдаче присутствует колдунщик ЧМФ с галереей сборной
    - screenshot: примерный внешний вид [plain]
  Кнопка пейджер - старт со второго таба:
    - params:
        foreverdata: '2250473706'
    - do: получать выдачу по запросу 'foreverdata'
    - assert: получена выдача по указанному запросу
    - assert: на выдаче присутствует колдунщик ЧМФ
    - screenshot: колдунщик [second-tab/before]
    - assert: внешний вид соответствует скриншоту
    - do: нажать в правую листалку пейджера таблицы в правом нижнем углу
    - assert: поменялось содержимое таблицы
    - assert: номер страницы в футере таблицы сменился с "1 из 2" на "2 из 2"
    - assert: появилась листалка пейджера таблицы "Влево"
    - tech: сработал счетчик '/wiz/special/event/chmf2018/table/pager/next'
    - screenshot: колдунщик [second-tab/next-page]
    - do: перейти на владку "Групповой этап"
    - assert: поменялось содержимое таблицы
    - screenshot: колдунщик [second-tab/back-to-first]
    - assert: внешний вид соответствует скриншоту
    - assertMetrics: '*'
  Тайтл - Расписание матчей Полуфиналы:
    Стандартный внешний вид:
      - params:
          foreverdata: '1834526701'
      - do: получить выдачу по запросу 'foreverdata'
      - assert: колдунщик присутствует на странице
      - assert: меню второго уровня автоматически подскроллилось к активному табу "1/2"
      - screenshot: колдунщик [semifinal]
      - assertMetrics: '*'
    Двузначный счет:
      - params:
          foreverdata: '2774993655'
      - do: получить выдачу по запросу 'foreverdata'
      - assert: колдунщик присутствует на странице
      - assert: в колдунщике присутствует матч с двузначным счетом
      - assert: верстка корректная, ничего не разъехалось
      - screenshot: колдунщик [semifinal-double-digit]
      - assertMetrics: '*'
  Тайтл - Расписание матчей Финалы:
    - params:
        foreverdata: '3123185095'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на странице
    - assert: в колдунщике отображается матч за третье место
    - screenshot: колдунщик [final]
  Матчи в разных статусах:
    Групповой этап:
      - params:
          text: foreverdata
          foreverdata: '649709800'
      - do: получить выдачу по запросу 'foreverdata'
      - screenshot: примерный внешний вид [plain]
      - assertMetrics: '*'
    Финал с трансляцией:
      - params:
          text: foreverdata
          foreverdata: '554115127'
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче присутствует колдунщик ЧМФ
      - screenshot: примерный внешний вид [final]
      - assertMetrics: '*'
  Новости:
    params:
      foreverdata: '3207312769'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче присутствует колдунщик ЧМФ
      - do: кликнуть в таб "Новости"
      - tech: сработал счетчик '/wiz/special/event/chmf2018/tab/table'
      - assert: таб "Новости" активен
      - assert: в таблице отображается список новостей и кнопка "Все новости"
    Первая новость:
      - label: special-event_sport-{{BROWSER_TYPE}}
      - screenshot: примерный внешний вид [plain]
      - do: кликнуть в первую новость в таблице
      - assert: в новой вкладке открылся сайт с выбранной новостью
      - tech: сработал счетчик '/wiz/special/event/chmf2018/table/news, vars="-row=0"'
      - assertMetrics: '*'
    Третья новость:
      - screenshot: внешний вид [special-event_sport-{{BROWSER_TYPE}} >> plain]
      - assert: внешний вид соответствует скриншоту
      - do: кликнуть в третью новость в таблице
      - assert: в новой вкладке открылся сайт с выбранной новостью
      - tech: сработал счетчик '/wiz/special/event/chmf2018/table/news, vars="-row=2"'
      - assertMetrics: '*'
    Кнопка "Все новости":
      - screenshot: внешний вид [special-event_sport-{{BROWSER_TYPE}} >> plain]
      - assert: внешний вид соответствует скриншоту
      - do: кликнуть в кнопку "Все новости"
      - assert: в новой вкладке открылся сервис "Яндекс Новости"
      - tech: сработал счетчик '/wiz/special/event/chmf2018/news/button'
      - assertMetrics: '*'
  Новости - гринурл со слэшем:
    - params:
        user_time: '20190920'
        foreverdata: '2746951800'
        text: foreverdata
    - do: получить выдачу по запросу foreverdata
    - assert: на выдаче присутствует колдунщик турнира
    - screenshot: примерный внешний колдунщика [with-slashes-in-news]
    - assert: внешний вид гринурлов в новостях соответствует скриншоту
  Расписание матчей Финалы - параметр source в ссылке:
    - tags:
        - no_assessors
    - params:
        foreverdata: '1238984629'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на странице
    - assert: таб "Финал" в таблице "Расписание матчей" активен
    - do: кликнуть в левый флаг в таблице "Расписание матчей"
    - assert: страница обновилась
    - assert: в адресе страницы есть параметр source=sport-serp
    - assertMetrics: '*'
  Внешний вид - хоккей:
    - tags: 
        - smoke
        - pp_new_core
    - params:
        foreverdata: '345228864'
    - do: получить выдачу по запросу 'foreverdata'
    - screenshot: примерный внешний вид [plain-hockey]
    - assertMetrics: '*'
  Внешний вид - хоккей с каруселью:
    - params:
        foreverdata: '539281971'
    - do: получить выдачу по запросу 'foreverdata'
    - screenshot: примерный внешний вид [plain-hockey]
    - assertMetrics: '*'
  Проверка наличия подсказки "Есть билеты":
    - params:
        text: test
        foreverdata: '1862740671'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на странице
    - assert: в таблице "Расписание матчей" есть матч с подсказкой "Есть билеты"
    - screenshot: примерный внешний вид [with-tickets-link]
    - do: кликнуть в надпись "Есть билеты"
    - assert: выдача обновилась
    - assert: на выдаче присутствует колдунщик матча
    - tech: сработал счетчик '/wiz/special/event/sport/football/table'
    - assertMetrics: '*'
  Блок новостей - новость с гринурлом:
    - params:
        text: test
        foreverdata: '1299271727'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на странице
    - do: кликнуть в таб "Новости"
    - tech: сработал счетчик '/wiz/special/event/football/tab/table'
    - assert: таб "Новости" активен
    - screenshot: внешний вид блока новостей с гринурлами [news]
    - do: кликнуть в первую новость
    - assert: в новой вкладке открылся выбранный новостной сюжет
    - tech: сработал счетчик '/wiz/special/event/football/table/news,-row=0'
    - do: вернуться на вкладку с колдунщиком
    - do: кликнуть в гринурл первой новости
    - assert: в новой вкладке открылся выбранный новостной сюжет
    - tech: сработал счетчик '/wiz/special/event/football/table/news/urlnav,-row=0'
    - assertMetrics: '*'
  Обводка флага национальных сборных:
    - params:
        text: test
        foreverdata: '782554592'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на странице
    - screenshot: внешний вид таблицы "Расписание матчей/Финал" [schedule]
    - assert: внешний вид соответствует скриншоту
    - assert: флаги выделены серой полупрозрачной рамочкой
    - assertMetrics: '*'
  Внешний вид для Украины:
    - params:
        text: test
        foreverdata: '1847447885'
        user_time: '20181121'
        l10n: uk
        tld: ua
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на выдаче
    - screenshot: внешний вид [plain-ua]
    - assert: все тексты в колдунщике на русском языке
    - assertMetrics: '*'
  Расписание матчей - матч с неизвестным временем:
    - params:
        foreverdata: '3262023764'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик турнира присутствует на странице
    - screenshot: внешний вид (для UCBrower должен совпадать с iphone) [match-time-unknown]
    - assertMetrics: '*'
  Иконка наличия трансляции для завершенного матча:
    - params:
        text: test
        foreverdata: '2769407676'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на странице
    - assert: у первого матча в таблице "Расписание матчей" справа есть иконка доступной трансляции
    - screenshot: внешний вид [with-play-icon]
    - do: нажать на иконку
    - assert: открылся сайдблок с трансляцией (само видео может быть недоступно)
    - tech: сработал счетчик '/wiz/special/event/chmf2018/table/table/timetable,-row=0,-column=2'
    - do: нажать назад на устройстве (или в браузере)
    - assert: сайдблок закрылся
    - assertMetrics: '*'
  Внешний вид ссылки на внешний источник - по данным ФИФА:
    - tags:
        - pp_new_core 
    - params:
        foreverdata: '4118095081'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик присутствует на выдаче
    - screenshot: внешний вид [with-source-link]
    - assert: справа снизу видна ссылка "По данным ФИФА"
    - do: нажать на ссылку
    - assert: открылась новая страница с соответствующим сайтом
    - tech: сработал счетчик '/wiz/special/event/football/source'
    - assertMetrics: '*'
  Внешний вид - таблица и ссылка на внешний источник:
    - params:
        foreverdata: '33606873'
    - do: получить выдачу по запросу 'foreverdata'
    - screenshot: примерный внешний вид [source-link-with-table]
    - assertMetrics: '*'
  Отсутствие заблокированных видео:
    - params:
        foreverdata: '1712816829'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: колдунщик чемпионата присутствует на выдаче
    - assert: в блоке "Популярные видео" на видеотумбах нет иконки с замочком
    - screenshot: внешний вид [without-disabled-thumbs]
    - assertMetrics: '*'
  Сокрытие счета:
    Проверка работы:
      - tags: 
          - pp_new_core
      - priority: high
      - params:
          foreverdata: '468561870'
      - do: почистить куки и получить выдачу по запросу 'foreverdata'
      - assert: колдунщик присутствует на выдаче
      - assert: в правом верхнем углу присутстует кнопка сокрытия счета и тултип с подсказкой "Результаты матча можно скрывать"
      - screenshot: внешний вид [with-button-and-tooltip]
      - do: нажать на кнопку сокрытия счета
      - assert: тултип с подсказкой закрылся
      - assert: кнопка стала активной
      - assert: в таблице расписаний скрылся счет у матчей
      - tech: сработал счетчик '/wiz/special/event/sport/football/hide_goals/button'
      - screenshot: внешний вид [with-hidden-score]
      - do: обновить выдачу (заново получить выдачу по тому же запросу)
      - assert: на выдаче присутствует колдунщик
      - assert: отсутствует тултип с сообщением "Результаты матча можно скрывать"
      - assert: счет матчей скрыт под звездочками
      - assert: кнопка скрытия счета во включенном состоянии
      - do: нажать на кнопку сокрытия счета
      - assert: кнопка стала неактивной
      - assert: счет отобразился для всех матчей
      - do: обновить выдачу (заново получить выдачу по тому же запросу)
      - assert: на выдаче присутствует колдунщик матча
      - assert: отсутствует тултип с сообщением "Результаты матча можно скрывать"
      - assert: счет матча отображается
      - assert: кнопка скрытия счета матча в выключенном состоянии
      - assertMetrics: '*'
    На табике "Полуфинал":
      - params:
          foreverdata: '3824491595'
      - do: почистить куки и получить выдачу по запросу 'foreverdata'
      - assert: колдунщик присутствует на выдаче
      - assert: в правом верхнем углу присутстует кнопка сокрытия счета и тултип с подсказкой "Результаты матча можно скрывать"
      - screenshot: внешний вид [button-and-tooltip-semifinal]
      - do: нажать на кнопку сокрытия счета
      - assert: тултип с подсказкой закрылся
      - assert: кнопка стала активной
      - assert: в таблице расписаний скрылся счет у матчей
      - tech: сработал счетчик '/wiz/special/event/sport/football/hide_goals/button'
      - screenshot: внешний вид [hidden-score-semifinal]
      - do: обновить выдачу (заново получить выдачу по тому же запросу)
      - assert: на выдаче присутствует колдунщик
      - assert: отсутствует тултип с сообщением "Результаты матча можно скрывать"
      - assert: счет матчей скрыт под звездочками
      - assert: кнопка скрытия счета во включенном состоянии
      - do: нажать на кнопку сокрытия счета
      - assert: кнопка стала неактивной
      - assert: счет отобразился для всех матчей
      - do: обновить выдачу (заново получить выдачу по тому же запросу)
      - assert: на выдаче присутствует колдунщик матча
      - assert: отсутствует тултип с сообщением "Результаты матча можно скрывать"
      - assert: счет матча отображается
      - assert: кнопка скрытия счета матча в выключенном состоянии
      - assertMetrics: '*'
    Позиционирование тултипа сокрытия счёта:
      - browsers:
          notFor:
            - searchapp-phone
      - params:
          foreverdata: '2556296875'
      - do: почистить куки и получить выдачу по запросу "foreverdata"
      - assert: колдунщик присутствует на выдаче
      - assert: в правом верхнем углу присутстует кнопка сокрытия счета и тултип с подсказкой "Результаты матча можно скрывать"
      - do: проскроллить страницу до конца вниз, а затем обратно вверх
      - assert: в верху страницы появился дистрибуционный подскролл (если подскролл не появился, закрыть вкладку, очистить куки и повторить шаги сначала)
      - assert: |
          тултип с подсказкой про сокрытие счета на своём месте.
          примечание: в процессе выезжания дистрибуционного подскролла
          тултип может съехать, но сразу после окончания анимации
          он должен вернуться на своё место
      - screenshot: внешний вид шапки колдунщика вместе с тултипом сокрытия счета после выезжания подскролла [slide-in]
      - do: нажать на кнопку "Нет, спасибо" в дистрибуционном подскролле
      - assert: |
          тултип с подсказкой про сокрытие счета остался на своём месте.
          примечание: в процессе закрытия дистрибуционного подскролла
          тултип может съехать, но сразу после окончания анимации
          он должен вернуться на своё место
      - screenshot: внешний вид шапки колдунщика вместе с тултипом сокрытия счета после закрытия подскролла [slide-out]
  Баскетбол - трехзначный счет:
    - params:
        foreverdata: '782692193'
    - do: получить выдачу по запросу "foreverdata"
    - assert: колдунщик присутствует на выдаче
    - screenshot: внешний вид таблицы расписания [long-score]
  Баскетбол - трехзначный счет в альбомной ориентации:
    - params:
        foreverdata: '782692193'
    - do: получить выдачу по запросу "foreverdata"
    - assert: колдунщик присутствует на выдаче
    - do: перевернуть телефон в альбомную ориентацию
    - screenshot: внешний вид таблицы расписания для альбомной ориентации [long-score-landscape]
  Внешний вид турнирной таблицы:
    - do: получить выдачу по запросу "рфпл турнирная таблица"
    - assert: колдунщик присутствует на выдаче
    - screenshot: примерный внешний вид турнирной таблицы  [tournament-table]
  Спорт - a11y:
    Основные проверки:
      - tags:
        - no_assessors
        - skip_e2e_check
      - do: получить выдачу по запросу 'РПЛ'
      - assert: колдунщик присутствует на выдаче
      - tech: кнопка скрытия счёта имеет aria-label, содержащий 'скрыть результаты матча'

specs-integration:
  Проверка наличия элементов:
    - counter: /$page/$main/$result[@wizard_name="special/event" and @subtype="sport/football"]
    - do: получить выдачу по запросу "лига чемпионов"
    - assert: на выдаче присутствует колдунщик
    - assert: колдунщик имеет хотя бы одну строчку с блоками

tlds:
  - ru
  - by
  - ua
  - kz
  - uz

files:
  - features/touch-phone/adapter-special-event/adapter-special-event_type_sport/adapter-special-event_type_sport.hermione.js
  - features/touch-phone/adapter-special-event/adapter-special-event_type_sport/adapter-special-event_type_sport.hermione.e2e.js

v-team: Sport

tags:
  - sport
  - reviewed

counter: /$page/$main/$result[@wizard_name="special/event"]
