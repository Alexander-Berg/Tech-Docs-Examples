feature: Включение и выключение уведомлений

import-steps:
    - tests/hermione/suites/messenger/shared-steps/open-messenger.testpalm.steps.yml

specs:

  Получение уведомлений в q[manual]:
    - automation: MSSNGRFRONT-3218
    - attach: Открытие чата q
    - do: авторизоваться пользователем 1
    - do: нажать на шестеренку настроек чата справа от поиска над списком чатов
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-11T14:03:56.jpg]
    - do: в открывшемся диалоге включить "Получать уведомления"
    - do: проверить, что переключатель "Получать фоновые уведомления" выключен
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-10T18:19:57.jpg]
    - do: перейти на новую вкладку браузера
    - do: в другом браузере в режиме инкогнито авторизоваться пользователем 2
    - do: написать любое сообщение в чат c пользователем 1
    - assert: из первого браузера приходит уведомление
    - screenshot: пример внешнего вида (может меняться в зависимости от браузера) [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-10T18:16:15.jpg]
    - do: кликнуть на уведомление
    - assert: открывается чат с пользователем 1, курсор мигает в поле ввода
    - do: остаться на вкладке с текущим открытым чатом в первом браузере
    - do: из второго браузера написать еще одно сообщение в чат с пользователем 1
    - assert: из первого браузера приходит уведомление
    - screenshot: пример внешнего вида (может меняться в зависимости от браузера) [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-10T18:16:15.jpg]
    - do: кликнуть на уведомление
    - assert: открывается чат с пользователем 1, курсор мигает в поле ввода
    - do: открыть любой другой чат не уходить с открытой вкладки браузера
    - do: из второго браузера написать еще одно сообщение в чат с пользователем 1
    - assert: из первого браузера приходит уведомление
    - screenshot: пример внешнего вида (может меняться в зависимости от браузера) [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-10T18:16:15.jpg]
    - do: кликнуть на уведомление
    - assert: открывается чат с пользователем 1, курсор мигает в поле ввода
    - do: закрыть вкладку браузера с чатом
    - do: пользователем 2 написать еще одно сообщение в чат с пользователем 1
    - assert: пушей или уведомлений нет

  Выключение уведомлений в профиле в q[manual]:
    - automation: MSSNGRFRONT-1927
    - attach: Открытие чата q
    - do: нажать на шестеренку настроек чата справа от поиска над списком чатов
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-17T17:47:50.jpg]
    - do: в открывшемся диалоге отключить "Получать уведомления"
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-11T13:14:17.jpg]
    - do: перейти на новую вкладку браузера
    - do: в другом браузере в режиме инкогнито авторизоваться пользователем 2 пароль pazone
    - do: написать любое сообщение в чат с пользователем 1
    - assert: пушей или уведомлений нет

  Выключение уведомлений в чате с пользователем в q[manual]:
    - automation: MSSNGRFRONT-1927
    - attach: Открытие чата q
    - do: нажать на шестеренку настроек чата справа от поиска над списком чатов
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-11T14:03:56.jpg]
    - do: в открывшемся диалоге включить "Получать уведомления"
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-17T17:47:50.jpg]
    - do: в списке чатов нажать правой кнопкой мыши на чат с пользователем 2
    - assert: открылось контекстное меню
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-11T13:50:44.jpg]
    - do: в контекстном меню выбрать пункт "Выключить уведомления"
    - assert: у чата в списке справа отображается иконка выключенных уведомлений
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-11T13:50:54.jpg]
    - do: перейти на новую вкладку браузера
    - do: в другом браузере в режиме инкогнито авторизоваться пользователем 2
    - do: написать любое сообщение в чат с пользователем 1
    - assert: пушей или уведомлений нет
    - do: отправить меншн (написать в поле ввода сообщения @ и в саджесте выбрать имя пользователя 1)
    - assert: из первого браузера приходит уведомление
    - screenshot: пример внешнего вида (может меняться в зависимости от браузера) [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-17T17:44:31.jpg]
    - do: вернуться в первый браузер с пользователем 1
    - assert: у чата в списке справа отображается количество новых сообщений серого цвета
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-11T13:51:45.jpg]
    - do: в списке чатов нажать правой кнопкой мыши на чат с пользователем 2
    - do: в контекстном меню выбрать пункт "Включить уведомления"
    - assert: у чата в списке справа отображается количество новых сообщений синего цвета

  Выключение уведомлений группового чата из меню в q[manual]:
    - automation: MSSNGRFRONT-1927
    - attach: Открытие чата q
    - do: нажать на шестеренку настроек чата справа от поиска над списком чатов
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-11T14:03:56.jpg]
    - do: в открывшемся диалоге включить "Получать уведомления"
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-11T13:48:47.jpg]
    - do: открыть групповой чат "пуши и уведомления"
    - do: в шапке чата кликнуть на троеточие меню
    - do: выбрать пункт "Выключить уведомления"
    - assert: у чата в списке справа отображается иконка выключенных уведомлений
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-17T18:16:16.jpg]
    - do: перейти на новую вкладку браузера
    - do: в другом браузере в режиме инкогнито авторизоваться пользователем 2
    - do: написать любое сообщение в групповой чат "пуши и уведомления"
    - assert: пушей или уведомлений нет
    - do: отправить меншн (написать в поле ввода сообщения @ и в саджесте выбрать имя пользователя 1)
    - assert: из первого браузера приходит уведомление
    - screenshot: пример внешнего вида (может меняться в зависимости от браузера) [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-17T17:44:31.jpg]
    - do: вернуться в первый браузер с пользователем 1
    - assert: у чата в списке справа отображается количество новых сообщений серого цвета
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-17T18:16:48.jpeg]
    - do: в списке чатов нажать правой кнопкой мыши на чат с пользователем 2
    - do: в контекстном меню выбрать пункт "Включить уведомления"
    - do: под пользователем 2 написать еще одно сообщение в групповой чат "пуши и уведомления"
    - assert: из первого браузера приходит уведомление
    - screenshot: пример внешнего вида (может меняться в зависимости от браузера) [https://jing.yandex-team.ru/files/ismateush/uhura_2019-06-10T18:16:15.jpg]
    - do: кликнуть на уведомление
    - assert: открывается групповой чат "пуши и уведомления", курсор мигает в поле ввода

files: []

v-team: Chat

tags:
  - release
  - q
  - no_assessors

tlds: ru

browsers:
  notFor:
    - ie11
