feature: ЖД
type: Страница заказа
description: >-
  **Информация для асессоров: форма оплаты с полями ввода данных карты в
  тестинге намеренно пропускается. Шаги, где требуется ввести данные карты и
  нажать кнопку Оплатить, нужно пропустить.**


  Кейс проверяет, что если ЭР отменена, то билет можно сдать в любое время до
  отправления пассажира со станции его посадки

  Перейти на главную сервиса

  Перейти на вкладку Ж/Д билеты


  Создать заказ для одного взрослого на сегодняшную дату, чтобы до отправления
  поезда оставалось чуть больше часа. Можно смотреть на поездах:

  * скоростном поезде (Сапсан, Ласточка), найти можно на Москва - Питер и
  обратно

  * поезде с перевозчиком НЕ РЖД, а любым другим - на любом направлении:

  ![](https://jing.yandex-team.ru/files/shenfeld/2020-11-25_11.00.34-3v50s.png)

  Иначе может не быть возможности отменить ЭР на странице заказа.

  Если не удалось найти поезд, удовлетворяющий условиям, и при этом чтобы до
  отправления поезда оставалось чуть больше часа - пропустите кейс.


  Создать заказ:

  * Зайти на выдачу

  * Кликнуть по кнопке покупки (кнопка может называть по разному, сейчас -
  “Выбрать место”)

  * Дальше следовать по страницам покупки

  * На странице успешного заказа (хэппи пейдж) кликнуть по кнопке "Подробнее о
  заказе"


  Для заполнения форм на странице оплаты использовать тестовую карту:,

  Номер карты: 5100003697253468

  CVN: 090

  Дата: 01/20
specs:
  'ЖД: Возврат билета, когда до отправления поезда осталось меньше часа и электронная регистрация отменена':
    - do: Перейти на страницу заказа из подготовки
    - assert: >-
        * Есть кнопки Сдать билет рядом с информацией о пассажире и в общих
        действиях по заказу

        * Есть действие Отменить электронную регистрацию рядом с информацией о
        пассажире и в общих действиях по заказу (по клику на гамбургер)
    - do: Кликнуть по кнопке Отменить электронную регистрацию
    - assert: '* Появилось окно для подтверждения'
    - do: Кликнуть кнопку Подтвердить
    - assert: '* На билете появился текст "Электронная регистрация отменена" и иконка'
    - do: |-
        Дождаться, когда до отправления поезда останется меньше часа
        Обновить страницу
    - assert: |-
        * На странице нет желтых предупреждений о невозможности возврата
        * Есть кнопки Сдать билет
    - do: Кликнуть кнопку Сдать билет
    - assert: '* Появилось окно для подтверждения'
    - do: Кликнуть кнопку Подтвердить
    - assert: >-
        * Через какое-то время осуществился возврат билета (красный статус
        Возврат)
manual: true
Функциональность: Действия с заказом
Устройство:
  - Десктоп
  - Тач
Страница: Страница заказа
Сервис: ЖД
Тестирование асессорами: Да
Окружение: Testing
Автор: shenfeld
