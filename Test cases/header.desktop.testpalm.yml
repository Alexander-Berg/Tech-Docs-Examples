feature: Поисковая шапка сервиса Яндекс.Новости

description:
  В сценарии описывается общий вид и компоненты шапки сервиса на десктопе.
  Проверяет корректное отображение шапки (с плюсом / без плюса) и пользовательского попапа

specs:
  имеет внешний вид для незалогиненного пользователя:
    - tags:
      - smoke
      - backend_news
    - do: открыть главную страницу сервиса Яндекс.Новости
    - do: разлогиниться, если был залогин
    - assert: |
        отображается шапка сервиса Яндекс.Новости,
        шапка содержит логотип Яндекса, иконку Яндекс.Плюс и надпись Будьте в Плюсе и кнопку Войти,
        шапка содержит поисковую строку, табы сервисов и рубрикатор,
        может отображаться поп-ап - приглашение об авторизации,
        внешний вид https://jing.yandex-team.ru/files/kossakovskaya/2022-04-14_11-54-28.png ,
        обратите внимание! список портальных табов может отличаться от скриншота - это ок.

  имеет внешний вид для залогиненного пользователя с подпиской Плюс:
    - tags:
      - smoke
      - backend_news
    - do: открыть главную страницу сервиса Яндекс.Новости
    - do: авторизоваться под пользователем с подпиской Яндекс.Плюс (если есть аккаунт с подпиской, в обратном случае пропустить шаг)
    - assert: |
        отображается шапка сервиса Яндекс.Новости,
        шапка содержит логотип Яндекса,
        шапка содержит колокольчик уведомлений, юзерпик пользователя с разноцветной обводкой,
        при наличии уведомлений колокольчик черный, рядом каунтер непрочитанных уведомлений,
        при отсутствии уведомлений колокольчик серый,
        при наличии непрочитанных писем рядом с юзерпиком каунтер непрочитанных писем,
        шапка содержит поисковую строку, табы сервисов и рубрикатор,
        внешний вид https://jing.yandex-team.ru/files/vasekerka/2022-01-27_12-27-44.png

  имеет внешний вид для залогиненного пользователя без подписки Плюс:
    - tags:
      - smoke
      - backend_news
    - do: открыть главную страницу сервиса Яндекс.Новости
    - do: авторизоваться под пользователем без подписки Яндекс.Плюс
    - assert: |
        отображается шапка сервиса Яндекс.Новости,
        шапка содержит логотип Яндекса, иконку Яндекс.Плюс и надпись Будьте в Плюсе, колокольчик уведомлений и юзерпик пользователя,
        при наличии уведомлений колокольчик черный, рядом каунтер непрочитанных уведомлений,
        при отсутствии уведомлений колокольчик серый,
        при наличии непрочитанных писем рядом с юзерпиком каунтер непрочитанных писем,
        шапка содержит поисковую строку, табы сервисов и рубрикатор,
        внешний вид https://jing.yandex-team.ru/files/vasekerka/2021-12-21_17-28-14.png

  не перекрывает поп-апы пользователя и колокольчика:
    - tags:
      - smoke
    - do: залогиниться, если еще не залогинены
    - do: кликнуть по аватарке пользователя
    - assert: отобразился поп-ап, поп-ап не заезжает под портальную шапку
    - do: кликнуть по любой пустой области за пределами поп-апа
    - assert: поп-ап закрылся
    - do: кликнуть по иконке колокольчика
    - assert: отобразился поп-ап, поп-ап не заезжает под портальную шапку

  сохраняет вид при изменении окна браузера:
    - tags:
      - smoke
    - do: открыть главную страницу сервиса Яндекс.Новости
    - do: изменить размер окна браузера
    - assert: |
        отображается шапка сервиса Яндекс.Новости,
        логотип Яндекса и кнопка Найти не перекрывают поисковую строку, поисковая строка уменьшается по ширине,
        аватар пользователя отображается корреткно,
        таб сервисов не смещается и не изменяется в размере,
        рубрики рубрикатора скрываются в выпадающем списке Еще,
        внешний вид https://jing.yandex-team.ru/files/vasekerka/2021-06-08_19-03-36.png

  позволяет перейти в другой сервис:
    - do: открыть главную страницу сервиса Яндекс.Новости
    - assert: |
        название Новости расположено по центру в ленте сервисов, выделено жирным шрифтом и подчеркнуто жирной линией
    - do: тапнуть на сервис Видео
    - assert: происходит переход на Яндекс.Видео в новой вкладке

  позволяет перейти в избранное пользователя:
    - browsers:
        notFor:
            - win-ie11
    - do: авторизоваться на сервисе Яндекс.Новости и открыть главную страницу сервиса Яндекс.Новости
    - assert: |
        название Новости расположено по центру в ленте сервисов, выделено жирным шрифтом и подчеркнуто жирной линией
    - do: тапнуть на аватар пользователя и в выпадающем меню нажать на строку "Избранное", скрин  https://jing.yandex-team.ru/files/kossakovskaya/2021-07-01_18-34-05.png
    - assert: |
        в текущей вкладке открывается сервис Яндекс.Избранное,
        пользователь в сервисе определен верно

  позволяет произвести поиск по сервису Яндекс.Новости:
    - tags:
      - smoke
      - backend_news
    - do: открыть главную страницу сервиса Яндекс.Новости
    - do: тапнуть в поисковой строке
    - assert: появился курсор в поле поисковой строки
    - do: ввести в поисковую строку слово 'заявил'
    - assert: появляется саджест с подсказками и крестик очищения строки

  позволяет перейти на сервис Яндекс.Спорт:
    - tags:
      - smoke
      - backend_news
    - do: навести курсор мыши на рубрику Спорт
    - assert: изменился стиль отображения рубрики в рубрикаторе и стиль курсора
    - do: кликнуть по рубрике Спорт
    - assert: |
        в новой вкладке открывается сервис Яндекс.Спорт,
        урл содержит параметры utm_source=yxnews&utm_medium=desktop

  может содержать иконку Яндекс Плюс на домене by, kz (проверяем только by) [manual]:
    - tags:
      - by_suite
      - smoke_zen
    - tlds:
      - by
    - reasonNotToAuto:
      - Нет возможности автоматизировать проверку на нацдомене, т.к. команда yaGoTld не сохраняет дамп
    - automation:
      - NERPA-12077
    - do: залогиниться под аккаунтом, не имеющим подписки в Я.Плюс
    - do: перейти на страницу https://yandex.by/tune/geo и выставить город "Минск"
    - do: перейти на тестовый стенд
    - do: открыть главную страницу сервиса Яндекс.Новости на домене by
    - assert: |
        отображается шапка сервиса Яндекс.Новости
        шапка содержит логотип Яндекса, колокольчик уведомлений, иконку Яндекс.Плюс и надпись Будьте в Плюсе, аватар и логин,
        шапка содержит поисковую строку, табы сервисов и рубрикатор

#  не содержит иконку Яндекс Плюс на доменах ua, uz, lt, lv, com (проверяем только ua) [manual]:
#    - tags:
#      - ua_suite
#    - tlds:
#      - ua
#    - reasonNotToAuto:
#      - Нет возможности автоматизировать проверку на нацдомене, т.к. команда yaGoTld не сохраняет дамп
#    - automation:
#      - NERPA-12077
#    - do: открыть главную страницу сервиса Яндекс.Новости на домене ua
#    Обратите внимание! - может происходить редирект на домен fr , это ок, заводить на такое баг не надо
#    - do: залогиниться под аккаунтом, не имеющим подписки в Я.Плюс
#    - assert: |
#        отображается шапка сервиса Яндекс.Новости,
#        шапка содержит логотип Яндекса, колокольчик уведомлений, аватар,
#        шапка содержит поисковую строку, табы сервисов и рубрикатор,
#        шапке НЕ содержит иконку Яндекс Плюс

files:
  - features/news/header/header.desktop.hermione.js

qa-engineer: terenandrevna

manager: glushneva

tags:
  - neo
  - header
  - neodesktop

tlds:
  - ru
  - by
  - kz
  - uz
  - ua
  - com
