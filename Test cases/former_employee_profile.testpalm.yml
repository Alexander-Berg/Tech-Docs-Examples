feature: Внешняя анкета
type: Бывший сотрудник

description: |
    создать оффер со значением 'Быший сотрудник' в поле 'Тип вывода'
    в поле 'Логин' введен логин бывшего сотрудника Яндекс
    оффер со значением 'Российская' в поле 'Тип анкеты'
    после отправки анкеты на странице оффера в разделе 'Профиль' заполнились поля значениями соответствующими введенным ранее
    после отправки анкеты на странице оффера появилась ссылка в поле 'Оффер в наниматоре'
    на странице оффера в наниматоре на стаффе предзаполнены ранее заполненные поля в анкете
    в тикете THR описание заполнено значениями из анкеты
    для вывода сотрудника на стафф необходимо нажать на кнопку в препрофайле стаффа 'Утвердить и отправить'
    после этого дождаться статуса 'Готов к выводу', тогда появится кнопка 'Вывести на стафф'
    клик на кнопку 'Вывести на стафф', у препрофайла должен стать статус 'Выведен'
    проверить пророс ли номер электронной подписи или нет можно пройдя по ссылке https://staff.test.yandex-team.ru/admin/django_intranet_stuff/staff/
    найти по ссылке выведенного сотрудника и зайти на его страницу
    если телефон пророс, то в разделе 'Staff phones' рядом с введенным ранее телефоном должна стоять галочка 'For digital sign'

specs:
  Отправка анкеты:
    - do: открыть страницу https://femida-ext.test.yandex-team.ru/hire/offers/<id_анкеты> (если правки на стенде, надо указывать доменную часть стенда)
    - assert: |
        открылась анкета сотрудника
        поле логин задисейблено
    - screenshot: пример внешнего вида [external_questionnaire_form]
    - do: заполнить поле 'Фамилия'
    - do: заполнить поле 'Имя'
    - do: заполнить поле 'Фамилия латиницей'
    - do: заполнить поле 'Имя латиницей'
    - do: заполнить поле 'Фото'
    - do: заполнить поле 'Дата рождения'
    - do: выбрать значение в поле 'Пол'
    - do: заполнить поле 'Контактный телефон' своим номером телефона
    - do: заполнить поле 'Личный email'
    - do: выбрать значение в поле 'Операционная система'
    - do: выбрать значение в поле 'Дата выхода на работу'
    - do: выбрать значение в поле 'Гражданство'
    - assert: |
        появилось поле 'Паспорт'
        появилось поле 'СНИЛС' (если выбрано гражданство 'Российское')
        появилось поле 'Адрес проживания'
    - do: заполнить поле 'Адрес проживания'
    - do: выбрать значение в поле 'Будет ли у вас трудовая книжка к дате выхода на работу?'
    - do: установить галочку в поле 'Я хочу выпустить ЭЦП'
    - screenshot: открылся попап [eds]
    - do: клик на 'Принять' в попапе
    - assert: |
        появилась кнопка 'Отправить смс для подтверждения'
        появилась ссылка 'Изменить'
    - do: клик на кнопку 'Отправить смс для подтверждения'
    - screenshot: появилось поле для ввода кода из смс [eds_code_input]
    - do: ввести код из смс
    - assert: кнопка 'Подтвердить' стала активна
    - do: клик на кнопку 'Подтвердить'
    - screenshot: появилось сообщение о подтвержденном телефоне [eds_code_input_success]
    - do: поставить галочку в поле согласия передачи персональных данных
    - do: поставить галочку в поле 'Принимаю соглашение о неразглашении (NDA)'
    - screenshot: открылся попап с описанием условий [nda_agreement]
    - do: клик на 'Принять' в попапе
    - screenshot: пример внешнего вида заполненной анкеты [external_questionnaire_form_filled]
    - do: клик на 'Отправить'
    - screenshot: выдало сообщение с благодарностью [external_questionnaire_form_success]

tags:
  - reviewed

priority: critical

browsers:
  - yandex-browser-desktop
  - firefox-desktop
  - safari-desktop

files:
  - tests/hermione/suites/desktop/external_profiles/former_employee_profile/former_employee_profile.hermione.js
