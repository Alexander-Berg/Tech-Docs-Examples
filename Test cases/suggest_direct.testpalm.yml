feature: Саджест
type: Реклама

specs:
  beforeEach:
    - do: получить выдачу по запросу "вконтакте"
    - do: кликнуть в крестик поисковой стрелки
  Получить первый результат из саджеста:
    - do: набрать запрос "купить квартиру"
    - assert: саджест открыт
    - screenshot: открытый саджест [suggest/request/opened]
    - assert: внешний вид соответствует скриншоту
    - do: навести курсор на первый элемент саджеста
    - assert: первый элемент саджеста выделен цветным фоном
    - screenshot: ховер первого элемента саджеста [suggest/request/first-control/hovered]
    - assert: внешний вид соответствует скриншоту
    - asssert: первым элементом в саджесте является реклама
    - assertMetrics: '*'
  В саджесте присутствует реклама:
    - do: набрать запрос "кредитная карта тинькофф"
    - assert: в саджесте присутствует реклама
    - screenshot: открытый саджест с рекламой [suggest/ad/opened]
  Открытие рекламы по Enter:
    - do: набрать запрос "кредитная кар"
    - assert: в саджесте присутствует реклама
    - do: выбрать первый элемент стрелкой вниз
    - assert: элемент выделен
    - do: нажать Enter на выбранном элементе
    - assert: открылась вкладка с адресом из рекламной подсказке
    - assertMetrics: '*'
  Заблокированная реклама:
    - tags: no_assessors
    - do: получить выдачу по запросу "кредит"
    - do: в поисковую стрелку донабрать к запросу " т"
    - assert: |
        в DOM дереве саджеста присутствует реклама
        в саджесте отсутствует видимая реклама
    - tech: |
        отправился счетчик саджеста
        поле adr равно 1
        поле adh равно 1
        поле adhb равно 1
  Реклама содержит jsredir ссылки на странице с блокировщиком:
    - params:
        exp_flags:
          - hideads=1
    - do: получить выдачу по запросу "купить холодильник"
    - do: кликнуть в крестик поисковой стрелки
    - assert: |
        саджест открыт
        в саджесте присутствует реклама
    - tech: ссылка содержит jsredir
    - assertMetrics: '*'

files:
  - features/desktop/suggest/suggest_direct.hermione.js

tlds: [ru, by, kz, ua]

tags:
  - no_assessors
  - skip_e2e_check

v-team: Suggest

priority: high
