feature: Ecom-tap

params:
  exp_flags:
    - turbo-app-global-search=1

specs:
  Поиск:
    Страница пустых результатов поиска:
      Внешний вид:
        - do: открыть страницу https://yandex.ru/turbo/spideradio.github.io/n/yandexturbocatalog/?query=qwe
        - assert: открылась страница, где ничего не найдено
        - screenshot: внешний вид соответствует скриншоту [plain]

      На странице нет сортировки и фильтров:
        - do: открыть страницу https://yandex.ru/turbo/spideradio.github.io/n/yandexturbocatalog/?query=qwe
        - assert: |
            открылась страница, где ничего не найдено
            на странице нет панели с сортировкой и фильтрами

      На странице есть панель фильтров, если есть примененные фильтры:
        - do: открыть страницу https://yandex.ru/turbo/spideradio.github.io/n/yandexturbocatalog/
        - do: нажать на "Фильтры"
        - do: в поле "Цена" задать до 1
        - assert: |
            открылась страница, где ничего не найдено
            на странице есть панель с сортировкой и фильтрами

    В подкатегориях есть кнопка искать везде:
      - do: открыть страницу https://yandex.ru/turbo/super01.ru/n/yandexturbocatalog/?query=игра
      - assert: |
          открылась страница с поисковой выдачей по запросу "игра"
          на странице есть слайдер с категориями
          в категориях нет кнопки "Везде"
      - do: перейти в любую категорию
      - assert: в категориях появилась кнопка "Везде"

    Опечаточник пропадает при переходе в подкатегорию:
      - do: открыть страницу https://yandex.ru/turbo/super01.ru/n/yandexturbocatalog/
      - do: написать в поисковой строке запрпос "иггра" (с двумя буквами г)
      - do: выполнить поиск
      - assert: на странице появился опечаточник
      - do: перейти в любую категорию
      - assert: опечаточник пропал

    Количество товаров в описании и на кнопке категории совпадают:
      - do: открыть страницу https://yandex.ru/turbo/super01.ru/n/yandexturbocatalog/?query=игра
      - assert: |
          открылась страница с поисковой выдачей по запросу "игра"
          на странице есть слайдер с категориями
      - do: запомнить количество товаров указанное в первой категории
      - do: перейти в первую категорию
      - assert: в начале страницы есть описание "Найдено N товаров в категории X"
      - assert: количество товаров указанное на кнопке категории совпадает с количеством, указанным в описании

    Ссылка из описания категории ведет в категорию без поиска:
      - do: открыть страницу https://yandex.ru/turbo/super01.ru/n/yandexturbocatalog/?query=игра
      - assert: |
          открылась страница с поисковой выдачей по запросу "игра"
          на странице есть слайдер с категориями
      - do: перейти в первую категорию
      - assert: в начале страницы есть описание "Найдено N товаров в категории X"
      - do: нажать по названию категории из описания
      - assert: произошел переход на оригинальную категорию без поиска

    Кнопка искать везде открывает поиск по корневому каталогу:
      - do: открыть страницу https://yandex.ru/turbo/super01.ru/n/yandexturbocatalog/?query=игра
      - assert: |
          открылась страница с поисковой выдачей по запросу "игра"
          на странице есть слайдер с категориями
      - do: перейти в первую категорию
      - assert: в категориях появилась кнопка "Везде"
      - do: нажать на кнопку "Везде"
      - assert: |
          произошел переход на начальную страницу поиска
          текст хлебной крошки "Каталог"

    Подскролл кнопок-категорий:
      - do: перейти по ссылке https://yandex.ru/turbo/spideradio.github.io/n/yandexturbocatalog/?query=lorem
      - assert: на странице отображаются кнопки-категории
      - screenshot: внешний вид соответствует скриншоту [categories]
      - do: проскроллить кнопки влево до конца и нажать по последней кнопке
      - assert: осуществился переход в выбранный раздел каталога
      - do: нажать Назад
      - assert: осуществился переход на предыдущую страницу
      - assert: кнопки-категории остались проскроллеными до конка влево

    Навигация:
      Возврат назад при поиске из Каталога и Главной:
        - do: перейти по ссылке https://yandex.ru/turbo/spideradio.github.io/n/yandexturbocatalog/main/?morda=1&ecommerce_main_page_preview=1
        - do: в поле поиска ввести 'lorem' и осуществить поиск
        - assert: осуществился переход к результатам поиска в раздел Каталог
        - assert: сверху отображается кнопка Главная
        - do: кликнуть по кнопке Главная
        - assert: осуществился переход в раздел Главная, в поле поиска пусто
        - do: перейти в раздел Каталог, кликнув по соответствующей пиктограмме на нижней панели
        - do: в поле поиска ввести 'lorem' и осуществить поиск
        - assert: в разделе Каталог отобрализись результаты поиска
        - assert: сверху отображается кнопка Каталог
        - do: кликнуть по кнопке Каталог
        - assert: осуществился переход в корень каталога, в поле поиска пусто

      Возврат назад из карточки товара и категории:
        - do: перейти по ссылке https://yandex.ru/turbo/spideradio.github.io/n/yandexturbocatalog/?query=lorem
        - assert: на странице отображаются кнопки-категории
        - do: кликнуть по первой кнопке-категории
        - assert: осуществился переход в выбранный раздел каталога
        - assert: сверху отображается кнопка Назад
        - do: кликнуть по кнопке Назад
        - assert: осуществился переход на предыдущую страницу
        - do: кликнуть по любой карточке товара
        - assert: открылась страница с подробной информацией выбранного товара
        - assert: сверху отображается кнопка Назад
        - do: кликнуть по кнопке Назад
        - assert: осуществился переход на предыдущую страницу

      Возврат назад со страницы фильтров:
        - do: перейти по ссылке https://yandex.ru/turbo/spideradio.github.io/n/yandexturbocatalog/?query=lorem
        - do: кликнуть по кнопке Фильтры
        - assert: осуществился переход в раздел фильтры
        - assert: сверху отображается кнопка Каталог
        - do: вернуться назад и кликнуть по любой кнопке-категории
        - assert: осуществился переход в выбранный раздел каталога
        - do: кликнуть по кнопке Фильтры
        - assert: осуществился переход в раздел фильтры
        - assert: сверху отображается кнопка с названием раздела, из которово открыли фильтры

      Возврат назад после применения фильтров:
        - do: перейти по ссылке https://yandex.ru/turbo/spideradio.github.io/n/yandexturbocatalog/?category_id=9&query=esse&category_count=2
        - assert: открылась страница со списком товаров, на странице отображается два товара
        - do: кликнуть по кнопке Фильтры, в поле ДО указать '1400' и применить фильтрацию
        - assert: открылась страница со списком товаров, на странице отображается один товар
        - do: нажать Назад сверху
        - assert: открылась страница со списком товаров
        - assert: фильтры сбросились, на странице отображается два товара

      Проброс фильтров в подкатегорию и обратно:
        - do: перейти по ссылке https://yandex.ru/turbo/spideradio.github.io/n/yandexturbocatalog/
        - assert: открылась страница со списком товаров
        - do: кликнуть по кнопке Фильтры, в поле ДО указать '2600' и применить фильтрацию
        - assert: открылась страница со списком отфильтрованных товаров
        - do: кликнуть по любой категории
        - assert: открылась выбранная категория, товары в ней соответствуют фильтру
        - do: кликнуть по ссылке Каталог сверху
        - assert: осуществился переход на предыдущую страницу, товары в на ней соответствуют фильтру

v-team: Turbo

files:
  - __tests__/search@phone.hermione.js

tlds: ru

tags:
  - ecom-tap
