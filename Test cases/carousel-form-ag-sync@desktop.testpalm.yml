feature: Hotels / Карусель

import-labels:
  - features/companies/hotels/hotels-carousel/hotels-carousel@desktop.testpalm.yml

params:
  rearr:
    - rearr=scheme_Local/OrgWizard/ForceCarousel=1

specs:
  Синхронизация значений формы:
    beforeEach:
      - do: получить выдачу по запросу "отели в алуште"
      - assert: показалась отельная карусель
      - screenshot: внешний вид [geo-hotels-carousel >> carousel]
      - do: изменить даты и количество гостей
      - assert: отели загрузились
    Пробрасываются в урл запроса пинов при драге карты:
      - tags:
          - map
          - switch
          - zoom
      - do: нажать на карточку карты в карусели и после открытия большой карты нажать на контрол зума "+"
      - assert: отели загрузились
      - tech: выполнился запрос в /search/result с правильными параметрами ag_dynamic
    Пробрасываются в урл загрузки попапа и фильтры в попапе:
      - tags:
          - popup
      - do: кликнуть во вторую карточку карусели
      - assert: |
          открылся попап отеля
          поля формы синхронизированы
      - tech: выполнился запрос в /search/result с правильными параметрами ag_dynamic
    Пробрасываются в карте:
      - tags:
          - map
          - popup
          - submit
          - pin
      - do: кликнуть в карточку карты в карусели
      - assert: появилась карта на месте карусели с отелями в виде пинов на ней
      - do: кликнуть в любой пин на карте
      - assert: слева появилась карточка выбранного отеля
      - do: кликнуть в карточку отеля
      - assert: |
          открылся попап с подробным описанием отеля
          в попапе присутствует форма поиска номеров
          даты в форме совпадают с теми, что были на карте
      - do: кликнуть в крестик в правом верхнем углу попапа
      - assert: попап закрылся
      - do: в форме на карте изменить вторую дату на день позже от предустановленной
      - assert: содержимое карты перезагрузилось
      - do: кликнуть в тот же пин на карте, в который кликали ранее
      - assert: |
          слева появилась карточка выбранного отеля
          название отеля совпадает с просмотренным ранее
      - do: кликнуть в карточку отеля
      - assert: |
          открылся попап с подробным описанием отеля
          в попапе присутствует форма поиска номеров
      - assert: даты в форме совпадают с теми, что были выбраны на предыдущем шаге
      - assertMetrics: '-'
    # Баг https://st.yandex-team.ru/SERP-93342
    Пробрасываются в попап при повторном открытии:
      - tags:
          - popup
          - submit
      - do: кликнуть во вторую карточку карусели
      - assert: |
          открылся попап отеля
          поля формы синхронизированы
      - do: |
          закрыть попап
          изменить даты и количество гостей, запомнить введенные значения
      - assert: загрузились отели
      - do: кликнуть в карточку отеля, открытого ранее
      - assert: открылся попап отеля
      - do: кликнуть в таб "Номера"
      - assert: открылась вкладка "Номера"
      - assert: поля формы синхронизированы с каруселью

files:
  - features/companies/hotels/form/carousel-form-ag-sync@desktop.hermione.js

counter: /parallel/result/snippet/companies/travel_company/form/submit

v-team: KotTeam

tags:
  - skip_e2e_check
  - orgmn
  - hotels-form
  - carousel
  - datasync
  - react
  - ajax

tlds: none
