feature: БНО новостей

specs:
  beforeEach:
    - do: получить выдачу по запросу 'новая газета' _ALTERNATIVE_SEARCH_QUERIES_
    - assert: появился сниппет новостей с галерей статей и БНО
  Внешний вид:
    - screenshot: внешний вид [plain]
    - assertMetrics: '*'
  Проверка заголовка:
    - do: кликнуть на заголовок БНО
    - assert: в новой вкладке открылся сайт
    - do: вернутся на выдачу
    - screenshot: заголовок имеет цвет посещенной ссылки (фиолетовый) (в инкогнито не работает - это ожидаемо) [visited]
    - tech: проверить счётчик в заголовке
    - assertMetrics: '*'
  Проверка сайтлинков:
    - do: кликнуть на первый сайтлинк БНО
    - assert: открылся выбранный раздел сайта
    - tech: проверить счётчик в первом сайтлинке
    - assertMetrics: '*'
  Нажатие на кнопку "еще" в сайтликах:
    - do: проскролить до кнопки 'ещё' и нажать ее
    - screenshot: примерный вид БНО со всеми сайтлинками [opened-sitelinks]
    - assert: появились все сайтлинки
    - screenshot: примерный вид развернутого списка сайтлинков [extended-sitelinks]
    - tech: проверить счётчик кнопки 'еще' на разворачивание сайтлинков
    - do: кликнуть на кнопку 'еще'
    - assert: часть сайтлинков скрылась
    - tech: проверить счётчик на кнопке 'еще' на сворачивание сайтлинков
    - assertMetrics: '*'
  Проверить счетчик на свайп карусели:
    - do: свайпнуть карусель влево
    - tech: сработал динамический счетчик
    - assertMetrics: '*'
  Проверка счетчиков и ссылок в галерее:
    - do: кликнуть на тумбe первого элемента галереи
    - assert: открылась выбранная новость
    - tech: проверить счётчик на тумбe первого элемента галереи
    - do: кликнуть на тайтл первого элемента галереи
    - assert: открылась выбранная новость
    - tech: проверить счётчик на тайтл первого элемента галереи
    - do: кликнуть на гринурл первого элемента галереи
    - assert: открылась выбранная новость
    - tech: проверить счётчик на гринурле первого элемента галереи
    - do: кликнуть на хинт первого элемента галереи (хинт - это дата серым цветом в нижней правой части тумбы)
    - assert: открылась выбранная новость
    - tech: проверить счётчик на хинте первого элемента галереи
    - do: проскроллить галерею до последнего элемента
    - screenshot: внешний вид после скролла до последнего элемента [last-news]
    - do: кликнуть на 'еще на сайте'
    - assert: открылся сайт источника
    - tech: проверить счётчик в последнем элементе галереи 'еще на сайте'
    - do: проскроллить галерею обратно
    - assert: скролл галереи работает
    - assertMetrics: '*'
  Проверка разных размеров картинки в карусели:
    Большая картинка:
      - params:
          foreverdata: '3275619588'
      - do: получить выдачу по запросу 'foreverdata'
      - screenshot: внешний вид фичи с большой картинкой [with-big-picture]
      - assertMetrics: '*'
    Маленькая картинка:
      - params:
          foreverdata: '1840664799'
      - do: получить выдачу по запросу 'foreverdata'
      - screenshot: внешний вид фичи с маленькой картинкой [with-small-picture]
      - assertMetrics: '*'
    Картинка с нестандартным соотношением сторон:
      - params:
          foreverdata: '347557966'
      - do: получить выдачу по запросу 'foreverdata'
      - screenshot: внешний вид фичи с картинкой 16:9 [with-no-standart-picture]
      - assertMetrics: '*'
  Проверка кириллических доменов:
    Кириллический домен на тумбе:
      - params:
          foreverdata: '898311414'
      - do: получить выдачу по запросу 'foreverdata'
      - screenshot: примерный внешний вид фичи с кириллическим доменом на тумбе [with-cyrillic-domain]
      - assertMetrics: '*'
  С рейтингом:
    - params:
        foreverdata: '836086347'
    - do: получить выдачу по запросу 'foreverdata'
    - screenshot: внешний вид с рейтингом [with-rating]

specs-integration:
  Присутствует на странице:
    - do: получить выдачу по запросу 'лента ру' _ALTERNATIVE_SEARCH_QUERIES_
    - assert: появился сниппет новостей с галерей статей и БНО
    - do: кликнуть на кнопку 'еще'
    - assert: видны все сайтлинки
    - counter: /$page/$main/$result[@features has "news_bno_view"]/bno/showcase/item/thumb

files:
  - features/bno/bno-common@touch-phone.hermione-helper.js
  - features/bno/bno-news@touch-phone.hermione.js
  - features/bno/bno-news@touch-phone.hermione.e2e.js

v-team: Beauty

tags:
  - reviewed
  - pp_new_core

counter: /$page/$main/$result[@features has "news_bno_view"]/bno/showcase/item/thumb

tlds:
  - ru
  - by
  - ua
  - kz
  - uz
  - com.tr
  - com

priority: high
