feature: Ресурсы
type: Страница ресурсов сервиса

specs:
  beforeEach:
    - tech: залогиниться под пользователем robot-internal-003
  aliases:
    - &openTestService
      - do: открыть страницу потребляемых ресурсов сервиса "Мой тестовый сервис 020 (автотесты)" (/services/zanartestservice020/resources/)
      - screenshot: на странице отображаются карточки ресурсов, которые выданы сервису; в карточках присутствуют названия поставщиков, типов ресурсов и их количество [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-25%2018-23-32.png] 

  Карточки ресурсов:
    1. Переход на список всех ресурсов определённого поставщика:
      - automation: ABC-10978
      - *openTestService
      - do: навести курсор на карточку "Паспорт"
      - screenshot: у карточки появилась серая тень [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-07-05%2018-41-51.png]
      - do: кликнуть на название карточки "Паспорт"
      - assert: |
              открылся список ресурсов
              в URL есть параметры view=consuming, layout=table и supplier=14
              в фильтрах справа в блоке "Поставщики и типы" отмечены галочками пункт "Паспорт" и все его подпункты - "TVM приложение", "OAuth API", "HistoryDB API", "Пользовательские данные" 

    2. Переход на список ресурсов конкретного типа:
      - automation: ABC-10978
      - *openTestService
      - do: навести курсор на надпись "HistoryDB API" в карточке "Паспорт"
      - screenshot: блок с типом ресурса "HistoryDB API" внутри карточки выделился, внешний блок при этом не выделился [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-25%2018-36-24.png]
      - do: кликнуть на надпись "HistoryDB API" в карточке "Паспорт"
      - assert: |
              открылся список ресурсов
              в URL есть параметры view=consuming, layout=table, supplier=14 и type=89
              в фильтрах справа в блоке "Поставщики и типы" прочерком отмечен пункт "Паспорт", галочкой отмечен его подпункт "HistoryDB API"
              напротив остальных подпунктов "Паспорта" - "TVM приложение", "OAuth API", Пользовательские данные" - галочек не стоит 

    3. Отображение ресурсов поставщика "BOT":
      - automation: ABC-10978
      - do: открыть страницу потребляемых ресурсов сервиса "Баланс" (/services/balance/resources/)
      - screenshot: среди карточек с ресурсами есть карточка поставщика "BOT", в которой написано количество ресурсов этого поставщика [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-07-05%2018-48-43.png]
      - do: кликнуть на карточку "BOT"
      - assert: |
              открылся список ресурсов
              в URL есть параметры view=consuming, layout=table, supplier=385, 
              в URL нет параметра type,
              в фильтрах справа в блоке "Поставщики и типы" галочкой отмечен пункт "BOT", галочками отмечены все его подпункты 

    4. Экспорт ресурсов в CSV:
      - automation: ABC-10978
      - *openTestService
      - do: кликнуть на кнопку "Экспорт в CSV" в правом углу над карточками ресурсов
      - screenshot: под кнопкой появилась зелёная подсказка "Письмо поставлено в очередь на отправку" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-25%2018-41-59.png]

files: []

priority: critical

tags:
  - no_assessors
  - reviewed
