feature: Сниппет екоммерс

specs:
  aliases:
    - &turboIframeInOverlayChecks
      - assertMetrics: '*'
      - assert: |
          открылся сайд-блок с контентом страницы
          в сайд-блоке показывается карточка товара
      - do: тапнуть на кнопку 'Назад' или крестик
      - tech: проверить, что сработали счетчики кнопки 'Назад' и закрытия всех оверлеев
      - assert: сайд-блок закрылся
      - assertMetrics: '*'
  Основные проверки:
    beforeEach:
      - do: получить выдачу по запросу "foreverdata"
    Внешний вид:
      - screenshot: на выдаче есть спецсниппет екоммерса [plain]
      - assertMetrics: '*'
      - params:
          foreverdata: '1985519620'
    Внешний вид в горизонтальной ориентации:
      - do: перевернуть девайс в горизонтальную ориентацию
      - screenshot: на выдаче есть спецсниппет екоммерса [plain-horizontal]
      - assertMetrics: '*'
      - params:
          foreverdata: '1985519620'
    Заголовок - новая вкладка:
      - assert: на выдаче есть спецсниппет екоммерса
      - tech: проверить счетчик в заголовке
      - do: тапнуть на заголовок сниппета турбо-страницы
      - assert: страница открылась в новой вкладке
      - params:
          foreverdata: '1985519620'

  Со скидкой:
    Внешний вид:
      - tags: no_assessors #скидка 'плавает', сложно словить
      - do: получить выдачу по запросу 'флемоксин солютаб 1000'
      - screenshot: на выдаче есть спецсниппет екоммерса со скидкой [discount]
      - assertMetrics: '*'


files:
  - features/touch-phone/adapter-ecommerce-info/adapter-ecommerce-info.hermione.js

v-team: Turbo

counter: /$page/$main/$result[@wizard_name="ecommerce_info"]

tags:
  - turbo
  # эксперимент
  - skip_e2e_check

tlds:
  - ru
  - by
  - ua
  - kz
  - uz
  - com.tr
  - com

browsers:
  notFor:
    - android-uc-browser-11-touch
    - android-uc-browser-touch
    - searchapp-phone-group # В ПП отключили турбо-оверлей. Открывается новая страница
