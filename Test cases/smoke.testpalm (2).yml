feature: AppSmoke
type: Automated

specs:
  Объектный ответ:
    Проверка работы фильтров в карусели:
      - v-team: OO
      - do: получить выдачу по запросу 'фильмы 2018'
      - screenshot: появилась карусель с фильмами, примерный вид такой [plain]
      - do: просвайпить фильтры влево до упора
      - assert: показаны крайние правые фильтры
      - do: выбрать любое значение жанр фильма
      - assert: |
          выдача перезагрузилась,
          на выдаче есть карусель фильмов,
          в фильтрах выбран правильный жанр

    Проверка аякс перезапроса:
      - v-team: OO
      - do: получить выдачу по запросу 'мадонна'
      - screenshot: появилась карточка объекта, примерный вид такой (может содержать также карусель с видео, могут отсутствовать рейтинги и блок 'подробнее' внизу) [plain]
      - do: кликнуть на первую ссылку в поле 'Родители'
      - assert: произошел аякс-перезапрос и появилась новая выдача

  Опечатка и Ко:
    Проверка наличия опечаточника:
      - v-team: Freshness
      - priority: high
      - do: получить выдачу по запросу 'малоко'
      - screenshot: на выдаче появился опечаточник [plain]
      - assert: в поисковой строке запрос 'малоко' исправился на 'молоко'
      - do: кликнуть на кнопку 'Отменить'
      - assert: опечаточник скрылся
      - assert: в поисковой строке запрос 'молоко' исправился на 'малоко'

  Проверка подгрузки второй страницы:
    - v-team: Beauty
    - do: получить выдачу по запросу 'тест'
    - assert: загрузились результаты выдачи
    - do: пролистать до конца выдачи
    - screenshot: внизу есть кнопка 'Показать ещё' [plain]
    - do: кликнуть по кнопке 'Показать еще'
    - assert: загрузилась вторая страница с результатами, появился разделитель страниц с номером 2
    - do: пролистать до конца выдачи и кликнуть 'Показать еще'
    - assert: загрузилась третья страница с результатами, появился разделитель страниц с номером 3

specs-integration:
  Колдунщик картинок:
    Проверка перехода на сервис картинок:
      - v-team: Images
      - priority: high
      - do: получить выдачу по запросу 'котята'
      - screenshot: появился колдунщик картинок, внешний вид в зависимости от разрешения экрана такой [https://jing.yandex-team.ru/files/shandraan/Google-Pixel-3_Android-12-0-0_08-09-2021_12-39-58.jpeg]
      - do: кликнуть по тайтлу в колдунщике картинок
      - assert: |
          осуществился переход на сервис картинок в приложении,
          показана выдача Картинок по тому же запросу
      - do: кликнуть на таб Сайты под желтой шапкой
      - assert: вернулись обратно на выдачу по сайтам по тому же запросу

    #По следам бага SERP-65463
    Проверка возврата к выдаче по нажатию кнопки "Назад" устройства:
      - v-team: Images
      - priority: high
      - do: получить выдачу по запросу 'котята'
      - screenshot: появился колдунщик картинок, внешний вид в зависимости от разрешения экрана такой [https://jing.yandex-team.ru/files/dudkevich/koldunshchik_kartinok.png]
      - do: кликнуть по тайтлу в колдунщике картинок
      - assert: |
          осуществился переход на сервис картинок в приложении,
          показана выдача Картинок по тому же запросу
      - do: кликнуть по кнопке "Назад" устройства
      - assert: |
          вернулись обратно на выдачу по сайтам по тому же запросу,
          поисковая стрелка отображается

    Проверка скролла:
      - counter: /$page/$main/$result[@wizard_name="images"]/images
      - v-team: Images
      - priority: high
      - do: получить выдачу по запросу 'котята'
      - screenshot: появился колдунщик картинок, примерный вид такой [https://jing.yandex-team.ru/files/dudkevich/koldunshchik_kartinok.png]
      - do: скроллить картинки в колдунщике вправо до конца
      - screenshot: появилась кнопка кнопка 'Ещё картинки', примерный вид такой [https://jing.yandex-team.ru/files/dudkevich/more_button.png]
      - do: клик по кнопке 'Ещё картинки'
      - assert: |
          осуществился переход на сервис картинок в приложении,
          показана выдача Картинок по тому же запросу
      - do: кликнуть на таб Сайты под желтой шапкой
      - assert: |
          вернулись обратно на выдачу по сайтам по тому же запросу,
          колдунщик проскроллен до кнопки 'Ещё картинки'
      - do: скроллить обратно до первой картинки в колдунщике
      - screenshot: показывается колдунщик картинок в виде по умолчанию [https://jing.yandex-team.ru/files/dudkevich/koldunshchik_kartinok_clicked.png]

  БНО:
    Проверка БНО и навигации:
      - v-team: Beauty
      - do: получить выдачу по запросу 'ВТБ'
      - assert: появился сниппет БНО
      - do: тапнуть на первый сайтлинк
      - assert: открылся сторонний сайт

  Проверка кнопки "назад":
    - v-team: Beauty
    - do: получить выдачу по запросу 'google'
    - do: кликнуть в тайтл любого сниппета
    - assert: осуществился переход на сторонний сайт в webview (внутренний браузер)
    - do: нажать на стрелку Назад на телефоне (НЕ в браузере)
    - assert: вернулись в поисковое приложение

files:
  - features/touch-phone/smoke/smoke.hermione.js
  - features/touch-phone/smoke/smoke.hermione.e2e.js

tags: [smoke, smoke_extended, required, pp_new_core]

v-team: Common

tlds: none

browsers:
  - searchapp-phone
