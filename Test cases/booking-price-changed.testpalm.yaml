feature: ТК Авиа
description: |
    Описание перехода на бронирование для команды: https://testpalm.yandex-team.ru/testcase/clone_travel-930
    Описание перехода на бронирование для асессоров: https://testpalm.yandex-team.ru/testcase/clone_travel-931

specs:
    Изменение цены при оплате:
        - do: Дернуть ручку тестового контекста https://api.travel-balancer-test.yandex.net/api/test_context/v1/avia_token?checkAvailabilityOnRedirOutcome=CAOR_SUCCESS&checkAvailabilityBeforeBookingOutcome=CAO_PRICE_CHANGED&tokenizationOutcome=TO_SUCCESS&confirmationOutcome=CO_SUCCESS&mqEventOutcome=MEO_SUCCESS
        - do: Положить значение из "token" в куку variantTestContext, из "payment_token" в куку paymentTestContext
        - do: Перейти на страницу бронирования (шаги описаны в Description)
        - assert: Открылась страница бронирования
        - do: Заполнить данные о пассажирах валидными данными
        - do: Запомнить сумму заказа и нажать кнопку "Оплатить"
        - assert: |
            Открылась страница оплаты
            Появился модал "Цена изменилась" с кнопками "Вернуться к результатам поиска" и "Продолжить бронирование"
        - do: Запомнить сумму2 из модала и нажать кнопку "Продолжить бронирование"
        - assert: |
            Открылась страница happy page "Вы успешно забронировали билеты"
            Оплаченная сумма в корзинке равна сумме2 из модала
            Цена у единственного пассажира в корзинке также равна сумме2

files:
    - tests/desktop/avia/booking/booking-price-changed.hermione.ts

tags: smoke

Сервис: Авиа
Функциональность: BOY
Устройство:
    - Десктоп
Окружение:
    - Testing
Тестирование асессорами: Нет
