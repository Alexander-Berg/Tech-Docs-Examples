feature: Колдунщик 1орг
type: Публикации

specs:
  Таб в сайдблоке:
    beforeEach:
      - do: получить выдачу по запросу 'ателье Лига джентльменов Алтайский край'
      - assert: должен быть виден колдунщик организации
      - do: кликнуть по табу 'Новости'
      - assert: |
          открылся оверлей с карточкой организации,
          появился таб 'Новости'
    Основные проверки:
      - label: 1org-posts-{{SET_NAME}}
      - screenshot: внешний вид [plain]
      - do: кликнуть на ссылку 'Читать еще' в первом посте
      - assert: показался полный текст поста
      - tech: сработал счетчик path='/$subresult/overlay-wrapper/content/tabs/controls/tabs/posts/posts/more'
      - do: кликнуть на ссылку 'Читать еще' во втором посте
      - assert: показался полный текст поста
      - do: кликнуть на ссылку в посте
      - assert: в новой вкладке открылась ссылка из поста
      - tech: сработал счетчик path='/$subresult/overlay-wrapper/content/tabs/controls/tabs/posts/posts/link
      - do: кликнуть по кнопке 'Ещё новости'
      - tech: сработал счетчик path='/$subresult/overlay-wrapper/content/tabs/controls/tabs/posts/posts/more-button'
      - assert: в список дозагрузились ещё новости
    Просмотрщик:
      - label: 1org-posts-viwer-{{SET_NAME}}
      - do: кликнуть по первой фотографии в первом посте
      - assert: появился просмотрщик
      - screenshot: внешний вид просмотрщика [plain]
      - tech: сработал счетчик path='/$subresult/overlay-wrapper/content/tabs/controls/tabs/posts/posts/thumb'
      - do: кликнуть по кнопке вперед в просмотрщике
      - tech: сработал счетчик path='/$subresult/overlay-wrapper/content/tabs/controls/tabs/posts/posts/viewer/preview/arrow-right'
      - assert: появилась следующая фотография
      - do: кликнуть по кнопке назад в просмотрщике
      - tech: сработал счетчик path='/$subresult/overlay-wrapper/content/tabs/controls/tabs/posts/posts/viewer/preview/arrow-left'
      - assert: появилась предыдущая фотография
      - do: кликнуть по третьей фотографии в галерее просмотрщика
      - tech: сработал счетчик path='/$subresult/overlay-wrapper/content/tabs/controls/tabs/posts/posts/viewer/gallery/item'
      - assert: появилась третья фотография
      - do: кликнуть по кнопке закрыть
      - tech: сработал счетчик path='/$subresult/overlay-wrapper/content/tabs/controls/tabs/posts/posts/viewer/close'
      - assert: скрылся просмотрщик
      - assertMetrics:
        - feature.web.wizards_common.wizard_companies_right.total.shows
        - feature.web.wizards_common.wizard_companies_right.total.external_clicks
        - feature.web.wizards_common.wizard_companies_right.total.dynamic_clicks
        - web.total_request_count
    Лайки:
      - assert: у первого поста есть лайки
      - screenshot: внешний вид первого поста с лайками [1org-posts-{{SET_NAME}} >> plain]
      - do: кликнуть по пальцу вверх (лайк)
      - assert: счетчик лайков увеличился на единицу
      - screenshot: внешний вид после клика на палец вверх [reactions-liked]
      - do: кликнуть по пальцу вниз (дизлайк)
      - assert: счетчик дизлайков увеличился на единицу
      - tech: сработал счетчик /$subresult/overlay-wrapper/content/tabs/controls/tabs/posts/posts/reactions/like
      - tech: сработал счетчик /$subresult/overlay-wrapper/content/tabs/controls/tabs/posts/posts/reactions/dislike
      - do: кликнуть ещё раз по пальцу вниз (дизлайк)
      - assert: счетчик дизлайков уменьшился на единицу
      - assert: оценка пользотвателя сбросилась
      - do: проскролить содержимое оверлея до кнопки 'Ещё новости'
      - do: кликнуть по кнопке 'Ещё новости'
      - assert: список новостей дозагрузилился
      - assert: у первого дозагруженного поста есть лайки
      - assertMetrics:
        - feature.web.wizards_common.wizard_companies_right.total.shows
        - feature.web.wizards_common.wizard_companies_right.total.external_clicks
        - feature.web.wizards_common.wizard_companies_right.total.dynamic_clicks
        - web.total_request_count
    Комментарии:
      - browser:
        notFor:
          - searchapp-phone-group
      - assert: у первого поста есть иконка комментариев
      - do: кликнуть по иконке комментариев первого поста
      - screenshot: внешний вид после клика на иконку комментариев [comments-opened]
      - assert: открылись комментарии под постом
      - do: кликнуть ещё раз по иконке комментариев первого поста
      - assert: скрылись комментарии под постом
      - assertMetrics:
        - feature.web.wizards_common.wizard_companies_right.total.shows
        - feature.web.wizards_common.wizard_companies_right.total.external_clicks
        - feature.web.wizards_common.wizard_companies_right.total.dynamic_clicks
        - web.total_request_count

v-team: VanillaGeo

tlds: all

files:
    - src/features/Companies/Companies.features/Posts/Posts.test/Posts@touch-phone.hermione.js

tags:
  - skip_e2e_check
  - react
