feature: Кандидат
type: Конфликт интересов

description: |
    после отправки на проверку КИ на почту в рассылку mtest падает письмо от компании Яндекс
    после заполнения формы кандидатом на почту в рассылку mtest падает письмо всем рекрутерам, что форма заполнена
    после заполнения формы кандидатом в очереди TESS создается тикет, в описании тикета есть все поля из формы с указанными значениями кандидата

specs:
  Проверка конфликта интересов:
    - do: открыть страницу кандидата, который добавлен на вакансии и не отправлялся на КИ /candidates/<id_кандидата>/
    - screenshot: в шапке присутствует кнопка '...' [candidate_actions]
    - do: нажать на '...' в шапке кандидата
    - screenshot: открылась выпадушка [candidate_actions_with_action_create_verification]
    - do: в выпадушке нажать 'Отправить на проверку конфликта интересов'
    - assert: |
        открылся поп-ап 'Отправить на проверку конфликта интересов'
        поле 'От кого' задисейблено и предзаполнено почтой того, кто отправляет на проверку
        поле 'Кому' предзаполнено основной почтой кандидата, если такая есть
        поле 'Тема' предзаполнено 'От компании Яндекс'
        в поле 'Сообщение' есть ссылка, в которой есть пар-ры id_recruit и uuid
    - screenshot: пример внешнего вида [candidate_action_verification_form]
    - do: в поле 'Вакансия' выбрать ту вакансию, на которую хотите проверить кандидата
    - do: нажать 'Отправить'
    - assert: попап закрылся
    - do: нажать на '...' в шапке кандидата
    - screenshot: в выпадушке нет экшена 'Отправить на проверку конфликта интересов' [candidate_workflow_actions]
    - screenshot: появилось сообщение об отправке анкеты [candidate_conflict_of_interests_info]

tags:
  - reviewed

priority: critical

files:
    - tests/hermione/suites/desktop/candidates/send_for_verification/send_for_verification.hermione.js

browsers:
  - yandex-browser-desktop
  - firefox-desktop
  - safari-desktop
