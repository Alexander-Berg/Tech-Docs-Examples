feature: ЖД
type: Страница заказа
description: >-
  Был баг - если в заказе была страховка и платеж создавался после переброни,
  страховка выкупалась два раза.
specs:
  'ЖД: Создание оплаты после перебронирования':
    - do: |-
        Перейти на вкладку ЖД
        Перейти на поиск (например, Москва - Пермь, Москва - Санкт-Петербург)
        Для любого поезда кликнуть по кнопке Выбрать место
        На странице выбора мест выбрать несколько пассажиров и места в вагонах
        Нажать Указать пассажиров
        Заполнить все поля валидными данными
        Нажать Проверить заказ и купить
    - assert: |-
        * Произошел переход на страницу подтверждения
        * Время на оплату 30 минут
    - do: >-
        Добавить страховку

        Нажать перейти к оплате

        Дождаться, когда на оплату останется меньше 15 минут

        Провалить оплату - ввести неверный cvc 228 (данные карты:
        5100003697253468, 090, 12/20)
    - assert: '* Произошла ошибка'
    - do: Нажать "К оплате"
    - assert: '* Снова открылась форма оплаты'
    - do: |-
        Ввести верные данные карты
        Нажать Оплатить
        Нажать Подробнее о заказе
    - assert: |-
        * Произошел переход на страницу заказа
        * В заказе есть страховка
        * Страховка оплачена 1 раз (проверить в чеках или письме)
manual: true
Функциональность: Покупка
Устройство: Десктоп
Страница: Страница заказа
Сервис: ЖД
Тестирование асессорами: Нет
Окружение: Testing
Автор: shenfeld
