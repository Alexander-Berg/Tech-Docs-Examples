feature: Объектный ответ
type: Афиша
counter: /$page/$main/$result/object-badge/afisha/title

description: Случай, когда афиша есть на серпе и нет в сайдблоке считаем валидным - всегда есть шанс неответов сервисов.

specs:
  aliases:
    - &CheckMetrics
      - assertMetrics:
        - daily.total_session_count
        - web.total_request_count
        - web.total_click_count
        - web.total_all_click
        - web.abandonment
        - web.tech_part_misc_click
        - all.total_dynamic_click_count
        - feature.web.wizards_common.entity_search_wizard_main.total.clicks

  В карточке:
    - tags:
        - smoke_extended
    - label: afisha__card-{{SET_NAME}}
    - do: выбрать на afisha.yandex.ru любой фильм из раздела 'премьеры недели'
    - do: получить выдачу Поиска по запросу с названием выбранного фильма
    - screenshot: пример внешнего вида [plain]
    - assert: в карточке ОО есть афиша
    - do: нажать на ссылку в названии первого кинотеатра
    - tech: проверить счётчик в названии кинотеатра
    - assert: ссылка ведёт на расписание сеансов в выбранном кинотеатре на afisha.yandex.ru
    - do: кликнуть на ссылку 'Все кинотеатры'
    - assert: открывается оверлей с карточкой объекта
    - assert: в оверлее выбран таб Афиша с расписанием сеансов
    - tech: проверить счётчик открытия оверлея
    - do: кликнуть 'Назад' в оверлее
    - assert: оверлей закрылся
    - do: нажать на активный (жёлтый) сеанс
    - tech: проверить счётчик на активном (жёлтом) сеансе расписания
    - assert: ссылка ведёт на страницу покупки билета widget.afisha.yandex.ru
    - *CheckMetrics

  Горизонтальный скролл сеансов в карточке:
    - params:
        foreverdata: '3183632528'
    - tags:
        - smoke_extended
    - do: получить выдачу по запросу 'foreverdata'
    - do: проскроллить сеансы влево
    - assert: сеансы скроллятся
    - do: проскроллить сеансы до конца
    - screenshot: пример внешнего вида проскролленых влево сеансов [plain]
    - do: проскроллить сеансы вправо
    - assert: сеансы скроллятся
    - *CheckMetrics

  Смена ориентации экрана:
    - do: |
        выбрать на afisha.yandex.ru любой фильм из раздела 'премьеры недели'
        получить выдачу Поиска по запросу с названием выбранного фильма
    - assert: в карточке ОО есть афиша
    - do: повернуть девайс в ландшафтную ориентацию
    - screenshot: пример внешнего вида афиши в ландшафтной ориентации [landscape]
    - *CheckMetrics
  В тёмной теме:
    - do: выбрать на afisha.yandex.ru любой фильм из раздела 'премьеры недели'
    - do: В тёмной теме получить выдачу Поиска по запросу с названием выбранного фильма
    - assert: в карточке ОО есть афиша
    - screenshot: пример внешнего вида [plain]

files:
  - features/touch-phone/z-entity-search/afisha/afisha.hermione.js

v-team: OO

tags:
  - hasE2E
  - skip_e2e_check
  - no_assessors
  - oo_afisha

tlds: ru
