feature: Фильтры

specs:
  beforeEach:
    - do: открыть страницу /jobs/vacancies
    - assert: на странице присутствуют кнопка фильтров по вакансиям
    - do: нажать на кнопку фильтров
    - assert: |
        открылся список фильтров по вакансиям
        под шапкой фильтров отображается счетчик вакансий
  Проверка фильтра Локации [manual]:
    - automation: VACANCIES-780
    - assert: |
        присутствует фильтр 'Локации'
        присутствует иконка поиска рядом с названием 'Локации'
        присутствует список городов
        рядом с каждым городом присутствует кол-во вакансий по нему
        рядом с каждым городом присутствует чекбокс
        под списком отображается кнопка 'Показать все'
    - do: нажать на 'Показать все' в фильтре Локации
    - assert: |
        развернулся весь список городов
        появилась кнопка 'Свернуть'
        если у города 0 вакансий, то его чекбокс недоступен
    - do: пролистнуть список вниз
    - assert: отображаются новые локации
    - do: нажать на доступный чекбокс рядом с новым городом
    - assert: |
        чек-бокс стал активен
        url содержит /?cities=<выбранный город>
        значение счетчика вакансий под шапкой изменилось
    - do: нажать на галочку в шапке фильтров
    - assert: |
        значение счетчика вакансий совпадает со значением в блоке фильтров
        под поисковой строкой появился выбранный город с крестиком
        под выбранным городом появилась кнопка 'Сбросить'
        вакансии в списке соответстуют фильтру
        у кнопки фильтров появился каунтер с цифрой 1
        первый город в карточках вакансий - город из выбранного ранее в фильтре
    - do: нажать на кнопку фильтров
    - do: нажать на кнопку поиска рядом с названием 'Локации'
    - assert: |
        название 'Локации' скрылось
        отобразилась поисковая строка 'Введите название локации'
    - do: введите набор символов, не соответствующий городу
    - screenshot: отобразилось сообщение [https://jing.yandex-team.ru/files/alex-murashev/no_locations_touch.png]
  Проверка несколько значений в фильтре Локации [manual]:
    - automation: VACANCIES-780
    - do: выбрать 10 или более городов в фильтре 'Локации'
    - assert: url содержит /?cities=<первый выбранный город>&cities=<второй выбранный город>...
    - do: нажать на галочку в шапке фильтров
    - assert: |
        под поисковой строкой появилось несколько городов с крестиком
        присутствует пролистываемый список из городов
        под списком городов под поисковой строкой присутствует кнопка 'Сбросить'
        у кнопки фильтров появился каунтер с числом выбранных фильтров
        вакансии в списке соответстуют фильтрам
    - do: проскроллить блоки городов
    - assert: появляются новые блоки с крестиком
    - do: нажать на крестики у каждого блока города
    - assert: |
        url не содержит фильтров
        у кнопки фильтров отсутствует каунтер
        отображается изначальный список вакансий
        под поисковой строкой пропали выбранные ранее города
        под поисковой строкой пропала кнопка 'Сбросить'
    - do: нажать на кнопку фильтров
    - assert: |
        значение счетчика вакансий под шапкой изменилось
        ранее выбранные чекбоксы перестали быть активными
  Проверка фильтра Направления [manual]:
    - automation: VACANCIES-780
    - do: пролистать фильтры до фильтра 'Направления'
    - assert: |
        присутствует фильтр 'Направления'
        присутствует иконка поиска рядом с названием 'Направления'
        присутствуют разворачиваемые списки профессиональных сфер
    - do: нажать на чекбокс рядом с профессиональной сферой
    - assert: |
        url содержит /?professions=<профессия из выбранной сферы>&professions=<профессия из выбранной сферы>...
        кол-во вакансий в других фильтрах изменилось
        значение счетчика вакансий под шапкой изменилось
    - do: нажать на галочку в шапке фильтров
    - assert: |
        у кнопки фильтров появился каунтер с числом профессий в выбранной ранее профессиональной сфере
        под поисковой строкой появились профессии с крестиками из выбранной в фильтре сферы
        под списком профессий появилась кнопка 'Сбросить'
        вакансии в списке соответстуют фильтру
    - do: нажать кнопку фильтров
    - do: нажать на выбранный ранее чекбокс профессиональной сферы
    - assert: значение счетчика вакансий под шапкой изменилось
    - do: нажать на галочку в шапке фильтров
    - assert: |
        у кнопки фильтров отсутствует каунтер
        под поисковой строкой пропали все профессии
        под поисковой строкой пропала кнопка 'Сбросить'
        отображается изначальный список вакансий
        url не содержит фильтров
    - do: нажать кнопку фильтров
    - do: нажать на стрелочку в профессиональной сфере
    - assert: |
        развернулся список профессий для этой сферы
        рядом с каждой профессией есть кол-во вакансий по ней
        рядом с каждой профессией есть чекбокс
        если у всех профессий сферы 0 вакансий, то чекбокс профессиональной сферы недоступен
    - do: нажать на чекбокс рядом с названием профессии
    - assert: |
        чекбокс стал активен
        чекбокс профессиональной сферы так же стал активен
        значение счетчика вакансий под шапкой изменилось
    - do: нажать на галочку в шапке фильтров
    - assert: |
        под поисковой строкой появилась выбранная профессия
        под блоком профессии появилась кнопка 'Сбросить'
        на странице отображаются вакансии для выбранной профессии
    - do: нажать кнопку фильтров
    - do: нажать на чекбокс у активной профессиональной сферы
    - assert: |
        чекбокс у профессии не активен
        чекбокс у проф. сферы не активен
    - do: нажать на стрелку рядом с проф. сферой
    - assert: список профессий свернулся
    - do: нажать на кнопку поиска рядом с названием 'Направления'
    - assert: отобразилась поисковая строка 'Введите название направления'
    - do: введите набор символов, не соответствующий направлению
    - screenshot: отобразилось сообщение [https://jing.yandex-team.ru/files/alex-murashev/no_professions_touch.png]
  Проверка фильтра Сервисы [manual]:
    - automation: VACANCIES-780
    - do: пролистать фильтры до фильтра 'Сервисы'
    - assert: |
        присутствует фильтр 'Сервисы'
        присутствует иконка поиска рядом с названием 'Сервисы'
        присутствует список сервисов
        рядом с каждым сервисом присутствует кол-во вакансий по нему
        рядом с каждым сервисом присутствует чекбокс
        под списком отображается кнопка 'Показать все'
    - do: нажать на кнопку 'Показать все'
    - assert: |
        количество отображаемых сервисов в фильтре изменилось
        отобразилась кнопка для сворачивания списка - 'Свернуть'
    - do: нажать на кнопку 'Свернуть'
    - assert: |
        отображается первоначальный список сервисов
        отображается текст 'Показать все'
    - do: нажать чекбокс рядом с названием сервиса
    - assert: |
        url содержит /?services=<выбранный сервис>
        значение счетчика вакансий под шапкой изменилось
        в других фильтрах изменилось кол-во найденных вакансий по ним
    - do: нажать на галочку в шапке фильтров
    - assert: |
        вакансии в списке соответстуют фильтру
        под поисковой строкой появился выбранный сервис с крестиком
        под блоком сервиса появилась кнопка 'Сбросить'
    - do: нажать кнопку фильтров
    - do: нажать на кнопку поиска рядом с названием 'Сервисы'
    - assert: отобразилась поисковая строка 'Введите название локации'
    - do: введите набор символов, не соответствующий сервису
    - screenshot: отобразилось сообщение [https://jing.yandex-team.ru/files/alex-murashev/no_services_touch.png]
  Проверка фильтра Технологии/Навыки [manual]:
    - automation: VACANCIES-780
    - do: пролистать фильтры до фильтра 'Технологии/Навыки'
    - assert: |
        присутствует фильтр 'Технологии/Навыки'
        присутствует иконка поиска рядом с названием 'Технологии/Навыки'
        присутствует список навыков/технологий
        рядом с каждым навыком/технологией присутствует кол-во вакансий по нему
        под списком отображается кнопка 'Показать все'
    - do: нажать на иконку поиска рядом с 'Технологии/Навыки'
    - assert: отобразилась поисковая строка 'Введите название технологии'
    - do: введите набор символов, не соответствующий технологии
    - screenshot: отобразилось сообщение [https://jing.yandex-team.ru/files/alex-murashev/no_technologies_touch.png]
    - do: очистить поле поиска
    - do: ввести имеющуюся технологию в поле поиска
    - assert: отобразился навык/технология, соответствующий поисковому запросу
    - do: нажать на чекбокс рядом с найденным навыком/технологией
    - assert: |
        ссылка содержит ?skills=<id выбранной технологии>
        значение счетчика вакансий под шапкой изменилось
    - do: нажать на галочку в шапке фильтров
    - assert: |
        под поисковой строкой появился выбранный технология/навык с крестиком
        под блоком технологии/навыка появилась кнопка 'Сбросить'
        вакансии соответствуют установленному фильтру
    - do: нажать на кнопку фильтров
    - assert: поисковая строка навыков/технологий отображается
  Проверка фильтра Уровень [manual]:
    - automation: VACANCIES-780
    - do: пролистать фильтры до фильтра 'Уровень'
    - assert: |
        присутствует фильтр 'Уровень'
        присутствует список уровней
        рядом с каждым уровнем присутствует кол-во вакансий по нему
    - do: нажать на фильтры 'Стажер', 'Младший', 'Специалист'
    - assert: ссылка содержит ?pro_levels=1&pro_levels=2&pro_levels=3
    - do: нажать на галочку в шапке фильтров
    - assert: |
        у кнопки фильтров присутствует каунтер с цифрой 3
        вакансии соответствуют установленным фильтрам
        под поисковой строкой появились выбранные уровни
        под поисковой строкой появилась кнопка 'Сбросить'
    - do: нажать на 'Сбросить'
    - assert: |
        у кнопки фильтров отсутствует каунтер
        под поисковой строкой пропали все фильтры
        под поисковой строкой пропала кнопка 'Сбросить'
    - do: нажать на кнопку фильтров
    - assert: чекбоксы в фильтре 'Уровень' не активны
  Предзаполнение фильтров по ссылке [manual]:
    - automation: VACANCIES-780
    - do: открыть страницу /jobs/vacancies?cities=moscow&professions=backend-developer&services=yandex&skills=62&pro_levels=4
    - assert: |
        у кнопки фильтров присутствует каунтер установленных фильтров
        под поисковой строкой расположены блоки фильтров
        под блоками фильтров расположена кнопка 'Сбросить'
    - do: нажать на кнопку фильтров
    - assert: |
        в фильтре 'Локации' активен чекбокс у города 'Москва'
        в фильтре 'Направления' активен чекбокс у направления 'Разработка'
        в фильтре 'Сервисы' активен чекбокс у сервиса 'Общие сервисы Яндекса'
        в фильтре 'Технологии/Наввыки' активен чекбокс у 'С++'
        в фильтре 'Уровень' активен чекбокс у 'Старший'
    - do: нажать на галочку в шапке фильтров
    - do: нажать на кнопку 'Сбросить' под поисковой строкой
    - do: нажать на кнопку фильтров
    - assert: чекбоксы не активны в фильтрах
  Проверка отсутствий фильтров на страницах [manual]:
    - automation: VACANCIES-780
    - do: открыть страницу /jobs/locations/<город>
    - do: нажать на кнопку 'Фильтры'
    - assert: среди фильтров отсутствует пункт - 'Локации'
    - do: открыть страницу /jobs/services/<сервис>
    - do: нажать на кнопку 'Фильтры'
    - assert: среди фильтров отсутствует пункт - 'Сервисы'
    - do: открыть страницу /jobs/professions/<профессия>
    - do: нажать на кнопку 'Фильтры'
    - assert: среди фильтров отсутствует пункт - 'Направления'

platform:
  - touch

tlds:
  - ru
  - by
  - ua

priority: normal

browsers:
  - android-yandex-browser-touch
  - android-browser-touch
  - ios-safari-touch
