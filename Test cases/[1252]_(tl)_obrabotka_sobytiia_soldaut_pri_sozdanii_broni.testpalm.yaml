feature: Отели
type: Бронирование
description: >-
  Для генерации события soldout (все номера раскуплены) на этапе создания заказа
  нужно дернуть ручку тестового контекста

  https://api.travel-balancer-test.yandex.net/api/test_context/v1/tokens?originalId=742&partnerId=PI_TRAVELLINE&occupancy=2&forceAvailability=true&cancellation=CR_FULLY_REFUNDABLE&pansionType=PT_BB&offerName=test&priceAmount=11000&partiallyRefundRate=50&getOfferOutcome=OO_SUCCESS&createOrderOutcome=OO_SOLD_OUT&hotelDataLookupOutcome=HO_REAL&reservationOutcome=RO_SUCCESS&confirmationOutcome=CO_SUCCESS&refundOutcome=RF_SUCCESS&priceMismatchRate=1


  При ответе с кодом 200 в booking_page_url будет содержаться урл страницы
  брони.
specs:
  (ТЛ) Обработка события солдаут при создании брони:
    - do: >-
        Перейти на страницу брони по сгенерированному урлу с заездом-выездом на
        завтра-послезавтра
    - assert: 'assert: Открылась страница бронирования'
    - do: Заполнить данные гостей и контактные данные валидными значениями
    - do: Кликнуть по Оплатить
    - assert: >-
        assert: Появился лоадер с текстом "Создание заказа Создаем заказ и
        готовимся к оплате"

        | Элементы на странице задизейблены:

        ![image](https://jing.yandex-team.ru/files/shenfeld/Yandeks.Puteshestviya__aviabilety_bilety_na_poezd_bronirovanie_otelei_2019-03-27_13-02-02.png)

        | Через какое-то время произошел переход на страницу с сообщением Все
        номера такого типа уже забронированы

        | Ниже отображается информация об отеле:

        | Название - Вега Измайлово

        | Адрес и рейтинг

        | Даты заезда и выезда - завтра и послезавтра

        | Кол-во гостей - 2

        | Название оффера - test

        | Информация про питание - Завтрак включен

        | Информация про кровати

        | Справа от названия отеля есть фото отеля

        | Под фото название отеля от партнера и ссылка Описание отеля от
        партнера

        | В самом низу блока об отеле расположены две кнопки:

        | Начать новый поиск и Найти номера в отеле
    - do: Кликнуть по ссылке Описание отеля от партнера
    - assert: |-
        assert: Открылся модал
        | Модал содержит название отеля, фото, карту и описание от партнера
        | Вверху модала есть крестик для закрытия
    - do: Кликнуть по крестику над модалом
    - assert: 'assert: Модал закрылся'
    - do: Кликнуть по кнопке Начать новый поиск
    - assert: >-
        assert: Произошел переход на выдачу отелей из гео-региона бронируемого
        отеля
    - do: Вернуться на предыдущую страницу
    - assert: >-
        assert: Произошел переход на страницу бронирования (особенность
        Тестового Контекста)
    - do: Кликнуть по Оплатить
    - assert: >-
        assert: Произошел переход на страницу с сообщением Все номера такого
        типа уже забронированы
    - do: Кликнуть по Найти номера в отеле
    - assert: >-
        assert: Открылась страница отеля Вега Измайлово с теми же параметрами
        дат и гостей
manual: true
Функциональность: Бронирование
Устройство:
  - Десктоп
  - Тач
Страница: Бронирование
Сервис: Отели
Тестирование асессорами: Нет
Окружение: Testing
Tag:
  - TK
  - orkestrator
  - Blocker
Автор: iliasova
