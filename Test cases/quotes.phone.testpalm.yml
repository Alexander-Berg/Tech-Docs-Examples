feature: Котировки. Страница котировок

description: Главная страница котировок позволяет осуществлять выбор и переход на интересующие котировки

specs-integration:
#  не выдает клиентских ошибок при переходе на by уникальные котировки (без флага на прибив аннотации) [manual]:
#      - tags:
#          - by_suite
#      - do: перейти на страницу https://yandex.by/tune/geo и выставить город "Минск"
#      - do: перейти на тестовый стенд
#      - do: перейти по ссылке https://yandex.by/news/quotes/157/40092.html
#      - assert: в консоли нет ошибок
#      - do: подскроллить к рекламе ниже
#      - assert: произошла подгрузка сюжетов, в консоли ошибок нет

#  не выдает клиентских ошибок при переходе на by уникальные котировки (с флагом на прибив аннотации) [manual]:
#      - tags:
#          - by_suite
#      - do: перейти на страницу https://yandex.by/tune/geo и выставить город "Минск"
#      - do: перейти на тестовый стенд
#      - do: перейти по ссылке https://yandex.by/news/quotes/157/40092.html?flags=yxnews_media_show_for_annot=1
#      - assert: в консоли нет ошибок
#      - do: подскроллить к рекламе ниже
#      - assert: произошла подгрузка сюжетов, в консоли ошибок нет

  содержит ленту новостей с рекламой под виджетом котировок:
    - tags:
      - advertisement
      - smoke
    - do: проскроллить страницу ниже графика и таблицы котировок
    - assert: отображается рекламный блок
    - do: проскроллить ниже
    - assert: |
          под рекламным блоком отображается лента новостей,
          в ленте есть рекламные блоки
    - do: тапнуть на любую новостную карточку
    - assert: происходит переход в соответствующий сюжет в той же вкладке

#  с возможностью купить акции открывается (без флага прибивания картинок):
#      - do: перейти по ссылке https://yandex.ru/news/quotes/29
#      - assert: открылся график котировок, в консоли нет ошибок, над графиком есть кнопка "Купить акции"
#      - do: проскроллить до рекламы
#      - assert: ниже подгрузилась порция карточек сюжетов

  с двумя графиками открывается (без флага прибивания картинок):
      - do: перейти по ссылке https://yandex.ru/news/quotes/4011
      - assert: страница открылась без ошибок в консоли, отображаются оба графика
      - do: подскроллить к рекламе под графиками
      - assert: подгрузилась порция карточек новостей

#  с возможностью купить акции открывается (С флагом прибивания картинок):
#      - do: перейти по ссылке https://yandex.ru/news/quotes/29?flags=yxnews_media_show_for_annot=1
#      - assert: открылся график котировок, в консоли нет ошибок, над графиком есть кнопка "Купить акции"
#      - do: проскроллить до рекламы
#      - assert: ниже подгрузилась порция карточек сюжетов

  с двумя графиками открывается (С флагом прибивания картинок):
      - do: перейти по ссылке https://yandex.ru/news/quotes/4011?flags=yxnews_media_show_for_annot=1
      - assert: страница открылась без ошибок в консоли, отображаются оба графика
      - do: подскроллить к рекламе под графиками
      - assert: подгрузилась порция карточек новостей

specs:
  beforeEach:
    - do: перейти на бета-стенд, а затем открыть страницу котировок по прямой ссылке https://yandex.ru/news/quotes
    - assert: отобразился раздел Сырье

  имеет внешний вид:
    - tags:
      - smoke
    - assert: |
        ниже отобразились виды сырья (Нефть Brent, Нефть WTI, Золото и т.д.)
        слева от названия раздела отобразилась кнопка 'Меню' (три полоски),
        отображается подрубрикатор с вкладками, по умолчанию активна первая, подчеркнута красным,
        отображается тип графика, значение стоимости на конкретную дату (по умолчанию на текущий день), дата, день недели,
        отображается график стоимости,
        нижняя ось графика отображает временные промежутки (по датам),
        правая ось графика отображает шкалу стоимости валюты/ресурса/акции,
        под графиком отобразились ссылки 'неделя', 'месяц' (отображается по умолчанию), 'квартал', 'год' и 'всё время'
    - assert: внешний вид https://jing.yandex-team.ru/files/vasekerka/2021-12-29_19-09-23.png
    - do: поскроллить ниже графика
    - assert: |
        под графиком отобразились данные за последние 10 дней (Дата, Курс и Изменения со значками повышения или понижения),
        в блоке "За последние 10 дней" сегодняшняя дата выделена жирным,
        содержится ссылка на источник ниже блока "За последние 10 дней",
        внешний вид https://jing.yandex-team.ru/files/vasekerka/2021-12-29_19-10-24.png

  позволяет открывать и закрывать меню:
    - tags:
      - smoke
    - do: тапнуть по кнопке 'Меню' (три полоски) или в произвольном месте полосы с названием раздела
    - assert: |
        изменился вид иконки меню (из 'трех полосок' превратился в 'крестик')
        появились наименования разделов в меню (Курсы валют НБ Украины, Сырье, Акции, и т.д.),
        график и вкладки раздела съехали вниз,
        в меню жирным шрифтом выделен выбранный раздел,
    - assert: внешний вид https://jing.yandex-team.ru/files/vasekerka/2021-12-29_19-11-04.png
    - do: тапнуть по кнопке крестика или в произвольном месте полосы с названием раздела
    - assert: меню закрылось

  позволяет перейти на выбранный раздел меню:
    - tags:
      - smoke
    - do: тапнуть по кнопке 'Меню' (три полоски) или в произвольном месте полосы с назваением раздела
    - do: тапнуть по разделу 'Кросс-курсы'
    - assert: произошёл переход на страницу соответствующего раздела, отобразились график и таблица котировок

  имеет кнопку:
    - tags:
      - smoke
    - assert: отображается кнопка

  имеет функцию скролла вкладок под заголовком и перехода по ним:
    - tags:
      - smoke
    - do: проскроллить вкладки под заголовком влево
    - assert: вкладки скроллятся влево
    - do: проскроллить вкладки под заголовком вправо
    - assert: вкладки скроллятся вправо
    - do: тапнуть по одной из вкладок
    - assert: |
        выбранная вкладка отобразилась как активная (название вкладки подчеркнуто красным),
        отобразился график для выбранной вкладки

  может отображать графики с двумя линиями:
    - tags:
      - smoke
    - do: тапнуть на меню, открыть вкладку Наличные курсы Украины
    - assert: отобразился график с двумя линиями - Покупка и Продажа (под каждым пунктом отображается стоимость)
    - do: тапнуть на каждое наименование - "Покупка" и "Продажа"
    - assert: |
        соответствующие графики пропали в порядке нажатия на заголовок,
        заголовок и стоимость, на который нажали, отображаются серым цветом

  содержит заголовок "Данные по 30 июня 2016" для валют Республики Беларусь:
    - do: тапнуть на меню, открыть вкладку Курсы валют НБ Республики Беларусь
    - assert: |
        отобразился график для BYN. Подписи BYN нет. График отображает данные по текущую дату,
        под графиком отобразились данные и заголовок за последние 10 дней,
        ниже отобразился график для BYR. Подписи BYR нет. График отображает данные по '30.06.2016, четверг',
        под графиком отобразились данные и заголовок 'Данные по 30 июня 2016'

  может отображать два графика:
    - tags:
      - smoke
    - do: тапнуть на меню, открыть вкладку с двумя графиками (например, Цены на бензин)
    - do: открыть произвольную вкладку с выбранным бензином
    - assert: |
        отобразился график для цен Москвы (в заголовке не указано, что график для Москвы),
        под графиком отобразились данные за последние 10 дней,
        ниже отобразился график для цен России (тоже в заголовке не указано, что график для России),
        под графиком отобразились данные за последние 10 дней

  позволяет отображать графики по различным временным промежуткам:
    - tags:
      - smoke
    - do: тапнуть на одну из ссылок с временным (неделя, месяц и т.д.) промежутком под графиком
    - assert: |
        график перестроился, масштаб осей изменился в соответствии с выбранным интервалом,
        на графике отобразился требуемый промежуток времени,
        кнопка с выбранным промежутком времени под графиком выделена жирным шрифтом

  отображает значение при тапе по линии на графике [manual]:
    - tags:
      - smoke
      - smoke_zen
    - reasonNotToAuto:
      - Решили оставить кейс ручным и не тратить силы на автоматизацию, т.к. в скором времени страницу котировок закопают     
    - do: тапнуть на произвольное место на графике
    - assert: |
        отобразилась цена на указанный момент времени,
        отобразились дата и день недели,
        цена совпала с данными в таблице за последние 10 дней

  отображает оба графика на домене by в спец котировках для Минска [manual]:
    - tags:
      - by_suite
      - smoke_zen
    - reasonNotToAuto:
      - Пока нет возможности автоматизировать, т.к. тестовый юзер по умолчанию логинится на ru, детали NERPADUTY-2105
    - tlds:
      - by
    - do: перейти на страницу https://yandex.by/tune/geo и выставить город "Минск"
    - do: после перехода на тестовый стенд перейти на https://news.yandex.by/quotes/157/40092.html в той же вкладке
    - assert: отобразились оба графика

  корректно отображает график для любого часового пояса [manual]:
    - tags:
      - backend_news
    - reasonNotToAuto:
      - Нет возможности сменить часовой пояс в автотесте
    - do: изменить часовой пояс на вашем устройстве на пояс GMT +10-00 (Хабаровск, Магадан и т.д)
    - do: перейти на график в разделе "Сырье" или "Биржевые индексы"
    - assert: |
        график отображается корректно,
        значения в графике соответствуют значениям в таблице снизу
    - do: изменить часовой пояс на вашем устройстве на пояс GMT -8-00 (США - Лос-Анджелес)
    - do: перейти на график в разделе "Сырье" или "Биржевые индексы"
    - assert: |
        график отображается корректно,
        значения в графике соответствуют значениям в таблице снизу

  отображает персональную ленту под блоком котировок [manual]:
    - tags:
      - backend_news
      - smoke_zen
    - reasonNotToAuto:
      - Кейсы с персонизацией должны быть всегда на живых данных (т.к. нужны для бэка)
    - do:
        залогиниться на сервисе под пользователем Александр Овечкин (логин и пароль взять со страницы-инструкции на вики - https://wiki.yandex-team.ru/eva/testing/projects/nerpa/#loginyiparolidljatestovyxpolzovatelejj)
        если возникла проблема с авторизацией - залогиниться под любым другим пользователем из таблицы - Ольга Бузова или Стив Джобс
    - do: перейти на https://yandex.ru/quotes
    - do: проскроллить ниже блока котировок
    - assert:
        отобразилась лента новостей,
        если вы залогинены под пользователем Александр Овечкин - в ленте большинство сюжетов - спортивные сюжеты
        если вы залогинены под пользователем Ольга Бузова - в ленте большинство сюжетов про шоу-бизнес
        если вы залогинены под пользователем Стив Джобс - в ленте большинство сюжетов про технологии
    - do: ОБЯЗАТЕЛЬНО выйти из тестового аккаунта

# отключили кнопку тут NERPADUTY-2621
#  отображает кнопку покупки акций:
#    - tags:
#      - backend_news
#    - do: перейти на https://yandex.ru/quotes
#    - do: выбрать "ГАЗПРОМ ао" в разделе "Акции" или перейти по ссылке https://yandex.ru/news/quotes/29
#    - assert:
#        отобразился график динамики курса акций ПАО Газпром,
#        справа от текущей цены (или снизу на узких экранах) акций отображается кнопка "Купить акции"
#    - do: нажать на кнопку "Купить акции"
#    - assert:
#        в новой вкладке открывается страница сервиса "Яндекс.Инвестиции" с покупкой акций (данная странца не наша, на нее заводить баги не нужно)
#    - assert: в урле прокинуты параметры "utm_source=news&utm_medium=buybutton&utm_content=stock"
#
#  отображает кнопку покупки сырья:
#    - tags:
#      - backend_news
#    - do: перейти на https://yandex.ru/quotes
#    - do: выбрать "Золото" или перейти по ссылке https://yandex.ru/news/quotes/10
#    - assert:
#        отобразился график динамики цен на золото,
#        справа от текущей цены (или снизу на узких экранах) сырья отображается кнопка 'Купить фонд "Золото"'
#    - do: нажать на кнопку 'Купить фонд "Золото"'
#    - assert:
#        в новой вкладке открывается страница сервиса "Яндекс.Инвестиции" с покупкой фонда (данная странца не наша, на нее заводить баги не нужно)
#    - assert: в урле прокинуты параметры "utm_source=news&utm_medium=buybutton&utm_content=fxgd"
#
#  отображает кнопку покупки валюты:
#    - tags:
#      - backend_news
#    - do: перейти на https://yandex.ru/quotes
#    - do: тапнуть по кнопке 'Меню' (три полоски) и выбрать "Курсы валют ЦБ РФ"
#    - do: выбрать "USD ЦБ РФ" или перейти по ссылке https://yandex.ru/news/quotes/1
#    - assert:
#        отобразился график динамики цен на доллар,
#        справа от текущей цены (или снизу на узких экранах) валюты отображается кнопка "Купить доллары"
#    - do: нажать на кнопку "Купить доллары"
#    - assert:
#        в новой вкладке открывается страница сервиса "Яндекс.Инвестиции" с покупкой валюты (данная странца не наша, на нее заводить баги не нужно)
#    - assert: в урле прокинуты параметры "utm_source=news&utm_medium=buybutton&utm_content=usd"

files:
  - features/news/quotes/quotes.phone.hermione.js
  - features/news/quotes/quotes.phone.hermione.e2e.js

tags:
  - neo
  - quotes

manager: mrwhite

qa-engineer: nightsonne

tlds:
  - ru
  - by
  - kz
  - uz
  - ua
  - com
