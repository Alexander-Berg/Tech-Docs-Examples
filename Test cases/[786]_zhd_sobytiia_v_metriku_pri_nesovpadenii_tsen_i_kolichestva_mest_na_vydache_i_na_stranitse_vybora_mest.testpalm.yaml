feature: ЖД
type: Выбор мест
description: >-
  Отправляем события при несовпадении данных в поиске и на выборе мест (из-за
  кэша): searchPagePriceInconsistency (разница между минимальной ценой на выдаче
  и на странице выбора мест) и searchPagePlaceInconsistency (разница в
  количестве свободных мест на выдаче и странице выбора мест).


  В кейсе проверяем только searchPagePlaceInconsistency, так как разницу в ценах
  сложно воспроизводить.

  Перейти на главную сервиса

  Перейти на вкладку Ж/Д билеты
specs:
  'ЖД: События в метрику при несовпадении цен и количества мест на выдаче и на странице выбора мест':
    - do: >-
        Открыть выдачу Москва - Санкт-Петербург на завтра с прописанным к урлу
        параметром для тестирования метрики ?_ym_debug=1
    - do: >-
        Открыть новую вкладку с этой же выдачей и произвести бронирование
        билетов по инструкции из описания (дойти до подтверждения заказа)
    - do: Вернуться на первую вкладку
    - do: Открыть консоль
    - do: >-
        Кликнуть по кнопке покупки для поезда, в котором были выкуплены билеты
        (кнопка может называться по-разному, сейчас называется "Выбрать место")
    - assert: >-
        * Осуществился переход на страницу выбора мест

        * В консоли появился параметр визита searchPagePlaceInconsistency
        (разница в количестве свободных мест на выдаче и странице выбора мест,
        значение равно количеству забронированных до этого мест):

        ![image](https://jing.yandex-team.ru/files/shenfeld/2020-06-02_11.39.52-kfuqv.png)
manual: true
Функциональность: Разное по странице выбора мест
Устройство: Десктоп
Страница: Выбор мест
Сервис: ЖД
Тестирование асессорами: Да
Окружение:
  - Production
  - Testing
Автор: shenfeld
