feature: Отели
type: Бронирование отелей

specs:
    Неуспешное применение промокода:
        - condition: Быть залогиненым.
        - do: Перейти на страницу бронирования для любого отеля, на любые даты.
        - assert: Открылась страница бронирования.
        - assert: В корзинке есть галка "У меня есть промокод", по умолчанию выключена. Поле инпут для промокода и кнопка "Применить" не показывается.
        - do: Включить галку "У меня есть промокод"
        - assert: Появилось Поле инпут для промокода и кнопка "Применить"
        - assert: Кнопка по умолчанию неактивна
        - do: В инпут написать промокод "EXPIRED", нажать применить
        - assert: Появился тултип "Срок действия промокода истёк"
        - do: В инпут написать промокод "NOT_APPLICABLE", нажать применить
        - assert: Появился тултип "Промокод не подходит для этого заказа по условиям использования"
    Промокод отклонен на этапе бронирования:
        - condition: Быть залогиненым.
        - do: Перейти на страницу бронирования для любого отеля, на любые даты
        - assert: Открылась страница бронирования.
        - assert: В корзинке есть галка "У меня есть промокод", по умолчанию выключена. Поле инпут для промокода и кнопка "Применить" не показывается.
        - do: Включить галку "У меня есть промокод"
        - assert: Появилось Поле инпут для промокода и кнопка "Применить"
        - do: Запомнить итоговую сумму заказа
        - do: В инпут написать промокод "SUCCESS_ALREADY_APPLIED", нажать применить
        - assert: Инпут, кнопка и галка задизейблились
        - assert: В блоке с промокодом появилась сумма скидки "− 200 ₽"
        - assert: Появилась ссылка "Отменить"
        - assert: Сумма заказа стала на 200р меньше, чем была до применения промокода
        - do: Заполнить информацию о гостях и контактную информацию любыми валидными данными.
        - do: Нажать оплатить.
        - assert: Остались на странице бронирования.
        - assert: Появился попап с текстом "Этот промокод уже был использован. Вы можете оплатить заказ без промокода или использовать другой."
        - assert: В попапе две кнопки - "Изменить промокод", "Оплатить"
        - assert: В попапе две цены - без скидки и со скидкой
        - do: Нажать кнопку "Изменить промокод"
        - assert: Открылась страница бронирования.
        - assert: Галка "У меня есть промокод" отжата
        - assert: Поле инпут для промокода и кнопка "Применить" не показывается.
        - assert: Сумма без учета промокода
        - do: Повторить применение промокода до нажатия кнопки "Отменить заказ"
        - do: Нажать "Оплатить" (если будет шаг оплаты, ввести данные тестовой карты и оплатить)
        - assert: Открылась страница успешного заказа
        - do: Нажать на кнопку "Подробнее о заказе"
        - assert: Открылась страница заказа в личном кабинете
        - assert: Сумма заказа без скидки.
        - assert: Лейбла с промокодом нет
        - do: Повторить с промокодом SUCCESS_NOT_APPLICABLE
        - assert: Все результаты по шагам будут такими же, кроме текста в попапе - "Промокод не подходит для этого заказа по условиям использования. Вы можете оплатить заказ без промокода или использовать другой."

files:
    - tests/common/hotels/book/promoCodes/failed-promoCodes.hermione.ts

Сервис: Отели
Страница: Бронирование
Автор: tcheremnykh
Устройство:
    - Тач
    - Десктоп
Функциональность: Промокод
Окружение:
    - Testing
Тестирование асессорами: Нет
