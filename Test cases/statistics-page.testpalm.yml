feature: Страница статистики
description: страница статистики пользователя по всем решенным задачам и предметам

specs:
    Нет данных статистики:
        # подготовить passport_uid
        # нет решенных задач или вариантов
        beforeEach:
            - do: перейти на страницу статистики, добавив в адрес параметр 'passport_uid=hermione_test-run_empty'
            - assert: |
                открыта страница статистики
                кнопка "По заданиям" подсвечена и активна
        Статистика заданий:
            - tags: no_assessors
            - do: кликнуть по кнопке "По заданиям"
            - assert: |
                кнопка "По заданиям" подсвечена и активна
                по центру карточки отображено "Не нашлось никаких данных"
                выпадающий список для выбора предмета отсутствует
            - screenshot: внешний вид пустой статистики заданий [plain]
        Статистика вариантов:
            - tags: no_assessors
            - do: кликнуть по кнопке "По вариантам"
            - assert: |
                кнопка "По вариантам" подсвечена и активна
                по центру карточки отображено "Не нашлось никаких данных"
                выпадающий список для выбора предмета отсутствует
            - screenshot: внешний вид пустой статистики вариантов [plain]
    Статистика множества заданий:
        # подготовить passport_uid
        # 1 предмет ОГЭ + 1 предмет ЕГЭ
        # - предмет с <20 решенными различными заданиями
        # - предмет с >20 решенными различными заданиями (есть кнопка "Показать еще")
        # - пустой ответ в задаче
        # - верный ответ в задаче
        # - неверный ответ в задаче
        # - одна попытка решения задачи
        # - несколько попыток решения задачи
        # - задания второй части
        beforeEach:
            - do: перейти на страницу статистики, добавив в адрес параметр 'passport_uid=hermione_test-run_first'
            - assert: |
                открыта страница статистики
                кнопка "По заданиям" подсвечена и активна
        Проверка внешнего вида:
            - screenshot: внешний вид статистики заданий [plain]
        Выбор предмета:
            - tags: no_assessors
            - do: кликнуть по выпадающему списку выбора предмета
            - screenshot: внешний вид развернутого списка выбора предмета [plain]
            - do: выбрать любой предмет из списка
            - assert: |
                страница не обновилась
                кнопка "По заданиям" подсвечена и активна
                в выпадающей списке отображен выбранный предмет
                список заданий обновился в соответствии с выбранным предметом
        Кол-во попыток решения задачи:
            - tags: no_assessors
            - do: выбрать **** предмет из выпадающего списка
            - assert: |
                кнопка "По заданиям" подсвечена и активна
                список заданий обновился в соответствии с выбранным предметом
            - screenshot: внешний вид статистики задач [plain]
            - do: найти в списке задачу с кол-вом попыток решения 1
            - assert: |
                у статистики задачи указан "Ваш ответ"
                у статистики задачи отсутствует стрелка вниз в правой части - попыток решения больше нет, запись о задаче не может быть развернута
            - do: найти в списке задачу с кол-вом попыток решения > 1
            - assert: |
                у статистики задачи указан "Ваш ответ"
                у статистики задачи присутствует стрелка вниз
            -  do: кликнуть по стрелке вниз напротив выбранной задачи
            - assert: |
                статистика задачи развернулась
                цифра в столбце Попытки соответствует кол-ву записей о задаче в развернутом виде
                даты отображены в порядке убывания
            - screenshot: внешний вид статистики задач с развернутой задачей [plain2]
        Ссылка на задачу:
            - tags: no_assessors
            - do: кликнуть по любому номеру задания в столбце "ID задания"
            - assert: |
                в новой вкладке открыта страница выбранного задания
                в адресе присутствует параметр 'problem_id'
        Кнопка показать еще:
            - tags: no_assessors
            - do: выбрать **** предмет из выпадающего списка
            - assert: |
                список заданий обновился в соответствии с выбранным предметом
                кол-во задач на странице <20
                кнопка "Показать еще" внизу страницы отсутствует
            - do: выбрать **** предмет из выпадающего списка
            - assert: |
                список заданий обновился в соответствии с выбранным предметом
                кол-во задач на странице >20
                кнопка "Показать еще" внизу страницы присутствует
            - screenshot: внешний вид статистики задач с кнопкой "Показать еще" [plain]
            - do: кликнуть "Показать еще"
            - assert: |
                страница не обновилась
                список увеличился, отобразив решенные задачи
            - screenshot: внешний вид статистики задач с увеличенным списком задач [plain2]
    Статистика множества вариантов:
        # подготовить passport_uid
        # 1 предмет ОГЭ + 1 предмет ЕГЭ
        # - предмет с <20 решенными вариантами
        # - предмет с >20 решенными вариантами
        # - 0 верных решенных заданий
        # - все верно решенные задания
        # - половина верно решенных заданий
        # - баллы не поддерживаются
        beforeEach:
            - do: перейти на страницу статистики, добавив в адрес параметр 'passport_uid=hermione_test-run_second'
            - assert: |
                открыта страница статистики
                кнопка "По заданиям" подсвечена и активна
            - do: кликнуть по кнопке "По вариантам"
        Выбор предмета:
            - tags: no_assessors
            - do: кликнуть по выпадающему списку выбора предмета
            - screenshot: внешний вид развернутого списка выбора предмета [plain]
            - do: выбрать любой предмет из списка
            - assert: |
                страница не обновилась
                кнопка "По вариантам" подсвечена и активна
                в выпадающей списке отображен выбранный предмет
                список варинатов обновился в соответствии с выбранным предметом
        Кнопка показать еще:
            - tags: no_assessors
            - do: выбрать **** предмет из выпадающего списка
            - assert: |
                список вариантов обновился в соответствии с выбранным предметом
                кол-во вариантов на странице <20
                кнопка "Показать еще" внизу страницы отсутствует
            - do: выбрать **** предмет из выпадающего списка
            - assert: |
                список вариантов обновился в соответствии с выбранным предметом
                кол-во вариантов на странице >20
                кнопка "Показать еще" внизу страницы присутствует
            - screenshot: внешний вид статистики вариантов с кнопкой "Показать еще" [plain]
            - do: кликнуть "Показать еще"
            - assert: |
                страница не обновилась
                список увеличился, отобразив решенные варианты
            - screenshot: внешний вид статистики вариантов с увеличенным списком вариантов [plain2]
        Ссылка на репорт:
            - tags: no_assessors
            - do: кликнуть по любому номеру варианта в столбце "Номер варианта"
            - assert: |
                произошел переход на страницу репорта по выбранному варианту
                в адресе присутствует параметр 'report_id'

specs-integration:
    beforeEach:
        - do: убедиться, что пользователь не залогинен или разлогиниться (чистая сессия)
        - assert: пользователь не залогинен
    Решение задачи:
        - tags: |
            - e2e
            - smoke
        - do: перейти на страницу задачи T333
        - assert: открыта страница задания
        - do: не заполняя поле ответ кликнуть кнопку "Проверить ответ"
        - assert: в поле ввода ответа указано в правой части "Неверно"
        - do: ввести в поле ответ 13 и кликнуть кнопку "Проверить ответ"
        - assert: в поле ввода ответа указано в правой части "Неверно"
        - do: ввести в поле ответ 33000 и кликнуть кнопку "Проверить ответ"
        - assert: в поле ввода ответа указано в правой части "Верно"
        - do: перейти на страницу статистики
        - do: развернуть ответы для задания Т333
        - assert: |
            в столбце дата указанно время решения
            кол-во попыток решения 3
            первый ответ (нижний) отмечен прочерком как пустой
            второй ответ выделен красным как неверный
            третий ответ выделен зеленым как верный и соответствует записи в столбце "Правильный ответ"
    Решение варианта (все верно):
        - tags: |
            - e2e
            - smoke
        - do: перейти на страницу варианта 1
        - assert: открыта страница решения варианта
        - do: верно заполнить все поля ответа для каждого задания и нажать "Завершить тест"
        - do: перейти на страницу статистики вариантов
        - assert: |
            в столбце "Дата" указанно время решения
            решено верно заданий 20 из 20
            Балл 5 из 5
            полоса прогресса полностью заполнена в столбцах "Решено верно заданий" и "Балл"
    Решение варианта (половина верно):
        - tags: |
            - e2e
            - smoke
        - do: перейти на страницу варианта 1
        - assert: открыта страница решения варианта
        - do: верно заполнить поля ответа для половины заданий и нажать "Завершить тест"
        - do: перейти на страницу статистики вариантов
        - assert: |
            в столбце "Дата" указанно время решения
            решено верно заданий 10 из 20
            Балл 3 из 5
            полоса прогресса заполнена не полностью в столбцах "Решено верно заданий" и "Балл"
    Решение варианта (НЕверно):
        - tags: |
            - e2e
            - smoke
        - do: перейти на страницу варианта 1
        - assert: открыта страница решения варианта
        - do: нажать "Завершить тест"
        - do: перейти на страницу статистики вариантов
        - assert: |
            в столбце "Дата" указанно время решения
            решено верно заданий 0 из 20
            Балл 2 из 5
            полоса прогресса полностью не заполнена в столбцах "Решено верно заданий" и "Балл"
    Решение варианта (не поддерживается):
        - tags: |
            - e2e
            - smoke
        - do: перейти на страницу варианта 188
        - assert: открыта страница решения варианта
        - do: нажать "Завершить тест"
        - assert: открыта страница решения заданий второй части
        - do: нажать "Завершить тест"
        - do: перейти на страницу статистики вариантов
        - assert: |
            в столбце "Дата" указанно время решения
            решено верно заданий 0 из 19
            Балл  - Не поддерживается
            полоса прогресса полностью не заполнена в столбце "Решено верно заданий"
            полоса прогресса отсутствует в столбце "Балл"

v-team: Younglings

qa-engineer:
    - helm

platform:
    - common

tags:
    - edu-front
    - statistics-page

files:
    - tests/hermione/suites/common/statistics-page/statistics-page.hermione.js
    - tests/hermione/suites/common/statistics-page/statistics-page.hermione.e2e.js
