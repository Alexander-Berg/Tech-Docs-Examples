feature: Кандидат.Испытания
type: Серия секций

specs:
  Проверка ошибки дубликатов:
    - do: открыть страницу /candidates/<id_кандидата>/interviews/create для кандидата, у которого есть дубликаты
    - screenshot: на странице присутствует ошибка о дубликатах кандидата [duplicates_page]
  Проверка тайтла:
    - do: открыть страницу /candidates/<id_кандидата>/interviews/create для кандидата, у которого нет дубликатов, нет оффера, он не закрыт
    - assert: на странице присутсвует имя кандидата и ссылка на его страницу 'CAN <id_кандидата>'
    - screenshot: открылась страница создания серии секций [candidate_info]
    - do: проверить ссылку кандидата
    - assert: ссылка ведет на страницу /candidates/<id_кандидата>/
  Проверка ошибок:
    - do: открыть страницу /candidates/<id_кандидата>/interviews/create для кандидата, у которого нет дубликатов, нет оффера, он не закрыт и у него есть претендент в работе
    - screenshot: открылась страница создания серии секций [interview_round_form]
    - do: удалить предзаполненную таймзону кандидата
    - do: удалить предзаполненную локацию кандидата
    - do: клик на иконку корзины в блоке 'Укажите удобное для кандидата время'
    - assert: дата и время кандидата пропали
    - do: очистить поле 'Электронная почта'
    - do: клик на кнопку 'Создать'
    - screenshot: под обязательными полями появились ошибки [interview_round_form_errors1]
    - do: выбрать 'Тип серии'
    - do: удалить текст в поле 'Название'
    - do: клик на кнопку 'Создать'
    - assert: |
        под полем 'Вакансия' появилась ошибка
        под полем 'Название' появилась ошибка
    - screenshot: пример внешнего вида [interview_round_form_errors2]
    - do: выбрать вариант в поле 'Вакансия'
    - screenshot: под 'Или укажите произвольного интервьюера' появилась ошибка [interview_round_form_errors3]
  Создание предварительной секции:
    - do: открыть страницу /candidates/<id_кандидата>/interviews/create для кандидата, у которого нет дубликатов, нет оффера, он не закрыт
    - screenshot: открылась страница создания серии секций [interview_round_form]
    - do: ввести в поле 'Где будет кандидат' место проведения секции и выбрать из саджеста с помощью мышки
    - do: ввести в поле 'Укажите таймзону кандидата' таймзону и выбрать из саджеста с помощью мышки
    - do: выбрать в поле 'Укажите удобное для кандидата время' чекбокс 'Любой день'
    - assert: |
        дата и время стали не активны
        кнопка 'Добавить' стала не активна
    - do: выбрать в поле 'Тип серии' значение 'Предварительная секция'
    - assert: |
        появилось поле 'Вакансия'
        появилось поле 'С написанием кода'
        появилось предзаполненное поле 'Название'
        появилось поле 'Пресет задач'
    - screenshot: пример внешнего вида [preliminary_section]
    - do: выбрать в поле 'Вакансия' какое-либо значение
    - do: изменить текст в поле 'Название'
    - do: выбрать несколько собеседующих в поле 'Или укажите произвольного интервьюера'
    - assert: |
        чекбокс активен рядом с именем собеседующего
        есть крестик в конце строки с собеседующим
    - screenshot: пример внешнего вида [interviewers]
    - do: клик на крестик в строке с каким-либо собеседующим
    - assert: собеседующий пропал из списка интервьюеров
    - screenshot: пример внешнего вида [interviewers2]
    - do: выберите какое-либо значение в поле 'Пресет задач'
    - do: заполнить поле 'Комментарий к серии'
    - do: заполнить поле 'Электронная почта' (если оно уже предзаполнено, то ничего не менять)
    - do: выбрать какие-либо значения в блоке 'Шаблон' и нажать 'Применить'
    - do: выбрать какое-либо значение в блоке 'Подпись' и нажать 'Добавить'
    - assert: |
        поле 'Тема' стало предзаполе в соответствии с выбранным шаблоном
        поле 'Текст письма' стало предзаполнено в соответствии с выбранным шаблоном и подписью
    - screenshot: пример внешнего вида заполненной формы [interview_round_form_filled]
    - do: клик на кнопку 'Создать'
    - assert: |
        произошел переход на страницу /candidates/<id_кандидата>/interviews/
        черновик заявки появился на вкладке 'Испытания'
        у черновика есть иконка скайпа
        у черновика есть введенное ранее название
        у черновика есть ссылка на выбранную вакансию
        у черновика есть дата создания и автор
    - screenshot: пример внешнего вида [interview_request]
  Создание стандартной секции:
    - do: открыть страницу /candidates/<id_кандидата>/interviews/create для кандидата, у которого нет дубликатов, нет оффера, он не закрыт
    - screenshot: открылась страница создания серии секций [interview_round_form]
    - do: ввести в поле 'Где будет кандидат' место проведения секции и выбрать из саджеста с помощью клавишей на клавиатуре
    - do: ввести в поле 'Укажите таймзону кандидата' таймзону и выбрать из саджеста с помощью мышки
    - do: выбрать в поле 'Укажите удобное для кандидата время' дату в календаре
    - do: введите в поле 'Укажите удобное для кандидата время' интервал времени
    - do: выбрать в поле 'Тип серии' значение 'Стандартная (очная) серия секций'
    - assert: |
        в поле 'Тип' выбрано значение 'По вакансии' по умолчанию
        присутствует кнопка 'Добавить' внизу блока 'Серия секций'
    - screenshot: пример внешнего вида [usual_sections]
    - do: выбрать в поле 'Вакансия' вариант вакансии, где указано более 5 собеседующих
    - assert: |
        в поле 'Выберите, кто из интервьюеров вакансии может провести секцию' подгрузились собеседующие
        в списке интервиюеров присутствует кнопка 'Загрузить еще'
    - screenshot: пример внешнего вида [interviewers]
    - do: клик на кнопку 'Загрузить еще'
    - assert: подгрузились еще собеседующие для выбранной вакансии
    - screenshot: пример внешнего вида [interviewers2]
    - do: сделать активными несколько чекбоксов в списке интервьюеров
    - do: ввести интервьюера в поле 'Или укажите произвольного интервьюера' и выбрать из саджеста
    - assert: |
        интервьюер появился в списке собеседующих
        у интервьюера сразу активен чекбокс
    - screenshot: пример внешнего вида [interviewers3]
    - do: клик на кнопку 'Добавить'
    - assert: |
        добавился еще один блок для выбора типа серии секции
        появилось поле 'Порядок секций важен' с выбранным по умолчанию значением 'Нет'
        появилось поле 'Если все секции получится запланировать в один день одна за другой, длительность обеда' с предзаполненным значением по умолчанию 'Без обеда'
    - screenshot: пример внешнего вида [usual_sections2]
    - do: в поле 'Тип' выбрать 'АА секция'
    - assert: появилось поле 'Тип АА секции'
    - do: выбрать значение в поле 'Тип АА секции'
    - do: в поле 'С написанием кода' выбрать значение 'Да'
    - assert: в поле 'Название' к предзаполненному названию добавился текст 'с кодом'
    - screenshot: пример внешнего вида [aa_section]
    - do: в поле 'Порядок секций важен' выберите значение 'Да'
    - do: выберите любое значение в поле 'Если все секции получится запланировать в один день одна за другой, длительность обеда'
    - do: в поле 'Отправить автоматически письмо-приглашение кандидату после подбора места и времени всех секций' выберите значение 'Нет'
    - assert: |
        поле 'Электронная почта' пропало
        блок 'Шаблон' пропал
        блок 'Подпись' пропал
        поле 'Тема' пропало
        поле 'Текст письма' пропало
        кнопка 'Добавить файлы' пропала
    - screenshot: пример внешнего вида заполненной формы [interview_round_form_filled]
    - do: клик на кнопку 'Создать'
    - assert: |
        произошел переход на страницу /candidates/<id_кандидата>/interviews/
        черновик заявки появился на вкладке 'Испытания'
        у черновика есть иконка АА
        у черновика есть иконка '</>'
        у черновика есть введенные ранее название для АА секции и секции по вакансии
        у черновика есть ссылка на выбранную вакансию для секции по вакансии
        у черновика есть дата создания и автор
    - screenshot: пример внешнего вида [interview_request]
  Создание финальной секции:
    - do: открыть страницу /candidates/<id_кандидата>/interviews/create для кандидата, у которого нет дубликатов, нет оффера, он не закрыт
    - screenshot: открылась страница создания серии секций [interview_round_form]
    - do: выбрать значение в поле 'Где будет кандидат'
    - do: ввести в поле 'Укажите таймзону кандидата' таймзону и выбрать из саджеста с помощью мышки
    - do: в блоке 'Укажите удобное для кандидата время' в строке с датой и временем установите галочку
    - assert: время стало не активно
    - do: в блоке 'Укажите удобное для кандидата время' клик на 'Добавить'
    - assert: |
        появилось еще поле для выбора даты и времени проведения секции
        по умолчанию указано текущая дата
        по умолчанию указано время с 10.00 до 20.00
    - do: в поле 'Тип серии' выберите значение 'Финальная серия секций'
    - do: выберите любое значение в поле 'Вакансия'
    - do: выберите собеседующего в поле 'Или укажите произвольного интервьюера'
    - do: клик на 'Добавить' в блоке 'Серия секций'
    - assert: появился еще блок для финальной секции
    - screenshot: пример внешнего вида [final_sections]
    - do: клик на иконка корзины в новом блоке для финальной секции
    - assert: блок пропал
    - screenshot: пример внешнего вида [final_sections2]
    - do: ввести значение в поле 'Электронная почта'
    - do: заполнить поле 'Тема'
    - do: заполнить поле 'Текст письма'
    - do: клик на 'Дата и время' в блоке 'Текст письма'
    - assert: блок 'Дата и время' появился там, где был установлен курсор
    - do: клик на кнопку 'Добавить файлы'
    - do: выбрать несколько файлов для прикрепления
    - screenshot: пример внешнего вида заполненной формы [interview_round_form_filled]
    - do: клик на кнопку 'Создать'
    - assert: |
        произошел переход на страницу /candidates/<id_кандидата>/interviews/
        черновик заявки появился на вкладке 'Испытания'
        у черновика есть иконка флажка
        у черновика есть название
        у черновика есть ссылка на выбранную вакансию
        у черновика есть дата создания и автор
    - screenshot: пример внешнего вида [interview_request]

tags:
  - reviewed

priority: critical

files:
  - tests/hermione/suites/desktop/candidates/interviews/interview_rounds/create_interview_rounds/create_interview_rounds.hermione.js

browsers:
  - yandex-browser-desktop
  - firefox-desktop
  - safari-desktop
