feature: Офферы
type: Рейтинг в офферах

specs:
  С расширенным гринурлом:
    - params:
        foreverdata: '3754065705'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: в гринурле есть рейтинг и ачивки
    - screenshot: внешний вид гринурла [long-greenurl]
    - counter: /$page/$main/$result/offer-reviews/rating

  С коротким гринурлом:
    - params:
        foreverdata: '372881226'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: в гринурле есть рейтинг
    - screenshot: внешний вид гринурла [short-greenurl]
    - counter: /$page/$main/$result/offer-reviews/rating

  Открытие тултипа рейтинга:
    - params:
        foreverdata: '372881226'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: в гринурле есть рейтинг
    - do: навести мышкой на рейтинг
    - assert: появилась всплывающая подсказка с текстом "Оценка по мнению пользователей Яндекса"
    - screenshot: вид сниппета с меткой и подсказкой [offer-reviews-tooltip]
    - tech: сработал счётчик path = '/$page/$main/$result/offer-reviews' event='tech' type='offer-reviews-show'
    - do: перейти по ссылке с отзывами во всплывающей подсказке
    - assert: открылась страница с отзывами
    - tech: сработал счётчик path = '/$page/$main/$result/offer-reviews-tooltip/link'

  Доступность:
    - tags: a11y_serp
    - params:
        foreverdata: '372881226'
    - do: |
        получить выдачу по запросу 'foreverdata'
        включить скринридер и дойти до рейтинга
    - assert: |
        в сниппете есть рейтинг
        рейтинг озвучивается как 'Рейтинг: 2,8 из 5'
        сразу после этого элемента есть визуально скрытый элемент 'Рейтинг магазина на Яндекс.Маркете'
        сразу после этого элемента есть визуально скрытая ссылка '4 отзыва'
        адрес ссылки = 'https://reviews.yandex.ru/ugcpub/object-digest?otype=Site&app_id=iznanka&ranking=by_relevance&object=%2Fsite%2FZ2FybzI0LnJ1&view=serp'

files:
  - src/features/OfferReviews/OfferReviews.test/OfferReviews@desktop.hermione.js

tags:
  - skip_e2e_check
  - dm_offer

v-team: Distribution

tlds: all
