feature: Универсальный колдунщик поиска врачей

specs:
  Блоки:
    Список клиник:
      Ссылки на перезапрос с 1Орг:
        - params:
            foreverdata: '2132929412'
        - do: получить выдачу по запросу 'foreverdata'
        - assert: на странице присутствует блок "Где принимает"
        - do: нажать на название клиники в блоке "Где принимает"
        - assert: открылась страница с поиском по названию клиники и первым элементом информация о ней

    Клиника с расписанием:
      Внешний вид:
        - params:
            foreverdata: '676973423'
        - do: получить выдачу по запросу 'foreverdata'
        - assert: на выдаче есть универсальный тематический блок поиска врачей
        - do: нажать на первого врача из списка тематический блока
        - assert: |
            открылось модальное окно с информацией о враче
            в блоке «Записаться» присутствуют клиники с расписанием врача
        - screenshot: внешний вид [plain]
      Клик по дате:
        - params:
            foreverdata: '676973423'
        - do: получить выдачу по запросу 'foreverdata'
        - assert: на выдаче есть универсальный тематический блок поиска врачей
        - do: нажать на первого врача из списка тематический блока
        - assert: |
            открылось модальное окно с информацией о враче
            в блоке «Записаться» присутствуют клиники с расписанием врача
        - do: нажать на кнопку с датой записи
        - assert: появились кнопки с доступными временными слотами
        - screenshot: внешний вид [date_selected]
      Разметка baobab:
        - params:
            foreverdata: '676973423'
        - do: получить выдачу по запросу 'foreverdata'
        - assert: на выдаче есть универсальный тематический блок поиска врачей
        - do: нажать на первого врача из списка тематический блока
        - assert: |
            открылось модальное окно с информацией о враче
            в блоке «Записаться» присутствуют клиники с расписанием врача
        - do: нажать на кнопку с изображением телефона в блоке «Записаться»
        - assert: открылся диалог набора номера
        - tech: сработал счетчик "$page/$main/$result/unisearch_medicine/preview/link[@action=phone]"
      Запись к врачу:
        Один источник:
          По нажатию в слот происходит переход по ссылке:
            - tags: no_assessors
            - params:
                foreverdata: '676973423'
            - do: получить выдачу по запросу 'foreverdata'
            - assert: на выдаче есть универсальный тематический блок поиска врачей
            - do: нажать на первого врача из списка тематический блока
            - assert: |
                открылось модальное окно с информацией о враче
                в блоке «Записаться» присутствуют клиники с расписанием врача
            - do: нажать на первую кнопку со временем "15:00" в первой клинике
            - assert: произошел переход на страницу "https://zoon.ru/?time=time1&date=date1"
            - tech: сработал счетчик "$page/$main/$result/unisearch_medicine/preview/unisearch-clinics/clinic/slot-button[@id=slot1]"
        Несколько источников:
          По нажатию в слот происходит открытие шторки:
            - params:
                foreverdata: '3265722964'
            - do: получить выдачу по запросу 'foreverdata'
            - assert: на выдаче есть универсальный тематический блок поиска врачей
            - do: нажать на первого врача из списка тематический блока
            - assert: |
                открылось модальное окно с информацией о враче
                в блоке «Записаться» присутствуют клиники с расписанием врача
            - do: нажать на первую кнопку со временем "15:00" в первой клинике
            - assert: появилось модальное окно с вариантами записи к врачу
            - screenshot: внешний вид модального окна [plain]
          Baobab-разметка:
            - tags: no_assessors
            - params:
                foreverdata: '3265722964'
            - do: получить выдачу по запросу 'foreverdata'
            - assert: на выдаче есть универсальный тематический блок поиска врачей
            - do: нажать на первого врача из списка тематический блока
            - assert: |
                открылось модальное окно с информацией о враче
                в блоке «Записаться» присутствуют клиники с расписанием врача
            - tech: |
                в баобаб дереве присутствет узел по пути "/$page/$main/$result/unisearch_medicine/preview/unisearch-clinics/clinic/slot-button"
                и атрибутами "id" = "slot1" и "title" = "15:00"
            - do: нажать на первую кнопку со временем "15:00" в первой клинике
            - assert: появилось модальное окно с вариантами записи к врачу
            - tech: |
                в баобаб дереве присутствет узел по пути "/$page/$main/$result/unisearch_medicine/preview/unisearch-clinics/appointment-popup/source-button"
                и атрибутом "url" = "https://zoon.ru/?time=time1&date=date1"
            - tech: |
                в баобаб дереве присутствет узел по пути "/$page/$main/$result/unisearch_medicine/preview/unisearch-clinics/appointment-popup/source-button"
                и атрибутом "url" = "https://docdoc.ru/?time=time01&date=date01"
            - tech: в баобаб дереве присутствет узел по пути "/$page/$main/$result/unisearch_medicine/preview/unisearch-clinics/appointment-popup/close-button"

    Клиника без расписания:
      Внешний вид:
        - params:
            foreverdata: '3253888529'
        - do: получить выдачу по запросу 'foreverdata'
        - assert: на выдаче есть универсальный тематический блок поиска врачей
        - do: нажать на первого врача из списка тематический блока
        - assert: |
            открылось модальное окно с информацией о враче
            в блоке «Записаться» присутствуют клиники, в которых врач принимает
        - screenshot: внешний вид [no_timetable]
      Запись к врачу:
        Один источник:
          По нажатию в кнопку записи происходит переход по ссылке:
            - tags: no_assessors
            - params:
                foreverdata: '3253888529'
            - do: получить выдачу по запросу 'foreverdata'
            - assert: на выдаче есть универсальный тематический блок поиска врачей
            - do: нажать на первого врача из списка тематический блока
            - assert: |
                открылось модальное окно с информацией о враче
                в блоке «Записаться» присутствуют клиники, в которых врач принимает
            - do: нажать на кнопку "Записаться на приём" в первой клинике
            - assert: произошел переход на страницу "https://zoon.ru/"
            - tech: сработал счетчик "$page/$main/$result/unisearch_medicine/preview/unisearch-clinics/clinic/make-appointment-button[@url=https://zoon.ru/]"
        Несколько источников:
          По нажатию в кнопку записи происходит открытие шторки:
            - params:
                foreverdata: '2140326007'
            - do: получить выдачу по запросу 'foreverdata'
            - assert: на выдаче есть универсальный тематический блок поиска врачей
            - do: нажать на первого врача из списка тематический блока
            - assert: |
                открылось модальное окно с информацией о враче
                в блоке «Записаться» присутствуют клиники, в которых врач принимает
            - do: нажать на кнопку "Записаться на приём" в первой клинике
            - assert: появилось модальное окно с вариантами записи к врачу
            - screenshot: внешний вид модального окна [plain]
          Baobab-разметка:
            - tags: no_assessors
            - params:
                foreverdata: '2140326007'
            - do: получить выдачу по запросу 'foreverdata'
            - assert: на выдаче есть универсальный тематический блок поиска врачей
            - do: нажать на первого врача из списка тематический блока
            - assert: |
                открылось модальное окно с информацией о враче
                в блоке «Записаться» присутствуют клиники, в которых врач принимает
            - tech: в баобаб дереве присутствет узел по пути "/$page/$main/$result/unisearch_medicine/preview/unisearch-clinics/clinic/make-appointment-button"
            - do: нажать на кнопку "Записаться на приём" в первой клинике
            - assert: появилось модальное окно с вариантами записи к врачу
            - tech: |
                в баобаб дереве присутствет узел по пути "/$page/$main/$result/unisearch_medicine/preview/unisearch-clinics/appointment-popup/source-button"
                и атрибутом "url" = "https://zoon.ru/"
            - tech: |
                в баобаб дереве присутствет узел по пути "/$page/$main/$result/unisearch_medicine/preview/unisearch-clinics/appointment-popup/source-button"
                и атрибутом "url" = "https://docdoc.ru/"
            - tech: в баобаб дереве присутствет узел по пути "/$page/$main/$result/unisearch_medicine/preview/unisearch-clinics/appointment-popup/close-button"

files:
  - src/features/UniSearch/UniSearch.features/UniSearchMedicine/UniSearchMedicine.features/Clinics/UniSearchMedicineClinics.test/UniSearchMedicineClinics@touch-phone.hermione.js

v-team: UniSearch

tlds: [ru, by, ua, kz, uz]

tags:
  - react
  - skip_e2e_check
