feature: Расширенный сниппет
type: Спецсниппет

description: В IE11 тап на текст расширенного сниппета раскрывает сниппет - это ожидаемо.

specs:
  Внешний вид:
    - do: получить выдачу Поиска по запросу 'test википедия' и пролистать выдачу до любого сниппета с надписью 'Читать ещё'
    - label: extended-snippet-{{PLATFORM}}-{{BROWSER_TYPE}}
    - screenshot: в выдаче есть расширенный сниппет со ссылкой 'Читать ещё' (примерный вид) [plain]
  Раскрытие/закрытия:
    - tags:
        - smoke
    - do: получить выдачу Поиска по запросу 'test википедия' и пролистать выдачу до любого сниппета с надписью 'Читать ещё'
    - tech: проверить счетчик на ссылке 'Читать ещё' (path = "/web/item/more/", vars="-adapters=extended-snippet,action=dynamic_click,pos=p1,-source=web")
    - do: тапнуть на ссылку 'Читать ещё' в сниппете
    - screenshot: появился полный текст сниппета [clicked]
    - tech: проверить счетчик на ссылке 'Скрыть' (path = "/web/item/close/", vars="-adapters=extended-snippet,action=dynamic_click,pos=p2,-source=web")
    - do: тапнуть на ссылку 'Скрыть'
    - assert: снова показывается короткий текст сниппета [extended-snippet-{{PLATFORM}}-{{BROWSER_TYPE}} >> plain]
  Проверка нераскрытия при клике на текст:
    - do: получить выдачу Поиска по запросу 'test википедия' и пролистать выдачу до любого сниппета с надписью 'Читать ещё'
    - do: тапнуть на текст расширенного сниппета с "Читать еще" (клик должен быть в текст сниппета, не на ссылку "читать еще")
    - assert: текст не раскрылся
    - screenshot: внешний вид сниппета не изменился [clicked]
  Внешний вид без текста:
    - params:
        foreverdata: '2559999911'
    - do: получить выдачу Поиска по запросу 'foreverdata'
    - screenshot: внешний вид сниппета без текста [plain]

specs-integration:
  Раскрытие/закрытия:
    - do: получить выдачу Поиска по запросу 'test википедия' и пролистать выдачу до любого сниппета с надписью 'Читать ещё'
    - tech: проверить счетчик на ссылке 'Читать ещё' (path = '/$page/$main/$result/extended-text/more[@behaviour@type="dynamic"]'
    - do: тапнуть на ссылку 'Читать ещё' в сниппете
    - screenshot: появился полный текст сниппета [clicked]
    - tech: проверить счетчик на ссылке 'Скрыть' (path = '/$page/$main/$result/extended-text/close[@behaviour@type="dynamic"]')
    - do: тапнуть на ссылку 'Скрыть'
    - assert: снова показывается короткий текст сниппета [extended-snippet-{{PLATFORM}}-{{BROWSER_TYPE}} >> plain]

files:
  - features/extended-snippet/extended-snippet@desktop.hermione.js
  - features/extended-snippet/extended-snippet@desktop.hermione.e2e.js

v-team: Beauty

counter: /web/item/more

priority: high

tags:
  - reviewed
  - smoke_extended

tlds: all
