feature: Кнопка "Показать ещё"

specs:
  Проверка подгрузки следующей страницы:
  - tags: 
     - smoke
     - pp_new_core
  - do: получить выдачу по запросу 'тест'
  - assert: загрузились результаты выдачи
  - do: пролистать до конца выдачи
  - assert: внизу есть кнопка 'Показать ещё' (если есть тумблер "легкая версия", то его нужно выключить)
  - do: кликнуть по кнопке 'Показать еще'
  - assert: |
      показался прелоадер загрузки второй страницы,
      исчез прелоадер загрузки второй страницы,
      загрузилась вторая страница с результатами,
      на месте кнопки появился разделитель страниц с номером 2
      на странице есть фавиконки
  - do: пролистать до конца выдачи и кликнуть 'Показать еще'
  - assert: |
      показался прелоадер загрузки третьей страницы,
      исчез прелоадер загрузки третьей страницы,
      загрузилась третья страница с результатами,
      на месте кнопки появился разделитель страниц с номером 3
  Проверка внешнего вида в активном состоянии:
  - tags: smoke
  - do: получить выдачу по запросу 'тест'
  - assert: загрузились результаты выдачи
  - do: пролистать до конца выдачи (если есть тумблер "легкая версия", то его нужно выключить)
  - assert: внизу есть кнопка 'Показать ещё'
  - screenshot: внешний вид кнопки соответствует скриншоту [plain]
  - do: кликнуть по кнопке 'Показать еще'
  - screenshot: внешний вид кнопки соответствует скриншоту [pressed]
  - screenshot: при клике выполнилась анимация продавливания кнопки [progress]
  Проскрол страницы после подгрузки:
  - do: получить выдачу по запросу 'тест'
  - assert: загрузились результаты выдачи
  - do: |
      пролистать страницу до конца
      кликнуть по кнопке 'Показать еще'
  - assert: |
      загрузилась вторая страница с результатами,
      появился разделитель 2 страница, предыдущего сниппета (который над разделителем) не видно (если сниппет над разделителем виден - подскролла не было. В старых ОС мобильных устройств и в поисковых приложениях на плашетах подскролла может не быть.)
      произошёл подскрол к разделителю 2 страница так, что его верхний край вплотную примыкает к верхнему краю экрана [https://jing.yandex-team.ru/files/vtroshina/2021-09-01T08:43:51Z.81ca410.png]
  Загрузка следующей страницы на выдаче с каруселью:
    # Тест на баг SERP-147979
    - tags: smoke_extended
    - do: получить выдачу по запросу 'купить iphone' (альтернативные запросы 'купить окна', 'купить телефон', 'купить холодильник')
    - assert: на странице присутствует карусель товаров на первой позиции
    - do: пролистать до конца выдачи
    - assert: внизу есть кнопка 'Показать ещё'
    - tech: на странице есть только один элемент serp-list (можно проверить, выполнив в консоли document.querySelectorAll('.serp-list').length)
    - do: кликнуть по кнопке 'Показать еще'
    - assert: загрузилась вторая страница с результатами

files:
- features/touch-phone/more/more.hermione.js

v-team: Beauty

tags:
  - skip_e2e_check

priority: normal

tlds: none
