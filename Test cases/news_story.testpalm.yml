feature: Колдунщик новостей
type: story

specs:
  Основные проверки:
    priority: high
    params:
      foreverdata: '3365841743'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
      - screenshot: внешний вид [news_story-4-{{PLATFORM}}-{{BROWSER_TYPE}} >> newsStory]
    Внешний вид:
      - tags: smoke
      - label: news_story-4-{{PLATFORM}}-{{BROWSER_TYPE}}
      - screenshot: внешний вид [newsStory]
      - assertMetrics: '-'
    Заголовок:
      - tags: smoke
      - do: нажать на ссылку в заголовке колдунщика
      - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/title'
      - assert: в новой вкладке открылись 'Яндекс Новости'
      - assertMetrics: '-'
    Первое видео:
      - tags: smoke
      - do: нажать на первое видео главной новости
      - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/video-slot0'
      - assert: в новой вкладке открылся сервис Яндекс.Эфира (проверяется сам факт перехода на сервис Яндекс.Эфир. Отсутствие видео на сервисе Я.Эфир,  или надпись 'Видео переехали из Эфира' не является ошибкой теста)
      - assertMetrics: '-' 
    Ссылка "Читать полностью":
      - tags: smoke
      - do: нажать на ссылку 'Читать полностью'
      - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/more_link'
      - assert: в новой вкладке открылись 'Яндекс Новости'
      - assertMetrics: '-'
    Реакции:
      Комментарии:
        - do: нажать на иконку 'Комментарии'
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/reactions/comments'
        - assert: открылась новая вкладка (содержимое открывшейся вкладки может не соответствовать новости. Это не ошибка - важен сам факт перехода)
        - assertMetrics: '-'
      Видео:
        - do: нажать на иконку 'Видео'
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/reactions/video'
        - assert: открылась новая вкладка (содержимое открывшейся вкладки может не соответствовать новости. Это не ошибка - важен сам факт перехода)
        - assertMetrics: '-'
      Фото:
        - do: нажать на иконку 'Фото'
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]reactions/photos'
        - assert: открылась новая вкладка (содержимое открывшейся вкладки может не соответствовать новости. Это не ошибка - важен сам факт перехода)
        - assertMetrics: '-'
    Кнопка "Все новости":
      - do: нажать на кнопку 'Все новости'
      - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/all'
      - assert: в новой вкладке открылись 'Яндекс Новости'
      - assertMetrics: '-'
  Без картинок:
    params:
      foreverdata: '2203655866'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
    Внешний вид:
      - screenshot: проверить внешний вид [newsStory]
      - assertMetrics: '-'
  Видео внизу:
    params:
      foreverdata: '685673995'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
    Внешний вид:
      - screenshot: проверить внешний вид [newsStory]
      - assertMetrics: '-'
    2ая новость:
      Заголовок:
        - do: нажать на заголовок второй новости
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/card/doc'
        - assert: в новой вкладке открылся сайт выбранной новости
        - assertMetrics: '-'
      Общая ссылка с хостом:
        - do: нажать на хост ссылку под заголовком второй новости
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/card/desc'
        - assert: в новой вкладке открылся сайт выбранной новости
        - assertMetrics: '-'
      Тумба:
        - do: нажать на картинку второй новости
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/card/image'
        - assert: в новой вкладке открылся сайт выбранной новости
        - assertMetrics: '-'
  Видео наверху:
    params:
      foreverdata: '832722218'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
    Внешний вид:
      - screenshot: проверить внешний вид [newsStory]
      - assertMetrics: '-'
  Без видео:
    params:
      foreverdata: '706160563'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
    Внешний вид:
      - screenshot: проверить внешний вид [newsStory]
      - assertMetrics: '-'
  В объектном ответе:
    params:
      foreverdata: '463705487'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
    Внешний вид:
      - screenshot: проверить внешний вид [newsStory]
      - assertMetrics: '-'
  Горизонтальная ориентация:
    С картиночной тумбой:
      - params:
          foreverdata: '4031105843'
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче присутствует колдунщик новостей
      - do: повернуть телефон в горизонтальную ориентацию
      - screenshot: примерный внешний вид [story-thumb-landscape]

files:
  - features/touch-phone/news/news_story.hermione.js

tags:
  - reviewed
  - skip_e2e_check # фича отключена на данных
  - news

v-team: Freshness

counter: /$page/$main/$result[@wizard_name="news" and @subtype="story"]

tlds:
  - ru
  - by
  - kz
  - uz
  - ua
