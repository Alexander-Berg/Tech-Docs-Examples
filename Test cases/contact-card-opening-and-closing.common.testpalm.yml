feature: Карточка контакта открытие и закрытие
tlds: ru

import-steps:
    - tests/hermione/suites/messenger/contact-card/shared-steps/open-private-chat.testpalm.steps.yml
    - tests/hermione/suites/messenger/contact-card/shared-steps/open-groupe-chat.testpalm.steps.yml

specs:
    Вызов карточки из личного чата по клику на шапку:
        - label: personal-{{PLATFORM}}
        - attach: Открытие личного чата
        - do: кликнуть на имя или аватар собеседника в шапке
        - assert: по центру экрана открылось модальное окно-карточка контакта

    Вызов карточки из группового чата по клику на шапку аккаунта:
        - attach: Открытие группового чата
        - do: кликнуть на имя или автарку собеседника в чате
        - assert: по центру экрана открылось модальное окно-карточка контакта

    Вызов карточки из раздела Информация о чате по клику на шапку контакта:
        - attach: Открытие группового чата
        - do: в правом верхнем углу нажать на кнопку вызова меню группового чата (в виде трех точек, расположенных вертикально)
        - assert: открылось меню группового чата
        - do: кликнуть на графу "Показать информацию" о чате
        - assert: открылась карточка чата
        - do: в карточке чата кликнуть на имя или аватарку любого собеседника
        - assert: по центру экрана открылось модальное окно-карточка контакта

    Вызов карточки контакта из меншена:
        - attach: Открытие группового чата
        - do: в чате отправить меншен (упоминание собеседника с символом @)
        - assert: отправилось сообщение с меншеном в чат, меншен выделен синим цветом
        - do: кликнуть на меншен
        - assert: по центру экрана открылось модальное окно-карточка упомянутого контакта

    Вызов карточки контакта по клику на добавленного собеседника:
        - attach: Открытие группового чата
        - do: в групповой чат добавить собеседника
        - assert: собеседник добавлен, в чате отобразилось сообщение "/собеседник/ добавлен в чат", имя собеседника выделено синим цветом
        - do: кликнуть на имя добавленного собеседника
        - assert: по центру экрана открылось модальное окно-карточка контакта добавленного собеседника

    Закрытие карточки контакта по клику на кнопку с крестиком:
        #- browsers:
            #- chrome-pad
        - attach: Открытие личного чата
        - do: открыть карточку контакта, кликнув на аватарку или имя собседника
        - assert: карточка контакта открылась, на всем экране кроме области карточки появилось затемнение
        - do: нажать на крестик в правом верхнем углу карточки
        - assert: карточка контакта закрылась, затемнение исчезло

    # TODO: make it work after (https://st.yandex-team.ru/MSSNGRFRONT-7924)
    Закрытие карточки контакта по клику на стрелку назад:
        - automation:
        #- browsers:
            #notFor:
                #- chrome-pad
        - attach: Открытие личного чата
        - do: открыть карточку контакта, кликнув на аватарку или имя собседника
        - assert: карточка контакта открылась, на всем экране, кроме области карточки, появилось затемнение
        - do: нажать на стрелку назад в левом верхнем углу карточки
        - assert: карточка контакта закрылась, затемнение исчезло

    # TODO: make it work after (https://st.yandex-team.ru/MSSNGRFRONT-7924)
    Закрытие карточки контакта при клике в сторону:
        - browsers:
            notFor:
                - iphone
                #- chrome-phone
        - attach: Открытие группового чата
        - do: открыть карточку контакта, кликнув на имя или аватарку собеседника
        - assert: карточка контакта открылась, остальной экран неактивен, покрыт светло-серым затемнением
        - do: кликнуть на любую область вне карточки контакта
        - assert: карточка контакта закрылась

tags:
    - no_assessors
    - y-team

files:
    - tests/hermione/suites/messenger/contact-card/contact-card-opening-and-closing.common.hermione.ts

v-team: Chat
