feature: Страница новостей
type: С бесконечной лентой новостей

specs:
  aliases:
    - &StartForNewsInfinite_1
      - do: получить выдачу по запросу 'foreverdata' и кликнуть в заголовок первого сниппета (название заголовка Тестовая страница для NewsInfinite-1 — турбо)
      - assert: открывается турбо-страница в новой вкладке

    - &StartForNewsInfinite_2
      - do: получить выдачу по запросу 'foreverdata' и кликнуть в заголовок первого сниппета (название заголовка Тестовая страница для NewsInfinite-2 — турбо)
      - assert: открывается турбо-страница в новой вкладке

  Порядок загрузки и инициализации с минимальной новости:
    - params:
        foreverdata: '2251695851'
    - do: получить выдачу по запросу 'foreverdata' и кликнуть в заголовок первого сниппета (название заголовка Тестовая страница для NewsInfinite-1 — турбо)
    - assert: |
        открывается турбо-страница в новой вкладке
        проверить, что загрузилась базовая новость с ракеткой в правом верхнем углу и заголовком 'Новость №1'
    - tech: сработал счетчик ошибки несуществующей новости '/turbo?text=bbbbbbb' (/turbo/ajax/empty)
    - assert: |
        под новостью с заголовком 'Новость №1' дожна подгрузиться связанная новость с заголовком 'Новость №2'
        в новости с заголовком 'Новость №2' отображается картинка
        в новости с заголовком 'Новость №2' есть кнопка меню рядом с ракеткой (3 полоски)
    - do: кликнуть на меню
    - assert: справа налево должно выехать меню меню
    - do: кликнуть по темной зоне слева меню
    - assert: меню закрылось
    - do: проскроллить до конца страницы
    - assert: должна подгрузиться новость с заголовком 'Новость №3'
    - do: проскроллить до конца страницы
    - assert: должна подгрузиться новость с заголовком 'Новость №4'
    - screenshot: внешний вид (на странице возможно наличие тестовых рекламных блоков) [plain]

  Инициализация с полной новости:
    - params:
        foreverdata: '765028790'
    - *StartForNewsInfinite_2
    - do: на открывшейся странице по-порядку провести следующие проверки
    - assert: |
        проверить, что загрузилась базовая новость с ракеткой в правом верхнем углу и заголовком 'Новость №2'
        в первой новости с заголовком 'Новость №2' есть кнопка меню рядом с ракеткой (3 полоски)
        в первой новости с заголовком 'Новость №2' отображается картинка
    - do: проскроллить по конца страницы
    - assert: |
        должна подгрузиться новость в заголовком 'Новость №4'
        в новости в заголовком 'Новость №4' в заголовке нет кнопки меню рядом с ракетком

  Повторяющиеся ссылки на статьи игнорируются:
    - params:
        foreverdata: '2251695851'
    - *StartForNewsInfinite_1
    - do: на открывшейся странице провести следующие проверки
    - assert: под новостью с заголовком 'Новость №1' дожна подгрузиться связанная новость с заголовком 'Новость №2'
    - do: проскроллить до конца страницы
    - assert: должна подгрузиться новость в заголовком 'Новость №3'
    - do: проскроллить до конца страницы
    - assert: должна подгрузиться новость в заголовком 'Новость №4'
    - do: проскроллить до конца страницы
    - assert: никаких новых страниц не должно загрузиться

  С дозагружаемыми react-бандлами:
    - do: открыть страницу `https://yandex.ru/turbo?stub=related/for-react.json
    - assert: открылась страница, в шапке нет меню
    - do: доскроллить вниз
    - aseert: |
        загрузилась вторая страница
        в шапке второй страницы есть бургерное меню
    - do: кликнуть в бургер
    - assert: |
        меню открылось
        ссылки в меню отображаются

files:
  - features/touch-phone/pages/with-related-by-ajax/with-related-by-ajax.hermione.js

v-team: Turbo

manager: tanzwuta

qa-engineer: kleev, k0nratka

tlds: none
