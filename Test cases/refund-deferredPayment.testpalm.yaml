feature: Отели
type: Бронирование отелей

specs:
    Возврат брони в рассрочку:
        - condition: Быть залогиненным.
        - do: Перейти на страницу бронирования отеля c параметрами
              | бесплатная отмена
              | 1 ночь
              | 2 взрослых
        - do: Выбрать чекбокс "Оплатить позже".
        - assert: Чекбокс рассрочки должен содержать текст "Оплатить позже".
        - do: В корзинке над рассрочками активировать чекбокс "У меня есть промокод" и ввести промокод "SUCCESS" и нажать "Применить".
        - do: Заполнить валидными данными гостей и контактную инфу и нажать "Забронировать".
        - do: Ввести данные карты и нажать "Оплатить".
        - do: Перейти по ссылке на страницу заказа.
        - assert: Есть информация о сумме рассрочки и общей сумме заказа (с учетом скидки).
        - assert: Ниже указано, сколько необходимо доплатить, до какого числа и времени и есть кнопка "Доплатить".
        - assert: Все суммы и даты с временем совпадают с информацией на бронировании.
        - assert: На странице есть активная кнопка "Отменить бронирование".
        - do: Кликнуть по кнопке "Отменить бронирование".
        - do: В открывшемся попапе подтвердить отмену.
        - assert: Появился лоадер с текстом "Загрузка заказа. Загружаем подробную информацию о заказе".
        - assert: После закрытия попапа и перезагрузке страницы отображается стандартная страница возврата.
        - assert: Есть текст "К возврату 0 р"

    Возврат брони после доплаты:
        - condition: Быть залогиненным.
        - do: Перейти на страницу бронирования отеля c параметрами
              | бесплатная отмена
              | 2 ночи
              | 2 взрослых
        - do: Выбрать чекбокс "Оплатить позже".
        - do: В корзинке над рассрочками активировать чекбокс "У меня есть промокод" и ввести промокод "SUCCESS" и нажать "Применить".
        - do: Заполнить валидными данными гостей и контактную инфу и нажать "Оплатить".
        - assert: После прокрутки всех спиннеров произошел переход на страницу успешного заказа.
        - do: Нажать кнопку "Подробнее о заказе"
        - assert: Есть информация о сумме рассрочки и общей сумме заказа (с учетом скидки).
        - assert: Ниже указано, сколько необходимо доплатить, до какого числа и времени и есть кнопка "Доплатить".
        - assert: Все суммы и даты с временем совпадают с информацией на бронировании.
        - assert: На странице есть активная кнопка "Отменить бронирование".
        - do: Кликнуть по кнопке "Отменить бронирование".
        - do: В открывшемся попапе подтвердить отмену.
        - assert: Появился лоадер с текстом "Загрузка заказа. Загружаем подробную информацию о заказе".
        - assert: После закрытия попапа и перезагрузке страницы отображается стандартная страница возврата.
        - assert: В блоке стоимости отеля указана общая сумма возврата (с учетом скидки).
        - assert: Рядом есть ссылка "Чеки и документы"
        - do: Кликнуть на ссылку.
        - assert: Открылось меню с чеками и документами. https://jing.yandex-team.ru/files/papulova/Iil6FPL3V4.png
        - assert: Открылся модал чека прихода.
        - do: Кликнуть на ссылку "Чек на платеж"
        - assert: Сумма в чеке равна сумме бронирования.
        - do: Закрыть модал по крестику.
        - do: Кликнуть на ссылку "Чек на возврат
        - assert: Открылся модал чека возврата - если появляется попап, что чек пока недоступен - перезагрузить страницу.
        - assert: Открылся модал чека возврата прихода.
        - assert: Сумма в чеке равна сумме бронирования.
        - do: Закрыть модал по крестику.

files:
    - tests/common/hotels/book/deferredPayment/refund-deferredPayment.hermione.ts

tags: smoke

Сервис: Отели
Страница: Страница заказа
Автор: iliasova
Устройство:
    - Тач
    - Десктоп
Функциональность:
    - Рассрочки
    - Промокод
Окружение:
    - Testing
    - Production
Тестирование асессорами: Нет
