feature: ТК Авиа
description: |
    Описание перехода на бронирование для команды: https://testpalm.yandex-team.ru/testcase/clone_travel-930
    Описание перехода на бронирование для асессоров: https://testpalm.yandex-team.ru/testcase/clone_travel-931

specs:
    Изменение цены при переходе на бой:
        - do: Дернуть ручку тестового контекста https://api.travel-balancer-test.yandex.net/api/test_context/v1/avia_token?checkAvailabilityOnRedirOutcome=CAOR_PRICE_CHANGED&checkAvailabilityBeforeBookingOutcome=CAO_SUCCESS&tokenizationOutcome=TO_SUCCESS&confirmationOutcome=CO_SUCCESS&mqEventOutcome=MEO_NO_EVENT
        - do: Положить значение из "token" в куку variantTestContext, из "payment_token" в куку paymentTestContext
        - do: Перейти на страницу бронирования (шаги описаны в Description)
        - assert: |
            Открылась страница бронирования
            Появился модал "Цена изменилась". У него две кнопки: "Продолжить бронирование","Вернуться к результатам поиска"
        - do: Нажать "Продолжить бронирование"
        - assert: |
            Модал закрылся
            В корзинке появилась вторая цена и в блоке тарифов и в блоке итого. Новая цена на 10р больше исходной.
            В корзинке появился лейбл "Цена изменилась после уточнения предложения у Авиакомпании."
        - do: Запомнить новую цену
        - do: Заполнить данные о пассажирах валидными данными
        - assert: |
            Открылась страница оплаты
        - do: Выполнить оплату
        - assert: Открылась страница happy page "Вы успешно забронировали билеты"
        - do: Кликнуть по кнопке Подробнее о заказе.
        - assert: |
            Перешли на страницу заказа в ЛК.
            Оплаченная сумма в корзинке равна той, что мы запомнили в п.3

files:
    - tests/common/avia/booking/booking-price-changed-boy.hermione.ts

tags: smoke

Сервис: Авиа
Функциональность: BOY
Устройство:
    - Десктоп
    - Тач
Окружение:
    - Testing
Тестирование асессорами: Нет
