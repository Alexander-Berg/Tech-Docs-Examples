feature: Отели
type: Страница заказа
description: >-
  Для выполнения кейса нужно иметь бронь, оплаченную в рассрочку, для этого
  можно пройти кейс https://testpalm.yandex-team.ru/testcase/travel-1398
specs:
  Отели. Обработка ошибки при доплате брони:
    - do: 'Перейти на страницу заказа, оплаченного в рассрочку (с промокодом)'
    - assert: |-
        Открылась страница заказа в лк
        На странице есть кнопка Доплатить и сумма доплаты (с учетом промокода)
    - do: Кликнуть Доплатить
    - assert: >-
        В новой вкладке появился лоадер Подготовка оплаты проверяем заказ и
        готовимся к оплате

        Далее в той же вкладке произошел переход на оплату

        В форме оплаты есть "Доплата" и указана сумма, равная сумме доплаты на
        странице заказа
    - do: Обновить страницу или ввести данные карты с CVC 999 и нажать Оплатить
    - assert: >-
        После прокрутки лоадеров на странице оплаты появляется модал с указанием
        причины ошибки оплаты, суммой и двумя кнопками - Отмена и Попробовать
        еще раз

        Сумма в модале совпадает с суммой доплаты на предыдущем шаге
    - do: Кликнуть по кнопке Отмена
    - assert: >-
        Произошел переход на страницу заказа в лк

        Внешний вид страницы не изменился - есть инфа про рассрочку и доплату и
        кнопка Доплатить
    - do: Повторить шаги 2-3
    - assert: ОР соответствует результатам в 2-3
    - do: Кликнуть в модале Попробовать еще раз
    - assert: >-
        Загрузилась форма оплаты

        В форме есть заголовок Доплата и указана сумма доплаты, совпадающая с
        суммой на странице заказа
    - do: |-
        Ввести валидные данные карты
        Нажать Оплатить
    - assert: >-
        После прогрузки всех необходимых лоадеров произошел переход на хэппи
        пейдж

        В заголовке отображается "Отель оплачен полностью"

        Информация про внесении доплаты отсутствует
manual: true
Функциональность:
  - Рассрочки
  - Промокод
Устройство:
  - Тач
  - Десктоп
Страница: Страница заказа
Сервис: Отели
Тестирование асессорами: Нет
Окружение:
  - Production
  - Testing
Автор: iliasova
