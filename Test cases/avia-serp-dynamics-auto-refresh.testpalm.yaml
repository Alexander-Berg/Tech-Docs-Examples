feature: Авиа
type: Выдача
description: ''
specs:
  'Автопрогрев неизвестных дат в Динамике цен':
    - do: 'Открыть главную страницу Путешествий, вкладка Авиабилеты'
    - do: |-
        Заполнить форму поиска билетов
        Откуда: Москва
        Куда: Кейптаун
        Туда: 5 число следующего месяца
        Обратно: любое другое число следующего месяца, для которого нет цены в календаре
        Пассажиры: 1 взрослый
        Класс: Эконом
    - do: Нажать кнопку "Найти"
    - assert: >-
        Открылась страница выдачи.

        На выдаче присутствует блок Динамики цен.

        Десктоп: https://jing.yandex-team.ru/files/gouken67/1442_1_desktop.png

        Тач: https://jing.yandex-team.ru/files/gouken67/1442_1_touch.png

        Десктоп: В блоке 7 кнопок с ценами: кнопка для текущего дня и 6 кнопок за +- 3 ближайших дня.

        Тач: В блоке 3 кнопки с ценами и одна кнопка Смотреть. Кнопки с ценами содержат цены и даты для текущего дня и +-1 ближайших дня.

        Цены на кнопках постепенно меняются на более дешёвые.
    - do: |-
        Дождаться, когда на всех кнопках будут получены точные цены (без значка ~).
        Кликнуть по Смотреть весь календарь.
    - assert: |-
        Десктоп: Открывается окно Динамики цен.
        Выбрана вкладка Таблица цен. Клетка, соответствующая датам Туда-Обратно на выдаче, выделена жёлтым цветом.
        Происходит обновление цен для промежутков, на которые цена была неизвестна (лежат по диагонали от выделенной клетки), а также на 6 дополнительных клеток вокруг жёлтой.

        https://jing.yandex-team.ru/files/gouken67/1443_3.png

        Тач: Открывается шторка Динамики цен.
        Происходит, либо уже завершилось получение цен за 6 ближайших дней.

        https://jing.yandex-team.ru/files/gouken67/dynamics-auto-refresh-touch-1.png
    - do: Кликнуть по клетке с уже известной ценой
    - assert: |-
        Осуществляется переход на выдачу Москва - Кейптаун для выбранного дня.
        Самая дешёвая цена на выдаче совпадает с тем, что было указано на кнопке в блоке Динамики цен.
    - do: |-
        Дождаться окончания опроса партнёров
        Через 1 мин. открыть календарь в форме поиска для поля Туда
    - assert: |-
        Под датой обратно стоит цена, равная стоимости минимального предложения на выдаче

        https://jing.yandex-team.ru/files/gouken67/dynamics-auto-refresh-touch-2.png
manual: true
Функциональность: Динамика
Устройство:
    - Десктоп
    - Тач
Страница: Выдача
Сервис: Авиа
Тестирование асессорами: Да
Окружение:
    - Testing
    - Production
Автор: gouken67
