feature: Саджест
type: Базовые подсказки

specs:
  beforeEach:
    - do: авторизоваться в Яндексе
    - assert: авторизация в Яндекс выполнена
    - do: на странице настроек поиска включить показ истории поиска
    - assert: чекбокс показа истории поиска включен
    - screenshot: примерный внешний вид [https://jing.yandex-team.ru/files/etestova/STF_2021-04-02_14-28-08.png]
    - do: получить выдачу по запросу "тест"
    - assert: получена выдача по указанному запросу
    - do: кликнуть в кнопку "х" поисковой стрелки
    - assert: поисковая стрелка очищена
    - assert: инпут активен
    - assert: саджест открыт
  Пословные и полнотектовые подсказки - горизонтальная ориентация:
    - tags: [smoke_extended, suggest_regress]
    - do: поверните телефон в горизонтальную ориентацию
    - do: введите в поисковую стрелку "новости"
    - assert: элементы саджеста обновились
    - assert: в саджесте присутствуют пословные подсказки
    - screenshot: пример внешнего вида (могут отсутствовать полнотекстовые подсказки) [suggest/hints/landscape/tpah_fulltext]
    - assertMetrics: '*'
  Пословные подсказки:
    - tags: [smoke_extended, suggest_regress]
    - do: введите в поисковую стрелку "путин"
    - assert: элементы саджеста обновились
    - assert: в саджесте присутствуют пословные подсказки
    - screenshot: пример внешнего вида (могут отсутствовать полнотекстовые подсказки) [suggest/hints/portrait/tpah_fulltext]
    - do: кликнуть в первую пословную подсказку
    - assert: тект выбранной пословной подсказки добавлен в инпут
    - assert: элементы саджеста обновились
    - assert: выдача не была перезагружена
    - assertMetrics: '*'
  Пословные подсказки - выборка всех вариантов:
    - tags: [smoke_extended, suggest_regress]
    - do: введите в поисковую стрелку "канбан что"
    - assert: элементы саджеста обновились
    - assert: в саджесте присутствуют пословные подсказки
    - do: кликнуть в первую пословную подсказку
    - assert: текст выбранной пословной подсказки добавлен в инпут
    - assert: элементы саджеста обновились
    - assert: выдача не была перезагружена
    - do: повторять предыдущий шаг пока пословные подсказки не закончатся
    - assert: в саджесте нет пословных подсказок
    - assert: в поисковой стрелке присутствует текст, состоящий из изначального запроса "канбан что" + все выбранные пословные подсказки в порядке их добавления
    - do: кликнуть в кнопку "Найти"
    - assert: выдача перезагрузилась
    - assert: получена выдача по запросу, состоящему из изначального запроса "канбан что" + все выбранные пословные подсказки в порядке их добавления
    - assertMetrics: '*'
  Навигационная подсказка:
    - tags: [smoke_extended, suggest_regress]
    - do: введите в поисковую стрелку "Яндекс переводчик"
    - assert: в саджесте присутствует навигационная подсказка "Яндекс.Переводчик" с зеленой ссылкой (если навигационная подсказка не отобразилась, попробуйте ввести названия других сервисов Яндекса, например "Яндекс почта", "Яндекс музыка", "Яндекс маркет")
    - screenshot: примерный внешний вид [suggest/hints/portrait/nav]
    - do: кликнуть в навигационную подсказку
    - assert: ссылка открылась (в новой вкладке, в той же вкладке, в приложении - не имеет значения)
    - assertMetrics: '*'
  Навигационная подсказка с длинным тайтлом и гринурлом:
    - tags: [smoke_extended, suggest_regress, no_assessors] #Ждём https://st.yandex-team.ru/SUGGEST-2154
    - do: введите в поисковую стрелку "Яндекс переводчик"
    - assert: в саджесте присутствует навигационная подсказка "Яндекс.Переводчик" с зеленой ссылкой (если навигационная подсказка не отобразилась, попробуйте ввести названия других сервисов Яндекса, например "Яндекс почта", "Яндекс музыка", "Яндекс маркет")
    - screenshot: примерный внешний вид [suggest/hints/portrait/nav-long]
    - do: кликнуть в навигационную подсказку
    - assert: ссылка открылась  (в новой вкладке, в той же вкладке, в приложении - не имеет значения)
    - assertMetrics: '*'
  Навигационная подсказка - горизонтальная ориентация:
    - tags: [smoke_extended]
    - do: поверните телефон в горизонтальную ориентацию
    - do: введите в поисковую стрелку "Яндекс переводчик"
    - assert: в саджесте присутствует навигационная подсказка "Яндекс.Переводчик" с зеленой ссылкой (если навигационная подсказка не отобразилась, попробуйте ввести названия других сервисов Яндекса, например "Яндекс почта", "Яндекс музыка", "Яндекс маркет")
    - screenshot: примерный внешний вид [suggest/hints/landscape/nav]
    - assertMetrics: '*'
  Фактовая подсказка - Длина окружности:
    - tags: [smoke_extended, suggest_regress]
    - do: введите в поисковую стрелку "длина окружности"
    - assert: элементы саджеста обновились
    - assert: в саджесте присутствует фактовая подсказка "длина окружности"
    - screenshot: примерный внешний вид (факт может быть многострочным, длинным, содержать источник) [suggest/hints/portrait/fact]
    - do: кликнуть в фактовую подсказку
    - assert: выдача перезагружена
    - assert: саджест закрыт
    - assert: в поисковой стрелке отображается запрос "длина окружности"
    - assert: получена релевантная запросу выдача
    - assertMetrics: '*'
  Исторические подсказки - наличие:
    - tags: [smoke_extended, suggest_regress]
    - assert: в саджесте отображается историческая подсказка "тест"
    - screenshot: примерный внешний вид [suggest/hints/portrait/history]
    - assertMetrics: '*'
  Исторические подсказки - удаление:
    - tags: [smoke_extended, suggest_regress]
    - do: изменить запрос на "тест на психику"
    - do: нажать кнопку "Найти"
    - assert: выдача перезагружена
    - do: нажать в кнопку "х" поисковой стрелки
    - assert: саджест открыт, среди пунктов присутствует историческая подсказка
    - screenshot: примерный внешний вид [suggest/hints/portrait/history_tpah]
    - do: кликнуть в крестик справа от исторической подсказки
    - assert: историческия подсказка "тест на психику" исчезла
    - tech: произошёл аякс запрос (https://suggest.yandex.ru/suggest-delete-text?srv=web&text_to_delete=подсказка)
    - do: получить выдачу по запросу "vk"
    - assert: получена выдача по указанному запросу
    - do: кликнуть в кнопку "х" поисковой стрелки
    - assert: поисковая стрелка очищена
    - assert: инпут активен
    - assert: саджест открыт
    - assert: удаленная историческая подсказка "тест на психику" отсутствует в саджесте
    - assert: историческая подсказка "vk" присутствует в саджесте
  Исторические подсказки - клик:
    - tags: [smoke_extended, suggest_regress]
    - assert: в саджесте отображается историческая подсказка "тест"
    - do: ввести в поисковую стрелку запрос "Новости" и нажать кнопку "Найти"
    - assert: выдача перезагружена
    - assert: саджест закрыт
    - do: кликнуть в кнопку "х" поисковой стрелки
    - assert: поисковая стрелка очищена
    - assert: инпут активен
    - assert: саджест открыт
    - assert: в открытом саджесте присутствуют исторические подсказки "новости" и "тест"
    - do: кликнуть в историческую подсказку "тест"
    - assert: выдача перезагружена
    - assert: саджест закрыт
    - assert: в поисковой стрелке отображается запрос "тест"
    - assert: получена релевантная запросу выдача
    - assertMetrics: '*'

specs-integration:
  tags: no_assessors
  beforeEach:
    - do: получить выдачу по запросу "тест"
    - assert: получена выдача по указанному запросу
    - do: кликнуть в кнопку "х" поисковой стрелки
    - assert: поисковая стрелка очищена
    - assert: инпут активен
    - assert: саджест открыт
  Пословные подсказки:
    - do: введите в поисковую стрелку "новости"
    - assert: элементы саджеста обновились
    - do: кликнуть в первую пословную подсказку
    - assert: тект выбранной пословной подсказки добавлен в инпут
    - assert: элементы саджеста обновились
  Навигационная подсказка:
    - do: введите в поисковую стрелку "youtube"
    - assert: в саджесте присутствует навигационная подсказка
    - do: кликнуть в навигационную подсказку
    - assert: ссылка открылась в новой вкладке
  Фактовая подсказка:
    - do: введите в поисковую стрелку "сколько дней в году "
    - assert: в саджесте присутствует фактовая подсказка
    - do: кликнуть в фактовую подсказку
    - assert: выдача перезагружена
    - assert: текст в поисковой строке равен тексту подзаголовка выбранной фактовой подсказки
  Карусельная фактовая подсказка:
    - do: введите в поисковую стрелку "погода в москве"
    - assert: в саджесте присутствует карусельная фактовая подсказка
    - do: кликнуть в карусельную фактовую подсказку
    - assert: выдача перезагружена
    - assert: текст в поисковой строке равен тексту подзаголовка выбранной фактовой подсказки
  Исторические подсказки:
    - do: залогиниться в Яндексе
    - assert: логин в Яндекс выполнен
    - do: проверить, что на странице настроек поиска включен показ истории поиска
    - assert: показ истории поиска включен
    - do: получить выдачу по запросу "вк"
    - assert: получена выдача по указанному запросу
    - do: очистить поисковую стрелку
    - assert: в открытом саджесте присутствует историческая подсказка "вк"

files:
  - features/touch-phone/suggest/suggest-hint.hermione.js
  - features/touch-phone/suggest/suggest-hint.hermione.e2e.js

tags:
  - suggest
  - input

browsers:
  notFor:
    - searchapp-phone-group

v-team: Suggest

priority: high

tlds:
  - ru
  - by
  - ua
  - kz
  - uz
  - com
  - com.tr
