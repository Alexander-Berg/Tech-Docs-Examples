feature: Обновление приложения

import-steps:
    - tests/hermione/suites/desktopApp/shared-steps/setup.testpalm.steps.yml

tlds: none

specs:
    beforeEach:
        - attach: Скачивание архива с последним зарелиженным приложением
        - attach: Установка приложения

    Обновление версии приложения по кнопке 'update' (только Windows и Mac)[manual]:
        - automation: MSSNGRFRONT-3314
        - do: запомните версию установленного приложения (назовем ее X)
        - do: открыть в браузере https://download.messenger.test.yandex-team.ru/desktop/update
        - do: на странице будет видна последняя доступная версия на тестовом сервере обновлений, запомните эту версию (назовем ее Y)
        - screenshot: ответ будет выглядеть примерно так [https://jing.yandex-team.ru/files/apanichkina/Screen%20Shot%202019-06-20%20at%2010.06.49%20PM.png]
        - assert: найденная версия Y должна быть больше X (обратитесь к релиз инженеру, если это не так)
        - do: найти иконку приложения в tray
        - do: нажать по иконке ПКМ(ЛКМ на Windows) и в появившемся меню нажать Quit(Выйти)
        - assert: |
              окно приложение закрылось
              в tray иконка пропала
        - do: выполнить в консоли следующий код https://paste.yandex-team.ru/744205
        - do: подождать 6-15 минут, пока скачается обновление (это происходит в фоне и длительность зависит от скорости интернета)
        - assert: в приложении появилась синяя плашка с текстом "Update available"(Доступно обновление) и кнопкой "Restart"(Перезагрузить)
        - do: нажать на кнопку "Restart"(Перезагрузить)
        - assert: приложение перезапустилось
        - assert: в консоли (откуда запустили приложение) нет ошибок (пример ошибки https://paste.yandex-team.ru/709963)
        - do: открыть настройки (нажать на шестеренку)
        - assert: версия приложения обновилась в бОльшую сторону и соответствует Y


    Обновление версии приложения через переустановку[manual]:
        - automation: MSSNGRFRONT-3314
        - attach: Скачивание архива с последним предрелизным приложением
        - do: запустить установку только что скаченного приложения
        - do: нажать ОК в появившемся попапе с примерным содержанием "Остановить приложение перед удалением?"
        - assert: |
              запущенное приложение (старой версии) автоматически закрылось
              нет системных ошибок о недоверенном источнике приложения
              новое приложение автоматически запущенно после установки
        - do: открыть настройки (нажать на шестеренку)
        - assert: версия приложения соответствует новому установленному приложению


files: []

v-team: Chat

tags:
    - no_assessors
    - desktop-app
