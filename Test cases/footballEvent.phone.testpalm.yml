feature: Страница футбольного матча

specs-integration:
  содержит рекламные блоки и ленту новостей:
    - do: перейти на страницу футбольного матча по клику на матч
    - assert: |
        новостные карточки спорта отображаются под блоками,
        в новостой ленте присутствуют рекламные блоки
    - do: кликнуть на любую рубрику в рубрикаторе
    - assert: |
        происходит переход в выбранную рубрику,
        в рубрикаторе выделена выбранная рубрика

  содержит Новости футбола:
    - tags: 
      - backend_sport  
    - do: тапнуть на вкладку Вчера или если вчера матчей не было тапнуть на дата-пикер и установить дату 5 декабря 2020
    - assert: открыт список матчей за вчера (или за 5 декабря)
    - do: перейти на страницу футбольного матча тапом на любой матч
    - do: поскроллить матч ниже блоков видео, 'Ход матча', 'Состав' до блока 'Новости футбола'
    - assert: страница матча содержит новостные карточки
    - do: проскроллить страницу матча до лоадера
    - assert: загружаются новые карточки
    - do: проскроллить страницу на несколько порций карточек
    - assert: |
        новостной блок помимо новостных карточек может содержать карточки с каруселями видео и рекламные блоки,
        Обратите внимание! Каруселей может и не быть, это нормально, заводить на такое баги не нужно!
    - do: тапнуть по заголовку или картинке любой новостной карточки
    - assert: в этой же вкладке открывается страница сюжета
    - do: вернуться назад на страницу футбольного матча
    - do: тапнуть по любому видео в любой карусели (если карусели видео нет, пропустить шаг)
    - assert: в новой вкладке открывается страница с видео

  может переключать состав команд в блоке Состав:
    - do: тапнуть по переключателю в блоке Состав
    - assert: |
        с анимацией отобразился состав второй команды,
        в блоке с переключателем выделена вторая команда

specs:

  aliases:
    &goTo
      - do: открыть главную страницу сервиса Я.Спорт
      - do: тапнуть на Матч-центр в рубрикаторе
      - assert: |
          произошел переход в матч-центр,
          в рубрикаторе выделена рубрика Матч-центр,
          в подрубрикаторе выделена вкладка Футбол и открыт футбольный календарь на вкладке Сегодня,
          в календаре присутствует дата-пикер,
          внешний вид - https://jing.yandex-team.ru/files/nightsonne/2020-04-13_19-17-24.png,
          обртите внимание! если матчей нет ни вчера, ни сегодня, ни завтра - ни одна вкладка календаря не будет выделена, а будет заглушка о том, что событий не найдено - это ок, заводить на такое баги не нужно! если матчи есть вчера - будет выделена вкладка "Вчера"

  может содержать иконку-индикатор видео:
    - *goTo
    - do: тапнуть на вкладку Вчера или если вчера матчей не было тапнуть на дата-пикер и установить дату 5 декабря 2020
    - assert: |
        открыт список матчей за вчера (или за 5 декабря),
        некоторые матчи содержат иконку-индикатор видео, 
        внешний вид - https://jing.yandex-team.ru/files/nightsonne/2019-11-11_18-19-20.png
# закомментила, потому что видео в матче проверяются в рамках лайв-страницы (для бразилии и фнл) + есть проверка для хоккейных матчей, этого достаточно
#    - do: перейти на страницу футбольного матча тапом на матч с иконкой видео в разделе 'Вчера' или 'Сегодня'
#    - assert: |
#          страница матча может содержать большое видео, скрин https://jing.yandex-team.ru/files/nightsonne/2019-11-11_18-20-12.png,
#          под большим видео расположено название видео,
#          под большим видео может быть расположена карусель видео моментов матча
#    - do: тапнуть на большое видео
#    - assert: в новой вкладке открывается видео матча (на сервисе Яндекс.Эфир, sportbox и тд)
#    - do: вернуться на вкладку с матчем
#    - do: поскроллить карусель видео
#    - assert: |
#          карусель скроллится,
#          каждое видео содержит подпись момента (максимум 2 строки),
#          длинные названия моментов корректно обрезаются многоточием
#    - do: тапнуть на любое видео в карусели
#    - assert: в новой вкладке открывается видео момента

  из списка прошедших матчей содержит футбольный виджет:
    - tags: 
      - backend_sport    
    - *goTo    
    - do: тапнуть на вкладку Вчера или если вчера матчей не было тапнуть на дата-пикер и установить дату 5 декабря 2020
    - assert: открыт список матчей за вчера (или за 5 декабря)
    - do: перейти на страницу футбольного матча тапом на матч со счетом
    - assert: |
        страница матча содержит футбольный виджет,
        виджет содержит название чемпионата, статус матча, для завершенных матчей - дату завершения, названия команд, счет,
        счет и название команды-победителя выделено жирным шрифтом,
        внешний вид - https://jing.yandex-team.ru/files/an-smirn0v/Снимок%20экрана%202021-11-29%20в%2015.08.31.png

  из блока 'Завтра' содержит футбольный виджет [manual]:
    - tags: backend_sport  
    - reasonNotToAuto:
      - Нет возможности автоматизировать, т.к. во внутренних функциях берется не время запроса из данных, а new Date(), поэтому "завтра" становится "сегодня" на следующий день, а тест падает.
    - *goTo
    - do: тапнуть на вкладку Завтра
    - do: перейти на страницу футбольного матча тапом на матч в разделе 'Завтра' (если раздела нет - найти другой матч)
    - assert: |
        страница матча содержит футбольный виджет,
        виджет содержит название чемпионата, названия команд, время начала матча, надпись 'Завтра',
        внешний вид - https://jing.yandex-team.ru/files/an-smirn0v/Снимок%20экрана%202021-11-29%20в%2015.09.35.png

  из списка прошедших матчей может содержать блок Ход матча:
    - tags: 
      - backend_sport    
    - *goTo  
    - do: тапнуть на вкладку Вчера или если вчера матчей не было тапнуть на дата-пикер и установить дату 5 декабря 2020
    - assert: открыт список матчей за вчера (или за 5 декабря)
    - do: перейти на страницу футбольного матча тапом на матч со счетом
    - assert: |
        страница матча может содержать блок 'Ход матча' (если в данном матче блока нет, открыть другой матч),
        блок содержит логотипы команд или флаги стран,
        рядом с каждым событием указана минута матча,
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2021-09-07_15-39-30.png
    - do: найти в блоке 'Ход матча' гол или гол с пенальти
    - assert: |
        голы отмечены значком мяча, пенальти - иконкой с буквой 'П' поверх мяча,
        рядом со значком мяча указана фамилия игрока, забившего гол,
        над фамилией игрока есть надпись 'Гооол!' серым шрифтом,
        под фамилией игрока серым шрифтом может быть указан игрок, отдавший пас,
        под фамилией игрока может быть иконка видео голевого момента с кнопкой плэй (видео может и не быть, это ок, заводить на такое баг не нужно),
        внешний вид - https://jing.yandex-team.ru/files/nightsonne/2019-11-11_18-39-50.png
    - do: тапнуть по иконке видео рядом с голом (пропустить шаг, если видео не нашлось)
    - assert: в новой вкладке открывается видео голевого момента
    - do: вернуться на вкладку с матчем
    - do: найти в блоке 'Ход матча' событие выдачи желтой или красной карточки
    - assert: |
        карточки отмечены значком соответствующего цвета,
        рядом со значком указана фамилия игрока, которому выдана карточка,
        над фамилией игрока есть надпись 'Желтая карточка' или 'Красная карточка' серым шрифтом
    - do: найти в блоке 'Ход матча' событие замены игрока
    - assert: |
        замены отмечены цветными стрелками,
        фамилия замененного игрока отображена серым шрифтом,
        фамилия заменяющего игрока отображена черным шрифтом,
        над фамилиями игроков есть надпись 'Замена' серым шрифтом,
        внешний вид - https://jing.yandex-team.ru/files/nightsonne/2019-11-11_18-45-51.png

  из списка прошедших матчей может содержать блок Состав:
    - tags: 
      - backend_sport    
    - *goTo   
    - do: тапнуть на вкладку Вчера или если вчера матчей не было тапнуть на дата-пикер и установить дату 5 декабря 2020
    - assert: открыт список матчей за вчера (или за 5 декабря)
    - do: перейти на страницу футбольного матча тапом на матч со счетом
    - assert: |
        страница матча может содержать блок 'Состав' (если в данном матче блока нет, открыть другой матч),
        в блоке есть переключатель состава команд с лого и названием команд,
        длинные названия команд корректно обрезаются многоточнием в переключателе и не выходят за рамки блока переключателя,
        по умолчанию отображается состав первой команды,
        номер и позиция игрока отображены серым шрифтом (позиция игрока сокращена - вр, пз, зщ, нп),
        внешний вид - https://jing.yandex-team.ru/files/nightsonne/2019-11-11_18-48-23.png
    - do: тапнуть по переключателю
    - assert: |
        с анимацией отобразился состав второй команды,
        в блоке с переключателем выделена вторая команда
    - do: найти в блоке 'Состав' гол или гол с пенальти
    - assert: |
         рядом с фамилией игрока, забившего гол, есть иконка мяча и счетчик с количеством голов,
         внещний вид - https://jing.yandex-team.ru/files/nightsonne/2019-11-11_18-56-27.png
    - do: найти в блоке 'Состав' событие замены игрока
    - assert: |
        замены отмечены цветными стрелками,
        рядом с фамилией замененного игрока указана минута замены,
        внешний вид - https://jing.yandex-team.ru/files/nightsonne/2019-11-11_18-52-41.png
    - do: найти в блоке 'Состав' событие событие выдачи желтой или красной карточки
    - assert: справа от фамилии игрока есть значок красной или желтой карточки
    - do: проскроллить до конца блока 'Состав'
    - assert: внизу указан тренер команды

  из списка прошедших матчей может содержать турнирную таблицу:
    - tags: 
      - backend_sport    
    - *goTo  
    - do: тапнуть на вкладку Вчера или если вчера матчей не было тапнуть на дата-пикер и установить дату 5 декабря 2020
    - assert: открыт список матчей за вчера (или за 5 декабря)
    - do: перейти на страницу футбольного матча тапом на матч со счетом
    - do: поскроллить матч ниже блоков видео, 'Ход матча', 'Состав'
    - assert: |
        страница матча может содержать блок 'Турнирная таблица' (если в данном матче блока нет, открыть другой матч),
        если есть вкладки групп - по умолчанию открыта вкладка той группы, к которой относятся команды данного матча,
        команды данного матча выделены жирным шрифтом,
        верстка таблицы корректна,
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2021-09-07_13-02-50.png
    - do: попереключать вкладки групп в таблице (если есть)
    - assert: вкладки переключаются, отображается новый список команд

  из списка прошедших матчей может содержать блок Другие матчи:
    - tags: 
      - backend_sport    
    - *goTo
    - do: тапнуть на вкладку Вчера или если вчера матчей не было тапнуть на дата-пикер и установить дату 5 декабря 2020
    - assert: открыт список матчей за вчера (или за 5 декабря)
    - do: перейти на страницу футбольного матча тапом на матч со счетом
    - do: поскроллить матч ниже блоков видео, 'Ход матча', 'Состав', 'Турнирная таблица'
    - assert: |
        страница матча может содержать блок 'Другие матчи' (если в данном матче блока нет, открыть другой матч),
        блок содержит названия и лого команд, время, дату, счет (в зависимости от того прошел матч или нет),
        обратите внимание! время в блоке 'Другие матчи' отображается только для предстоящих матчей, для прошедших - дата или 'Вчера' (редко - 'Сегодня', если матч закончился сегодня),
        внизу есть кнопка 'Все матчи',
        верстка блока корректна,
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2021-09-07_14-45-57.png
    - do: тапнуть на любой матч в блоке 'Другие матчи'
    - assert: в той же вкладке открывается страница выбранного матча
    - do: вернуться назад
    - do: тапнуть на 'Все матчи'
    - assert: в той же вкладке открывается страница футбольного календаря

  отображает корректное время начала матча в разных часовых поясах [manual]:
    - tags:
      - backend_sport
    - reasonNotToAuto: 
      - Нет возможности сменить регион в автотесте  
    - do: перейти на страницу https://yandex.ru/tune/geo, выставить город "Торонто" и тапнуть на кнопку "Сохранить" 
    - do: открыть страницу футбольного календаря https://yandex.ru/sport/calendar/football
    - assert: |
        на странице присутствует календарь, по умолчанию открыта вкладка "Сегодня", название вкладки выделено шрифтом,
        обратите внимание! если сегодня матчей нет, в календаре присутствует плашка "Сегодня событий не найдено. Показаны ближайшие", Это ок, заводить баги на такое на нужно!
        внешний вид - https://jing.yandex-team.ru/files/umansai5/2022-07-14%2016.16.28.jpg  
    - do: кликнуть по любому не начавшемуся матчу 
    - assert: |
        открылась страница выбранного матча,
        страница матча содержит футбольный виджет,
        виджет содержит название чемпионата, названия команд, время начала матча,
        внешний вид - https://jing.yandex-team.ru/files/umansai5/2022-07-14%2016.16.24.jpg
    - do: открыть в соседней вкладке страницу https://yandex.ru/tune/geo, выставить город "Сеул" и тапнуть на кнопку "Сохранить"        
    - do: вернуться на страницу матча и обновить страницу
    - assert: |
        страница обновилась,
        в виджете изменилась информация о дате и времени начала матча, согласно новому часовому поясу, +13 часов от Торонто,
        внешний вид - https://jing.yandex-team.ru/files/umansai5/2022-07-14%2016.16.33.jpg    

#связанных новостей пока нет
#  из списка прошедших матчей может содержать карточки о связанных с матчем новостях [manual]:
#    - *goTo
#    - do: тапнуть на вкладку Вчера или если вчера матчей не было тапнуть на дата-пикер и установить дату 5 декабря 2020
#    - assert: открыт список матчей за вчера (или за 5 декабря)
#    - do: перейти на страницу футбольного матча тапом на матч со счетом
#    - do: поскроллить матч ниже блоков видео, 'Ход матча', 'Состав', но ДО блока 'Новости футбола'
#    - assert: |
#        страница матча может содержать карточки о связанных с матчем новостях (если в данном матче карточек нет, открыть другой матч),
#        карточки о связанных с матчем новостях (при наличии располагаются над заголовком Новости футбола) содержат иконку добавления в избранное (но не сожержат иконку лайка и комментария),
#        скрин https://jing.yandex-team.ru/files/nightsonne/2019-11-11_19-00-38.png
#    - do: тапнуть по любой карточке о связанных с матчем новостях
#    - assert: в новой вкладке открывается страница источника

  отсутствует лишний разделительный маркер в неначавшемся матче:
    - do: открыть ненчавшейся матч https://yandex.ru/sport/event/m531524
    - assert: в матче отсутвует лишний разделительный маркер

files:
  - features/sport/event/footballEvent.phone.hermione.js
  - features/sport/event/footballEvent.phone.hermione.e2e.js

tags:
  - sport-neo
  - event

manager: mrwhite

qa-engineer: an-smirn0v

tlds:
  - ru
  - by
  - kz
  - uz
  - ua
  - com
