feature: Администрирование группового чата

import-steps:
    - tests/hermione/suites/messenger/shared-steps/open-messenger.testpalm.steps.yml

specs:
    beforeEach:
        - attach: Открытие чата q
        - do: нажать на иконку создания чата (справа от поиска по чатам)
        - do: нажать "Новый групповой чат"
        - assert: открылось окно поиска по контактам
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-08-02T17:53:36.jpg]
        - do: найти в поиске и выбрать бота "Автотестер Мессенджеров"
        - assert: |
                бот отображается в блоке добавленных участников
                в основном списке напротив имени бота стоит галочка
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-08-02T17:58:37.jpg]
        - do: нажать далее
        - do: написать любое название чата и описание
        - do: нажать готово
        - assert: |
                создался и сразу открылся новый чат
                если в браузере включены пуши, то всплыл пуш "Вас добавили в чат *название чата*"
        - screenshot: пример внешнего вида для десктопа [https://jing.yandex-team.ru/files/ismateush/uhura_2019-08-02T18:08:23.jpg]

    Управление учатниками группового чата админом[manual]:
        - automation: MSSNGRFRONT-3154
        - do: нажать на троеточие в правом верхнем углу чата
        - do: в выпадающем меню выбрать "Информация о чате"
        - assert: открылось окно информации о чате
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-08-15T14:17:51.454942.jpg]
        - do: кликнуть на "Добавить участников"
        - do: открылось окно поиска сотрудников
        - do: найти в поиске и добавить Афанасий Петрович (любой из 2х)
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-10-04T13:20:43.944451.jpg]
        - do: нажать добавить
        - assert: |
                количество участников в шапке чата изменилось и отображается верно
                в контейнере чата отображается информация о добавленных сотрудниках
                по клику на имя сотрудника открывается информация о нём
        - do: найти в поиске и добавить Афанасий Петрович
        - assert: |
                в списке найденых сотрудников, добавленный сотрудник задизейблен
                в списке найденых сотрудников, у добавленного сотрудника отсутствует чекбокс
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/stepler/Screenshot%202019-10-16%20at%2019.13.39.png]
        - do: нажать на троеточие в правом верхнем углу чата
        - do: в выпадающем меню выбрать "Информация о чате"
        - assert: открылось окно информации о чате
        - do: в блоке "участники" кликнуть на троеточие справа от имени пользователя и выбрать пункт "Показать профиль"
        - assert: открылась информация о пользователе (может незначительно отличаться из-за доступов)
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-10-04T13:22:04.225411.jpg]
        - do: кликнуть на стрелочку "назад" рядом с заголовком "информация"
        - do: в блоке "участники" кликнуть на троеточие справа от имени пользователя и выбрать пункт "Сделать администратором"
        - assert: в карточке информации о группе пользователь переместился в блок администраторы
        - do: снова кликнуть на троеточие справа от имени этого пользователя и выбрать пункт "Убрать из администраторов"
        - assert: в карточке информации о группе пользователь переместился в блок участники
        - do: снова кликнуть на троеточие справа от имени этого пользователя и выбрать пункт "Удалить из чата"
        - do: подтвердить удаление во всплывающем окне
        - assert: пользователь больше не отображается в карточке информации о группе
        - do: закрыть карточку по крестику в шапке
        - assert:
                карточка закрылась
                в шапке информации о чате изменилось количество участников
                в контейнере чата отображается информация об удаленном из чата сотруднике
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-10-04T13:24:03.011951.jpeg]
        - do: снова добавить Афанасия Петровича в чат и сделать администратором
        - do: кликнуть на троеточие справа от имени и выбрать пункт "Удалить из чата"
        - assert: Петрович-администратор удален из чата
        - do: нажать на троеточие в правом верхнем углу чата
        - do: в выпадающем меню выбрать "покинуть чат"
        - do: подтвердить решение во всплывающем окне
        - assert: |
                чат закрыт
                отображается сообщение "Выберите чат для начала общения"

    Изменение аватара чата администратором[manual]:
        - automation: MSSNGRFRONT-3154
        - do: нажать на троеточие в правом верхнем углу чата
        - do: в выпадающем меню выбрать "Информация о чате"
        - assert: открылось окно информации о чате
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-08-15T14:17:51.454942.jpg]
        - do: кликнуть на иконку фото в заглушке аватарки
        - assert: открылся файловый менеджер
        - do: выбрать картинку на устройстве
        - assert: открылось окно масштабирования
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-08-15T15:13:52.817305.jpg]
        - do: сохранить
        - assert: аватар чата изменился
        - do: нажать на троеточие в правом верхнем углу чата
        - do: в выпадающем меню выбрать "покинуть чат"
        - do: подтвердить решение во всплывающем окне
        - assert: |
                чат закрыт
                отображается сообщение "Выберите чат для начала общения"

    Изменение информации о чате администратором[manual]:
        - automation: MSSNGRFRONT-3154
        - do: нажать на троеточие в правом верхнем углу чата
        - do: в выпадающем меню выбрать "Редактировать информацию о чате"
        - assert: открылось окно редактирования информации о группе
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-08-15T15:08:43.660615.jpg]
        - do: изменить название чата на любое и сохранить
        - assert: |
                название чата в шапке изменилось
                в контейнере чата появилось информационное сообщение о изменении названия
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-08-15T15:26:26.758223.jpg]
        - do: нажать на троеточие в правом верхнем углу чата
        - do: в выпадающем меню выбрать "Редактировать информацию о чате"
        - assert: открылось окно редактирования информации о группе
        - do: изменить описание чата на любое и сохранить
        - assert: в контейнере чата появилось информационное сообщение о изменении описания
        - do: нажать на троеточие в правом верхнем углу чата
        - do: в выпадающем меню выбрать "Информация о чате"
        - assert: описание чата в карточке соответствует измененному
        - do: нажать на троеточие в правом верхнем углу чата
        - do: в выпадающем меню выбрать "покинуть чат"
        - do: подтвердить решение во всплывающем окне
        - assert: |
                чат закрыт
                отображается сообщение "Выберите чат для начала общения"

    Запин сообщения в чате администратором[manual]:
        - automation: MSSNGRFRONT-3154
        - do: написать в чат сообщение /text
        - assert: бот "Автотестер Мессенджеров" присылает в ответ текстовое сообщение
        - do: кликнуть правой кнопкой мыши на свое сообщение
        - aseert: открылось контекстное меню
        - do: в контекстном меню выбрать "закрепить сообщение"
        - aseert: |
                сообщение закреплено в шапке чата
                в контейнере чата появилось сообщение об изменении инфрормации о группе
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-08-15T15:55:46.964235.jpg]
        - do: кликнуть правой кнопкой мыши на сообщение от бота
        - do: в контекстном меню выбрать "закрепить сообщение"
        - aseert: |
                закрепленное сообщение в шапке изменено на новое
                в контейнере чата появилось сообщение об изменении инфрормации о группе
        - do: отправить в чат много сообщений (так, чтобы закрепленное скрылось за шапкой)
        - do: кликнуть на закрепленное сообщение
        - assert: |
                осуществился подскролл к закрепленному сообщению,
                сообщение на секунду подсветилось
        - do: кликнуть на крестик справа в закрепленном сообщении
        - asseert: появилось окно подтверждения с текстом "Открепить сообщение?"
        - do: кликнуть на ок
        - assert: |
                сообщение пропало из шапки чата
                в контейнере чата появилось сообщение об изменении информации о группе
        - do: нажать на троеточие в правом верхнем углу чата
        - do: в выпадающем меню выбрать "покинуть чат"
        - do: подтвердить решение во всплывающем окне
        - assert: |
                чат закрыт
                отображается сообщение "Выберите чат для начала общения"

files: []

v-team: Chat

tlds: ru

tags:
    - q
    - release
    - y-team
