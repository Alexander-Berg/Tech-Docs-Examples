feature: ЖД
type: Страница заказа
description: |-
  Кейс для проверки покупки дежурным тестировщиком.
  Реквизиты тестовой карты: 5100003697253468, 12/22, 090
specs:
  'ЖД: Покупка билетов со страховкой, шаг оплаты включен':
    - do: >-
        Перейти на выдачу Москва - Санкт-Петербург через неделю

        Для любого поезда кликнуть по кнопке покупки

        Выбрать 3 пассажиров - 1 взрослого, 1 ребенка от 5 до 10 лет, 1 ребенка
        без места

        Выбрать места

        Нажать на кнопку “Указать пассажиров”

        Заполнить все поля валидными данными

        В поле электронной почты указать почту на @yandex-team.ru

        Нажать по кнопке “Проверить заказ и купить”
    - assert: |-
        * Осуществился переход на страницу подтверждения
        * Все данные о поезде и пассажирах соответствуют выбранным
        * В корзине есть чекбокс для добавления страховки
    - do: Нажать на чекбокс
    - assert: '* К итоговой сумме добавилась стоимость страховки'
    - do: |-
        Нажать на кнопку “Ввести карту и оплатить”
        На странице оплаты ввести данные тестовой карты из описания кейса
        Нажать на кнопку “Оплатить”
        На хэппи пейдж нажать на кнопку "Подробнее о заказе"
    - assert: >-
        * Произошел переход на страницу подробного заказа для 3 пассажиров

        * На странице есть кнопка “Скачать билеты и страховку” (в таче просто
        Скачать)

        * На почту пришло письмо о покупке (письмо может прийти в течение
        получаса, так как не будет чека)

        * Стоимость заказа в письме совпадает с итоговой суммой со страницы
        подтверждения (равна сумме за билеты + за страховки)

        * В письме есть блок “Страхование” с текстом “Стоимость страхового
        полиса: … руб. Он включает страхование жизни и здоровья всех пассажиров
        и находится в том же файле, что и посадочный купон.” и ссылкой
        “Подробнее об условиях”

        * Для каждого билета на странице успешной покупки есть пункт Страховка

        * При нажатии на иконку ? рядом с пунктом страховки появляется попап с
        текстом “Страхование жизни и здоровья от несчастных случаев.” и ссылкой
        “Подробнее об условиях.”, которая ведет на правила от Ренессанса

        * Сумма стоимостей страховки всех пассажиров совпадает с общей
        стоимостью на странице подтверждения

        * Для ребенка без места Цена билета и Сервисный сбор равны 0, Стоимость
        страховки равна 40

        * Для остальных билетов стоимость страховки рассчитана в зависимости от
        стоимости билета
    - do: Нажать на кнопку “Скачать билеты и страховку” (в таче просто Скачать)
    - assert: '* Произошло скачивание pdf-файла'
    - do: Открыть чек со страницы заказа
    - assert: >-
        * В чеке 3 позиции “Страхование поездки (страховая премия)”

        * Суммы за страховки и итоговая сумма в чеке совпадают с суммами в
        письме и на странице заказа
manual: true
Функциональность: Действия с заказом
Устройство:
  - Десктоп
  - Тач
Страница: Страница заказа
Сервис: ЖД
Тестирование асессорами: Нет
Окружение: Testing
Tag: Smoke
Автор: shenfeld
