feature: Дефолтная карточка товара

params:
  exp_flags:
    - turboforms_endpoint=https://test-turbo-forms.common.yandex.ru/
    - analytics-disabled=1

browsers:
  - ios-safari-12-touch
  - ios-safari-11-touch
  - ios-safari-10-touch
  - ios-safari-9-touch

specs:
  Основные проверки:
    - params:
        foreverdata: '3937911619'
    - do: получить выдачу по запросу 'foreverdata' и кликнуть в заголовок первого сниппета (название заголовка Тестовая страница для Дефолтной карточки товара — турбо)
    - screenshot: внешний вид соответствует скриншоту [plain]
    - tech: у формы в `data-bem` атрибуте в from не задан параметр `targetInSeparateTab`
    - do: нажать на кнопку 'Купить в 1 клик'
    - screenshot: внешний вид соответствует скриншоту [modal]

  Ошибка оформления:
    - params:
        foreverdata: '3937911619'
    - do: получить выдачу по запросу 'foreverdata' и кликнуть в заголовок первого сниппета (название заголовка Тестовая страница для Дефолтной карточки товара — турбо)
    - do: кликнуть в тайтл первого сниппета
    - assert: открылась карточка товара
    - do: нажать на кнопку 'Купить в 1 клик'
    - assert: открылась страница с формой оформления заказа
    - do: ввести имя "test"
    - do: ввести телефон "88001234567"
    - do: ввести email "test@test.ru"
    - do: ввести адрес "Адрес"
    - do: выключить интернет
    - do: нажать на кнопку "Отправить"
    - assert: появился попап "Подтверждение заказа"
    - assert: попап сменился попапом "Произошла ошибка"
    - do: нажать в попапе на "Повторить"
    - assert: попап закрылся и мы остались на странице с формой

  Успешное оформление:
    - params:
        foreverdata: '3937911619'
    - do: получить выдачу по запросу 'site:super01.ru каталог'
    - assert: в выдаче присутствует сниппет с карточками товаров
    - assert: примерный внешний вид [https://jing.yandex-team.ru/files/skurhanski/browser_7EaQT79tQf.png]
    - do: кликнуть по карточке любого товара
    - assert: открылась карточка товара
    - do: нажать на кнопку 'Купить в 1 клик'
    - assert: открылась страница с формой оформления заказа
    - do: ввести имя "test"
    - do: ввести телефон "88001234567"
    - do: ввести email "test@test.ru"
    - do: ввести адрес "Адрес"
    - do: нажать на кнопку "Отправить"
    - assert: появился попап "Подтверждение заказа"
    - assert: попап сменился попапом "Заказ оформлен"
    - assert: в попапе "Заказ оформлен" есть текст с номером вашего заказа
    - do: нажать на браузерную кнопку "Назад"
    - assert: попап закрылся и мы вернулись на карточку товара

  Проверка связанности полей:
    - params:
        foreverdata: '3937911619'
    - do: получить выдачу по запросу 'foreverdata' и кликнуть в заголовок первого сниппета (название заголовка Тестовая страница для Дефолтной карточки товара — турбо)
    - do: кликнуть в тайтл первого сниппета
    - assert: открылась карточка товара
    - do: нажать на кнопку 'Купить в 1 клик'
    - assert: открылась страница с формой оформления заказа
    - assert: в описании товара указан правильный размер 'US 6 (RU 35,5)'
    - tech: заполнить форму и нажать "отправить" - во вкладке network в отправляемых параметрах видно, что указан правильный код размера 116011
    - do: закрыть форму
    - do: поменять значение в селекте выбора размера на US 8 (ему соответствует id 116016)
    - do: нажать на кнопку 'Купить в 1 клик'
    - assert: открылась страница с формой оформления заказа
    - assert: в описании товара указан правильный размер 'US 8 (RU 37,5)'
    - tech: заполнить форму и нажать "отправить" - во вкладке network в отправляемых параметрах видно, что указан правильный код размера 116016

  Обрезание заголовка в карточке товара:
    - do: перейти по ссылке yandex.ru/turbo?stub=productpage/product-without-cart.json
    - screenshot: внешний вид шапки соответствует скриншоту [header]

  Обрезание заголовка в карточке товара с корзиной:
    - do: перейти по ссылке yandex.ru/turbo?stub=productpage/product-2-server.json
    - screenshot: внешний вид шапки соответствует скриншоту [header]

  Добавить во внешнюю корзину по ссылке:
    - tags: no_assessors
    - do: открыть ссылку https://yandex.ru/turbo?stub=page/ecom-item-card-to-outer-card.json&ymclid=1
    - tech: у кнопки "Добавить в корзину" в `data-bem` атрибуте в from параметр `targetInSeparateTab` задан `_self`

  С экспериментом для маркета:
    Переход в корзину через форму:
      - tags: no_assessors
      - params:
          exp_flags: add-to-outer-cart-self-with-ymclid=1
      - do: открыть ссылку https://yandex.ru/turbo?stub=page%2Fnike.json&ymclid=1
      - tech: у формы в `data-bem` атрибуте в from параметр `targetInSeparateTab` задан `_self`
    Переход в корзину по ссылке:
      - tags: no_assessors
      - params:
          exp_flags: add-to-outer-cart-self-with-ymclid=1
      - do: открыть ссылку https://yandex.ru/turbo?stub=page/ecom-item-card-to-outer-card.json&ymclid=1
      - tech: у кнопки "Добавить в корзину" в `data-bem` атрибуте в from параметр `targetInSeparateTab` задан `_self`

tags:
  - e-commerce
  - no_assessors #раскатили новый дизайн на 100%

files:
  - platform/components/ProductPage/__tests__/ecommerce-default-item-card@phone.hermione.js

v-team: Turbo

manager: tanzwuta

qa-engineer: spv

tlds: none
