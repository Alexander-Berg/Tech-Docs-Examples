feature: Сети/Рубрики
type: Большая карта и список сверху / Режим списка

specs-integration:
  beforeEach:
    - do: получить выдачу по запросу 'кафе'
    - assert: появилась карусель с карточками,
  Наличие элементов:
    - assert: на карусели есть тумба, фильтр, список, карта
  Дозагрузка списка:
    - do: проскроллить список до конца
    - assert: дозагрузились еще организации

specs:
  beforeEach:
    - do: получить выдачу по запросу 'кафе' _ALTERNATIVE_SEARCH_QUERIES_
    - screenshot: появилась карусель с карточками [companies-bk-carousel-{{SET_NAME}} >> carousel]
  Проверка карточки:
    - tags: smoke
    - label: companies-bk-carousel-{{SET_NAME}}
    - screenshot: появилась карусель с карточками [carousel]
    - do: кликнуть по картинке в первой не рекламной карточке
    - tech: сработал счетчик path='/$page/$top/$result/companies-map-list/carousel/showcase/item/topic'
    - assert: выдача перезагрузилась
    - assertMetrics: '*'
  Проверка скролла карусели:
    - do: кликнуть по стрелке 'Вправо' в карусели
    - tech: сработал счетчик path='/$page/$top/$result/companies-map-list/carousel/showcase/scroll_right'
    - assert: |
        содержимое карусели сдвинулось влево,
        появилась стрелка 'Влево'
    - do: кликнуть по стрелке 'Влево' в карусели
    - tech: сработал счетчик path='/$page/$top/$result/companies-map-list/carousel/showcase/scroll_left'
    - assert: |
        содержимое карусели сдвинулось вправо,
        стрелка 'Влево' ислезла
    - assertMetrics: '*'
  Проверка фильтров:
    - do: кликнуть по любой кнопке-фильтру (со стрелочками)
    - tech: сработал счетчик path='/$page/$top/$result/companies-map-list/carousel/filters/filter'
    - screenshot: появилось выпадающее меню со списком выбранной категории [select-opened]
    - do: выбрать любой пункт из выпадающего меню
    - assert: |
        название кнопки-фильтра изменилось на название выбранного пункта из меню,
        цвет кнопки стал темнее,
        данные в карусели обновились в соответствии с выбранным фильтром
    - do: кликнуть еще раз по выбранной кнопке-фильтру
    - do: кликнуть по ранее выбранному пункту
    - assert: |
        название кнопки-фильтра изменилось на первоначальное,
        цвет кнопки не отличается от других кнопок-фильтров,
        данные в карусели обновились и отображаются без фильтрации
    - assertMetrics: '*'
  Проверка переключения на карту:
    - do: кликнуть по кнопке 'Показать карту'
    - tech: сработал счетчик path='/$page/$top/$result/companies-map-list/switch'
    - assert: появилась карта с обозначенными организациями в виде пинов на ней
    - screenshot: внейшний вид карты [map]
    - assertMetrics: '*'

files:
  - features/companies/bk_list/companies-list@desktop.hermione.js
  - features/companies/bk_list/companies-list@desktop.hermione.e2e.js

v-team: VanillaGeo

counter: /$page/$top/$result[@wizard_name="companies" and @subtype="map"]/companies-map-list/carousel/showcase/item/topic

tags:
  - hasE2E

tlds: all
