feature: AdvertBottom
tlds: ru
tags: no_assessors

params:
  exp_flags:
    - adv-disabled=0

specs:
  Показ залипающей плашки с рекламой:
    - do: открыть страницу https://yandex.ru/turbo?stub=advertbottom%2Fpage.json
    - do: проскроллить страницу на один экран
    - assert: внизу окна показался залипающий блок с рекламой

  Скрытие и показ плашки:
    - do: открыть страницу https://yandex.ru/turbo?stub=advertbottom%2Fpage.json
    - do: проскроллить страницу на один экран
    - tech: внизу окна показался залипающий блок с рекламой
    - do: нажать на крест в круге над залипающим блоком (кнопка закрытия)
    - tech: залипающий блок с рекламой пропал
    - do: обновить страницу
    - do: проскроллить страницу на один экран
    - tech: блок не должен появиться
    - do: в консоли выполнить sessionStorage.removeItem('turbo/sa-disabled');
    - do: обновить страницу
    - do: проскроллить страницу на один экран
    - tech: залипающий блок с рекламой снова появился внизу экрана

  Плашка скрылась при проскролле:
    - do: открыть страницу https://yandex.ru/turbo?stub=advertbottom%2Fpage-10-200.json
    - do: проскроллить страницу на один экран
    - tech: внизу окна показался залипающий блок с рекламой
    - do: проскроллить страницу на один экран
    - tech: залипающий блок с рекламой исчез

  Плашка скрылась по таймауту:
    - do: открыть страницу https://yandex.ru/turbo?stub=advertbottom%2Fpage-3-200.json
    - do: проскроллить страницу на один экран
    - tech: внизу окна показался залипающий блок с рекламой
    - do: Подождать 3 секунды
    - tech: залипающий блок с рекламой исчез

  Плашка не должна появляться, если реклама не загрузилась:
    - do: открыть страницу https://yandex.ru/turbo?stub=advertbottom%2Fpage.json
    - do: проскроллить страницу на один экран
    - tech: залипающий блок с рекламой не появился

  Скрытие плашки при уничтожении вложенной в неё рекламы:
    - description: данный сценарий возможно выполнить только в темпларе
    - do: открыть страницу https://yandex.ru/turbo?stub=advertbottom%2Fpage.json&hermione_advert=fail
    - do: проскроллить страницу на один экран
    - tech: внизу окна показался залипающий блок с рекламой
    - do: выполнить скрипт, имитирующий уничтожение рекламы `window.modules.require('advert__item',function(AdvertItem) {AdvertItem.getFromDom(document.querySelector('.advert-bottom .advert__item'))._destroyBlock();});`
    - tech: залипающий блок исчез вслед за рекламой

files:
  - platform/components/AdvertBottom/__tests__/AdvertBottom@phone.hermione.js

v-team: Turbo

manager: sergey-kuldin

qa-engineer: spv
