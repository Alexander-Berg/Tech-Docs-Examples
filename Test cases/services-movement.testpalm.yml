feature: Подтверждение перемещения сервисов

specs:
  Положительные:
    1. Отклонение непосредственного запроса на перемещение сервиса со страницы "Подтверждения":
      - do: (PREPARE) залогиниться пользователем robot-internal-003
      - do: (PREPARE) открыть сервис "Автотестовый сервис для отклонения перемещений" (/services/autotestservicedeclinemov/)
      - do: (PREPARE) изменить родитель сервиса на "Автотестовый сервис для запроса ролей 1"
      - do: залогиниться пользователем robot-abc-001
      - do: открыть сервис "Автотестовый сервис для отклонения перемещений" (/services/autotestservicedeclinemov/)
      - assert: на странице есть запрос на перемещение сервиса, от имени robot-internal-003
      - do: кликнуть на стрелочку в правом верхнем углу плашки
      - screenshot: плашка с запросом на перемещение сервиса раскрылась, внутри указана детальная информация о переносе [service-movement-request]
      - do: открыть страницу "Подтверждения" на табе "Перемещения сервисов" (/approves/services-movement/)
      - screenshot: по умолчанию выбран переключатель "Непосредственные", в таблице есть запрос от пользователя robot-internal-003 на перемещение сервиса "Автотестовый сервис для отклонения перемещений" [approve-content]
      - do: в столбце "Новый владелец подтвердил" кликнуть на значок "палец вниз"
      - assert: покрутился спиннер, строка с запросом из таблицы пропала

    2. Одобрение запроса на перемещение сервиса с учётом иерархии со страницы "Подтверждения":
      - do: (PREPARE) залогиниться пользователем robot-internal-003
      - do: (PREPARE) открыть сервис "Автотестовый сервис для подтверждения перемещений" (/services/autotestserviceforapprove/)
      - do: (PREPARE) изменить родитель сервиса на "Автотестовый сервис для запроса ролей N2"
      - do: залогиниться пользователем robot-abc-001
      - do: открыть страницу "Подтверждения" на табе "Перемещения сервисов" (/approves/services-movement/)
      - screenshot: выбран переключатель "Непосредственные", запросов на перемещение сервисов нет [no-direct-requests]
      - do: кликнуть на переключатель "С учетом иерархии"
      - assert: |
              выбран переключатель "С учетом иерархии"
              в таблице есть запрос от пользователя robot-internal-003 на перемещение сервиса "Автотестовый сервис для подтверждения перемещений" 
      - screenshot:  запрос на перемещение сервиса "Автотестовый сервис для подтверждения перемещений" [inherited-approve-content]
      - do: в столбце "Новый владелец подтвердил" кликнуть на значок "палец вверх"
      - assert: покрутился спиннер, строка с запросом из таблицы пропала
      - do: открыть сервис "Автотестовый сервис для подтверждения перемещений" (/services/autotestserviceforapprove/)
      - assert: сервис начал перемещаться, рядом с его названием появилась плашка "RO Перемещается"
      - screenshot: плашка "RO Перемещается" [ro-label]
      - do: (PREPARE) дождаться завершения перемещения - пока пропадёт красная плашка "RO Перемещается"
      - do: (PREPARE) изменить родителя сервиса на "Другие сервисы (Не надо запрашивать Железо здесь)"

files:
  - test/features/desktop/approves/services-movement.hermione.js

priority: blocker

tags:
  - reviewed
  - no_assessors
