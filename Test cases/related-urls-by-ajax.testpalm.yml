feature: related
type: с запросом дозагружаемых урлов по ajax

specs:
  Работа на примере нескольких статей:
    - do: открыть страницу https://yandex.ru/turbo?text=https%3A%2F%2Fpikabu.ru%2Fstory%2Ftrevor_philips_industries_7258469
    - assert: открылась страница
    - do: скроллить вниз
    - assert: подгрузилась еще одна страница

  Запрашивает дополнительные урлы, только если очередь пуста:
    - tags: no_assessors
    - params:
        exp_flags:
            - turbo_params_for_itditp=recommender_max_recommendations_override=2
    - do: открыть страницу https://yandex.ru/turbo/s/expert.ru/2020/05/1/uchenyie-prognoziruyut-chto-k-seredine-maya-bolshinstvo-regionov-projdet-pik-pandemii-osobaya-situatsiya---na-urale/
    - assert: |
        открылась турбо-страница
        в списке запросов присутствует запрос на 'https://yandex.ru/search/itditp/'
    - do: скроллить вниз
    - assert: |
        загрузилась еще одна страница
        дополнительный запрос на 'https://yandex.ru/search/itditp/' не произошел
    - do: скроллить вниз
    - assert: |
        загрузилась еще одна страница
        произошел запрос на 'https://yandex.ru/search/itditp/'

  Прикрепляет идентификаторы уже запрошенных страниц к запросу:
    - tags: no_assessors
    - params:
        exp_flags:
            - turbo_params_for_itditp=recommender_max_recommendations_override=2
            - recommender-hashes-limit=2
    - do: открыть страницу 'https://yandex.ru/turbo/s/expert.ru/2020/05/1/uchenyie-prognoziruyut-chto-k-seredine-maya-bolshinstvo-regionov-projdet-pik-pandemii-osobaya-situatsiya---na-urale/'
    - assert: |
        открылась турбо-страница
        в списке запросов присутствует запрос на 'https://yandex.ru/search/itditp/'
    - do: проскроллить 2 статьи в ленте
    - assert: |
        в списке запросов присутствует новый запрос на 'https://yandex.ru/search/itditp/'
        в урле запроса присутствует параметр 'snippetsHash'
        в значении 'snippetsHash' 2 хеша через запятую
    - do: проскроллить еще 2 статьи в ленте
    - assert: |
        в списке запросов присутствует новый запрос на 'https://yandex.ru/search/itditp/'
        в урле запроса присутствует параметр 'snippetsHash'
        в значении 'snippetsHash' 2 хеша через запятую, отличные от первых двух


files:
  - features/touch-phone/blocks/related/related-urls-by-ajax.hermione.js

v-team: Turbo

manager: sergey-kuldin

tlds: ru
