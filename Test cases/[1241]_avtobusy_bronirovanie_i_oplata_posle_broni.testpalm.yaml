feature: Автобусы. Старый фронт
type: ''
description: >-
  Выдержки из [Условия бронирования и приобретения электронных билетов на
  автобусы](https://yandex.ru/legal/bus_tickets_booking_conditions/) (возможны
  изменеия. но общий смысл вряд ли поменяется со временем):

  "...

  2.13. Пользователю может быть доступна функция бронирования Электронного
  билета без необходимости оплаты Электронного билета на Ресурсах Яндекса.

  ...

  3.2. ..., Пользователю предоставляется время для оплаты, при этом время сессии
  на оплату составляет 15 минут (если большее время не указано в интерфейсе
  Системы Яндекса), по истечении которых будет выдаваться сообщение об истечении
  времени ожидания и о необходимости осуществить процедуру приобретения
  Электронного билета заново.

  ...

  3.4. После нажатия Пользователем на кнопку «Оплатить» и подтверждения оплаты в
  Системе Яндекса, о чём выдаётся соответствующее сообщение, договор перевозки
  считается заключенным, Пользователю направляются Электронный билет и (или)
  маршрутная квитанция на указанный им адрес электронной почты и(или) номер
  мобильного телефона.

  ..."

  **ЗКП (записная книжка пассажира)** - личный кабинет... (см.
  [Инструкцию](https://wiki.yandex-team.ru/eva/search/assessors-testing/Testirovanie-Poezdov/)).

  Пользователь авторизован на тестируемом сервисе, получена **Выдача** на любую
  поездку на Автобусе, выбрана любая доступная поездка и заполнены валидными
  значениями данные пассажиров и контактные данные (то есть открыта страница
  бронирования и оплаты выбранной поездки и доступна кнопка для бронирования и
  оплаты - скриншот примера кнопки: https://yadi.sk/i/_MNGhc1q0g53mw ).
specs:
  Автобусы. Бронирование и Оплата. После брони:
    - do: >-
        На странице бронирования и оплаты выбранной поездки из **Предусловия**
        нажать кнопку для бронирования и оплаты. Закрыть открывшийся попап
        Оплаты банковской картой.
    - assert: >-
        Открывается страница заказа с надписью "Билеты ожидают оплату" с
        активной кнопкой Оплатить (скриншот примера страницы и кнопки:
        https://yadi.sk/i/q9LwGfKkrTQ-EQ ).

        На e-mail, указанный в контактных данных приходит письмо от сервиса.
    - do: Нажать на кнопку оплаты.
    - assert: >-
        В зависимости от количества времени прошедшего с момента нажатия кнопки
        для бронирования и оплаты (см. **Описание**):
         - прошло более 15 минут: Открывается страница заказа с надписью "Билеты аннулированы" (скриншот примера страницы: https://yadi.sk/i/OhkBF2IOURX9mA )
         - прошло менее 15 минут: Открывается попап Оплаты банковской картой  (скриншот примера попапа: https://yadi.sk/i/PU04eSy29M-z6A ).
    - do: Закрыть попап Оплаты банковской картой.
    - assert: >-
        Открывается страница заказа  с надписью "Билеты ожидают оплату" с
        активной кнопкой Оплатить (скриншот примера страницы и кнопки:
        https://yadi.sk/i/q9LwGfKkrTQ-EQ ).
    - do: >-
        В новой вкладке открыть письмо от сервиса из шага 1 и проверить данные
        указанные в письме.
    - assert: >-
        В письме присутствует  (скриншот примера письма:
        https://yadi.sk/i/UwK4x3k_9FaGQQ ):
         - Номер заказа
         - данные поездки, совпадающие с данными указанные при оформлении поездки (см. **Предисловие**)
         - данные по отправлению и прибытию
         - информация о партнере
         - кликабельная кнопка оплаты, открывающая страницу сервиса с открытым попапом Оплаты банковской картой.
    - do: Нажать на кнопку оплаты из письма.
    - assert: >-
        В зависимости от количества времени прошедшего с момента нажатия кнопки
        для бронирования и оплаты (см. **Описание**):
         - прошло более 15 минут: Открывается страница заказа с надписью "Билеты аннулированы" (скриншот примера страницы: https://yadi.sk/i/OhkBF2IOURX9mA )
         - прошло менее 15 минут: Открывается попап Оплаты банковской картой  (скриншот примера попапа: https://yadi.sk/i/PU04eSy29M-z6A ).
    - do: Закрыть попап Оплаты банковской картой (если открыт).
    - assert: >-
        Открывается страница заказа  с надписью "Билеты ожидают оплату" с
        активной кнопкой Оплатить (скриншот примера страницы и кнопки:
        https://yadi.sk/i/q9LwGfKkrTQ-EQ ).
    - do: >-
        Перейти в раздел **Мои билеты** нажав на иконку ЗКП  или название
        раздела слева вверху страницы  (скриншот примера кнопки и названия
        раздела: https://yadi.sk/i/8f5pH6wUhV5ZBg ).
    - assert: >-
        Открывается ЗКП с надписью "Мои заказы" и на ней в зависимости от
        количества времени прошедшего с момента нажатия кнопки для бронирования
        и оплаты (см. **Описание**):
         - прошло более 15 минут: Список только аннулированных и оплаченных заказов.
         - прошло менее 15 минут: Отображается только что забронированный, но не оплаченный заказ. Присутствует активная кнопка оплаты. Справа вверху пустой чекбокс рядом с текстом "Показать аннулированные" (только если есть другие заказы в другом статусе), при отметке чекбокса показываются анулированные заказы - при наличии  (скриншот примера страницы: https://yadi.sk/i/qFkkXjdz40Ng_g ).
    - do: Нажать на кнопку оплаты.
    - assert: >-
        В зависимости от количества времени прошедшего с момента нажатия кнопки
        для бронирования и оплаты (см. **Описание**):
         - прошло более 15 минут: Открывается страница заказа с надписью "Билеты аннулированы" (скриншот примера страницы: https://yadi.sk/i/OhkBF2IOURX9mA )
         - прошло менее 15 минут: Открывается попап Оплаты банковской картой  (скриншот примера попапа: https://yadi.sk/i/PU04eSy29M-z6A ).
    - do: Закрыть попап Оплаты банковской картой (если открыт).
    - assert: >-
        Открывается страница заказа  с надписью "Билеты ожидают оплату" с
        активной кнопкой Оплатить (скриншот примера страницы и кнопки:
        https://yadi.sk/i/q9LwGfKkrTQ-EQ ).
    - do: >-
        Перейти в Мои билеты, нажать на ссылку **_Детали Заказа_** справа от
        номера заказа.
    - assert: >-
        В зависимости от количества времени прошедшего с момента нажатия кнопки
        для бронирования и оплаты (см. **Описание**):
         - прошло более 15 минут: Открывается страница заказа с надписью "Билеты аннулированы" (скриншот примера страницы: https://yadi.sk/i/OhkBF2IOURX9mA )
         - прошло менее 15 минут: Открывается попап Оплаты банковской картой  (скриншот примера попапа: https://yadi.sk/i/PU04eSy29M-z6A ).
    - do: Закрыть попап Оплаты банковской картой (если открыт).
    - assert: >-
        Открывается страница заказа  с надписью "Билеты ожидают оплату" с
        активной кнопкой Оплатить (скриншот примера страницы и кнопки:
        https://yadi.sk/i/q9LwGfKkrTQ-EQ ).
    - do: >-
        Подождать когда пройдут 15 минут с момента нажатия кнопки Бронирования и
        оплаты и повторить шаги 4-7 и шаг 10.
    - assert: ОР соответствует ОР шагов 4-7 и шага 10.
    - do: >-
        [**этот и последующие шаги кейса пропустить если нет возможности
        оплатить заказ**] Повторить условия из **Предусловия** и нажать кнопку
        для бронирования и оплаты.
    - assert: >-
        Открывается попап Оплаты банковской картой  (скриншот примера попапа:
        https://yadi.sk/i/PU04eSy29M-z6A ).

        Кнопка оплаты задизейблена.
    - do: Заполнить данные карты валидными данные.
    - assert: Кнопка оплаты становится активной.
    - do: Нажать на кнопку оплаты и подтвердить оплату.
    - assert: >-
        Заказ оплачен и попап закрывается (возможно появление других попапов и
        элементов, необходимых для завершения процесса оплаты).

        Открывается страница заказа с отметкой, что заказ оплачен.

        На e-mail, указанный в контактных данных при бронировании приходит
        письмо от сервиса с уведомлением о купленных билетах и с чеком об оплате
    - do: >-
        В новой вкладке открыть полученное на предыдущем шаге письмо от сервиса
        и проверить данные указанные в письме.
    - assert: Данные в уведомлении и в чеке соответствуют данным заказа.
manual: true
Функциональность: Бронирование
Устройство: Десктоп
Сервис: Автобусы. Старый фронт
