feature: Объектный ответ
type: Списки
counter: /$page/$main/$result[@wizard_name="entity_search"]/list[@type="project"]/title

specs-integration:
  aliases:
    - &ListingsCheck
      - assert: <context> должно быть три списка
      - assert: <context> у первого списка должен быть заголовок
      - assert: <context> в первом списке должны быть элементы
      - assert: <context> у первого элемента первого списка должен быть текст
      - assert: <context> у первого элемента первого списка должен быть второстепенный текст (хинт)
      - assert: <context> у второго списка должен быть заголовок
      - assert: <context> во втором списке должны быть элементы
      - assert: <context> у первого элемента второго списка должен быть текст
  beforeEach:
    - do: получить выдачу по запросу 'Анджелина Джоли'
    - assert: должен появиться Объектный ответ
  На серпе: *ListingsCheck

specs:
  beforeEach:
    - do: получить выдачу по запросу 'Анджелина Джоли'
    - screenshot: появилась карточка объекта со списками, иконка избранного может отсутствовать [z-entity-search/list-{{PLATFORM}}-{{BROWSER_TYPE}} >> plain]
  Ссылка заголовка списка "Фильмы":
    - label: z-entity-search/list-{{PLATFORM}}-{{BROWSER_TYPE}}
    - screenshot: внешний вид, иконка избранного может отсутствовать [plain]
    - tags:
        - smoke
        - smoke_extended
        - pp_new_core
    - tech: должен сработать счетчик показа списка 'Фильмы' /$page/$main/$result[@wizard_name="entity_search"]/list[@type="project"]
    - do: кликнуть на заголовок 'Фильмы' в карточке объекта
    - tech: проверить счетчик заголовка списка /$page/$main/$result[@wizard_name="entity_search"]/list[@type="project"]/title
    - assert: |
        произошел переход на вкладку ОО с фильмами
    - assertMetrics:
      - daily.total_session_count
      - web.total_request_count
      - web.total_click_count
      - web.total_all_click
      - web.abandonment
      - web.tech_part_misc_click
      - all.total_dynamic_click_count
      - feature.web.wizards_common.entity_search_wizard_main.total.clicks
  Ссылка первого элемента списка:
    - tags:
        - smoke_extended
        - pp_new_core
    - do: кликнуть на первую тумбу в списке 'Фильмы'
    - assert: |
        произошел перезапрос серпа и обновилась выдача
        на выдаче есть список с фильмами
    - tech: проверить счётчик клика по первой тумбе списка 'Фильмы' /snippet/entity_search/list/project/showcase/item/thumb
    - assertMetrics:
      - daily.total_session_count
      - web.total_request_count
      - web.total_click_count
      - web.total_all_click
      - web.abandonment
      - web.tech_part_misc_click
      - all.total_dynamic_click_count
      - feature.web.wizards_common.entity_search_wizard_main.total.clicks
    - assertMetrics:
      - daily.total_session_count
      - web.total_request_count
      - web.total_click_count
      - web.total_all_click
      - web.abandonment
      - web.tech_part_misc_click
      - all.total_dynamic_click_count
      - feature.web.wizards_common.entity_search_wizard_main.total.clicks
  Счетчик на свайп списка:
    - tags: no_assessors
    - do: сделать свайп списка
    - assert: список проскроллился влево
    - tech: проверить счетчик на свайп /snippet/entity_search/list/project/showcase/scroll
    - assertMetrics:
      - daily.total_session_count
      - web.total_request_count
      - web.total_click_count
      - web.total_all_click
      - web.abandonment
      - web.tech_part_misc_click
      - all.total_dynamic_click_count
      - feature.web.wizards_common.entity_search_wizard_main.total.clicks

  Отображение связанных списков в альбомной ориентации:
    - do: проскроллить карточку ОО к связанным спискам 'Фильмы'/'Смотрите также' и повернуть устройство в альбомную ориентацию
    - screenshot: внешний вид, иконка избранного может отсутствовать [lists-landscape]
    - assertMetrics:
      - daily.total_session_count
      - web.total_request_count
      - web.total_click_count
      - web.total_all_click
      - web.abandonment
      - web.tech_part_misc_click
      - all.total_dynamic_click_count
      - feature.web.wizards_common.entity_search_wizard_main.total.clicks

  Список без объектов не отображается в карточке:
    - do: получить выдачу по запросу 'Маргарита'
    - assert: появилась карточка объекта с одним списком
    - screenshot: пример внешнего вида (блок 'Популярные вопросы' может отсутствовать) [plain]
  
  Кнопка весь список:
    - do: получить выдачу по запросу 'Эфиопия'
    - assert: появилась карточка объекта со списками
    - do: пролистать все списки до конца
    - screenshot: пример внешнего вида [plain]
  
  Список с картинками square_smart:
    - do: получить выдачу по запросу 'гермиона грейнджер'
    - assert: появилась карточка объекта со списками
    - screenshot: пример внешнего вида первого списка [plain]

files:
  - features/touch-phone/z-entity-search/list/list.hermione.e2e.js
  - features/touch-phone/z-entity-search/list/list.hermione.js

v-team: OO

tags:
  - reviewed
  - hasE2E
  - oo_list

tlds: ['ru', 'ua', 'by', 'kz', 'fr', 'com.tr']

