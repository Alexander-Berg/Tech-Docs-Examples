feature: Саджест
type: Релизный смоук

specs:
  Базовые сценарии:
    beforeEach:
      - do: получить выдачу по запросу "тест"
      - assert: получена выдача по указанному запросу
      - do: кликнуть в кнопку "х" поисковой стрелки
      - assert: поисковая стрелка очищена
      - assert: инпут активен
      - assert: саджест открыт
    Перезапросы разными способами и возврат [manual]:
      - tags:
          - smoke
      - automation: SERPTEST-549
      - do: набрать в поисковой строке "запрос 1"
      - do: нажать кнопку "Найти" в поисковой стрелке
      - assert: получена выдача по указанному запросу
      - assert: саджест закрыт
      - do: кликнуть в поисковую стрелку
      - assert: инпут активен
      - assert: саджест открыт
      - do: изменить запрос в поисковой стрелке на "запрос 2"
      - do: нажать кнопку "Enter" на клавиатуре
      - assert: получена выдача по указанному запросу
      - assert: саджест закрыт
      - do: кликнуть в поисковую стрелку
      - assert: инпут активен
      - assert: саджест открыт
      - do: изменить запрос в поисковой стрелке на "длина окружности"
      - do: кликнуть в фактовую подсказку длина окружности
      - assert: получена выдача по запросу с текстом из выбранной подсказки
      - assert: саджест закрыт
      - do: нажать кнопку "Назад" браузера или телефона
      - assert: выдача перезагрузилась
      - assert: отображается выдача по запросу "запрос 2"
      - do: нажать кнопку "Назад" браузера или телефона
      - assert: выдача перезагрузилась
      - assert: отображается выдачат по запросу "запрос 1"
      - do: нажать кнопку "Назад" браузера или телефона
      - assert: выдача перезагрузилась
      - assert: отображается выдача по запросу "тест"
      - do: кликнуть в поисковую стрелку
      - assert: в инпуте отображается запрос "тест"
      - assert: в саджесте присутствуют подсказки релевантные запросу "тест"
    Закрытие саджеста по клику вне блока [manual]:
      - tags:
          - smoke
      - automation: SERPTEST-549
      - do: набрать в поисковой строке "котики"
      - do: кликнуть вне блока саджеста и поисковой строки
      - assert: саджест закрылся
      - assert: выдача не была перезагружена
      - do: клик в поисковую стрелку
      - assert: саджест открыт
    Backspace - подсказки обновляются [manual]:
      - automation: SERPTEST-549
      - do: набрать в поисковой строке "котики"
      - do: кликнуть в первую пословную подсказку
      - assert: текст выбранной пословной подсказки добавлен в инпут
      - assert: элементы саджеста обновились
      - assert: выдача не была перезагружена
      - do: нажать 2 раза backspace на клавиатуре
      - assert: элементы саджеста обновились
    Пословные подсказки [manual]:
      - tags:
          - smoke
      - automation: SERPTEST-549
      - do: введите в поисковую стрелку "новости"
      - assert: элементы саджеста обновились
      - assert: в саджесте присутствуют пословные подсказки
      - screenshot: примерный внешний вид [https://jing.yandex-team.ru/files/likharad-m/novosti__Yandeks_nashlos_77mlnrezultatov_2019-08-14_18-27-57.png]
      - do: кликнуть в первую пословную подсказку
      - assert: тект выбранной пословной подсказки добавлен в инпут
      - assert: элементы саджеста обновились
      - assert: выдача не была перезагружена
    Полнотекстовые подсказки [manual]:
      # временно ставим тег, так как полнотекстовые сейчас выключены на данных
      - tags:
          - smoke
          - no_assessors
      - automation: SERPTEST-549
      - do: введите в поисковую стрелку "новости"
      - assert: элементы саджеста обновились
      - screenshot: примерный внешний вид [https://jing.yandex-team.ru/files/likharad-m/test__Yandeks_nashlos_56mlnrezultatov_2019-04-08_11-02-24.png]
      - do: кликнуть в полнотекстовую подсказку
      - assert: выдача обновилась
      - assert: параметр "text" в урле идентичен тексту полнотекстовой подсказки (кириллица и часть символов в ссылке могут быть закодированы спецсимволами, например "%3D%25D0%25B2...". Для раскодирования можно воспользоваться сервисами типа "URL Decoder")
    Навигационная подсказка [manual]:
      - tags:
          - smoke
      - automation: SERPTEST-549
      - do: введите в поисковую стрелку "яндекс маркет" (альтернативные запросы "сбербанк", "музыка яндекс")
      - assert: в саджесте присутствует навигационная подсказка с зеленой ссылкой
      - screenshot: примерный внешний вид [https://jing.yandex-team.ru/files/etestova/STF_2021-03-25_11-04-08-1.png]
      - do: кликнуть в навигационную подсказку
      - assert: ссылка открылась (в той же вкладке, в новой странице, в приложении - не имеет значения)
    Фактовая подсказка [manual]:
      - tags:
          - smoke
      - automation: SERPTEST-549
      - do: введите в поисковую стрелку "фунт в кг" (альтернативные запросы "миля в километрах", "расстояние от Москвы до Питера", "метр в см")
      - assert: элементы саджеста обновились
      - assert: в саджесте присутствует фактовая подсказка (короткий факт это только название, цифры и единицы измерения. Если отображается длинный текстовый ответ, то введите альтернативный запрос)
      - screenshot: примерный внешний вид [https://jing.yandex-team.ru/files/etestova/screen_2021-12-09_10-56-20.png]
      - do: кликнуть в фактовую подсказку
      - assert: выдача перезагружена
      - assert: саджест закрыт
      - assert: в поисковой стрелке отображается запрос, который был в сером тексте фактовой подсказки
      - assert: получена релевантная запросу выдача
    Исторические подсказки - клик [manual]:
      - tags:
          - smoke
      - automation: SERPTEST-549
      - do: закрыть саджест кликнув вне блока саджеста
      - assert: саджест закрыт
      - do: залогиниться в Яндекс
      - assert: логин в Яндекс выполнен
      - do: на странице настроек поиска включить показ истории поиска
      - assert: чекбокс показа истории поиска включен
      - screenshot: примерный внешний вид [https://jing.yandex-team.ru/files/etestova/STF_2021-02-08_17-22-08.png]
      - do: получить выдачу по запросу "тест"
      - assert: получена выдача по указанному запросу
      - do: кликнуть в кнопку "х" поисковой стрелки
      - assert: |
            поисковая стрелка очищена
            инпут активен
            саджест открыт
            в саджесте отображается историческая подсказка "тест"
      - screenshot: примерный внешний вид [https://jing.yandex-team.ru/files/likharad-m/test__Yandeks_nashlos_56mlnrezultatov_2019-04-08_10-59-33.png]
      - do: ввести в поисковую стрелку запрос "Новости" и нажать кнопку "Найти"
      - assert: выдача перезагружена
      - assert: саджест закрыт
      - do: кликнуть в кнопку "х" поисковой стрелки
      - assert: |
            поисковая стрелка очищена
            инпут активен
            саджест открыт
            в открытом саджесте присутствуют исторические подсказки "новости" и "тест"
      - do: кликнуть в историческую подсказку "тест"
      - assert: |
            выдача перезагружена
            саджест закрыт
            в поисковой стрелке отображается запрос "тест"
            получена релевантная запросу выдача
    Исторические подсказки - удаление [manual]:
      - tags:
          - smoke
      - automation: SERPTEST-549
      - do: закрыть саджест кликнув вне блока саджеста
      - assert: саджест закрыт
      - do: залогиниться в Яндекс
      - assert: логин в Яндекс выполнен
      - do: на странице настроек поиска включить показ истории поиска
      - assert: чекбокс показа истории поиска включен
      - screenshot: примерный внешний вид [https://jing.yandex-team.ru/files/etestova/STF_2021-02-08_17-22-08.png]
      - do: получить выдачу по запросу "тест"
      - assert: получена выдача по указанному запросу
      - do: кликнуть в кнопку "х" поисковой стрелки
      - assert: |
            поисковая стрелка очищена
            инпут активен
            саджест открыт
            в саджесте отображается историческая подсказка "тест"
      - screenshot: примерный внешний вид [https://jing.yandex-team.ru/files/likharad-m/test__Yandeks_nashlos_56mlnrezultatov_2019-04-08_10-59-33.png]
      - do: кликнуть в "х" справа от исторической подсказки
      - assert: историческая подсказка была удалена из саджеста

files: []

tags:
  - suggest
  - input
  - not automated
  # обязательные мануальные тесты для релизов (по следам ЛСР https://st.yandex-team.ru/SERP-77951)
  - skip_e2e_check
  # обязательные мануальные тесты для релизов (по следам ЛСР https://st.yandex-team.ru/SERP-77951)
  - skip_manual_check

browsers:
  notFor:
    - searchapp-phone-group

v-team: Suggest

priority: high

tlds:
  - ru
  - by
  - ua
  - kz
  - uz
  - com
  - com.tr
