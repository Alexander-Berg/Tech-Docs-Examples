feature: Кандидат.Испытания

type: Отправка секции на согласование

description: |
  у кандидата есть два или более претендентства в работе,
  у которых есть завершенные финальные секции. Список претендентств отображен:
  - во вкладке 'Вакансии'
  - в панели 'Активные претендентства'


specs:
  Отправка секции на согласование:
    - do: открыть страницу кандитата /candidates/<id кандидата>/applications
    - assert: в панели 'Активные претендентства' присутствуют два или более претендентства в работе
    - screenshot: внешний вид панели 'Активные претендентства' до отправки секции на согласование [actual_applications_before_sending]
    - assert: во вкладке 'Вакансии' присутствуют два или более претендентства в работе
    - screenshot: внешний вид вкладки 'Вакансии' до отправки секции на согласование [all_applications_before_sending]
    - do: кликнуть на вкладку 'Испытания'
    - assert: присутствует кнопка 'Отправить секции на согласование'
    - screenshot:  кнопка 'Отправить секции на согласование' [send_for_approval_button]
    - do: кликнуть по кнопке 'Отправить секции на согласование'
    - assert: появилась форма отправки секции на согласование
    - do: в поле 'Претендент' выбрать один из вариантов
    - screenshot: форма заполнена [send_for_approval_form_filled]
    - do: кликнуть 'Сохранить'
    - assert: скрылась форма отправки секции на согласование
    - do: кликнуть на вкладку 'Вакансии'
    - assert: |
        во вкладке 'Вакансии' все вакансии, кроме выбранной закрылись
        в панели 'Активные претендентства' все вакансии, кроме выбранной закрылись
    - screenshot: в панели 'Активные претендентства' все вакансии, кроме выбранной закрыты [actual_applications_after_sending]
    - screenshot: все вакансии, кроме выбранной закрыты [all_applications_after_sending]

  Проверка обязательных полей:
    - do: открыть страницу кандитата /candidates/<id кандидата>/applications
    - assert: присутствует кнопка 'Отправить секции на согласование'
    - do: кликнуть по кнопке 'Отправить секции на согласование'
    - do: кликнуть 'Сохранить'
    - assert: форма провалидировалась и подсветила ошибку
    - screenshot: провалидированная форма [send_for_approval_form_empty]

tags:
  - reviewed

priority: blocker

browsers:
  - yandex-browser-desktop
  - firefox-desktop
  - safari-desktop

files:
  - tests/hermione/suites/desktop/candidates/interviews/send_for_approval/send_for_aproval.hermione.js
