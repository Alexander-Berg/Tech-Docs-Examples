feature: Создание новой организации с /portal/registration

import-steps:
  - tests/hermione/shared-steps/registration.testpalm.steps.yml

specs:
  Положительные:
    1. Создание организации с аккаунтом без организации:
      - do: авторизоваться под учеткой в паспорте у которой нет организации или зарегистрироваться
      - attach: Регистрация учетки в паспорте, для яндекс организации
      - do: перейти по ссылке {{CONNECT_HOST}}/portal/registration
      - screenshot: открылась страница с "Выберите аккаунт для подключения к Коннекту", кнопками "+ Другой аккаунт" и "Подключить" [plain]
      - do: выбрать аккаунт под которым авторизованы и нажать кнопку "Подключить"
      - assert: выполнился переход на страницу "Добро пожаловать в Коннект" {{CONNECT_HOST}}/portal/start/
  Отрицательные:
    1. Вход в организацию с аккаунтом состоящим в организации:
      - do: авторизоваться под учеткой в паспорте у которой есть организация(sup@kub.yaconnect.com 689-5Bd-3PS-rjG) или зарегистрироваться и создать организацию.
      - attach: Регистрация организации с промо коннекта
      - do: перейти по ссылке {{CONNECT_HOST}}/portal/registration
      - screenshot: открылась страница с "Этот аккаунт уже подключен к Коннекту", кнопками "+ Другой аккаунт" и "Войти" [plain]
      - do: выбрать аккаунт под которым авторизованы и нажать кнопку "Войти"
      - assert: выполнился переход на страницу "Дашборда" {{CONNECT_HOST}}/portal/home, новая организация не создалась.
    2. Выбор другого аккаунта через "+ Другой аккаунт":
      - do: авторизоваться под учеткой в паспорте у которой есть или нет организации или зарегистрироваться
      - attach: Регистрация учетки в паспорте, для яндекс организации
      - do: перейти по ссылке {{CONNECT_HOST}}/portal/registration
      - assert: открылась страница регистрации
      - do: нажать на "+ Другой аккаунт"
      - assert: выполнился переход на страницу паспорта
    3. Вход в организацию без выбора сессии с аккаунтом состоящим в организации:
      - do: авторизоваться под учеткой в паспорте у которой есть организация
      - attach: Регистрация учетки в паспорте, для яндекс организации
      - do: перейти по ссылке {{CONNECT_HOST}}/portal/registration?session=current
      - assert: выполнился переход на страницу "Дашборда" {{CONNECT_HOST}}/portal/home

priority: blocker

files:
  - tests/hermione/suites/organization/create-registration.js

tlds:
 - ru
 - com

tags:
  - smoke_test_assessors
  - regression
  - smoke_test
  - reviewed
