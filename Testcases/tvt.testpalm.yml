feature: Объектный ответ
type: Счетчики TVT (Total View Time)

specs:
  Сериальный навигатор:
    - tags:
        - oo_overlay
    - params:
        exp_flags: QA_kp_cover_available_touch=1
    - do: получить выдачу по запросу 'доктор хаус сериал'
    - assert: на выдаче есть ОО
    - do: проскроллить список серий до конца и нажать на 'Весь список'
    - assert: открылся оверлей с карточкой объекта
    - assert: выбран таб Сезоны с сериальным навигатором
    - tech: должен сработать счетчик /tech/tvt/entity_search/navigator/open
    - tech: через 3 секунды должны сработать еще два счетчика /tech/tvt/entity_search/navigator/p1 и /tech/tvt/entity_search/navigator/p2
    - do: нажать 'Назад' на навигационной панели оверлея
    - assert: оверлей с карточкой закрылся
    - tech: должен сработать счетчик /tech/tvt/entity_search/navigator/close
    - tech: не должно сработать любых других счетчиков /tech/tvt/entity_search/*
    - assertMetrics:
      - daily.total_session_count
      - web.total_request_count
      - web.total_click_count
      - web.total_all_click
      - web.abandonment
      - web.tech_part_misc_click
      - all.total_dynamic_click_count
      - feature.web.wizards_common.entity_search_wizard_main.total.clicks

  Карта:
    - tags:
        - oo_overlay
    - do: получить выдачу по запросу 'эйфелева башня'
    - assert: на выдаче есть ОО
    - do: нажать на карту
    - assert: открылся оверлей Карты
    - tech: должен сработать счетчик /tech/tvt/entity_search/map/open
    - tech: через 3 секунды должны сработать еще два счетчика /tech/tvt/entity_search/map/p1 и /tech/tvt/entity_search/map/p2
    - do: нажать 'Назад' на навигационной панели оверлея
    - assert: оверлей с Картой закрылся
    - tech: должен сработать счетчик /tech/tvt/entity_search/map/close
    - tech: не должно сработать любых других счетчиков /tech/tvt/entity_search/*
    - assertMetrics:
      - daily.total_session_count
      - web.total_request_count
      - web.total_click_count
      - web.total_all_click
      - web.abandonment
      - web.tech_part_misc_click
      - all.total_dynamic_click_count
      - feature.web.wizards_common.entity_search_wizard_main.total.clicks

  Просмотрщик картинок:
    - do: получить выдачу по запросу 'Анджелина Джоли'
    - assert: на выдаче есть ОО
    - do: нажать на первую тумбу в галерее ОО
    - assert: открылся Просмотрщик картинок
    - tech: должен сработать счетчик /tech/tvt/entity_search/preview/open
    - tech: через 3 секунды должны сработать еще два счетчика /tech/tvt/entity_search/preview/p1 и /tech/tvt/entity_search/preview/p2'
    - do: нажать крестик в правом-верхнем углу
    - assert: просмотрщик картинок закрылся
    - tech: должен сработать счетчик /tech/tvt/entity_search/preview/close
    - tech: не должно сработать любых других счетчиков /tech/tvt/entity_search/*
    - assertMetrics:
      - daily.total_session_count
      - web.total_request_count
      - web.total_click_count
      - web.total_all_click
      - web.abandonment
      - web.tech_part_misc_click
      - all.total_dynamic_click_count
      - feature.web.wizards_common.entity_search_wizard_main.total.clicks

  Трейлер в оверлее:
    - tags:
        - oo_overlay
    - do: получить выдачу по запросу 'гадкий я 3'
    - assert: на выдаче есть ОО
    - do: нажать на кнопку 'Трейлер'
    - assert: открылся оверлей с трейлером
    - tech: должен сработать счетчик /tech/tvt/entity_search/trailer/open
    - tech: через 3 секунды должны сработать еще два счетчика /tech/tvt/entity_search/trailer/p1 и /tech/tvt/entity_search/trailer/p2
    - do: нажать 'Назад' на навигационной панели оверлея
    - assert: оверлей с трейлером закрылся
    - tech: должен сработать счетчик /tech/tvt/entity_search/trailer/close
    - tech: не должно сработать любых других счетчиков /tech/tvt/entity_search/*
    - assertMetrics:
      - daily.total_session_count
      - web.total_request_count
      - web.total_click_count
      - web.total_all_click
      - web.abandonment
      - web.tech_part_misc_click
      - all.total_dynamic_click_count
      - feature.web.wizards_common.entity_search_wizard_main.total.clicks

  Браузерная кнопка Назад:
    beforeEach:
      - do: получить выдачу по запросу 'Анджелина Джоли'
      - assert: на выдаче есть ОО

    Просмотрщик картинок:
      - do: нажать на первую тумбу в галерее ОО
      - assert: открылся Просмотрщик картинок
      - tech: должен сработать счетчик /tech/tvt/entity_search/preview/open
      - tech: через 3 секунды должны сработать еще два счетчика /tech/tvt/entity_search/preview/p1 и /tech/tvt/entity_search/preview/p2
      - do: нажать браузерную кнопку 'Назад'
      - assert: просмотрщик картинок закрылся
      - tech: должен сработать счетчик /tech/tvt/entity_search/peview/close
      - tech: не должно сработать любых других счетчиков /tech/tvt/entity_search/*
      - assertMetrics:
        - daily.total_session_count
        - web.total_request_count
        - web.total_click_count
        - web.total_all_click
        - web.abandonment
        - web.tech_part_misc_click
        - all.total_dynamic_click_count
        - feature.web.wizards_common.entity_search_wizard_main.total.clicks

  Соседство с другими фичами:
    Просмотрщик картинок у сниппета:
      - do: получить выдачу по запросу 'роза'
      - assert: на выдаче есть ОО
      - assert: на выдаче есть сниппет с картинкой
      - do: нажать на первую тумбу в галерее ОО
      - assert: открылся Просмотрщик картинок
      - tech: должен сработать счетчик /tech/tvt/entity_search/preview/open
      - tech: через 3 секунды должны сработать еще два счетчика /tech/tvt/entity_search/preview/p1 и /tech/tvt/entity_search/preview/p2
      - do: нажать крестик в правом-верхнем углу
      - assert: просмотрщик картинок закрылся
      - tech: должен сработать счетчик /tech/tvt/entity_search/peview/close
      - do: кликнуть в картинку в сниппете
      - assert: открылся Просмотрщик картинок
      - tech: не должно сработать новых счетчиков /tech/tvt/entity_search/*
      - assertMetrics:
        - daily.total_session_count
        - web.total_request_count
        - web.total_click_count
        - web.total_all_click
        - web.abandonment
        - web.tech_part_misc_click
        - all.total_dynamic_click_count
        - feature.web.wizards_common.entity_search_wizard_main.total.clicks

files:
  - features/touch-phone/z-entity-search/tvt/tvt.hermione.js

v-team: OO

tags:
  - reviewed
  - no_assessors
  - oo_tvt

tlds: [ru, ua, kz, by, com, com.tr]
