feature: Калькулятор

specs:
  beforeEach:
    - do: получить выдачу по запросу 'онлайн калькулятор'
    - assert: на странице есть колдунщик 'Калькулятор'

  Основные проверки:
    - screenshot: Внешний вид [plain]
    - do: |
        ввести текст '(14-4)*2-(23-3)/5' в инпут Калькулятора
        кликнуть/тапнуть по кнопке '='
    - assert: значение в поле ввода Калькулятора изменилось
    - do: кликнуть/тапнуть на кнопку 'C' калькулятора
    - assert: поле ввода Калькулятора очистилось
    - assertMetrics: '-'

  Проверка ссылки выражения:
    - do: |
        ввести в инпут Калькулятора текст '22-5'
        кликнуть/тапнуть по кнопке '='
    - assert: значение в поле ввода стало равно '17'
    - do: кликнуть/тапнуть по ссылке с вычисленным выражением (над полем ввода)
    - assert: в поле ввода отобразилось '22 - 5'
    - assertMetrics: '-'

  Работа экранной клавиатуры:
    - do: |
        кликнуть/тапнуть на кнопку '4' калькулятора
        кликнуть/тапнуть на кнопку '8' калькулятора
        кликнуть/тапнуть на кнопку '-' калькулятора
        кликнуть/тапнуть на кнопку '5' калькулятора
        кликнуть/тапнуть на кнопку '=' калькулятора
    - assert: значение в поле ввода стало равно '43'
    - assertMetrics: '-'

  Работа с физической клавиатуры:
    - do: |
        убедиться, что к устройству подключена физическая клавиатура
        на физической клавиатуре нажать на кнопку '1'
        на физической клавиатуре нажать на кнопку '7'
        на физической клавиатуре нажать на кнопку '+'
        на физической клавиатуре нажать на кнопку '7'
        на физической клавиатуре нажать на кнопку 'Enter'
    - assert: значение в поле ввода стало равно '24'
    - assertMetrics: '-'

  Физическая клавиатура - табуляция и специальные символы:
    - do: |
        на физической клавиатуре нажать на кнопку '7'
        нажать Tab на клавиатуре
        нажать Tab на клавиатуре
        на физической клавиатуре нажать на кнопку 'Enter'
    - assert: изменилось содержимое поля ввода калькулятора, отобразилось вычисленное значение
    - do: |
        кликнуть/тапнуть на кнопку 'C' калькулятора
        кликнуть/тапнуть в полу ввода калькулятора
        на физической клавиатуре нажать на кнопку 's'
    - assert: в поле ввода отобразилось 'sin('
    - do: на физической клавиатуре нажать на кнопку 'Esc'
    - assert: поле ввода Калькулятора очистилось
    - assertMetrics: '-'

  Специальные кнопки:
    - do: кликнуть/тапнуть на кнопку калькулятора с греческой буквой 'пи'
    - assert: значение в поле ввода стало греческой буквой 'пи'
    - do: |
        кликнуть/тапнуть на кнопку 'C' калькулятора
        кликнуть/тапнуть на кнопку 'e'
    - assert: значение в поле ввода стало символом 'e'
    - do: |
        кликнуть/тапнуть на кнопку 'C' калькулятора
        кликнуть/тапнуть на кнопку '()'
    - assert: значение в поле ввода стало символом '('
    - assertMetrics: '-'

  Переключатель deg-rad:
    - do: |
        ввести текст 'sin(90)' в инпут калькулятора
        кликнуть/тапнуть на кнопку '=' калькулятора
    - assert: в поле ввода отобразилось значение '1'
    - do: кликнуть/тапнуть на переключатель 'RAD' (слева над инпутом)
    - assert: значение в поле ввода изменилось
    - do: кликнуть/тапнуть на переключатель 'DEG' (там же)
    - assert: в поле ввода восстановилось значение '1'
    - assertMetrics: '-'

  Посчитаное sin(90):
    - do: загрузить выдачу Поиска по запросу 'sin 90'
    - assert: в поле ввода отобразилось значение '1'
    - do: кликнуть/тапнуть на переключатель 'RAD' (слева над инпутом)
    - assert: значение в поле ввода изменилось на '0,8939966636'
    - assertMetrics: '-'

  Посчитаное sin(0):
    - do: загрузить выдачу Поиска по запросу 'sin 0'
    - assert: в поле ввода отобразилось значение '0'
    - do: кликнуть/тапнуть на переключатель 'RAD' (слева над инпутом)
    - assert: значение в поле ввода не изменилось
    - assertMetrics: '-'

  Посчитаное sin(22):
    - do: загрузить выдачу Поиска по запросу 'sin 22'
    - assert: в поле ввода отобразилось значение '0,37460659341'
    - do: кликнуть/тапнуть на переключатель 'RAD' (слева над инпутом)
    - assert: значение в поле ввода изменилось на '−0,00885130929'
    - assertMetrics: '-'

  Посчитаное sin(22.):
    - do: загрузить выдачу Поиска по запросу 'sin 22.'
    - assert: в поле ввода отобразилось значение '0,37460659341'
    - do: кликнуть/тапнуть на переключатель 'RAD' (слева над инпутом)
    - assert: значение в поле ввода изменилось на '−0,00885130929'
    - assertMetrics: '-'

  Посчитаное sin(22.4):
    - do: загрузить выдачу Поиска по запросу 'sin 22.4'
    - assert: в поле ввода отобразилось значение '−0,39755568312'
    - do: кликнуть/тапнуть на переключатель 'DEG' (слева над инпутом)
    - assert: значение в поле ввода изменилось на '0,38107037635'
    - assertMetrics: '-'

  Работа после аякс-перезапроса:
    - do: |
        загрузить выдачу Поиска по запросу 'тест'
        заменить запрос в поисковой строке на 'калькулятор', нажать кнопку 'Найти'
    - assert: |
        поисковая выдача перезагрузилась,
        на странице показался калькулятор
    - do: |
        ввести текст '26-7' в инпут калькулятора
        кликнуть/тапнуть на кнопку '=' калькулятора
    - assert: значение в поле ввода калькулятора стало равно 19
    - assertMetrics: '-'

  Проверка счетчиков:
    - tags:
        - no_assessors
    - tech: проверка выполнения следующих счетчиков /wiz/calculator/${'action','button','keyboard','left','right','toggle','gray'}
    - do: нажать на клавиатуре цифру 9
    - tech: проверить срабаывание клавиатурного счётчика
    - do: кликнуть/тапнуть по кнопке 0
    - tech: проверить срабатывание счётчика по кнопке
    - do: кликнуть/тапнуть по переключателю deg-rad
    - tech: проверить срабатывание счётчика
    - assertMetrics: '-'

  Возведение в степень e:
    - do: ввести текст '1 ^ e' в поле ввода Калькулятора
    - assert: в выражении над полем ввода единица находится в степени 'e'
    - assertMetrics: '-'

  Проверка работы калькулятора при удалении ln:
    - do: ввести текст 'ln' в инпут Калькулятора
    - assert: значение в поле ввода изменилось на 'ln('
    - do: на физической клавиатуре нажать на кнопку 'Backspase'
    - assert: значение в поле ввода изменилось на 'ln'
    - do: на физической клавиатуре нажать на кнопку 'Backspase'
    - assert: значение в поле ввода изменилось на 'l'
    - do: на физической клавиатуре нажать на кнопку 'Backspase'
    - assert: поле ввода Калькулятора очистилось
    - assertMetrics: '-'

  Шторка обратной связи:
    - do: кликнуть по ссылке "Сообщить об ошибке" под калькулятором
    - assert: открылось модальное окно для обратной связи
    - screenshot: внешний вид модального окна для обратной связи [feedback-drawer]

specs-integration:
  Проверка наличия фичи:
    - do: получить выдачу по запросу 'онлайн калькулятор'
    - assert: на странице есть колдунщик 'Калькулятор'
    - counter: /$page/$main/$result[@wizard_name="calculator"]

files:
  - features/calculator/calculator@deskpad.hermione.js
  - features/calculator/calculator@deskpad.hermione.e2e.js

tlds:
  - ru
  - by
  - ua
  - kz
  - ua
  - com.tr
  - com

tags:
  - reviewed
  - calculator

v-team: Facts

counter: /$page/$main/$result[@wizard_name="calculator"]
