feature: Объектный ответ
type: Избранное в списках и карусели
params:
  yandex_login: 'stas.mihailov666'

counter: /$page/$main/$result[@wizard_name="entity_search"]/carousel/showcase/item/thumb/favorite

specs:
  В карусели ОО:
    Фильм изначально не добавлен в коллекцию:
      - params:
          foreverdata: '2174580374'
      - do: авторизоваться
      - do: получить выдачу по запросу 'foreverdata'
      - assert: |
          появилась фильмовая карусель
          в карусели, в тумбах фильмов есть кнопки добавления в избранное (флажки в правом верхнем углу)
      - screenshot: внешний вид кнопки добавления в избранное в фильмовой карусели [carousel-plain]
      - do: кликнуть по кнопке добавления в избранное в первой тумбе карусели
      - assert: открылся попап с предложением добавить фильм в коллекцию
      - screenshot: внешний вид попапа [carousel-modal]
      - tech: сработал счетчик клика по кнопке /$page/$main/$result[@wizard_name="entity_search"]/carousel/showcase/item/thumb/favorite
      - do: добавить фильм в коллекцию 'Мои фильмы'
      - assert: |
          попап закрылся,
          флажок в тумбе добавленного фильма закрасился,
          появился тултип внизу страницы
      - screenshot: внешний вид добавленного фильма [carousel-saved]
      - do: кликнуть по кнопке добавления в коллекцию в той же тумбе (удаляем из коллекции)
      - tech: сработал счетчик клика по кнопке /$page/$main/$result[@wizard_name="entity_search"]/carousel/showcase/item/thumb/favorite data.type=remove
      - assert: |
          в кнопке добавления в коллекцию флажок стал незакрашенным,
          тултип закрылся
      - assertMetrics: '*'
    Фильм изначально добавлен в коллекцию:
      - params:
          foreverdata: '1201808385'
      - do: авторизоваться
      - do: получить выдачу по запросу 'foreverdata'
      - assert: |
          появилась фильмовая карусель
          в карусели, в тумбах фильмов есть кнопки добавления в избранное (флажки в правом верхнем углу),
          первый фильм добавлен в избранное (флажок закрашен)
      - screenshot: внешний вид кнопки добавления в избранное в фильмовой карусели [carousel-plain]
      - do: кликнуть по кнопке добавления в избранное (удаляем из коллекции)
      - assert: кнопка сменилась на незакрашенный флажок, соседняя кнопка осталась закрашенной
      - screenshot: внешний вид кнопки добавления в избранное в фильмовой карусели после удаления из избранного [carousel-plain-after]
      - do: кликнуть по кнопке добавления в коллекцию (добавляем в коллекцию)
      - assert: открылся попап с предложением добавить фильм в коллекцию
      - do: добавить фильм в коллекцию 'Мои фильмы'
      - assert: |
          попап закрылся,
          флажок в тумбе добавленного фильма закрасился,
          появился тултип внизу страницы
      - assertMetrics: '*'
    Синхронизация с оверлеем [manual]:
      - automation: SERPTEST-549
      - tags: [for_assessors, skip_manual_check]
      - do: авторизоваться
      - do: получить выдачу по запросу "фильмы 2018"
      - assert: |
          появилась фильмовая карусель
          в карусели, в тумбах фильмов есть кнопки добавления в избранное (флажки в правом верхнем углу)
      - do: кликнуть по кнопке добавления в избранное в первом фильме
      - assert: открылся попап с предложением добавить фильм в коллекцию
      - tech: сработал счетчик клика по кнопке /$page/$main/$result[@wizard_name="entity_search"]/carousel/showcase/item/thumb/favorite
      - do: добавить фильм в коллекцию 'Мои фильмы'
      - assert: |
          попап закрылся,
          флажок в тумбе добавленного фильма закрасился,
          появился тултип внизу страницы
      - do: кликнуть по титулу карусели
      - assert: |
          открылся оверлей с плиточным списком,
          в оверлее у добавленного фильма закрашен флажок добавления в избранное
      - do: кликнуть на тумбу добавленного фильма
      - assert: |
          открылся оверлей с карточкой добавленного фильма,
          в карточке есть кнопка дабавления в избранное (с закрашенным флажком)
      - do: кликнуть по кнопке добавления в избранное (удаляем из коллекции)
      - assert: в кнопке добавления в коллекцию флажок стал незакрашенным
      - do: кликнуть на кнопку назад в шапке оверлея
      - assert: |
          оверлей с карточкой фильма закрылся,
          открылся оверлей с плиточным списком фильмов,
          фильм больше не добавлен в избранное (флажок не закрашен)
      - do: кликнуть на кнопку назад в шапке оверлея
      - assert: |
          оверлей с плиточным списком закрылся,
          в карусели фильм больше не добавлен в избранное (флажок не закрашен)
      - assertMetrics: '*'
  В связанном списке в карточке ОО:
    - params:
        foreverdata: '2381668480'
    - do: авторизоваться
    - do: получить выдачу по запросу 'foreverdata'
    - assert: |
        появилась карточка ОО с связанным списком
        в списке есть кнопки добавления в избранное (флажки в правом верхнем углу)
    - screenshot: внешний вид связанного списка в карточке ОО [lists-plain]
    - do: кликнуть по кнопке добавления в избранное в первой тумбе списка
    - assert: открылся попап с предложением добавить фильм в коллекцию
    - tech: сработал счетчик клика по кнопке /$page/$main/$result[@wizard_name="entity_search"]/carousel/showcase/item/thumb/favorite
    - do: добавить фильм в коллекцию 'Мои места'
    - assert: |
        попап закрылся,
        флажок в тумбе добавленного места закрасился,
        появился тултип внизу страницы
    - screenshot: внешний вид связанного списка в карточке ОО [lists-saved]
    - assertMetrics: '*'

files:
  - features/touch-phone/z-entity-search/favorites/lists/favorites-lists.hermione.js

tags: ['no_assessors', 'oo_lists', 'oo_favorites']
#сейчас избраное отключено, поставила тег, чтобы не раздавалось на асессоров

v-team: OO

tlds: [ru, by, ua, kz]
