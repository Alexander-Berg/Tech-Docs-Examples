feature: CSP

description: Проверка работы СЕРП'а с включенными CSP

specs:
  В блокирующем комбинированном режиме:
    - params:
        exp_flags: 'csp_report_only=0'
    - do: получить выдачу по запросу "vk"
    - assert: страница должна загрузиться без ошибок
    - do: кликнуть на кнопку перехода на следующую страницу в пейджере
    - assert: должна загрузиться вторая страница без ошибок
  В блокирующем режиме через заголовок Content-Security-Policy:
    - params:
        exp_flags:
          - csp_report_only=0
          - csp_header_only=1
    - do: получить выдачу по запросу "vk"
    - assert: страница должна загрузиться без ошибок
    - do: кликнуть на кнопку перехода на следующую страницу в пейджере
    - assert: должна загрузиться вторая страница без ошибок
  В неблокирующем режиме через заголовок Content-Security-Policy-Report-Only:
    - params:
        exp_flags: 'csp_report_only=1'
    - do: получить выдачу по запросу "vk"
    - assert: страница должна загрузиться без ошибок
    - do: кликнуть на кнопку перехода на следующую страницу в пейджере
    - assert: должна загрузиться вторая страница без ошибок

files:
    - features/csp/csp@deskpad.hermione.js
    - features/touch-phone/csp/csp.hermione.js

v-team: Architecture

tags:
  - csp
  - skip_e2e_check
  - no_assessors

tlds: none
