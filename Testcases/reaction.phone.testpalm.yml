feature: Эмоджи

description: |
    Эмоджи - сущность в сюжете, позволяющая пользователям выразить свое мнение о новости посредством выбора реакции из набора эмоджи.
    Доступные эмоджи: Нравится, Хаха, Ого, Апчхи, Грусть, Возмутительно, Не нравится

specs:
  позволяют оценить новость:
    - do: перейти в сюжет без поставленных эмоджи (не из топа новостей)
    - assert: |
        под аннотацией есть кнопки 'Оценить' со значком смайла,
        элементы расположены в одну строку, не наезжают друг на друга
    - do: тапнуть по кнопке Оценить
    - assert: |
        появляется блок с доступными эмоджи,
        все эмоджи отображаются корректно, блок эмоджи не выезжает за границу экрана

  отображают топ популярных реакций и количество отреагировавших на новость:
    - do: перейти в сюжет с количеством эмоджи > 1000
    - assert: |
         отображается топ из 3 самых популярных эмоджи, кнопка Оценить и количество оценивших '(N)K' (например, 2,2K),
         элементы расположены в одну строку, не наезжают друг на друга
    - do: тапнуть по кнопке Оценить, выбрать эмоджи
    - assert: |
        отображается топ из 3 самых популярных эмоджи, выбранная эмоджи расположена рядом с топ3 и имеет больший размер,
        рядом появилась надпись "Вы +NK" (Вы - черным шрифтом, +NK - серым),
        элементы расположены в одну строку, не наезжают друг на друга, отображаются корректно
        количество N не изменилось
    - do: обновить страницу
    - assert: количество N не изменилось

  позволяют изменить реакцию:
    - tags:
        - backend_news
        - smoke_zen
    - do: авторизоваться на сервисе и перейти в сюжет без поставленных эмоджи (не из топа новостей, и кроме рубрики 'Спорт'). Обратите внимание! Сюжет без проставленных эмоджи означает, что в сюжете нет НИ ЕДИНОЙ эмоджи и есть надпись "Оценить". Внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2021-08-31_20-15-57.png
    - assert: открывается соответствующий сюжет, есть кнопка 'Оценить' со значком смайла,
    - do: тапнуть по кнопке Оценить, выбрать любую эмоджи
    - assert: выбранная эмоджи отобразилась вместо значка смайла, рядом появилась черная надпись "Вы оценили"
    - do: тапнуть 'Вы оценили'
    - assert: |
        выбранная эмоджи и надпись 'Вы оценили' пропали,
        на их месте появились значок смайла и кнопка 'Оценить'
    - do: тапнуть по кнопке 'Оценить'
    - assert: появляется блок с доступными эмоджи
    - do: выбрать другую эмоджи
    - assert: отображается только новая эмоджи и надпись "Вы оценили"
    - do: обновить страницу
    - assert: отображается только последняя выбранная эмоджи и черная надпись "Вы оценили"
    - do: авторизоваться (если были авторизованы, залогиниться другим пользователем)
    - do: в том же сюжете тапнуть по кнопке 'Оценить', выбрать эмоджи, отличную от ранее поставленной
    - assert: |
        отобразилась выбранная эмоджи, рядом появилась надпись "Вы +1" (Вы - черным шрифтом, +1 - серым),
        левее отображается топ эмоджи - эмоджи первого пользователя + выбранная эмоджи

  авторизация через таб эмоджи [manual]:
    - tags:
        - smoke_zen
    - reasonNotToAuto:
      - Нет возможности авторизоваться в тесте через поп-ап
    - do: перейти в сюжет без залогина (кроме рубрики 'Спорт')
    - assert: отображается топ из 3 самых популярных эмоджи, кнопка Оценить и количество оценивших '(N)K', элементы расположены в одну строку, не наезжают друг на друга
    - do: тапнуть на кнопку 'Оценить'
    - assert: |
        появился попап с предложением авторизации 'Хотите оценить новость? Войдите в аккаунт, чтобы оставить свою оценку', отображаются кнопки 'Закрыть' и 'Войти'
        внешний вид поп-апа - https://jing.yandex-team.ru/files/vasekerka/pop-up.png
    - do: нажать на кнопку 'Закрыть'
    - assert: поп-ап авторизации пропадает
    - do: повторно нажать на кнопку 'Оценить'
    - assert: появился попап с предложением авторизации
    - do: нажать на кнопку 'Войти' и авторизоваться на сервисе
    - assert: произошел возврат к сюжету
    - do: тапнуть на кнопку 'Оценить' и кликнуть по любой эмоджи в появившемся блоке
    - assert: |
        блок с доступными эмоджи пропадает,
        выбранная эмоджи появляется справа от трех популярных эмоджи,
        'Оценить' меняется на "Вы +NK", количество N не изменилось

  отображают пользовательские реакции на домене, отличном от ru:
    - tags:
#      - ua_suite
      - by_suite
      - backend_news
      - smoke_zen
    - tlds:
#      - ua
      - by
    - do: перейти в сюжет с эмоджи на домене by
    - do: авторизоваться
    - do: тапнуть по кнопке "Оценить"
    - assert: появляется блок с доступными эмоджи
    - do: выбрать любую эмоджи
    - assert: отобразилась выбранная эмоджи, рядом появилась надпись "Вы +N" (Вы - черным шрифтом, +N - серым)
    - do: обновить страницу
    - assert: отобразилась выбранная эмоджи, рядом надпись "Вы +N" (Вы - черным шрифтом, +N - серым)

  не отображают реакцию "Лайк" в топе эмоджи у траурных сюжетов:
    - do: авторизованным пользователем перейти в траурный сюжет (траурный сюжет содержит упоминания о смерти, тяжелых травмах, либо терракте). В сюжете ОБЯЗАТЕЛЬНО не должно быть реакций - https://jing.yandex-team.ru/files/kossakovskaya/2021-08-31_20-15-57.png
    - do: кликнуть по кнопке "Оценить"
    - assert: появился бабл со списком эмоджи
    - do: кликнуть по первой эмоджи из списка ("Лайк")
    - assert: |
        блок с доступными эмоджи пропадает,
        выбранная эмоджи появляется справа от иконки оценить,
        справа от выбранной эмоджи появилась серая надпись "Вы оценили",
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2021-07-29_17-30-30.png
    - do: авторизоваться под другим пользователем, оставаясь на текущей странице траурного сюжета
    - assert: |
        отображается иконка и кнопка "Оценить",
        справа от "Оценить" отображается цифра 1,
        эмоджи "Лайк" не отображается,
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2021-07-29_17-33-16.png
    - do: кликнуть по кнопке "Оценить"
    - assert: появился бабл со списком доступных эмоджи
    - do: кликнуть по первой эмоджи ("Лайк")
    - assert: |
        блок с доступными эмоджи пропадает,
        выбранная эмоджи появляется справа от иконки оценить,
        справа от выбранной эмоджи появилась серая надпись "Вы +1",
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2021-08-04_17-13-11.png

  не отображают реакцию "Ха-ха" в топе эмоджи у траурных сюжетов:
    - do: авторизованным пользователем перейти в траурный сюжет (траурный сюжет содержит упоминания о смерти, тяжелых травмах, либо терракте). В сюжете ОБЯЗАТЕЛЬНО не должно быть реакций - https://jing.yandex-team.ru/files/kossakovskaya/2021-08-31_20-15-57.png
    - do: кликнуть по кнопке "Оценить"
    - assert: появился бабл со списком эмоджи
    - do: кликнуть по второй эмоджи ("Ха-ха")
    - assert: |
        блок с доступными эмоджи пропадает,
        выбранная эмоджи появляется справа от иконки оценить,
        справа от выбранной эмоджи появилась серая надпись "Вы оценили",
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2021-08-04_17-12-29.png
    - do: авторизоваться под другим пользователем, оставаясь на текущей странице траурного сюжета
    - assert: |
        отображается иконка и кнопка "Оценить",
        справа от "Оценить" отображается цифра 1,
        эмоджи "Ха-ха" не отображается,
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2021-07-29_17-33-16.png
    - do: кликнуть по кнопке "Оценить"
    - assert: появился бабл со списком доступных эмоджи
    - do: кликнуть по второй эмоджи ("Ха-ха")
    - assert: |
        блок с доступными эмоджи пропадает,
        выбранная эмоджи появляется справа от иконки оценить,
        справа от выбранной эмоджи появилась серая надпись "Вы +1",
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2021-07-29_17-36-04.png

  корректно отображаются в темной теме:
    - do: кликнуть по блоку эмоджи
    - assert: отобразился саджест со списком эмоджи

files:
  - features/news/reaction/reaction.phone.hermione.js
# кейсы без пометки [manual] покрыты тут:
# https://github.yandex-team.ru/search-interfaces/frontend/blob/master/services/news/src/mg/components/Reactions/__tests__/Reactions.phone.hermione.js

tags:
  - reaction
  - neo

qa-engineer: a-groza

manager: glushneva

tlds:
  - ru
  - by
  - kz
  - ua
  - com
