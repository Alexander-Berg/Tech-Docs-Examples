feature: Лендинги

specs:
  Первый лендинг:
    Переходы между страницами:
      - tags: no_assessors #дергается ручка, которая не доступна из внешней сети.
      - do: перейти по ссылке https://yandex.ru/turbo?text=bin:turbo-403
      - assert: загрузилась страница лендинга
      - screenshot: внешний вид [first-page]
      - do: кликнуть на кнопку 'Оставить заявку'
      - assert: произошел переход на следующую страницу [https://jing.yandex-team.ru/files/k0nratka/chrome-phone_2.png_2017-11-13_00-47-10.png]
      - screenshot: внешний вид [second-page]
      - do: нажать на кнопку 'Назад' внизу страницы (проскролить вниз, если кнопка не видна)
      - assert: произошел переход на предыдущую страницу
      - do: кликнуть на кнопку 'Оставить заявку'
      - assert: произошел переход на вторую страницу
      - do: заполнить поле 'Телефон' 81234567890
      - do: нажать на кнопку 'Отправить'
      - assert: произошел переход на третью страницу [https://jing.yandex-team.ru/files/k0nratka/Yandeks_Lending_1_2017-11-13_00-48-17.png]
      - screenshot: внешний вид [third-page]
      - do: нажать на кнопку 'Посетить сайт'
      - assert: открылась страница yandex.ru в новой вкладке

    Пользовательское соглашение:
      - do: перейти по ссылке https://yandex.ru/turbo?text=bin:turbo-403
      - assert: проверить, что страница загрузилась
      - do: кликнуть на кнопку 'Оставить заявку'
      - assert: должен произойти переход на следующую страницу
      - do: кликнуть по ссылке 'Пользовательское соглашение'
      - assert: открылась страница соглашения в новой вкладке
      - do: закрыть страницу 'Пользовательское соглашение сервисов Яндекса'
      - do: кликнуть по ссылке 'Подробнее' в тексте под полями ввода
      - assert: открылось модальное окно с заголовком Соглашение и текстом [https://jing.yandex-team.ru/files/k0nratka/chrome-phone_3.png_2017-11-13_00-50-04.png]
      - screenshot: внешний вид [second-page-modal-agreement]
      - do: кликнуть по серой кнопке 'Закрыть' в модальной окне
      - assert: модальное окно с пользовательским соглашением закрылось

    Страница ввода значений:
      - do: перейти по ссылке https://yandex.ru/turbo?text=bin:turbo-403
      - assert: проверить, что страница загрузилась
      - do: кликнуть на кнопку 'Оставить заявку'
      - assert: |
          должен произойти переход на следующую страницу
          поле ввода 'Телефон' должно быть пустым
      - do: заполнить поле 'Телефон' 81234567890
      - assert: в поле ввода должна появиться кнопка очистки (крестик)
      - do: кликнуть на крестик в поле 'Телефон'
      - assert: поле ввода 'Телефон' должно очиститься
      - do: заполнить поле 'Телефон' 81234567890
      - do: выбрать город 'Казань' в поле 'Город'
      - assert: |
          в поле 'Город' выбрано значение 'Казань'
          поле ввода 'Вопрос/комментарий' должно быть пустым
      - do: заполнить поле 'Вопрос/комментарий' мой вопрос
      - assert: в поле ввода должна появиться кнопка очистки (крестик)
      - do: кликнуть на крестик в поле 'Вопрос/комментарий'
      - assert: поле ввода 'Вопрос/комментарий' должно очиститься

  Второй лендинг:
    Валидация полей:
      - params:
          exp_flags:
            - turbopages-org-override-disabled=1
      - do: перейти по ссылке https://yandex.ru/turbo?stub=metrika/landing.json
      - assert: проверить, что страница загрузилась
      - do: кликнуть на кнопку 'Оставить заявку'
      - assert: должен произойти переход на следующую страницу
      - do: кликнуть на кнопку 'Отправить'
      - assert: |
          не должно быть перехода на следующую страницу
          поле 'Телефон' должно покраситься красным
          поле 'Email' должно покраситься красным
      - do: ввести с помощью клавиатуры в поле 'Телефон' *123 (!обязательно ввести знак звездочки перед 123)
      - assert: под полем 'Телефон' должен появиться текст 'Номер телефона указан неверно'
      - do: ввести с помощью клавиатуры в поле 'Телефон' 81234567890
      - assert: |
          под полем 'Телефон' должен пропасть текст ошибки
          поле 'Телефон' должно перестать быть красным
      - do: ввести с помощью клавиатуры в поле 'Email' 11111
      - assert: под полем 'Email' должен появиться текст 'Email указан неверно'
      - do: заполнить поле 'Email' test@example.com
      - assert: |
          под полем 'Email' должен пропасть текст ошибки
          поле 'Email' должно перестать быть красным
      - do: кликнуть по кнопке 'Отправить'
      - tech: Данные с формы должны отправиться в бэкенд
      - assert: должен произойти переход на следующую страницу

    Плавающая кнопка:
      - do: перейти по ссылке https://yandex.ru/turbo?stub=metrika/landing.json
      - assert: проверить, что страница загрузилась
      - do: прокрутить страницу до конца
      - assert: кнопка должна быть внизу экрана, пока не доскролим до подвала странцы

    Проверка счетчиков:
      - tags: no_assessors
      - do: открыть главную страницу поиска, удалить все параметры кроме yandex.ru и добавить в адресную строку к URL '/turbo?text=test-landing-2'
      - assert: проверить, что страница загрузилась
      - tech: проверить серверные счетчики
      - do: кликаем по ссылке 'Яндекс.Директ'
      - tech: счетчик на ссылке работает
      - do: кликнуть на кнопку 'Оставить заявку'
      - assert: проверить, что страничка загрузилась
      - tech: проверить счетчик на кнопке
      - do: кликнуть в поле 'Телефон'
      - tech: счетчик на инпуте работает

    Проверка счетчиков метрики:
      - tags: no_assessors
      - do: открыть главную страницу поиска, удалить все параметры кроме yandex.ru и добавить в адресную строку к URL '/turbo?text=test-landing-2&exp_flags=analytics-disabled=0&_ym_debug=1'
      - assert: проверить, что страница загрузилась
      - do: кликнуть на кнопку 'Оставить заявку'
      - assert: должен произойти переход на следующую страницу
      - tech: счетчик на кнопке работает
      - tech: счетчик на переход на следующую страницу работает
    
    Реальный лендинг:
      - tags: no_assessors
      - do: перейти по ссылке https://yandex.ru/turbo?text=lpc%2Ff1631fc7b21f1a5ca1ca34c6e1d3c4c8236174737e35b473303b089cbd2556ec&yclid=4498062521165450332
      - screenshot: внешний вид соответствует [plain]

files:
  - features/landings/test-landing/test-landing.hermione.js

v-team: Turbo

manager: tanzwuta

qa-engineer: kleev, k0nratka


tlds: none
