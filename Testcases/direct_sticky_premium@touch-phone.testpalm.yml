feature: Залипающий рекламный сниппет

specs:
  Внешний вид:
    - tags: smoke
    - params:
        foreverdata: '755453079'
    - do: |
        на устройстве с размером экрана больше 320х571 pts получить выдачу по запросу "foreverdata" (диагональ экрана устройства должна быть больше 4,1 дюймов)
        проскроллить выдачу вниз
    - assert: появился залипающий сниппет
    - do: проскроллить выдачу в самый верх
    - assert: залипающий сниппет скрылся
    - do: проскроллить выдачу вниз
    - assert: появился залипающий сниппет
    - screenshot: пример внешнего вида (текст и наличие элементом может отличаться - не баг) [design]
    - do: кликнуть в тайтл
    - tech: сработал счётчик /tech/direct/sticky/title
    - assert: произошел переход на сторонний сайт (вид и содержание открывшейся ссылки проверять не требуется)
    - do: |
        вернуться на страницу с выдачей
        проскроллить выдачу вниз
    - do: кликнуть в крестик в залипающем сниппете
    - assert: залипающий сниппет исчез
    - tech: сработал счётчик /tech/direct/sticky/close
    - assertMetrics: '*'
  Работа с реакт-шапкой:
    - params:
        foreverdata: '2058618529'
        exp_flags:
          - beauty_react_header=1
    - do: |
        на устройстве с размером экрана больше 320х571px получить выдачу по запросу "котангенс градусов солома"
        проскроллить выдачу к началу карточки первого сниппета
    - assert: залипающий сниппет не появился
    - do: проскроллить выдачу ниже начала карточки первого сниппета
    - assert: залипающий сниппет появился без рывка относительно тайтла первого сниппета
  Только age:
    - tags:
        - disclaimer
    - params:
        foreverdata: '3078547671'
    - do: |
        на устройстве с размером экрана больше 320х571 pts получить выдачу по запросу "foreverdata" (диагональ экрана устройства должна быть больше 4,1 дюймов)
        проскроллить выдачу вниз
    - assert: появился залипающий сниппет с меткой 18+ справа от лейблы
    - screenshot: внешний вид [plain]
    - assertMetrics: '*'
  Мед. метки и age:
    - tags:
        - disclaimer
    - params:
        foreverdata: '1146319888'
    - do: |
        на устройстве с размером экрана больше 320х571 pts получить выдачу по запросу "foreverdata" (диагональ экрана устройства должна быть больше 4,1 дюймов)
        проскроллить выдачу вниз
    - assert: появился залипающий сниппет с мед. меткой и 18+
    - screenshot: внешний вид [plain]
    - assertMetrics: '*'
  Обычная метка и age:
    - tags:
        - disclaimer
    - params:
        foreverdata: '2964993958'
    - do: |
        на устройстве с размером экрана больше 320х571 pts получить выдачу по запросу "foreverdata" (диагональ экрана устройства должна быть больше 4,1 дюймов)
        проскроллить выдачу вниз
    - assert: появился залипающий сниппет с обычной меткой и 18+
    - screenshot: внешний вид [plain]
    - assertMetrics: '*'
  Обычная метка:
    - tags:
        - disclaimer
    - params:
        foreverdata: '2238825498'
    - do: |
        на устройстве с размером экрана больше 320х571 pts получить выдачу по запросу "foreverdata" (диагональ экрана устройства должна быть больше 4,1 дюймов)
        проскроллить выдачу вниз
    - assert: появился залипающий сниппет с обычной меткой
    - screenshot: внешний вид [plain]
    - assertMetrics: '*'
  Работа с колдунщиком картинок:
    - params:
        foreverdata: '710536607'
        text: котики
    - do: |
        на устройстве с размером экрана больше 320х571 pts получить выдачу по запросу "foreverdata" (диагональ экрана устройства должна быть больше 4,1 дюймов)
        проскроллить выдачу вниз до колдунщика картинок
        кликнуть в первую картинку
    - assert: |
        открылся просмотрщик картинок
        баннер с рекламой скрылся
    - do: нажать в крестик, закрывающий просмотрщик картинок
    - assert: |
        просмотрщик картинок скрылся
        появился баннер с рекламой
  Обратный скролл:
    - params:
        foreverdata: '710536607'
    - do: |
        на устройстве с размером экрана больше 320х571 pts получить выдачу по запросу "foreverdata" (диагональ экрана устройства должна быть больше 4,1 дюймов)
        проскроллить выдачу вниз
        поскроллить выдачу наверх
    - assert: появился залипающий сниппет
    - screenshot: внешний вид [reverse]
    - assertMetrics: '*'

files:
  - features/direct_sticky_premium/direct_sticky_premium@touch-phone.hermione.js

browsers:
  notFor:
    - iphone
    - chrome-phone

v-team: Distribution

tags:
  - skip_e2e_check
  - adv
  - adv_sticky
  - pp_new_core

tlds: ru
