feature: Расширенный факт

specs:
  aliases:
    - &openEComFact
      - do: получить выдачу по запросу 'как выбрать холодильник'
      - assert: |
          на выдаче присутствует фактовый ответ

  Несколько источников:
    - params:
        foreverdata: '1459605187'
    - do: получить выдачу по запросу "foreverdata"
    - assert: на странице присутствует быстрый ответ
    - screenshot: внешний вид [plain]
    - do: нажать на первую ссылку "найдено на ..."
    - assert: произошёл переход на страницу
    - tech: сработал счётчик path="/$page/$main/$result/rich_fact/source-link"

  Выделение цветом:
    - params:
        foreverdata: '2010421768'
    - do: получить выдачу по запросу "foreverdata"
    - assert: |
        на странице присутствует быстрый ответ
        в заголовке быстрого ответа есть текст выделенный зелёным цветом
    - screenshot: внешний вид [plain]

  Несколько правил:
    - params:
        foreverdata: '1182951221'
    - do: получить выдачу по запросу "foreverdata"
    - assert: |
        на странице присутствует быстрый ответ
        в заголовке быстрого ответа есть текст выделенный зелёным цветом
    - screenshot: внешний вид [plain]

  Таблица:
    - params:
        foreverdata: '3462775540'
    - do: получить выдачу по запросу "foreverdata"
    - assert: на странице присутствует быстрый ответ с таблицей
    - screenshot: внешний вид [plain]

  Брендинг:
    - params:
        foreverdata: '422557946'
    - do: получить выдачу по запросу "foreverdata"
    - assert: на странице присутствует быстрый ответ
    - screenshot: внешний вид [plain]

  Длинный список:
    - params:
        foreverdata: '1917632869'
    - do: получить выдачу по запросу "foreverdata"
    - assert: на странице присутствует быстрый ответ со списком из 10 элементов
    - screenshot: внешний вид [plain]

  Разворачивание списка:
    - params:
        foreverdata: '3317947206'
    - do: получить выдачу по запросу "foreverdata"
    - assert: на странице присутствует быстрый ответ со списком
    - screenshot: внешний вид [collapsed]
    - do: нажать на первую ссылку "Читать ещё N пунктов"
    - tech: сработал счётчик path="/$page/$main/$result/rich_fact/list-collapser-toggle"
    - assert: список раскрылся
    - screenshot: внешний вид [expanded]

  Фрагмент:
    - params:
        foreverdata: '2359266519'
        exp_flags: 'fact_doc_sum=chapter'
    - do: получить выдачу по запросу "foreverdata"
    - assert: на странице присутствует быстрый ответ
    - screenshot: внешний вид [plain]
    - do: кликнуть в первый раскрывающийся элемент
    - assert: элемент раскрылся
    - screenshot: внешний вид [opened]
    - do: кликнуть во внутренний раскрывающийся элемент
    - assert: элемент раскрылся
    - screenshot: внешний вид [opened-collapser]

  Проверка source в $result:
    - do: получить выдачу по запросу "как сделать скриншот на макбуке"
    - tech: в счетчике $result содержится атрибут source, значение которого равно "apple_facts"

  ECom факт:
    Внешний вид:
      - params: 
          rearr: scheme_blender/commands/after_blend/move_mds_ecom={\"Cmd\":\"nail_intent_doc\",\"on\":1,\"MoveTo\":2,\"IntentName\":\"mds_ecom\"}
          srcparams: FASTRES2=WizardsEnabled/ecom_research_amorgun11=1
      - *openEComFact
      - screenshot: внешний вид фактового ответа [plain]
    
    Внешний вид с расхлопом:
      - params: 
          rearr: scheme_blender/commands/after_blend/move_mds_ecom={\"Cmd\":\"nail_intent_doc\",\"on\":1,\"MoveTo\":2,\"IntentName\":\"mds_ecom\"}
          srcparams: FASTRES2=WizardsEnabled/ecom_research_amorgun11=1
      - *openEComFact
      - do: нажать на первый элемент коллапсера
      - assert: коллапсер раскрылся
      - screeshot: содержимое открытого коллапсера [plain]

    Проверка счётчиков:
      Кнопка снизу факта:
        - params: 
            rearr: scheme_blender/commands/after_blend/move_mds_ecom={\"Cmd\":\"nail_intent_doc\",\"on\":1,\"MoveTo\":2,\"IntentName\":\"mds_ecom\"}
            srcparams: FASTRES2=WizardsEnabled/ecom_research_amorgun11=1
        - *openEComFact
        - do: кликнуть на кнопку внизу факта
        - tech: сработал счётчик path='$page/$main/$result/rich_fact/detailed'

      Кнопка в расхлопнутом колапсере:
        - params: 
            rearr: scheme_blender/commands/after_blend/move_mds_ecom={\"Cmd\":\"nail_intent_doc\",\"on\":1,\"MoveTo\":2,\"IntentName\":\"mds_ecom\"}
            srcparams: FASTRES2=WizardsEnabled/ecom_research_amorgun11=1
        - *openEComFact
        - do: кликнуть во второй элемент расхлопывающегося списка
        - tech: сработал счётчик path='$page/$main/$result/rich_fact/Collapser/open'
        - assert: | 
            элемент списка расхлопнулся
            появилось содержмиое расхлопнутого элемента списка
        - do: клинуть на кнопку внизу расхлопнутого элемента списка
        - tech: сработал счётчик path='$page/$main/$result/rich_fact/Collapser/detailed'

files:
  - src/features/RichFact/RichFact.tests/RichFact@common.hermione.js

v-team: Facts

tags:
  # Эксперимент
  - skip_e2e_check
  - react

tlds: ru
