feature: Внутренний оффер
type: Согласование

description: |
  После прохождения кейса 'Заполнение формы 'Отправка оффера на согласование' проверить:
  - в тикете TJOB появился комментарий о запуске согласования в TSALARY;
  - в тикете TSALARY статус 'Согласование в HR', в комментарии добавилось согласование, создаем согласование и нажимаем ОК за всех согласующих -> статус оффера поменялся на статус 'Согласование';
  - после согласование в TSALARY -> в тикете TJOB меняется статус на 'Согласование в HR' и добавляется комментарий с информацией по вакансии и с согласованием, OK создаем и согласовываем;
  - в тикете TJOB поменять статус, нажав на 'Оффер согласован'(БП должна быть от 10000 до 19999);
  - в тикете TJOB статус поменялся на 'Решен' и тут же проставилась резолюция у тикета 'Перевод';
  - в оффере появился тикет на релокацию TEST и статус изменился на 'Принят'.

specs:
    beforeEach:
        - do: открыть страницу оффера offers/<id_оффера>/ со статусом 'Готов к согласованию' и типом вывода 'Ротация'
        - screenshot: присутствуют кнопки 'Редактировать', 'На согласование', 'Удалить' [offer_actions]
        - do: нажать 'На согласование'
        - assert: открылось модальное окно 'Отправка оффера на согласование'
        - screenshot: пример внешнего вида модального окна 'Отправка оффера на согласование' [offer_form_approve]
    Проверка обязательных полей:
        - do: удалить все варианты из поля 'Сервисы АBC'
        - do: в модальном окне нажать 'На согласование'
        - screenshot: под обязательными полями появились ошибки [offer_form_approve_validation]
    Заполнение формы 'Отправка оффера на согласование':
        - do: в поле 'Сервисы ABC' указать 'Фемида'
        - do: в поле 'Профессиональный уровень' выбрать значение на выбор
        - do: нажать 'На согласование'
        - assert: |
            модальное окно пропало
            данные соответствуют введенным в форме 'Отправка оффера на согласование'
            напротив 'Оффер' присутствуют кнопки 'Редактировать', 'Удалить'
            оффер поменял статус на 'Согласование ротации отдающей стороной'
        - screenshot: пример внешнего вида шапки оффера [offer_form_approve_success]

tags:
  - reviewed

priority: blocker

files:
  - tests/hermione/suites/desktop/candidates/internal_offers/internal_offer_approve/internal_offer_approve.hermione.js

browsers:
  - yandex-browser-desktop
  - firefox-desktop
  - safari-desktop
