feature: Страница новостей
type: С бесконечной лентой новостей
experiment: С внешними бандлами

params:
  exp_flags:
    - enable-external-bundles=1

specs:
  aliases:
    - &StartForNewsInfinite_1
      - do: получить выдачу по запросу 'foreverdata' и кликнуть в заголовок первого сниппета (название заголовка Тестовая страница для NewsInfinite-1 — турбо)
      - assert: открывается турбо-страница в новой вкладке

    - &StartForNewsInfinite_2
      - do: получить выдачу по запросу 'foreverdata' и кликнуть в заголовок первого сниппета (название заголовка Тестовая страница для NewsInfinite-2 — турбо)
      - assert: открывается турбо-страница в новой вкладке

  Порядок загрузки и инициализации с минимальной новости:
    - params:
        foreverdata: '2251695851'
    - do: получить выдачу по запросу 'foreverdata' и кликнуть в заголовок первого сниппета (название заголовка Тестовая страница для NewsInfinite-1 — турбо)
    - assert: |
        открывается турбо-страница в новой вкладке
        проверить, что загрузилась базовая новость с ракеткой в правом верхнем углу и заголовком 'Новость №1'
    - tech: сработал счетчик ошибки несуществующей новости '/turbo?text=bbbbbbb' (/turbo/ajax/empty)
    - assert: |
        под новостью с заголовком 'Новость №1' дожна подгрузиться связанная новость с заголовком 'Новость №2'
        в новости с заголовком 'Новость №2' отображается картинка
        в новости с заголовком 'Новость №2' есть кнопка меню рядом с ракеткой (3 полоски)
    - do: кликнуть на меню
    - assert: справа налево должно выехать меню меню
    - do: кликнуть по темной зоне слева меню
    - assert: меню закрылось
    - do: проскроллить до конца страницы
    - assert: должна подгрузиться новость с заголовком 'Новость №3'
    - do: проскроллить до конца страницы
    - assert: должна подгрузиться новость с заголовком 'Новость №4'
    - screenshot: внешний вид [plain]

  Инициализация с полной новости:
    - params:
        foreverdata: '765028790'
    - *StartForNewsInfinite_2
    - assert: |
        проверить, что загрузилась базовая новость с ракеткой в правом верхнем углу и заголовком 'Новость №2'
        в первой новости с заголовком 'Новость №2' есть кнопка меню рядом с ракеткой (3 полоски)
        в первой новости с заголовком 'Новость №2' отображается картинка
    - do: проскроллить до конца страницы
    - assert: |
        должна подгрузиться новость с заголовком 'Новость №4'
        в новости с заголовком 'Новость №4' в заголовке нет кнопки меню рядом с ракетком

files:
  - features/touch-phone/pages/with-related-by-ajax/with-external-async-modules.hermione.js

v-team: Turbo

manager: gfranco

qa-engineer: olga0321, dakhetov

tlds: none
