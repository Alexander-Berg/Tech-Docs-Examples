feature: Жалобщик

specs:
  beforeEach:
    #TODO SERP-64184 добавить в джемини скрин попапа по умолчанию
    - do: получить выдачу по запросу 'test'
    - assert: в гринурле первого сниппета есть три точки
    - do: кликнуть в три точки
    - assert: |
        появилось выпадающее меню,
        в меню есть пункт 'Пожаловаться' [https://jing.yandex-team.ru/files/loreley/feedback-tessst.jpg]
    - tech: проверить счетчик в пункте 'Пожаловаться' '/web/item/abuse'
    - do: кликнуть 'Пожаловаться'
    - assert: |
        появился попап жалобщика,
        сниппет выделен рамкой
  Закрытие попапа:
    Кликом по паранже:
      - do: кликнуть мимо попапа
      - assert: попап жалобщика закрылся
    По нажатию на кнопку Esc:
      - do: нажать клавишу 'Esc' на клавиатуре
      - assert: попап жалобщика закрылся
    Кликом по крестику:
      - do: кликнуть в иконку крестика
      - assert: попап жалобщика закрылся
  Паранжа при открытии:
    - screenshot: внешний вид [feedback-loading-paranja]
    - assert: полупрозрачная паранджа при открытии жалобщика над шапкой
  Пожаловаться на результат:
    - do: посмотреть на попап и выдачу под попапом
    - screenshot: внешний вид [feedback-popup]
    - assert: |
        в попапе выбран вариант 'На этот результат',
        первый сниппет выделен рамкой
    - do: установить чекбокс для 1-й и 2-й причины жалобы
    - screenshot: пример внешнего вида [checks]
    - assert: кнопка 'Пожаловаться' в попапе стала активной
    - do: кликнуть на кнопку 'Пожаловаться'
    - tech: проверить ajax-запрос
    - assert: поменялось содержимое в попапе и появилась кнопка 'Вернуться на Яндекс'
    - screenshot: пример внешнего вида попапа [success]
    - do: кликнуть кнопку 'Вернуться'
    - assert: попап жалобщика закрылся
  Пожаловаться на страницу:
    - do: выбрать в попапе вариант 'На всю страницу'
    - assert: в попапе выбран вариант 'На всю страницу'
    - do: установить чекбокс для 1-й и 2-й причины жалобы
    - assert: кнопка 'Пожаловаться' в попапе стала активной
    - do: кликнуть на кнопку 'Пожаловаться'
    - assert: поменялось содержимое в попапе и появилась кнопка 'Вернуться'
    - tech: проверить ajax-запрос
    - do: кликнуть кнопку 'Вернуться'
    - assert: попап жалобщика закрылся
  Повторное открытие жалобщика:
    - do: нажать esc для закрытия попапа
    - assert: попап жалобщика закрылся
    - do: кликнуть в три точки
    - assert: |
        появилось выпадающее меню,
        в меню есть пункт 'Пожаловаться' [https://jing.yandex-team.ru/files/dindikovans/feedback.png]
    - tech: проверить счетчик в пункте 'Пожаловаться' '/web/item/abuse'
    - do: кликнуть 'Пожаловаться'
    - assert: |
        появился попап жалобщика,
        сниппет выделен рамкой

files:
  - features/desktop/feedback/feedback.hermione.js


tlds: all

v-team: UGC

tags:
  - reviewed
  - skip_e2e_check
  - organic
  - extralink
