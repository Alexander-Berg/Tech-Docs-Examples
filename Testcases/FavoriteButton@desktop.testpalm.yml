feature: Яндекс.Избранное

specs:
  Незалогин:
    Карточка фильма:
      - params:
          text: Чудо-женщина
          exp_flags: 'es_favorites_redesign=true'
          rearr: 'entsearch_experiment=enable-favorites-info;scheme_Local/EntitySearch/MarkFavoriteItems=1'
      - do: получить выдачу по запросу 'Чудо-женщина'
      - assert: |
          появилась карточка фильма,
          в карточке есть кнопка добавления в избранное
      - screenshot: внешний вид кнопки 'Добавить в избранное' в карточке объекта [plain]
      - do: кликнуть по кнопке 'Добавить в избранное'
      - tech: сработал счетчик клика по кнопке /$page/favorite-add-button
      - assert: |
          появился тултип (небольшой попап с хвостиком) рядом с кнопкой,
          в тултипе есть кнопка 'Войти и изменить'
      - screenshot: внешний вид кнопки 'Добавлено в избранное' и тултипа рядом [saved-anonym]
      - tech: сработал счетчик клика по кнопке /$page/favorite-added-button
      - do: кликнуть по кнопке 'Войти и изменить'
      - assert: открылась страница паспорта

  Залогин:
    params:
      yandex_login: pds.user.no.license

    Карточка фильма:
      - params:
          text: Чудо-женщина
          exp_flags: 'es_favorites_redesign=true'
          rearr: 'entsearch_experiment=enable-favorites-info;scheme_Local/EntitySearch/MarkFavoriteItems=1'
      - do: залогиниться на портале
      - do: получить выдачу по запросу 'Чудо-женщина'
      - assert: |
          появилась карточка объекта,
          в карточке есть кнопка добавления в избранное
      - screenshot: внешний вид кнопки добавления в коллекцию в карточке объекта [plain]
      - do: кликнуть по кнопке добавления в коллекцию
      - tech: сработал счетчик клика по кнопке /$page/favorite-add-button
      - assert: открылся попап с предложением добавить фильм в коллекцию
      # TODO: https://st.yandex-team.ru/PODB-20911
      # - screenshot: внешний вид попапа [modal]
      # - do: добавить фильм в любую коллекции (можно в 'Мои фильмы')
      # - assert: |
      #    попап закрылся,
      #    кнопка сменилась на закрашенный флажок
      #    появился тултип внизу экрана
      # - screenshot: внешний вид кнопки добавления в коллекцию и тултипа рядом [saved]
      # - do: кликнуть по кнопке добавления в коллекцию (удаляем из коллекции)
      # - assert: |
      #    кнопка сменилась на незакрашенный флажок
      #    тултип закрылся
      # - do: кликнуть по кнопке добавления в коллекцию
      # - assert: появился тултип рядом с кнопкой с процессом добавления
      # - assert: |
      #    кнопка сменилась на закрашенный флажок,
      #    содержимое тултипа сменилось в состояние успешного добавления
      # - screenshot: внешний вид кнопки добавления в коллекцию и тултипа рядом [saved-again]

files:
  - src/features/FavoriteButton/FavoriteButton.test/FavoriteButton@desktop.hermione.js

v-team: Favorites

tags:
  - skip_e2e_check
  - no_assessors

tlds: all
