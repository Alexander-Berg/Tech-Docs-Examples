feature: Вложенные сервисы 
 
specs:
  Вложенные сервисы:
    beforeEach:
     - tech: залогиниться под пользователем robot-abc-002
     - do: открыть сервис "autotest-nested-services" на вкладке "Вложенные сервисы" (/services/autotest-nested-services/services/)
     - screenshot: отображаются вложенные сервисы и блок с фильтрами справа [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2020-11-41.png]

    1. Отображение вложенных сервисов для конкретного сервиса:
      - automation: ABC-10153
      - assert: в блоке с фильтрами по умолчанию выбраны фильтры по статусу сервиса - "Развивается", "Поддерживается" и "Требуется информация"
      - do: кликнуть на стрелочку (>) рядом с сервисом "autotest-descendant-1"
      - screenshot: дерево сервисов раскрылось, показаны два вложенных - "autotest-descendant-1-1" и "autotest-descendant-1-2" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2021-16-33.png]
      - do: кликнуть на стрелочку (>) рядом с сервисом "autotest-descendant-1"
      - assert: вложенные сервисы и информация по ним скрылась 

    2. Фильтрация вложенных сервисов по названию:
     - automation: ABC-10154
     - assert: в URL нет параметра "?search="  
     - do: заполнить фильтр "Название" значением "descendant-1"
     - screenshot: фильтр применился, отображаются сервисы, в названии которых есть "descendant-1", в фильтрах над списком сервисов есть "Название descendant-1" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2020-23-15.png]
     - assert: в URL появился параметр "?search=descendant-1"
     - do: в фильтрах над списком сервисов кликнуть на крестик в сером блоке "Название descendant-1"
     - assert: |
            в блоке с фильтрами поле "Название" очистилось
            над списком сервисов есть только серый блок с фильтром "Статус Развивается, Поддерживается, Требуется информация"
            в URL параметр "?search=" пустой
     - screenshot: отображаются вложенные сервисы, содержащие в названии не только "descendant-1" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-17%2015-20-38.png]

    3. Фильтрация вложенных сервисов по участнику:
     - automation: ABC-10154
     - assert: в URL нет параметра "?member="  
     - do: в блоке с фильтрами ввести в поле "Участник" значение "ivanovaox"
     - assert: под полем появился выпадающий список, в котором есть вариант "Oxana Ivanova"
     - do: кликнуть на вариант "Oxana Ivanova"
     - screenshot: фильтр применился; отображаются сервисы "autotest-descendant-1" (светло-голубым цветом) и "autotest-descendant-1-1" (синим цветом); в фильтрах над списком сервисов есть "Участник Oxana Ivanova", в блоке с фильтрами справа тоже выбран "Oxana Ivanova" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2020-46-05.png]
     - assert: в URL появился параметр "?member=ivanovaox"
     - do: в фильтрах над списком сервисов кликнуть на крестик в сером блоке "Участник Oxana Ivanova"
     - assert: |
            в блоке с фильтрами исчез выбранный вариант "Oxana Ivanova" под полем "Участник" 
            над списком сервисов есть только серый блок с фильтром "Статус Развивается, Поддерживается, Требуется информация"
            в URL параметр "?member=" пустой
     - screenshot: отображаются все вложенные сервисы [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-17%2015-21-39.png]

    4. Фильтрация вложенных сервисов по руководителю:
     - automation: ABC-10154
     - assert: в URL нет параметра "?owner="  
     - do: в блоке с фильтрами ввести в поле "Руководитель" значение "medvedeva-an"
     - assert: под полем появился выпадающий список, в котором есть вариант "Anna Medvedeva"
     - do: кликнуть на вариант "Anna Medvedeva"
     - screenshot: фильтр применился, отображается сервис "autotest-descendant-2"; в фильтрах над списком сервисов есть "Руководитель Anna Medvedeva"; в блоке с фильтрами справа тоже выбран "Anna Medvedeva" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2021-55-22.png]
     - assert: в URL появился параметр "?owner=medvedeva-an"
     - do: в фильтрах над списком сервисов кликнуть на крестик в сером блоке "Руководитель Anna Medvedeva"
     - assert: |
            в блоке с фильтрами исчез выбранный вариант "Anna Medvedeva" под полем "Руководитель" 
            над списком сервисов есть только серый блок с фильтром "Статус Развивается, Поддерживается, Требуется информация"
            в URL параметр "?owner=" пустой
     - screenshot: отображаются все вложенные сервисы [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-17%2015-22-27.png]

    5. Фильтрация вложенных сервисов по подразделению:
     - automation: ABC-10154
     - assert: в URL нет параметра "?department="  
     - do: в блоке с фильтрами ввести в поле "Подразделение" значение "Внешние консультанты Группа асессоров-тестировщиков в Казахстане"
     - assert: под полем появился выпадающий список, в котором есть вариант "Внешние консультанты Группа асессоров-тестировщиков в Казахстане"
     - do: кликнуть на вариант "Внешние консультанты Группа асессоров-тестировщиков в Казахстане"
     - screenshot: фильтр применился, отображается сервис "autotest-descendant-3", в фильтрах над списком сервисов есть "Подразделение Внешние консультанты Группа асессоров-тестировщиков в Казахстане", в блоке с фильтрами справа тоже выбрано это же подразделение [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2020-57-24.png]
     - assert: в URL появился параметр "?department=5"
     - do: в фильтрах над списком сервисов кликнуть на крестик в сером блоке "Подразделение Внешние консультанты Группа асессоров-тестировщиков в Казахстане"
     - assert: |
            в блоке с фильтрами исчезло выбранное подразделение под полем "Подразделение"
            над списком сервисов есть только серый блок с фильтром "Статус Развивается, Поддерживается, Требуется информация"
            в URL параметр "?department=" пустой
     - screenshot: отображаются все вложенные сервисы [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2020-11-41.png]

    6. Фильтрация вложенных сервисов по статусу сервиса:
     - automation: ABC-10154
     - assert: в блоке "Статус сервиса" отмечены галочками статусы "Развивается", "Поддерживается", "Требуется информация"
     - do: в блоке "Статус сервиса" снять галочку напротив статуса "Развивается"
     - assert: |
            в блоке "Статус сервиса" отмечены галочками статусы "Поддерживается" и "Требуется информация"
            в списке показаны только два сервиса - "autotest-descendant-2" и "autotest-descendant-3"
            в блоке с фильтрами над списком сервисов есть один фильтр - "Статус Поддерживается, Требуется информация"
            в URL есть параметры "?states=supported&states=needinfo"
     - screenshot: внешний вид списка сервисов после фильтрации [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2021-11-55.png]
     - do: кликнуть на крестик в сером блоке над списком сервисов "Статус Поддерживается, Требуется информация"
     - screenshot: список сервисов обновился, показаны сервисы "autotest-closed-descendant", "autotest-descendant-1", "autotest-descendant-2", "autotest-descendant-3", "autotest-descendant-4", "autotest-descendant-5"; фильтры в блоке справа не заполнены никакими значениями [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2021-14-11.png]
     - assert: в URL параметр "?states=" пустой

    7. Фильтрация вложенных сервисов по наличию внешних участников:
     - automation: ABC-10154
     - assert: в URL нет параметра "hasExternalMembers="
     - do: в фильтрах справа в блоке "Внешние участники" поставить галочку напротив пункта "Без внешних"
     - assert: |
            список сервисов обновился 
            над списком сервисов добавился выбранный фильтр "Без внешних"
            в фильтрах справа в блоке "Внешние участники" пункт "Без внешних" отмечен галочкой 
            в URL есть параметр "hasExternalMembers=false"
     - screenshot: в списке сервисов нет ни одного сервиса, у которого был бы значок "Стрелочка" для отображения наличия внешних участников в столбце "Статус" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2021-24-11.png]
     - do: кликнуть на крестик в сером блоке над списком сервисов "Без внешних"
     - screenshot: список сервисов обновился, показаны все сервисы - "autotest-descendant-1", "autotest-descendant-2", "autotest-descendant-3", "autotest-descendant-4", "autotest-descendant-5"; в блоке с фильтрами нет галочки напротив пункта "Без внешних [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2021-26-20.png]
     - assert: в URL параметр "?hasExternalMembers=" пустой

    8. Фильтрация вложенных сервисов по тегам:
     - automation: ABC-10154
     - assert: в URL нет параметра "tags="  
     - do: в блоке с фильтрами кликнуть в поле "Теги" 
     - assert: под полем появился выпадающий список, в котором есть вариант "GDPR"
     - do: кликнуть на вариант "GDPR"
     - screenshot: фильтр применился, отображается сервис "autotest-descendant-1", в фильтрах над списком сервисов есть "Теги GDPR", в блоке с фильтрами справа тоже выбран тег "GDRP" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2021-30-56.png]
     - assert: в URL появился параметр "tags=2"
     - do: кликнуть на стрелочку (>) рядом с сервисом "autotest-descendant-1"
     - screenshot: показан один вложенный сервис "autotest-descendant-1-2", у которого есть тег "GDPR" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2021-32-47.png]
     - do: в фильтрах над списком сервисов кликнуть на крестик в сером блоке "Теги GDPR"
     - assert: |
            в блоке с фильтрами выбранный тег "GDPR" под полем "Теги" исчез
            над списком сервисов есть только серый блок с фильтром "Статус Развивается, Поддерживается, Требуется информация"
            в URL параметр "?tags=" пустой
     - screenshot: отображаются все вложенные сервисы [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-11%2016-56-09.png]

    9. Применение комбинации фильтров и сброс всех выбранных фильтров:
     - automation: ABC-10154
     - do: в блоке с фильтрами справа в поле "Название" ввести "2"
     - do: в поле "Участник" ввести "medvedeva-an"
     - assert: под полем "Участник" появился выпадающий список с вариантом "Anna Medvedeva"
     - do: кликнуть по варианту "Anna Medvedeva"
     - do: в поле "Руководитель" ввести "medvedeva-an"
     - assert: под полем "Руководитель" появился выпадающий список с вариантом "Anna Medvedeva"
     - do: кликнуть по варианту "Anna Medvedeva"
     - do: в блоке "Статус сервиса" снять все галочки, кроме статуса "Поддерживается"
     - screenshot: заполненный блок с фильтрами [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2021-58-45.png]
     - screenshot: в списке сервисов показан только один сервис - "autotest-descendant-2", над списком есть фильтры - "Название 2", "Участник Anna Medvedeva", "Руководитель Anna Medvedeva", "Статус Поддерживается" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2022-01-08.png]
     - do: кликнуть на надпись "очистить все фильтры", расположенную над списком сервисов
     - screenshot: все выбранные фильтры над списком сервисов пропали; показаны все доступные вложенные сервисы; в блоке с фильтрами справа нет заполненных значений [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-08%2022-02-00.png]

    10. Плашка отсутствия результатов поиска:
     - automation: ABC-10154
     - do: открыть страницу с вложенными для "autotest-nested-services" сервисами с предустановленными фильтрами (/services/autotest-nested-services/services/?search=no-name-service)
     - screenshot: над списком сервисов есть фильтры "Название no-name-service" и "Статус Развивается, Поддерживается, Требуется информация"; вместо списка сервисов - плашка с текстом "Ни один сервис не попадает под выбранные фильтры" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-09%2013-32-02.png]

    11. Переход на страницу вложенного сервиса:
     - automation: ABC-10154
     - do: кликнуть на название сервиса "autotest-descendant-5"
     - assert: в той же вкладке произошёл переход на страницу сервиса "autotest-descendant-5" (/services/autotest-descendant-5/)

files: []

priority: critical

tags:
 - reviewed
