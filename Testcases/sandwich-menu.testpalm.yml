feature: sandwich-menu

specs:
  Стандартное меню:
    params:
      foreverdata: '1826589425'

    beforeEach:
      - do: получить выдачу по запросу 'foreverdata' и кликнуть в заголовок первого сниппета (название заголовка Тестовая cтраница для Test-gismeteo — турбо)
      - assert: открывается турбо-страница в той же вкладке (в поисковом приложении Яндекс турбо-страница открывается в новой вкладке)

    Проверка открытия и закрытия меню:
      - screenshot: внешний вид кнопки открытия меню [button-open]
      - do: кликнуть на иконку меню
      - screenshot: должно выехать меню, внешний вид после клика [menu]
      - do: кликнуть на серую зону
      - assert: меню должно скрыться
      - do: снова раскрыть меню нажатием на иконку
      - assert: меню раскрылось
      - do: кликнуть на иконку крестика
      - assert: меню скрылось

    Проверка возможности скроллить меню:
      - do: кликнуть на иконку меню
      - assert: должно выехать меню
      - do: проскролить меню
      - assert: должна быть видима ссылка с названием "Самый последний пункт"

    Проверка ссылки внутри меню:
      - do: кликнуть на иконку меню
      - do: кликнуть по любому пункту в открывшемся меню
      - assert: в новой вкладке открывается сайт гисметео

    Проверка отсутствия скролла по кнопке:
      - do: кликнуть на иконку меню
      - assert: должно выехать меню
      - do: провести пальцем вниз по серой зоне слева от меню
      - assert: страница под меню не скроллится
      - do: попробовать прокрутить меню вверх
      - assert: контент позади меню остался на месте
      - do: прокрутить меню в самый низ
      - do: попытаться прокрутить меню еще ниже
      - assert: меню осталось на месте

  Меню с якорями:
    Скрывает меню по клику на якорь:
      - do: открыть главную страницу поиска, удалить все параметры кроме yandex.ru и добавить в адресную строку к URL /turbo?stub=sandwich-menu/default.json
      - do: кликнуть на иконку меню
      - assert: справа выехало меню
      - do: нажать на первый элемент меню
      - assert: |
          меню закрылось
          cтраница проскроллилась до элемента "Кнопка - якорь"
      - tech: на странице отсутствуют клиентские ошибки

  Расширенное меню:
    params:
      foreverdata: '717002954'

    beforeEach:
      - do: получить выдачу по запросу 'foreverdata' и кликнуть в заголовок первого сниппета (название заголовка Тестовая страничка для нового меню)
      - assert: открывается турбо-страница в той же вкладке (в поисковом приложении Яндекс турбо-страница открывается в новой вкладке)
      - do: кликнуть на иконку меню
      - assert: справа выехало меню

    Внешний вид:
      - screenshot: внешний вид меню соответствует скриншоту [extended]

    Открывает и закрывает спойлер:
      - do: нажать на строку первый элемент меню, содержащий спойлер (черную стрелку справа)
      - assert: спойлер расскрылся, внутри видно содержимое, внешний вид аналогичен примеру [accordion-expanded]
      - do: нажать на первую строку внутри спойлера, содержащую спойлер
      - screenshot: спойлер раскрылся, внутри видно содержимое, внешний вид аналогичен примеру [accordion-expanded-inner]
      - do: нажать на пункт меню со спойлером, в который кликали ранее
      - assert: спойлер закрылся, содержимое скрылось
      - do: нажать на раскрытый спойлер
      - assert: спойлер закрылся, содержимое скрылось

    Внешний вид в горизонтальной ориентации:
      - do: сменить ориентацию на альбомную
      - screenshot: внешний вид меню соответствует скриншоту [extended-horizontal]

  Меню с авторизацией:
    - tags: no_assessors
    - do: открыть главную страницу поиска, удалить все параметры кроме yandex.ru и добавить в адресную строку к URL /turbo?stub=sandwich-menu/withauth.json
    - do: кликнуть на иконку меню
    - assert: |
        справа выехало меню
        в меню содержится кнопка "Войти"
    - do: тапнуть по кнопке "Войти"
    - assert: |
        меню закрылось
        открылось модальное окно в котором iframe с формой авторизации
    - tech: уснановить фокус на iframe с авторизацией
    - do: ввести любой логин
    - do: ввести любой пароль
    - do: нажать кнопку "Войти"
    - assert: модальное окно с авторизацией закрылось
    - do: тапнуть на иконку меню
    - assert: |
        справа выехало меню
        рядом с кнопкой выйти виден введенный логин
    - screenshot: внешний вид блока auth соответствует скриншоту [button-with-login]
    - do: тапнуть на кнопку выйти
    - assert: меню закрылось
    - do: тапнуть на иконке меню
    - assert: |
        справа выехало меню
        в меню не отображается введенный логин
    - screenshot: внешний вид блока auth соответствует скриншоту [button-without-login]

  Максимальная вложенность:
    На БЭМе:
      - do: открыть страницу https://yandex.ru/turbo?stub=sandwich-menu/deep.json
      - assert: открылась страница с иконокой бургерного меню
      - do: кликнуть на иконку меню
      - assert: справа выехало меню
      - do: кликнуть на пункт "Верхний уровень1"
      - assert: меню раскрылось
      - do: кликнуть на пункты "Первая вложенность11" и "Первая вложенность12"
      - assert: пункты раскрылись
      - screenshot: внешний вид меню соответствует скриншоту [opened]

    На реакте:
      - do: открыть страницу https://yandex.ru/turbo?stub=sandwich-menu/deep-react.json
      - assert: открылась страница с иконокой бургерного меню
      - do: кликнуть на иконку меню
      - assert: справа выехало меню
      - do: кликнуть на пункт "Верхний уровень1"
      - assert: меню раскрылось
      - do: кликнуть на пункты "Первая вложенность11" и "Первая вложенность12"
      - assert: пункты раскрылись
      - screenshot: внешний вид меню соответствует скриншоту [opened]

files:
  - features/blocks/sandwich-menu/sandwich-menu.hermione.js

v-team: Turbo

manager: tanzwuta

qa-engineer: kleev, k0nratka

tlds: none
