feature: Одна организация
type: Похожие организации

specs-integration:
  beforeEach:
    - do: получить выдачу по запросу 'кафе пушкин' _ALTERNATIVE_SEARCH_QUERIES_
    - assert: на странице присутствует колдунщик организации
  Наличие элементов:
    - assert: |
        в карточке организации есть похожие организации,
        в похожих организациях есть тайтл,
        в похожих организациях есть список организаций,
  Открытие оверлея организации:
    - do: кликнуть на первый элемент в похожих организациях
    - assert: открылся оверлей с карточкой организации

specs:
  На выдаче:
    Основные проверки в 1орге:
      - tags: 
          - smoke
          - pp_new_core
      - do: получить выдачу по запросу 'кафе пушкин'
      - assert: |
          должна быть видна карточка организации
          должен быть виден блок похожих организаций
      - screenshot: внешний вид [plain]
      - do: проскроллить вправо
      - assert: блок с похожими организациями проскроллился вправо
      - tech: сработал счетчик path='/$page/$main/$result/composite/similar/scroller'
      - do: кликнуть по третьему элементу блока
      - assert: открылся оверлей с выбранной организацией
      - tech: сработал счетчик path='/$page/$main/$result/composite/similar/scroller/topic/topic'
      - assertMetrics: '*'
    Счетчик показа похожих в 1орг на выдаче:
      - do: получить выдачу по запросу 'кафе пушкин'
      - assert: |
          должна быть видна карточка организации
          должен быть виден блок похожих организаций
      - do: проскроллить карточку до похожих организаций
      - tech: сработал счетчик path='/$page/$main/$result/composite/similar/scroller/topic'
    Основные проверки в отеле:
      - do: получить выдачу по запросу 'отель хаятт екатеринбург'
      - assert: |
          должна быть видна карточка отеля
          должен быть виден блок похожих организаций
      - screenshot: внешний вид [hotel]
      - do: проскроллить вправо
      - assert: блок с похожими организациями проскроллился вправо
      - tech: сработал счетчик path='/$page/$main/$result/composite/similar/scroller'
      - do: кликнуть по третьему элементу блока
      - assert: открылся оверлей с выбранным отелем
      - tech: сработал счетчик path='/$page/$main/$result/composite/similar/scroller/topic/topic'
      - assertMetrics: '*'
    Счетчик показа похожих в отелях на выдаче:
      - do: получить выдачу по запросу 'отель хаятт екатеринбург'
      - assert: |
          должна быть видна карточка отеля
          должен быть виден блок похожих организаций
      - do: проскроллить карточку до похожих организаций
      - tech: сработал счетчик path='/$page/$main/$result/composite/similar/scroller/topic'
  В оверлее:
    - tags:
        - pp_new_core
    - do: получить выдачу по запросу 'кафе пушкин'
    - assert: |
        должна быть видна карточка организации 
        должен быть виден блок похожих организаций внизу карточки
    - do: кликнуть в таб 'Главное'
    - assert: открылся оверлей с информацией об организации
    - screenshot: внешний вид блока [overlay]
    - do: кликнуть по первому элементу блока
    - assert: открылся новый айтем оверлея с выбранной организацией
    - tech: сработал счетчик path='/$subresult/overlay-wrapper/content/tabs/controls/tabs/about/side-block-bcard/composite/similar/scroller/topic/topic'
    - assertMetrics: '*'
  Счетчик показа похожих в оверлее:
    - do: получить выдачу по запросу 'кафе пушкин'
    - assert: |
        должна быть видна карточка организации
        должен быть виден блок похожих организаций
    - do: кликнуть в таб 'Главное'
    - assert: открылся оверлей с информацией об организации
    - do: проскроллить карточку до похожих организаций
    - tech: сработал счетчик path='/$subresult/overlay-wrapper/content/tabs/controls/tabs/about/side-block-bcard/composite/similar/scroller/topic'

tlds: all

v-team: VanillaGeo

files:
  - src/features/Companies/Companies.features/SimilarCompanies/SimilarCompanies.test/SimilarCompanies@touch-phone.hermione.js
  - src/features/Companies/Companies.features/SimilarCompanies/SimilarCompanies.test/SimilarCompanies@touch-phone.hermione.e2e.js

counter: /$page/$main/$result//similar/scroller/topic/topic

tags:
  - react
  - hasE2E
  - geo
  - geo_one_org
  - geo_one_org_similar
