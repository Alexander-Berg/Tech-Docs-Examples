feature: Смена пароля администратора

description: "Важно: менять пароль именно той учётной записи, которая указана в кейсе."

aliases:
  - &open_password_form
    - do: нажать на "..."
    - assert: в меню есть пункт "Изменить пароль"
    - do: выбрать пункт "Изменить пароль"

specs:
  beforeEach:
    - do: авторизоваться под администратором организации (henrik-edwards@yandex.ru)
    - do: перейти по ссылке {{CONNECT_HOST}}/portal/admin/customization/admins

  Положительные:
    1. Внешний вид меню и формы изменения пароля:
      - do: открыть карточку сотрудника "Dupont Ole" {{CONNECT_HOST}}/portal/admin/users/1130000002088032
      - do: нажать на "..."
      - assert: в меню есть пункт "Изменить пароль"
      - screenshot: меню [menu]
      - do: выбрать пункт "Изменить пароль"
      - screenshot: форма изменения пароля [password-form]
    2. Смена пароля доменной учётной записи:
      - do: открыть карточку сотрудника "Dupont Ole" {{CONNECT_HOST}}/portal/admin/users/1130000002088032
      - *open_password_form
      - do: ввести новый пароль (например, "{{TIMESTAMP}}")
      - do: ввести подтверждение пароля
      - do: нажать кнопку "Сохранить"
      - assert: появилось сообщение "Логин и пароль пользователя обновлены"
      - assert: модальное окно закрылось

  Отрицательные:
    01. Нет смены пароля портальной учётной записи:
      - do: открыть карточку сотрудника "Walker Nicholas" {{CONNECT_HOST}}/portal/admin/users/4028853046
      - do: нажать на "..."
      - assert: в меню нет пункта "Изменить пароль"
    02. Не введён пароль:
      - do: открыть карточку сотрудника "Nielsen Mary" {{CONNECT_HOST}}/portal/admin/users/1130000002088034
      - *open_password_form
      - do: нажать кнопку "Сохранить"
      - screenshot: сообщение о пустом пароле [empty-password-error]
    03. Не введено подтверждение пароля:
      - do: открыть карточку сотрудника "Nielsen Mary" {{CONNECT_HOST}}/portal/admin/users/1130000002088034
      - *open_password_form
      - do: ввести пароль (например, "123")
      - do: нажать кнопку "Сохранить"
      - screenshot: сообщение о пустом подтверждении [empty-confirmation-error]
    04. Несоответствие пароля и подверждения пароля:
      - do: открыть карточку сотрудника "Nielsen Mary" {{CONNECT_HOST}}/portal/admin/users/1130000002088034
      - *open_password_form
      - do: ввести пароль (например, "123")
      - do: ввести подтверждение пароля, не совпадающее с паролем (например, "1234")
      - do: нажать кнопку "Сохранить"
      - screenshot: сообщение о том, что пароли не совпадают [password-confirmation-error]
    05. Ввод короткого пароля:
      - do: открыть карточку сотрудника "Nielsen Mary" {{CONNECT_HOST}}/portal/admin/users/1130000002088034
      - *open_password_form
      - do: ввести пароль длиной менее 6-ти символов (например, "123")
      - do: ввести подтверждение пароля
      - do: нажать кнопку "Сохранить"
      - screenshot: сообщение о коротком пароле [short-password-error]
    06. Ввод длинного пароля:
      - do: открыть карточку сотрудника "Nielsen Mary" {{CONNECT_HOST}}/portal/admin/users/1130000002088034
      - *open_password_form
      - do: ввести пароль длиной более 255-ти символов (например, "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111")
      - do: ввести подтверждение пароля
      - do: нажать кнопку "Сохранить"
      - screenshot: сообщение о длинном пароле [long-password-error]
    07. Ввод некорректного пароля:
      - do: открыть карточку сотрудника "Nielsen Mary" {{CONNECT_HOST}}/portal/admin/users/1130000002088034
      - *open_password_form
      - do: ввести пароль из недопустимых символов (например, "∞∞∞∞∞∞")
      - do: ввести подтверждение пароля
      - do: нажать кнопку "Сохранить"
      - screenshot: сообщение о некорректном пароле [invalid-password-error]
    08. Ввод старого пароля:
      - do: открыть карточку сотрудника "Nielsen Mary" {{CONNECT_HOST}}/portal/admin/users/1130000002088034
      - *open_password_form
      - do: ввести новый пароль (например, "{{TIMESTAMP}}")
      - do: ввести подтверждение пароля
      - do: нажать кнопку "Сохранить"
      - assert: модальное окно закрылось
      - assert: появилось сообщение "Логин и пароль пользователя обновлены"
      - *open_password_form
      - do: в поле "Пароль" ввести ранее установленный пароль
      - do: ввести подтверждение пароля
      - do: нажать кнопку "Сохранить"
      - screenshot: сообщение о том, что новый пароль не может совпадать со старым [used-password-error]
    09. Закрытие модального окна по клику на крестик:
      - do: открыть карточку сотрудника "Nielsen Mary" {{CONNECT_HOST}}/portal/admin/users/1130000002088034
      - *open_password_form
      - do: кликнуть на крестик
      - assert: модальное окно закрылось
    10. Закрытие модального окна по клику на кнопку "Отменить":
      - do: открыть карточку сотрудника "Nielsen Mary" {{CONNECT_HOST}}/portal/admin/users/1130000002088034
      - *open_password_form
      - do: нажать кнопку "Отменить"
      - assert: модальное окно закрылось
    11. Закрытие модального окна по клику за его пределами:
      - do: открыть карточку сотрудника "Nielsen Mary" {{CONNECT_HOST}}/portal/admin/users/1130000002088034
      - *open_password_form
      - do: сделать клик за пределами модального окна
      - assert: модальное окно закрылось

files:
  - tests/hermione/suites/user/change-admin-password.js

priority: blocker

tlds:
  - ru
  - com

tags:
  - smoke_test_assessors
  - regression
  - smoke_test
  - reviewed
