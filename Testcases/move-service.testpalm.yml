feature: Перенос сервисов

specs:
  afterEach:
    - do: (PREPARE) перейти на страницу сервиса "АвтоКотёнок в переноске 2" (/services/autocatmove2/)
    - do: (PREPARE) нажать на значок ветки после хлебных крошек над названием
    - do: (PREPARE) вписать в поле ввода родителя "autocatmove1"
    - do: (PREPARE) выбрать из саджеста сервис "АвтоКот в переноске 1 (автотесты)"
    - do: (PREPARE) нажать "сохранить"

  Положительные:
    1. Перенос сервисов без подтверждения:
      - automation: ABC-6500
      - do: залогиниться под пользователем robot-internal-003
      - do: перейти на страницу сервиса "АвтоКотёнок в переноске 2" (/services/autocatmove2/)
      - do: нажать на значок ветки после хлебных крошек над названием
      - do: вписать в поле ввода родителя "autocatmove3"
      - do: выбрать из саджеста сервис "АвтоКот в переноске 3 (автотесты)"
      - do: нажать "сохранить"
      - assert: появилась плашка "Перемещается" с указанием, что сервис находится в Read Only
      - assert: |
          плашка "Перемещается" пропала не более чем за 25 секунд,
          изменился родитель в хлебных крошках на "АвтоКот в переноске 3 (автотесты)" не более чем за 25 секунд

    2. Перенос сервисов с подтверждением:
      - automation: ABC-6500
      - do: залогиниться под пользователем robot-internal-002
      - do: перейти на страницу сервиса "АвтоКотёнок в переноске 2" (/services/autocatmove2/)
      - do: нажать на значок ветки после хлебных крошек над названием
      - do: вписать в поле ввода родителя "autocatmove3"
      - do: выбрать из саджеста сервис "АвтоКот в переноске 3 (автотесты)"
      - do: нажать "сохранить"
      - assert: появилась надпись "Запросы на перемещения сервисов"
      - do: нажать на стрелочку для разворачивания подробной информации о запросах
      - do: нажать на кнопку "кто может подтвердить"
      - screenshot: отображение запроса на перемещение сервиса [plain]
      - do: залогиниться под пользователем robot-internal-003
      - do: перейти на страницу сервиса "АвтоКотёнок в переноске 2" (/services/autocatmove2/)
      - do: нажать на стрелочку для разворачивания подробной информации о запросах
      - do: нажать "одобрить"
      - assert: появилась плашка "Перемещается" с указанием, что сервис находится в Read Only
      - assert: |
          плашка "Перемещается" пропала не более чем за 25 секунд,
          изменился родитель в хлебных крошках на "АвтоКот в переноске 3 (автотесты)" не более чем за 25 секунд

    3. Перенос сервисов с отказом:
      - automation: ABC-6500
      - do: залогиниться под пользователем robot-internal-002
      - do: перейти на страницу сервиса "АвтоКотёнок в переноске 2" (/services/autocatmove2/)
      - do: нажать на значок ветки после хлебных крошек над названием
      - do: вписать в поле ввода родителя "autocatmove3"
      - do: выбрать из саджеста сервис "АвтоКот в переноске 3 (автотесты)"
      - do: нажать "сохранить"
      - assert: появилась надпись "Запросы на перемещения сервисов"
      - do: нажать на стрелочку для разворачивания подробной информации о запросах
      - do: нажать на кнопку "кто может подтвердить"
      - assert: отображается запрос на перемещение сервиса
      - do: залогиниться под пользователем robot-internal-003
      - do: перейти на страницу сервиса "АвтоКотёнок в переноске 2" (/services/autocatmove2/)
      - do: нажать на стрелочку для разворачивания подробной информации о запросах
      - do: нажать "отказать"
      - assert: пропал раздел "Запросы на перемещения сервисов"

files: []

priority: critical

tags:
  - reviewed
  - no_assessors
