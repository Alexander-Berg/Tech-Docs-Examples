feature: Маркет. Офферный колдунщик

specs:
  Проверка внешнего вида:
    - params:
        foreverdata: '246877604'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: в выдаче есть колдунщик Маркета
    - screenshot: внешний вид [plain]
  Проверка внешнего вида с VT=market_offers_wizard_center_incut:
    - params:
        foreverdata: '4250366517'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: в выдаче есть колдунщик Маркета
    - screenshot: внешний вид [plain]
  Проверка внешнего вида с тайтлом более 3х строк:
    - params:
        foreverdata: '531460829'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: в выдаче есть колдунщик Маркета, тайтл корректно обреезается до трех строк
    - screenshot: внешний вид [plain]
  Проверка ссылки:
    В кнопке «ещё»:
      - params:
          foreverdata: '1677495901'
      - do: |
          открыть выдачу по запросу 'foreverdata'
          проскроллить до конца вправо
      - tech: в ссылке «Ещё предложения» есть параметр rs
      - do: нажать на ссылку «Ещё предложения»
      - tech: |
          открылась новая вкладка по ссылке `https://yandex.ru/products/search`
          в нажатую на выдаче ссылку добавились параметры parent-reqid и utm_source_service
  Скрытие кнопки «ещё»:
    - params:
        foreverdata: '925983392'
        exp_flags:
          - 'PRODUCTS_2x2_hide_button=1'
    - assert: в выдаче есть колдунщик Маркета
    - assert: под товарами не должно быть кнопки «Показать ещё»
  Внешний вид c одной строчкой:
    - params:
        foreverdata: '925983392'
        exp_flags:
          - 'PRODUCTS_expanded_initial_rows_count=1'
    - assert: в выдаче есть колдунщик Маркета
    - screenshot: внешний вид соответствует скриншоту [one-line]
    - do: нажать на кнопку «Показать ещё»
    - screenshot: внешний вид соответствует скриншоту [one-line-expanded]
  Внешний вид c расхлопом (searchapp-phone):
    - params:
        foreverdata: '939423507'
        text: 'iphone'
    - assert: в выдаче есть колдунщик Маркета
    - do: нажать кнопку "Показать ещё"
    - assert: должно появиться еще два ряда карточек
    - screenshot: внешний вид [after-click-more]
    - do: нажать кнопку "Показать ещё"
    - assert: должно появиться ещё две карточки
    - screenshot: внешний вид [after-second-click-more]
  С недостаточным количеством офферов:
    - params:
        foreverdata: '3744070323'
        text: 'iphone'
    - assert: в выдаче есть колдунщик Маркета в виде карусели
    - screenshot: внешний вид [not-enough-offers]
  Внешний вид c дозагрузкой:
    - params:
        foreverdata: '2132253131'
        text: 'iphone'
    - assert: в выдаче есть колдунщик Маркета
    - do: нажать кнопку "Показать ещё"
    - assert: должно появиться еще два ряда карточек
    - screenshot: внешний вид [after-click-more]
    - do: нажать кнопку "Показать ещё"
    - assert: должно появиться еще два ряда карточек
    - screenshot: внешний вид [after-second-click-more]
    - do: нажать кнопку "Показать ещё"
    - assert: должна появиться ещё одна карточка
    - screenshot: внешний вид [after-third-click-more]

files:
  - src/features/Market/Market.features/MarketOffersWizard/MarketOffersWizard.test/MarketOffersWizard@touch-phone.hermione.js

v-team: Goods

tlds: [ru]

tags:
  - react
  - organic
