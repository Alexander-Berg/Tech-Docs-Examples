feature: Сети/Рубрики
type: Большая карта и список сверху / Режим карты

specs-integration:
  Проверка наличия элементов:
    - do: получить выдачу по запросу 'кафе' _ALTERNATIVE_SEARCH_QUERIES_
    - assert: появилась карусель с карточкой-картой
    - do: кликнуть по кнопке 'Показать карту'
    - assert: появилась карта
    - do: выбрать в фильтре рейтинга первое значение
    - assert: пины на карте перезагрузились

specs:
  Проверка карточки:
    - do: получить выдачу по запросу 'кафе' _ALTERNATIVE_SEARCH_QUERIES_
    - assert: появилась карусель с карточками
    - do: кликнуть по кнопке 'Показать карту'
    - screenshot: появилась карта с обозначенными организациями в виде пинов на ней [map]
    - do: кликнуть в любой синий пин на карте
    - tech: сработал счетчик path='/parallel/result/wiz/companies/map/upper/tabs/map/point', vars='pos=upper,-subtype=carousel,-adapters=companies,action=dynamic_click'
    - assert: |
        цвет выбранного пина сменился на красный,
        слева появилась карточка выбранной организации
    - screenshot: внешний вид [card]
    - assertMetrics: '*'
  Карта с открытым РП:
    - params:
        rstr: '-213'
    - do: получить выдачу по запросу 'кафе в Москве'
    - assert: |
        на выдаче открыт расширенный поиск
        под расширенным поиском есть карусель с организациями
    - do: кликнуть по кнопке 'Показать карту'
    - assert: появилась карта с обозначенными организациями в виде пинов на ней
    - screenshot: внешний вид [plain]

files:
  - features/companies/bk_map/companies-map@desktop.hermione.js
  - features/companies/bk_map/companies-map@desktop.hermione.e2e.js

v-team: VanillaGeo

counter: /$page/$top/$result[@wizard_name="companies" and @subtype="map"]/companies-map-list/carousel/showcase/item/adv

tags:
  - hasE2E

tlds: all
