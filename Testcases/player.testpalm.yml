feature: Объектный ответ
type: Плеер
description:
  ВНИМАНИЕ, тест необходимо выполнять НЕавторизованным пользователем, если не указано явно обратного, а так же только на территории РФ, иначе некоторый функционал может быть недоступен.
  При прохождении на ферме колхоз в плеере может быть черный экран - это не баг.
  На ie11 необходимо проходить тест на win10, иначе плеер не будет работать - это не баг.
  Плеер может запуститься без звука - это не баг, чтобы звук включился надо предварительно кликнуть в любую область плеера.
  Если при нажатии кнопки Смотреть, происходит переход в приложение Кинопоиска или сайт, - скипните тест

specs:
  aliases:
    - &automationTicket
      - automation: SERP-105387
    # В начале воспроизведения должно показать ограничение по возрасту (если есть в шапке)
    - &ageRestriction
      - *automationTicket
      - assert: |
          в плеере показывается возрастное ограничение в начале проигрывания видео,
          (показывается, ЕСЛИ есть ограничение по возрасту в шапке у карточки ОО, например, (12+), ЕСЛИ его нет и заголовок в плеере не появился, то это НЕ баг)
      - screenshot: примерный вид [https://jing.yandex-team.ru/files/eksamoylova/2021-03-19_23.10.33-unnr2.png]
      - do: увести курсор с плеера и дождаться, когда возрастное ограничение пропадет
      - do: поставить видео на паузу и снова воспроизвести
      - assert: возрастное ограничение появилось снова

    # Открываем плеер для сериалов и начинаем воспроизведение в правой колонке
    - &playerAdvCondition2
      - *automationTicket
      - do: залогиниться пользователем с подпиской (например, test-serp-assessors-plus/hL5-tYe-VGX-fzg)
      - do: получить выдачу по запросу 'клуб винкс – школа волшебниц мультсериал на иви' (альтернативные запросы 'доктор плюшева мультсериал на иви', 'город ангел бэби сериал на иви')
      - assert: |
          справа в карточке ОО присутствует заглушка с кнопкой "Смотреть" (если заглушки нет или название кнопки "Купить", то проверьте наличие подписки и попробуйте альтернативные запросы)
          под заглушкой есть сериальный навигатор
      - screenshot: примерный внешний вид заглушки и сериального навигатора [https://jing.yandex-team.ru/files/kulagin-iv/Screenshot_178.png]
      - do: нажать на кнопку "Смотреть" и выбрать там "Кинопоиск"
      - assert: плеер начал воспроизводиться
      - do: кликнуть в область плеера для появления плеерных контролов или навести курсор
      - *ageRestriction
    # Открываем плеер для трейлеров и начинаем воспроизведение в правой колонке
    - &trailersPlayerStartRight
      - *automationTicket
      - do: получить выдачу по запросу 'квантовый скачок' (альтернативные запросы 'фея-крёстная фильм 2020', 'на западном фронте без перемен фильм 1979', 'артемис фаул фильм 2020')
      - assert: |
          справа в карточке присутствует блок с кнопкой 'трейлер' и иконкой плей
      - do: нажать на кнопку 'трейлер' с иконкой плей
      - assert: на месте блока появился плеер и начал воспроизведение трейлера
    # Открываем плеер для трейлеров в правой колонке за кнопкой и начинаем воспроизведение
    - &trailersPlayerStartRightButton
      - *automationTicket
      - do: получить выдачу по запросу 'я худею' (альтернативные запросы 'викинги сериал', 'я снова я и ирэн', 'джентльмены')
      - assert: справа в карточке присутствует кнопка 'Трейлер'
      - screenshot: примерный внешний вид кнопки [https://jing.yandex-team.ru/files/kulagin-iv/Screenshot_176.png]
      - do: нажать на кнопку 'Трейлер'
      - assert: |
          открылся плеер с трейлером
          трейлер начал автоматически вопроизводиться
    # Открываем плеер для трейлеров в центральной колонке
    - &trailersPlayerStartMiddle
      - *automationTicket
      - do: получить выдачу по запросу 'кингсман начало трейлер' (альтернативные запросы 'фильм 11.22.63 трейлер', 'половое воспитание трейлер', 'я снова я и ирэн трейлер')
      - assert: |
          в выдаче на первой позиции присутствует трейлер
          трейлер начал автоматически воспроизводиться
      - screenshot: примерный внешний вид трейлера [https://jing.yandex-team.ru/files/kulagin-iv/Screenshot_177.png]
    # Открываем плеер для фильмов и начинаем воспроизведение в правой колонке
    - &playerRecommendationsOnTheEnd9
      - *automationTicket
      - do: залогиниться пользователем с подпиской (например, test-serp-assessors-plus/hL5-tYe-VGX-fzg)
      - do: |
          ЧИТАЙТЕ ВНИМАТЕЛЬНЕЕ КАКОЙ ТЕСТ ВЫПОЛНЯЕТСЯ, ЕСЛИ ПРО АУДИО И СУБТИТРЫ, ТО НУЖНЫ ОПРЕДЕЛЕННЫЕ ФИЛЬМЫ, КОТОРЫЕ УКАЗАНЫ НИЖЕ
          получить выдачу по запросу 'я худею на иви' (альтернативные запросы 'ультраамериканцы на иви', 'хардкор на иви', 'новая земля на иви')
          для теста по изменению АУДИО запрос 'жертвуя пешкой на иви' (альтернативные запросы 'глоток на иви', 'вкус ночи на иви')
          для теста по включению СУБТИТРОВ запрос 'Тот кто убивает узник тьмы' (альтернативные запросы 'джентльмены', 'настоящие боссы')
      - assert: справа в карточке ОО присутствует заглушка с кнопкой "Смотреть" (если заглушки нет или название кнопки "Купить", то проверьте наличие подписки и попробуйте альтернативные запросы)
      - do: нажать на кнопку "Смотреть" и выбрать "Кинопоиск"
      - assert: плеер начал воспроизводиться
      - do: кликнуть в область плеера для появления плеерных контролов или навести курсор
      - *ageRestriction
    # Открываем плеер для клипов и начинаем воспроизведение в правой колонке
    - &trailersPlayerStartRight5
      - *automationTicket
      - do: получить выдачу по запросу 'леди гага алехандро' (альтернативные запросы 'evanescence bring me to life', 'lady gaga poker face', 'каста радиосигналы', 'Zombie The Cranberries', 'Обезоружена Полина Гагарина')
      - assert: |
          справа в карточке присутствует плеер с клипом
          плеер не начал автоматическое воспроизведение
      - do: нажать на кнопку воспроизведения в плеере
      - assert: плеер начал воспроизводиться (если в плеере отображается ошибка что-то вроде "Обнаружен блокировщик рекламы или видео недоступно" - то это не баг, в таком случае надо скипнуть кейс)
      - do: кликнуть в область плеера для появления плеерных контролов или навести курсор

    # Открываем плеер для блогеров и начинаем воспроизведение в правой колонке
    - &playerAdvCondition5
      - *automationTicket
      - do: получить выдачу по запросу 'катя клэп' (альтернативные запросы 'гусейн гасанов', 'чикен карри', если в правой колонке у плеера есть метка Яндекс.Видео, то попробуйте другой запрос, иначе прохождение не верно)
      - assert: |
          справа в карточке присутствует плеер
          плеер не начал автоматическое воспроизведение
      - do: нажать на кнопку воспроизведения в плеере
      - assert: плеер начал воспроизводиться
      - do: кликнуть в область плеера для появления плеерных контролов или навести курсор
      - assert: включился звук
    # Основные элементы управления для ОТТ-контента (фильмы, мультфильмы, сериалы, трейлеры)
    - &playerOttControlElements
      - do: проверить расположение элементов плеера, для этого навести курсор в любое место плеера, чтобы появились контролы
      - assert: |
          в плеере отображаются:
          окно проигрывание контента
          регулятор громкости звука
          кнопка играть/пауза
          время проигрывания контента
          кнопка-шестеренка с настройками
          кнопка полноэкранного режима (fullscreen)
    # Основные элементы управления для Дзен-контента (блоггеры)
    - &playerAdvCondition6
      - do: проверить расположение элементов плеера, для этого навести курсор в любое место плеера, чтобы появились контролы
      - assert: |
          в плеере отображаются:
          окно проигрывание контента
          регулятор громкости звука
          кнопка играть/пауза
          время проигрывания контента
          кнопка 'скопировать ссылку' (может отсутствовать - это не баг)
          кнопка 'отправить на устройство' (может отсутствовать - это не баг)
          кнопка 'сообщить о проблеме'
          кнопка-шестеренка с настройками
          кнопка полноэкранного режима (fullscreen)
    # Идет воспроизведение
    - &playerPlaying
      - do: кликнуть в область плеера для появления плеерных контролов или навести курсор
      - assert: появились элементы управления плеером
      - assert: |
          индикатор времени будет отображать время проигрывания и время окончания
          движется ползунок скроллбара прогресса видео
          отображается прогресс загрузки видео на скроллбаре
      - screenshot: примерный вид [https://jing.yandex-team.ru/files/av-denis/player-playing.png]
      - *ageRestriction
    # Поставили на паузу
    - &playerPause
      - do: кликнуть в область плеера или навести курсор (валидно для правой колонки)
      - assert: появились элементы управления плеером
      - do: нажать на кнопку паузы
      - assert: |
          плеер перестал воспроизводиться
          на месте кнопки паузы теперь плей
      - do: снова нажать на кнопку воспроизведения в плеере
      - assert: |
          плеер продолжил воспроизведение
          на месте кнопки плей теперь пауза
      - screenshot: примерный вид [https://jing.yandex-team.ru/files/av-denis/pause-button.png]
      - *ageRestriction
      - do: снова нажать на кнопку паузы
      - assert: |
          плеер перестал воспроизводиться
          на месте кнопки паузы теперь плей
    # Превью над таймлайном
    - &playerTimelinePreview
      - do: навести курсор на скроллбар в нижней части плеера
      - assert: |
          над скроллбаром появится превью видео и время (иногда превью может и не быть; чтобы убедиться, что это баг, надо проверить есть ли превью у роликов из альтернативных запросов, если есть хоть у одного - тогда не баг)
      - screenshot: примерный вид [https://jing.yandex-team.ru/files/av-denis/player-preview-desktop.png]
      - do: провести курсор вдоль скроллбара
      - assert: над скроллбаром изменяется превью видео и время
      - do: увести курсор со скроллбара
      - assert: превью видео и время исчезают
    # Отключение/изменение звука
    - &playerRecommendationsOnTheEnd0
      - assert: если тест проходится на ферме (kolhoz), то там может не быть звука, это не является ошибкой
      - do: нажать на кнопку включения/отключения звука в левом нижнем углу
      - assert: |
          звук в плеере включается/отключается
          кнопка с включения/отключения звука изменяется на соответствующую кнопку для включения или отключения звука
          воспроизведение ролика не остановилось
      - do: навести курсор мыши на кнопку с отключением звука
      - assert: |
          рядом появился ползунок с регулировкой звука
      - screenshot: примерный вид [https://jing.yandex-team.ru/files/av-denis/music-panel.png]
      - do: перетянуть ползунок регулировки звука вперед
      - assert: громкость звука увеличилась
      - do: перетянуть ползунок регулировки звука назад
      - assert: громкость звука уменьшилась
    # Изменение качества воспроизведения в шестерёнке
    - &playerRecommendationsOnTheEnd1
      - assert: в правом нижнем углу находится кнопка-шестерёнка с настройками
      - do: нажать на кнопку-шестерёнку с настройками
      - assert: |
          в плеере появилось всплывающее окошко с настройками воспроизведения
          в нём есть кнопка с изменением качества воспроизводимого контента
      - screenshot: примерный вид (!!100% СОВПАДЕНИЯ СО СКРИНШОТОМ МОЖЕТ НЕ БЫТЬ - ЭТО НЕ БАГ!! кнопка сообщить о проблеме на контенте кинопоиска может отсутствовать (это не баг)) [https://jing.yandex-team.ru/files/av-denis/settings-quality.png]
      - do: |
            изменить качество на минимально возможное
            если автоматически выбралось самое минимальное, то выберите сначала более высокое
      - assert: качество видео снизилось (может измениться с задержкой)
      - do: нажать на кнопку и изменить качество на максимально возможное
      - assert: качество видео увеличилось (может измениться с задержкой)
      - do: нажать на кнопку и изменить качество на 'Авто'
      - assert: |
          качество видео выбралось автоматически
          проигрывание продолжилось
    # Изменение скорости воспроизведения в шестерёнке
    - &playerRecommendationsOnTheEnd2
      - assert: в правом нижнем углу находится кнопка-шестерёнка с настройками
      - do: нажать на кнопку-шестерёнку с настройками
      - assert: |
          в плеере появилось всплывающее окошко с настройками воспроизведения
          в нём есть кнопка с изменением скорости воспроизведения контента
      - screenshot: примерный вид (!!100% СОВПАДЕНИЯ СО СКРИНШОТОМ МОЖЕТ НЕ БЫТЬ - ЭТО НЕ БАГ!! кнопка сообщить о проблеме на контенте кинопоиска может отсутствовать (это не баг)) [https://jing.yandex-team.ru/files/av-denis/settings-speed.png]
      - do: изменить скорость воспроизведения на минимальную из предложенных
      - assert: скорость воспроизведения видео уменьшилась, окошко с настройками осталось открытым
      - do: изменить скорость воспроизведения на максимальную из предложенных
      - assert: скорость воспроизведения видео увеличилась, окошко с настройками осталось открытым
      - do: изменить скорость воспроизведения на обычную по-умолчанию (1x)
      - assert: скорость воспроизведения стала обычная, окошко с настройками осталось открытым
    # Включение субтитров в шестерёнке
    - &playerAdvCondition0
      - assert: в правом нижнем углу находится кнопка-шестерёнка с настройками
      - do: нажать на кнопку-шестерёнку с настройками
      - assert: |
          в плеере появилось всплывающее окошко с настройками воспроизведения
          в нём есть кнопка, включающая субтитры
      - screenshot: примерный вид (!!100% СОВПАДЕНИЯ СО СКРИНШОТОМ МОЖЕТ НЕ БЫТЬ - ЭТО НЕ БАГ!! кнопка сообщить о проблеме на контенте кинопоиска может отсутствовать (это не баг)) [https://jing.yandex-team.ru/files/av-denis/settings-subs.png]
      - do: кликнуть по кнопке включения субтитров
      - assert: в нижней части плеера появились субтитры
      - do: кликнуть ещё раз по кнопке субтитров
      - assert: в нижней части плеера пропали субтитры
    # Изменение языка субтитров в шестерёнке
    - - assert: в правом нижнем углу находится кнопка-шестерёнка с настройками
      - do: нажать на кнопку-шестерёнку с настройками
      - assert: |
          в плеере появилось всплывающее окошко с настройками воспроизведения
          в нём есть кнопка изменения языка
      - screenshot: примерный вид (!!100% СОВПАДЕНИЯ  СО СКРИНШОТОМ МОЖЕТ НЕ БЫТЬ - ЭТО НЕ БАГ!! кнопка сообщить о проблеме на контенте кинопоиска может отсутствовать (это не баг)) [https://jing.yandex-team.ru/files/av-denis/settings-lang.png]
      - do: кликнуть по кнопке изменения языка и выбрать любой язык
      - assert: в нижней части плеера появились субтитры на выбранном языке
      - do: кликнуть по кнопке изменения языка и выбрать другой язык
      - assert: в нижней части плеера появились субтитры на другом выбранном языке
    # Изменение аудиодорожки в шестерёнке
    - &playerAdvCondition1
      - assert: в правом нижнем углу находится кнопка-шестерёнка с настройками
      - do: нажать на кнопку-шестерёнку с настройками
      - assert: |
          в плеере появилось всплывающее окошко с настройками воспроизведения
          в нём есть кнопка изменения аудио
      - screenshot: примерный вид (!!100% СОВПАДЕНИЯ СО СКРИНШОТОМ МОЖЕТ НЕ БЫТЬ - ЭТО НЕ БАГ!!) [https://jing.yandex-team.ru/files/av-denis/settings-audio.png]
      - do: кликнуть по кнопке изменения аудио и выбрать другую аудиодорожку (язык)
      - assert: в плеера началась озвучка на выбранном языке
      - do: кликнуть по кнопке изменения аудио и выбрать изначальную аудиодорожку
      - assert: в плеера началась озвучка на изначальном языке
    # Повторное проигрывание видео в плеере
    - &playerRecommendationsOnTheEnd4
      - do: после старта воспроизведения дождаться пока появится карусель роликов под плеером(или перемотать чуть больше чем на середину ролика) !!Шаг при прохождении на десктопах и планшетах!!
      - do: в списке под плеером выбрать последнее видео
      - do: перемотать видео в конец (за 5-10 секунд)
      - assert: |
          после окончания проигрывания вместо кнопки плей/пауза появилась кнопка с круговой стрелкой (возможно наличие рекламы в конце ролика, её можно пропустить)
      - screenshot: примерный вид (!!100% СОВПАДЕНИЯ  СО СКРИНШОТОМ МОЖЕТ НЕ БЫТЬ - ЭТО НЕ БАГ!!) [https://jing.yandex-team.ru/files/av-denis/player-again.png]
      - do: нажать на кнопку со стрелкой
      - assert: видео проигрывается сначала
    # Нет автоматического повторноого проигрывания по окончании фильма
    - &playerRecommendationsOnTheEnd4film
      - do: перемотать видео в конец (за 5-10 секунд)
      - assert: |
          после окончания проигрывания не запустилась реклама
          после окончания проигрывания вместо кнопки плей/пауза появилась кнопка с круговой стрелкой
      - screenshot: примерный вид (!!100% СОВПАДЕНИЯ СО СКРИНШОТОМ МОЖЕТ НЕ БЫТЬ - ЭТО НЕ БАГ!!) [https://jing.yandex-team.ru/files/av-denis/player-again.png]
      - do: нажать на кнопку со стрелкой
      - assert: видео проигрывается сначала
    # Нет автоматического повторноого проигрывания по окончании трейлера за кнопкой
    - &playerRecommendationsOnTheEnd4ButtonTrailer
      - do: перемотать видео в конец (за 5-10 секунд) и дождаться окончания ролика
      - do: если по окончании ролика запустилась реклама, то пропустить её (если возможно)
      - assert: |
          после окончания проигрывания вместо кнопки плей/пауза появилась кнопка с круговой стрелкой (возможно наличие рекламы в конце ролика, её можно пропустить)
      - screenshot: примерный вид (!!100% СОВПАДЕНИЯ СО СКРИНШОТОМ МОЖЕТ НЕ БЫТЬ - ЭТО НЕ БАГ!!) [https://jing.yandex-team.ru/files/av-denis/player-again.png]
      - do: нажать на кнопку со стрелкой
      - assert: видео проигрывается сначала
    # Сообщить о проблеме из кнопки плеера
    - &playerAdvCondition7
      - assert: |
          в правом нижнем углу находится кнопка 'Сообщить о проблеме'
      - screenshot: примерный вид (!!100% СОВПАДЕНИЯ  СО СКРИНШОТОМ МОЖЕТ НЕ БЫТЬ - ЭТО НЕ БАГ!!) [https://jing.yandex-team.ru/files/av-denis/player-desktop-has-problem.png]
      - do: нажать на 'Сообщить о проблеме'
      - assert: в новой вкладке открылась страница 'Сообщить о проблеме с видеоплеером' сервиса Яндекс.Справка
    # Сообщить о проблеме из шестеренки с настройками
    - &playerAdvCondition8
      - assert: в правом нижнем углу находится кнопка-шестерёнка с настройками
      - do: нажать на кнопку-шестерёнку с настройками
      - assert: |
          в плеере появилось всплывающее окошко с настройками воспроизведения
          в нём есть кнопка 'Сообщить о проблеме'
      - screenshot: примерный вид (!!100% СОВПАДЕНИЯ  СО СКРИНШОТОМ МОЖЕТ НЕ БЫТЬ - ЭТО НЕ БАГ!!) [https://jing.yandex-team.ru/files/av-denis/has-problem.png]
      - do: нажать на кнопку 'Сообщить о проблеме'
      - assert: в новой вкладке открылась страница 'Сообщить о проблеме с видеоплеером' сервиса Яндекс.Справка
    # Переход во весь экран и обратно
    - &playerRecommendationsOnTheEnd3
      - assert: в правом нижнем углу находится кнопка перехода в полноэкранный режим
      - do: нажать на кнопку перехода в полноэкранный режим
      - assert: |
          плеер открылся на полный экран
          в правом нижнем углу теперь находится кнопка выхода из полноэкранного режима
      - do: нажать на кнопку выхода из полноэкранного режима
      - assert: плеер вернулся к первоначальному размеру
    # Перемотка содержимого
    - &playerRewind
      - do: нажать внутри плеера
      - assert: в нижней части плеера есть ползунок воспроизведения
      - do: |
          навести курсор на ползунок воспроизведения и перемотать содержимое,
          потянув ползунок вперед на некоторое количество времени
      - assert: |
          содержимое плеера перемоталось вперед на выбранное количество времени
          время воспроизведения в нижней части плеера поменялось
      - do: |
          навести курсор на ползунок воспроизведения и перемотать содержимое,
          потянув ползунок назад на некоторое количество времени
      - assert: |
          содержимое плеера перемоталось назад на выбранное количество времени
          время воспроизведения в нижней части плеера поменялось
      - do: навести курсор на прогресс-бар и кликнуть в конец
      - assert: |
          содержимое плеера перемоталось в конец
          время воспроизведения в нижней части плеера поменялось
    - &playerAdvCondition9
      - assert: для прохождения теста рекомендуется брать устройство с шириной экрана больше 1200px, в противном случае рекомендации могут отсутствовать
    # Рекомендационные ролики, показанные во время паузы воспроизведения
    - &trailersPlayerStartRight0
      - do: нажать на кнопку паузы
      - assert: |
          плеер перестал воспроизводиться
          через небольшой промежуток времени в нижней части плеера появился блок с рекомендациями
      - screenshot: примерный вид [https://jing.yandex-team.ru/files/av-denis/recommended.png]
      - do: нажать на кнопку продолжения воспроизведения
      - assert: |
          плеер продолжил воспроизводиться
          в нижней части плеера пропал блок с рекомендациями
      - do: снова нажать на кнопку паузы
      - assert: |
          плеер перестал воспроизводиться
          через небольшой промежуток времени в нижней части плеера снова появился блок с рекомендациями
      - screenshot: примерный вид [https://jing.yandex-team.ru/files/av-denis/recommended.png]
    # Клик по элементу из списка рекомендаций
    - &trailersPlayerStartRight1
      - do: нажать на кнопку паузы
      - assert: |
          плеер перестал воспроизводиться
          через небольшой промежуток времени в нижней части плеера появился блок с рекомендациями
      - screenshot: примерный вид [https://jing.yandex-team.ru/files/av-denis/recommended.png]
      - do: кликнуть на любой понравившийся ролик
      - assert: содержимое плеера подменилось на выбраный ролик
    # Скролл списка рекомендаций
    - &trailersPlayerStartRight2
      - do: нажать на кнопку паузы
      - assert: |
          плеер перестал воспроизводиться
          через небольшой промежуток времени в нижней части плеера появился блок с рекомендациями
          у блока рекомендаций справа есть стрелка вперёд
      - screenshot: примерный вид [https://jing.yandex-team.ru/files/av-denis/recommended.png]
      - do: кликнуть на стрелку вперёд
      - assert: |
          блок с рекомендациями проскроллился вперед
          в левой части есть стрелка назад
      - do: кликнуть на стрелку назад
      - assert: блок с рекомендациями проскроллился назад
    # Рекомендации по окончании последнего ролика
    - &playerRecommendationsOnTheEnd
      - assert: под плеером находится список с эпизодами
      - do: проскроллить список с эпизодами до конца (с учетом дозагрузок) и кликнуть в последний эпизод
      - assert: в плеере начало проигрываться содержимое последнего эпизода
      - do: перемотать видео в самый конец
      - assert: |
          после окончания воспроизведения видео в плеере появился блок с рекомендациями
      - screenshot: примерный внешний вид [https://jing.yandex-team.ru/files/av-denis/player-desktop-recommendations-end.png]
    # Рекомендации по окончании последнего ролика, выбор эпизода
    - &trailersPlayerStartRight3
      - *playerRecommendationsOnTheEnd
      - assert: в блоке рекомендаций есть набор эпизодов
      - do: кликнуть по любому эпизоду
      - assert: в плеере начало проигрываться содержимое выбранного эпизода
      # Рекомендации по окончании последнего ролика, скролл блока
    - &trailersPlayerStartRight4
      - *playerRecommendationsOnTheEnd
      - assert: в правой части блока рекомендаций есть стрелка направо
      - do: кликнуть по стрелке направо
      - assert: |
          содержимое блока рекомендаций перелистнулось вперед
          в левой части блока рекомендаций есть стрелка налево
      - do: кликнуть по стрелке налево
      - assert: содержимое блока рекомендаций перелистнулось назад
    # Условие для кейсов с рекламой
    - &playerAdvCondition
      - do: |
           этот кейс нужно выполнить в режиме инкогнито
           или предварительно, почистив куки (валидно для тестов, связанных с блокировщиком рекламы)
           !!ВАЖНО!! размер плеера должен быть !!не меньше 440х520 px!!, иначе реклама не разыграется из-за маленького размера
           если нет возможности посмотреть в большем размере, то перейдите во фулскрин
    # Условие для кейсов с рекламой и блокировщиком рекламы
    - &playerRecommendationsOnTheEnd7
      - *playerAdvCondition
      - do: включить адблок в браузере
      - do: после загрузки выдачи по запросу обновите страницу
    # Клик по рекламному содержимому
    - &playerRecommendationsOnTheEnd5
      - do: |
          включить звук в нижней части плеера(если на предыдущем шаге он не включился самостоятельно) и
          досмотреть видео до момента появления рекламы (обычно в конце ролика)
          (если реклама в конце и начал играть следующий ролик, то это НЕ баг) (если рекламы нет, тогда перезагрузить страницу и попробовать выполнить кейс ещё раз)
      - assert: |
          появился рекламный блок
      - screenshot: примерный вид [https://jing.yandex-team.ru/files/av-denis/player-adv.png]
      - do: кликнуть на любую ссылку в содержимом рекламного блока (если нет ссылок - в любом месте блока)
      - assert: в новой вкладке открылся сайт с рекламным контентом
    # Досмотр рекламного ролика
    - &playerRecommendationsOnTheEnd6
      - do: |
          досмотреть видео до момента появления рекламы (обычно в конце ролика)
          (если рекламы нет, тогда перезагрузить страницу и попробовать выполнить кейс ещё раз)
      - assert: |
          появился рекламный блок
      - screenshot: примерный вид [https://jing.yandex-team.ru/files/av-denis/player-adv.png]
      - do: досмотреть рекламу до конца (их может быть несколько)
      - assert: |
          после рекламы автоматически продолжилось воспроизведение ролика (кроме случая, когда реклама в конце ролика)
          (если реклама в конце и начал играть следующий ролик, то это НЕ баг)
    # Скопировать ссылку
    - &playerAdvCondition4
      - do: нажать на кнопку паузы
      - assert: |
          плеер перестал воспроизводиться
          на месте кнопки паузы теперь плей
      - do: в контролах нажать на "Скопировать ссылку" !!ШАГ ДЛЯ БЛОГГЕРОВ, ТРЕЙЛЕРОВ И КЛИПОВ, У ФИЛЬМОВ И СЕРИАЛОВ ПРОВЕРЯТЬ НЕ НАДО!!
      - assert: |
                появилась галочка, обозначающая успешное копирование
                (если появилось системное окно с вариантами как поделиться ссылкой - это не баг, в этом случае надо выбрать "Скопировать ссылку" в вариантах)
                проверить, что ссылка скопировалась, вставив её в адресную строку
    # Включился следующий выпуск блогера по очереди
    - &playerAdvCondition3
      - do: |
            навести курсор на ползунок воспроизведения и перемотать содержимое в конец ролика (за 5-10 секунд)
            если прохождение у сериала, то следующий эпизод должен быть бесплатным
      - assert: |
          после окончания проигрывания начал автоматическое воспроизведение следующий эпизод по списку
          возможно начнется воспроизведение рекламы, в таком случае после окончания рекламы начнется воспроизведение следующего эпизода
      - do: перемотать теперь содержимое в конец ролика (за 5-10 секунд)
      - assert: |
          снова после окончания проигрывания начал автоматическое воспроизведение следующий эпизод по списку
          возможно начнется воспроизведение рекламы, в таком случае после окончания рекламы начнется воспроизведение следующего эпизода
    # Включилась следующая по очереди серия сериала
    - &playerAdvCondition3serial
      - do: |
            навести курсор на ползунок воспроизведения и перемотать содержимое в конец ролика (за 5-10 секунд)
      - assert: |
          после окончания проигрывания не запустилась реклама
          после окончания проигрывания начал автоматическое воспроизведение следующий эпизод по списку
      - do: перемотать теперь содержимое в конец ролика (за 5-10 секунд)
      - assert: |
          после окончания проигрывания не запустилась реклама
          снова после окончания проигрывания начал автоматическое воспроизведение следующий эпизод по списку
  Проверки по типам контента:
    Трейлеры в правой колонке:
      Основные элементы управления [manual]:
        - *trailersPlayerStartRight
        - *playerOttControlElements
      Перемотка содержимого [manual]:
        - priority: normal
        - *trailersPlayerStartRight
        - *playerRewind
      Воспроизведение контента [manual]:
        - priority: normal
        - *trailersPlayerStartRight
        - *playerPlaying
      Пауза [manual]:
        - priority: normal
        - *trailersPlayerStartRight
        - *playerPause
      Полноэкранный режим (fullscreen) [manual]:
        - priority: minor
        - *trailersPlayerStartRight
        - *playerRecommendationsOnTheEnd3
      Реклама:
        Открытие [manual]:
          - *playerAdvCondition
          - *trailersPlayerStartRight
          - *playerRecommendationsOnTheEnd5
        Бездействие [manual]:
          - priority: normal
          - *playerAdvCondition
          - *trailersPlayerStartRight
          - *playerRecommendationsOnTheEnd6
        С включённым блокировщиком рекламы [manual]:
          - *playerRecommendationsOnTheEnd7
          - *trailersPlayerStartRight
          - *playerRecommendationsOnTheEnd6
    Трейлеры в правой колонке за кнопкой:
      Основные элементы управления [manual]:
        - priority: normal
        - *trailersPlayerStartRightButton
        - *playerOttControlElements
      Перемотка содержимого [manual]:
        - priority: normal
        - *trailersPlayerStartRightButton
        - *playerRewind
      Воспроизведение контента [manual]:
        - priority: normal
        - *trailersPlayerStartRightButton
        - *playerPlaying
      Пауза [manual]:
        - priority: normal
        - *trailersPlayerStartRightButton
        - *playerPause
      Отображение превью над таймлайном [manual]:
        - priority: minor
        - *trailersPlayerStartRightButton
        - *playerTimelinePreview
      Регулятор громкости звука [manual]:
        - priority: normal
        - *trailersPlayerStartRightButton
        - *playerRecommendationsOnTheEnd0
      Шестерёнка с настройками:
        Изменение качества [manual]:
          - priority: normal
          - *trailersPlayerStartRightButton
          - *playerRecommendationsOnTheEnd1
        Изменение скорости воспроизведения [manual]:
          - priority: minor
          - *trailersPlayerStartRightButton
          - *playerRecommendationsOnTheEnd2
      Полноэкранный режим (fullscreen) [manual]:
        - priority: normal
        - *trailersPlayerStartRightButton
        - *playerRecommendationsOnTheEnd3
      Повторное проигрывание видео в плеере [manual]:
        - priority: minor
        - *trailersPlayerStartRightButton
        - *playerRecommendationsOnTheEnd4ButtonTrailer
      Реклама:
        Открытие [manual]:
          - *playerAdvCondition
          - *trailersPlayerStartRightButton
          - *playerRecommendationsOnTheEnd5
        Бездействие [manual]:
          - priority: normal
          - *playerAdvCondition
          - *trailersPlayerStartRightButton
          - *playerRecommendationsOnTheEnd6
        С включённым блокировщиком рекламы [manual]:
          - *playerRecommendationsOnTheEnd7
          - *trailersPlayerStartRightButton
          - *playerRecommendationsOnTheEnd6
    Трейлеры в центральной колонке:
      Основные элементы управления [manual]:
        - priority: normal
        - *trailersPlayerStartMiddle
        - *playerOttControlElements
      Перемотка содержимого [manual]:
        - priority: normal
        - *trailersPlayerStartMiddle
        - *playerRewind
      Воспроизведение контента [manual]:
        - priority: normal
        - *trailersPlayerStartMiddle
        - *playerPlaying
      Пауза [manual]:
        - priority: normal
        - *trailersPlayerStartMiddle
        - *playerPause
      Отображение превью над таймлайном [manual]:
        - priority: minor
        - *trailersPlayerStartMiddle
        - *playerTimelinePreview
      Регулятор громкости звука [manual]:
        - priority: normal
        - *trailersPlayerStartMiddle
        - *playerRecommendationsOnTheEnd0
      Шестерёнка с настройками:
        Изменение качества [manual]:
          - priority: normal
          - *trailersPlayerStartMiddle
          - *playerRecommendationsOnTheEnd1
        Изменение скорости воспроизведения [manual]:
          - priority: minor
          - *trailersPlayerStartMiddle
          - *playerRecommendationsOnTheEnd2
      Полноэкранный режим (fullscreen) [manual]:
        - priority: normal
        - *trailersPlayerStartMiddle
        - *playerRecommendationsOnTheEnd3
      Повторное проигрывание видео в плеере [manual]:
        - priority: minor
        - *trailersPlayerStartMiddle
        - *playerRecommendationsOnTheEnd4
      Реклама:
        Открытие [manual]:
          - *playerAdvCondition
          - *trailersPlayerStartMiddle
          - *playerRecommendationsOnTheEnd5
        Бездействие [manual]:
          - priority: normal
          - *playerAdvCondition
          - *trailersPlayerStartMiddle
          - *playerRecommendationsOnTheEnd6
        С включённым блокировщиком рекламы [manual]:
          - *playerRecommendationsOnTheEnd7
          - *trailersPlayerStartMiddle
          - *playerRecommendationsOnTheEnd6
    Фильмы:
      Основные элементы управления [manual]:
        - *playerRecommendationsOnTheEnd9
        - *playerOttControlElements
      Перемотка содержимого [manual]:
        - priority: normal
        - *playerRecommendationsOnTheEnd9
        - *playerRewind
      Воспроизведение контента [manual]:
        - *playerRecommendationsOnTheEnd9
        - *playerPlaying
      Пауза [manual]:
        - *playerRecommendationsOnTheEnd9
        - *playerPause
      Отображение превью над таймлайном [manual]:
        - priority: minor
        - *playerRecommendationsOnTheEnd9
        - *playerTimelinePreview
      Регулятор громкости звука [manual]:
        - priority: normal
        - *playerRecommendationsOnTheEnd9
        - *playerRecommendationsOnTheEnd0
      Шестерёнка с настройками:
        Изменение качества [manual]:
          - priority: normal
          - *playerRecommendationsOnTheEnd9
          - *playerRecommendationsOnTheEnd1
        Изменение скорости воспроизведения [manual]:
          - priority: minor
          - *playerRecommendationsOnTheEnd9
          - *playerRecommendationsOnTheEnd2
        Изменение субтитров [manual]:
          - priority: minor
          - *playerRecommendationsOnTheEnd9
          - *playerAdvCondition0
        Изменение аудио [manual]:
          - priority: minor
          - *playerRecommendationsOnTheEnd9
          - *playerAdvCondition1
      Полноэкранный режим (fullscreen) [manual]:
        - priority: normal
        - *playerRecommendationsOnTheEnd9
        - *playerRecommendationsOnTheEnd3
      Повторное проигрывание видео в плеере [manual]:
        - priority: normal
        - *playerRecommendationsOnTheEnd9
        - *playerRecommendationsOnTheEnd4film
      Реклама:
        tags: no_assessors # отключаю, т.к. после удаления авода с Серпа кейсы стали неактуальными
        Открытие [manual]:
          - *playerAdvCondition
          - *playerRecommendationsOnTheEnd9
          - *playerRecommendationsOnTheEnd5
        С включённым блокировщиком рекламы [manual]:
          - *playerRecommendationsOnTheEnd7
          - *playerRecommendationsOnTheEnd9
          - *playerRecommendationsOnTheEnd6
        Бездействие [manual]:
          - *playerAdvCondition
          - *playerRecommendationsOnTheEnd9
          - *playerRecommendationsOnTheEnd6
    Сериалы:
      Основные элементы управления [manual]:
        - *playerAdvCondition2
        - *playerOttControlElements
      Автовоспроизведение следующей серии [manual]:
        - priority: minor
        - *playerAdvCondition2
        - *playerAdvCondition3serial
      Реклама:
        tags: [no_assessors, draft] # заскипал т.к. на Серпе выключили AVOD (нужно подумать как использовать этот кейс в УПФ)
        Открытие [manual]:
          - *playerAdvCondition
          - *playerAdvCondition2
          - *playerRecommendationsOnTheEnd5
        С включённым блокировщиком рекламы [manual]:
          - *playerRecommendationsOnTheEnd7
          - *playerAdvCondition2
          - *playerRecommendationsOnTheEnd6
        Бездействие [manual]:
          - *playerAdvCondition
          - *playerAdvCondition2
          - *playerRecommendationsOnTheEnd6
      Скопировать ссылку [manual]:
        - tags: [no_assessors, draft] #пока скипаю, VIDEOUI-15841
        - *playerAdvCondition2
        - *playerAdvCondition4
    Блогеры:
      tags: [no_assessors] # убрали плеер для карточек блогеров
      Основные элементы управления [manual]:
        - *playerAdvCondition5
        - *playerAdvCondition6
      Автовоспроизведение следующего эпизода [manual]:
        - priority: minor
        - *playerAdvCondition5
        - *playerAdvCondition3
      Реклама:
        Открытие [manual]:
          - *playerAdvCondition
          - *playerAdvCondition5
          - *playerRecommendationsOnTheEnd5
        С включённым блокировщиком рекламы [manual]:
          - *playerRecommendationsOnTheEnd7
          - *playerAdvCondition5
          - *playerRecommendationsOnTheEnd6
        Бездействие [manual]:
          - priority: normal
          - *playerAdvCondition
          - *playerAdvCondition5
          - *playerRecommendationsOnTheEnd6
      Скопировать ссылку [manual]:
        - tags: [no_assessors, draft] #пока скипаю, VIDEOUI-15841
        - *playerAdvCondition5
        - *playerAdvCondition4
    Клипы:
      description: если в карточке музыканта нет плеера, убедитесь что кейс проходится из местоположения РФ, иначе плеер может отсутсвовать
      Основные элементы управления [manual]:
        - priority: normal
        - *trailersPlayerStartRight5
        - *playerOttControlElements
      Реклама:
        Открытие [manual]:
          - *playerAdvCondition
          - *trailersPlayerStartRight5
          - *playerRecommendationsOnTheEnd5
        С включённым блокировщиком рекламы [manual]:
          - *playerRecommendationsOnTheEnd7
          - *trailersPlayerStartRight5
          - *playerRecommendationsOnTheEnd6
        Бездействие [manual]:
          - priority: normal
          - *playerAdvCondition
          - *trailersPlayerStartRight5
          - *playerRecommendationsOnTheEnd6
    Проигрывание DRM контента [manual]:
      - *automationTicket
      - do: залогиниться пользователем с подпиской (например, test-serp-assessors-plus/hL5-tYe-VGX-fzg)
      - do: получить выдачу по запросу 'веном' (альтернативные запросы 'рик и морти', 'клиника сериал')
      - assert: справа в карточке ОО присутствует заглушка с кнопкой "Смотреть" (если заглушки нет или название кнопки "Купить", то проверьте наличие подписки и попробуйте альтернативные запросы)
      - do: нажать на кнопку "Смотреть" и выбрать там "Кинопоиск"
      - assert: плеер начал воспроизводиться
      - do: немного перемотать ролик
      - assert: после перемотки ролик продолжает проигрываться

    Проигрывание EST контента:
      - priority: normal
      - *automationTicket
      - do: залогиниться пользователем с купленным контентом ( test-serp-assessors-plus / hL5-tYe-VGX-fzg )
      - do: получить выдачу по запросу "Зверопой" (альтернативные запросы "Семейка Крудс", "Мадагаскар 1")
      - assert: справа в карточке ОО присутствует заглушка с кнопкой "Смотреть" (если заглушки нет или название кнопки "Купить", то проверьте наличие подписки и попробуйте альтернативные запросы)
      - do: нажать на кнопку "Смотреть"
      - assert: появился попап с подсказкой 'Сериал/Фильм куплен'
      - do: выбрать "Кинопоиск" Смотреть
      - assert: плеер начал воспроизводиться
      - do: немного перемотать ролик
      - assert: после перемотки ролик продолжает проигрываться

files: []

v-team: Video

priority: high

tags:
  - skip_manual_check
  - video_player
  - skip_e2e_check

tlds: ru
