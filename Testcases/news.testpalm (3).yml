feature: Колдунщик новостей
type: в виде списка-галереи

description: |
  Везде, кроме Яндекс Браузера (на Android и на iOs>13), вместо турбо-слайдера открывается отдельная турбо-страница;
  в шапке нет точек навигации и имени ресурса;
  вместо крестика - кнопка "Назад"

specs:
  Проверка ссылок в списке:
    priority: high
    params:
      foreverdata: '535018853'
    beforeEach:
      - do: |
          убедиться, что находитесь не в режиме инкогнито
          получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
    Внешний вид:
      - tags: smoke
      - screenshot: проверить внешний вид [news]
      - assertMetrics: '*'
    Заголовок:
      - browsers:
          notFor:
            - android-pp-6.45-touch
      - tags: smoke
      - do: нажать на заголовок колдунщика ('Свежие новости')
      - tech: сработал счетчик '/$page/$main/$result[@wizard_name="news"]/title'
      - assert: в новой вкладке открылись "Яндекс Новости"
      - do: вернуться на страницу с выдачей
      - assert: ссылка в заголовке окрашена в фиолетовый цвет
      - assertMetrics: '*'
    Все новости:
      - browsers:
          notFor:
            - android-pp-6.45-touch
      - tags: smoke
      - do: нажать на кнопку 'Все новости'
      - tech: сработал счетчик '/$page/$main/$result[@wizard_name="news"]/all'
      - assert: сработала анимация нажатия кнопки "Все новости"
      - assert: в новой вкладке открылись "Яндекс Новости"
      - do: вернуться на страницу с выдачей
      - assert: ссылка в заголовке окрашена в фиолетовый цвет
    2я новость:
      browsers:
        notFor:
          - android-pp-6.45-touch
      Тумба:
        - do: нажать на картинку второй новости
        - tech: сработал счетчик '/$page/$main/$result[@wizard_name="news"]/card/image'
        - assert: в новой вкладке открылся сайт выбранной новости
        - do: вернуться на страницу с выдачей
        - assert: тайтл новости окрашен в фиолетовый цвет
        - assertMetrics: '*'
      Заголовок:
        - do: нажать на заголовок второй новости
        - tech: сработал счетчик '/$page/$main/$result[@wizard_name="news"]/card/doc'
        - assert: в новой вкладке открылся сайт выбранной новости
        - do: вернуться на страницу с выдачей
        - assert: тайтл новости окрашен в фиолетовый цвет
        - assertMetrics: '*'
      Общая ссылка с хостом:
        - do: нажать на хост ссылку под заголовком второй новости
        - tech: сработал счетчик '/$page/$main/$result[@wizard_name="news"]/card/desc'
        - assert: в новой вкладке открылся сайт выбранной новости
        - do: вернуться на страницу с выдачей
        - assert: тайтл новости окрашен в фиолетовый цвет
        - assertMetrics: '*'
        - tags: no_assessors
    Слайдер открывается с третьей новости:
      - browsers:
          notFor:
            - chrome-phone
            - android-browser-4.4-touch
            - android-browser-5.1-touch
            - android-opera-42-touch
            - android-samsung-internet-5-touch
            - ios-chrome-mobile-touch
            - ios-safari-9-touch
            - ios-safari-10-touch
            - ios-safari-11-touch
            - ios-safari-12-touch
            - ios-safari-13-touch
            - ios-safari-14-touch
            - android-browser-6-touch
            - android-uc-browser-touch
            - android-uc-browser-11-touch
            - android-mz-browser-touch
            - android-miui-9-touch
            - android-browser-7-touch
            - searchapp-phone-group
            - iphone
            - safari11
            - safari12
      - do: тапнуть по картинке в третьей новости
      - assert: открылся оверлей с турбо-слайдером
      - assert: в оверлее есть слайдер, в шапке слайдера есть навигация, в которой выделена вторая точка [https://jing.yandex-team.ru/files/firestorm/_Yandeks_nichego_ne_naideno_2018-04-26_21-41-06.png]
  Проверка видео тумбы:
    - params:
        foreverdata: '3778956177'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: на выдаче есть колдунщик новостей
    - screenshot: проверить внешний вид [news]
    - do: нажать на картинку первой новости
    - tech: сработал счетчик '/$page/$main/$result[@wizard_name="news"]/card/video'
    - assert: в новой вкладке открылось видео выбранной новости (само видео может отсутствовать, проверка заключается в открытии ссылки)
  Проверка кебаб-меню:
    params:
      foreverdata: '2655449846'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
  Иконки турбо для нетурбированного сниппета:
    params:
      foreverdata: '1926695066'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче присутствует колдунщик новостей
    Внешний вид:
      - screenshot: примерный внешний вид [plain]
    Первая новость:
      - do: нажать на ссылку заголовок первой новости
      - tech: сработал счетчик '/$page/$main/$result[@wizard_name="news"]/card/doc'
      - assert: открылся сюжет в новой вкладке (сам сюжет может отсутствовать выдавать 404 или страница не найдена - это не ошибка, для теста важен сам факт открытия в новой вкладке)
specs-integration:
  Список новостей:
    - counter: /$page/$main/$result[@wizard_name="news" and @subtype="list-right"]
    - do: открыть выдачу по запросу 'что происходит в мире' _ALTERNATIVE_SEARCH_QUERIES_
    - assert: колдунщик присутствует на выдаче
    - assert: колдунщик содержит хотя бы одну новость

files:
  - features/touch-phone/news/news.hermione.js
  - features/touch-phone/news/news.hermione.e2e.js

v-team: Freshness

counter: /$page/$main/$result[@wizard_name="news"]

tags:
  - reviewed
  - news

tlds:
  - ru
  - by
  - ua
  - kz
  - uz
