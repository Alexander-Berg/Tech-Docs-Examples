feature: Сети/Рубрики
type: Большая карта и список сверху / Карточка-карта

import-labels:
  - features/companies/bk_list/companies-list@desktop.testpalm.yml

specs-integration:
  Проверка наличия элементов:
    - do: получить выдачу по запросу 'бары'
    - assert: появилась карусель с карточкой-картой
    - do: кликнуть по карточке-карте
    - assert: появилась карта

specs:
  Внешний вид карточки-карты:
    - label: geo-bk-card-map
    - do: получить выдачу по запросу 'бары' _ALTERNATIVE_SEARCH_QUERIES_
    - screenshot: появилась карусель с карточкой-картой [carousel-map]
  Проверка карточки-карты:
    - do: получить выдачу по запросу 'бары' _ALTERNATIVE_SEARCH_QUERIES_
    - screenshot: появилась карусель с карточкой-картой [geo-bk-card-map >> carousel-map]
    - do: кликнуть по карточке-карте
    - assert: появилась карта с обозначенными организациями в виде пинов на ней
  Проверка наличия параметра drag_context:
    - tags:
        - no_assessors
    - do: получить выдачу по запросу "кафе в омске" _ALTERNATIVE_SEARCH_QUERIES_
    - screenshot: появилась карусель с карточкой-картой [geo-bk-card-map >> carousel-map]
    - assert: у фильтров в карусели заведений есть параметр dragContext
  Сброс фильтра после пустого результата:
    - tags:
        - no_assessors
    # запрос, на котором при смене фильтров легко получить результат 'Ничего не найдено
    - do: получить выдачу по запросу 'кафе в каменске уральском' _ALTERNATIVE_SEARCH_QUERIES_
    - screenshot: появилась карусель с карточками [companies-bk-carousel-{{SET_NAME}} >> carousel]
    - do: выбрать в фильтре рейтинг 'Не ниже 4.9'
    - assert: элементы карусели исчезли
    - assert: появилось сообщение 'Ничего не найдено'
    - do: сбросить фильтр рейтинга
    - assert: в карусели загрузились элементы
    - tech: в аякс-запросе есть параметр drag_context
  # https://st.yandex-team.ru/SERP-134858
  Организация без фильтров:
    - tags:
        - no_assessors
    - params:
        foreverdata: '809520832'
    - do: получить выдачу по запросу 'foreverdata'
    - assert: на выдаче есть карточка одной организации
    - do: кликнуть в кнопку "Показать карту"
    - tech: в консоли нет ошибок

files:
  - features/companies/bk_card_map/companies-list@desktop.hermione.js
  - features/companies/bk_card_map/companies-list@desktop.hermione.e2e.js

v-team: VanillaGeo

counter: /$page/$top/$result[@wizard_name="companies" and @subtype="map"]/companies-map-list/carousel/showcase/item/map/bcard-map

tags:
  - hasE2E

tlds: all
