feature: CartIcon

params:
  exp_flags:
    - turboforms_endpoint=https://test-turbo-forms.common.yandex.ru/
    - analytics-disabled=1

browsers:
  - ios-safari-12-touch
  - ios-safari-11-touch
  - ios-safari-10-touch
  - ios-safari-9-touch

specs:
  Данные с сервера (дефолт):
    Внешний вид с товарами:
      - do: |
          открыть страницу https://yandex.ru/turbo?stub=productpage%2Fproduct-1-server-for-screens.json
          если товар не в корзине (в товаре есть кнопка `добавить в корзину`) - добавить
          открыть страницу https://yandex.ru/turbo?stub=productpage%2Fproduct-server-for-screens.json
          если товар не в корзине (в товаре есть кнопка `добавить в корзину`) - добавить
          открыть ссылку https://yandex.ru/turbo?stub=carticon/default.json
      - screenshot: внешний вид соответствует скриншоту (количество должно отображаться, но может отличаться)[plain]

    Внешний вид с пустой корзиной:
      - do: |
          открыть ссылку https://yandex.ru/turbo?stub=cart/default.json
          если список товаров не пуст - нажать в каждом товаре `Удалить`
          открыть ссылку https://yandex.ru/turbo?stub=carticon/default.json
      - screenshot: внешний вид соответствует скриншоту [plain]

    Ссылка на корзину:
      - do: открыть ссылку https://yandex.ru/turbo?stub=carticon/default.json
      - assert: на странице есть иконка корзины
      - do: кликнуть на иконку
      - assert: в той же вкладке открылась ссылка https://yandex.ru/turbo?stub=cart/default.json

  Данные из localstorage:
    Проверка работы:
      - do: открыть ссылку https://yandex.ru/turbo?stub=cart/ls-clear-data.json
      - assert: виден текст о том, что корзина пуста
      - do: открыть ссылку https://yandex.ru/turbo?stub=carticon/ls-read-data.json
      - assert: |
          на странице есть иконка корзины
          на иконке не отображается количество товаров
      - do: открыть ссылку https://yandex.ru/turbo?stub=cart/ls-set-data.json
      - assert: на странице виден список товаров
      - do: открыть ссылку https://yandex.ru/turbo?stub=cart/ls-set-data-another-shopid.json
      - assert: на странице виден список с другими товарами
      - do: открыть ссылку https://yandex.ru/turbo?stub=carticon/ls-read-data.json
      - assert: |
          на странице есть иконка корзины
          на иконке отображается `8`
      - do: открыть ссылку https://yandex.ru/turbo?stub=carticon/ls-read-data-another-shopId.json
      - assert: |
          на странице есть иконка корзины
          на иконке отображается `102`
      - screenshot: внешний вид соответствует скриншоту [plain]

files:
  - platform/components/CartIcon/__tests__/CartIcon@phone.hermione.js

tags:
  - e-commerce
  - no_assessors #раскатили новый дизайн на 100%

v-team: Turbo

manager: tanzwuta

qa-engineer: yanislav

tlds: none
