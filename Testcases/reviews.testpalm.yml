feature: Отзывы

description: |
  блок с отзывами пользователей о сущности (фильм/книга/игра/кафе и т.п.)
  может быть 2 видов - с горизонтальной (view=card) и вертикальной прокруткой
  используется несколькими командами

specs:
  В центральной колонке:
    Отзывы к фильму:
      - do: получить выдачу по запросу 'Аквамен отзывы'
      - screenshot: в центральной колонке появился блок с одним отзывом [initial]
      - do: нажать на кнопку 'Ещё отзывы'
      - screenshot: подгрузилось ещё 3 отзыва [moar-1]
      - assertMetrics: '*'
    Намерение смотреть отзывы:
      - params:
          ento: '0oCgpydXc2OTQ5OTQ4GAJCG9Cw0LrQstCw0LzQtdC9INC-0YLQt9GL0LLRi1yYAmQ;tab=reviews'
          text: 'Аквамен отзывы'
      - screenshot: в центральной колонке появился блок с 5 отзывами [initial]
      - do: нажать на кнопку 'Ещё отзывы'
      - screenshot: подгрузилось ещё 5 отзывов [moar-1]
      - assertMetrics: '*'
    Переход из отзывов на ПК c utm_source:
      - do: получить выдачу по запросу 'Аквамен отзывы'
      - do: дождаться загрузки отзывов
      - do: нажать на имя пользователя во втором отзыве
      - assert: в новом окне открылась ссылка с параметром utm_source=entity
    Проверка корректных параметров в запросе за отзывами:
      - params:
          ento: '0oCgpydXc3NTczOTc4GAJCNNGE0L7RgNC0INC_0YDQvtGC0LjQsiDRhNC10YDRgNCw0YDQuCDRhNC40LvRjNC8IDIwMTnZRngt;tab=reviews'
      - do: предварительно открыть в браузере вкладку network инструментов разработчика
      - do: получить выдачу по запросу 'форд против феррари отзывы'
      - assert: в центральной колонке появился блок с двумя отзывами
      - assert: |
          во вкладке network инструментов разработчика есть запрос по адресу /search/ugc2/desktop-digest (адрес проще всего искать указав в его в фильтре)
          с параметром utm_content=system
          с параметром appId=serp-desktop-ontodb
          параметры можно найти в деталях запроса [https://jing.yandex-team.ru/files/shnurig/browser_7VK3lfFZfm.png]
      - do: нажать на кнопку 'Ещё отзывы'
      - assert: |
          во вкладке network инструментов разработчика появился еще один запрос
          по адресу /search/ugc2/desktop-digest
          с параметром utm_content=user
          с параметром appId=serp-desktop-ontodb

  В колонке справа:
    Ссылка на ПК с параметром utm_source=entity:
      - params:
          intent: reviews
      - do: получить выдачу по запросу 'фильм аквамен 2018'
      - do: дождаться загрузки отзывов
      - do: нажать на имя пользователя в первом отзыве
      - assert: в новом окне открылась ссылка с параметром utm_source=entity

files:
  - features/desktop/reviews/reviews.hermione.js

v-team: UGC

tags: ['oo_reviews', 'skip_e2e_check']

tlds: ['ru']
