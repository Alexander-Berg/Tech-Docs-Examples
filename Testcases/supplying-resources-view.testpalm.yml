feature: Ресурсы
type: Страница ресурсов сервиса

specs:
  beforeEach:
    - tech: залогиниться под пользователем robot-abc-002
    - do: открыть страницу поставляемых ресурсов сервиса "КотикиДелаютКусь" (/services/catsmakebite/resources/?view=supplying&layout=table)
    - assert: открылся список поставляемых ресурсов; в переключателе рядом со сторой поиска выбран вариант "Поставляемые"

  Поставляемые ресурсы:
    1. Поиск ресурса по названию:
      - automation: ABC-10986
      - do: в строке поиска ресурсов (напротив переключателя "Потребляемые/Поставляемые") написать "autotest"
      - do: нажать на кнопку "Найти"
      - assert: |
             страница обновилась, показан список поставляемых ресурсов
             в списке ресурсов только те ресурсы, которые содержат в имени "autotest"
             в строке поиска осталось введённое значение "autotest"
      - screenshot: в списке ресурсов только ресурсы, содержащие в имени "autotest" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-28%2020-34-31.png]
    
    2. Переключение между страницами:
      - automation: ABC-10986
      - do: проскроллить страницу до самого низа
      - screenshot: внизу страницы есть кнопки "показать ещё" и "дальше" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-09-09%2016-19-55.png]
      - do: кликнуть на кнопку "показать ещё"
      - assert: |
             подгрузилась вторая страница с ресурсами - отображается больше 20, но меньше 40 ресурсов,
             в URL появился параметр "page=2020-02-05%2016%3A22%3A08.026255%2B00%3A00-0",
             внизу страницы добавилась ещё одна кнопка - "назад"
      - do: кликнуть на кнопку "назад" 
      - assert: |
             подгрузилась первая страница с ресурсами - отображается 20 ресурсов, 
             внизу страницы показаны только две кнопки - "показать ещё" и "дальше"

    3. Выдача подтверждённого ресурса и его удаление:
      - automation: ABC-10986
      - do: (PREPARE) открыть презаполненную форму запроса выдаваемого сервисом ресурса (/services/catsmakebite/resources/?view=supplying&layout=table&new-resource=yes&new-resource-service=3465&new-resource-resource=272)
      - do: (PREPARE) в появившейся форме заполнить "Название", например, "тестовый ресурс"
      - do: (PREPARE) кликнуть в форме на кнопку "Отправить"
      - do: (PREPARE) закрыть форму запроса ресурса
      - assert: первой строчкой в списке ресурсов появился ресурс в статусе "Подтвержден"
      - do: кликнуть на строчку с этим ресурсом
      - screenshot: появилось модальное окно с информацией про ресурс; в левом нижнем углу окна есть кнопка "Выдать" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-28%2021-20-22.png]
      - do: кликнуть на кнопку "Выдать"
      - assert: окно закрылось, ресурс перешёл в статус "Выдаётся"
      - do: кликнуть на многоточие в конце строки с ресурсом 
      - screenshot: появилось меню с пунктами "Удалить", "Редактировать" и "Посмотреть" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-09-09%2016-32-55.png]
      - do: кликнуть на вариант "Удалить"
      - screenshot: появилось модальное окно с заголовком "Подтвердите действие", текстом "Вы уверены что хотите удалить ресурс?" и кнопками "Отмена" и "Подтвердить" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-28%2021-24-29.png]
      - do: кликнуть на кнопку "Подтвердить"
      - assert: окно закрылось, у ресурса статус изменился на "Отозван"

    4. Переход в форму редактирования ресурса:
      - automation: ABC-10986
      - do: кликнуть на многоточие в конце строки с любым ресурсом 
      - assert: появилось меню с доступными действиями над ресурсом, среди пунктов есть вариант - "Редактировать"
      - do: кликнуть на вариант "Редактировать"
      - screenshot: открылась форма "Редактирование ресурса" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-28%2021-23-30.png] 
      - do: закрыть форму
      - assert: форма закрылась

    5. Ресурсов в результате поиска не нашлось:
      - automation: ABC-10986  
      - do: в строке поиска ресурсов (напротив переключателя "Потребляемые/Поставляемые") написать "несуществующий ресурс"
      - do: нажать кнопку "Найти"
      - screenshot: страница обновилась; в строке поиска осталось введённое значение "несуществующий ресурс"; показана надпись "Ничего не найдено" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-30%2011-49-59.png]


files: []

priority: critical

tags:
  - no_assessors
  - reviewed
