feature: Отправка файлов в q

tlds: ru

import-steps:
    - tests/hermione/suites/messenger/shared-steps/open-messenger.testpalm.steps.yml

specs:
  beforeEach:
    - attach: Открытие чата q
    - do: открыть чат с другим пользователем

  Отправка файла:
    - tags: [smoke_automation]
    - do: нажать на скрепку в поле ввода сообщения
    - do: в появившемся окне файловой системы выбрать файл размером менее (50 МБ для production или 500 КБ для testing)
    - assert: |
        файл отправлен в чат с ботом
        в балуне сообщения отображается название файла, вес, время отправки и ссылка скачать
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-09-30T16:53:27.322546.jpg]

  Ошибка загрузки файла размером более чем максимальный лимит:
    - do: нажать на скрепку в поле ввода сообщения
    - do: в появившемся окне файловой системы выбрать файл размером более (50 МБ для production или 500 КБ для testing)
    - assert: ошибка загрузки с текстом "Можно загружать непустые файлы размеер которых не превышает 50 МБ"

  Отправка файлов drag-and-drop[manual]:
    - automation: MSSNGRFRONT-4989
    - do: уменьшить размер окна браузера так, чтобы можно было выбрать текстовые файлы и перетащить их в чат
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-09-30T17:08:42.251676.jpg]
    - do: выбрать оба файла и перетащить в чат с ботом
    - assert: в момент наведения файлов на контейнер отображается сообщение "перетащите файлы сюда, чтобы отправить"
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-09-30T17:12:34.511674.jpg]
    - assert: |
        отображается окно подтверждения загрузки
        кнопка загрузить подсвечена
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-09-30T17:15:10.961914.jpg]
    - do: нажать энтер
    - assert: |
        файлы отправлены в чат с ботом
        в балуне сообщений отображаются названия файлов, вес, время отправки и ссылка скачать

  Ошибка загрузки файлов при отсутствии интернет-соединения[manual]:
    - automation: MSSNGRFRONT-4990
    - do: любым способом отключить интернет
    - do: нажать на скрепку в поле ввода сообщения
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-09-30T16:50:06.763868.jpg]
    - do: найти в файловой системе файл весом < 50 МБ и выбрать его
    - do: в модальном окне подтвердить загрузку файла
    - assert: |
        файл отображается в чате, но не загружен
        в балуне сообщения ссылка "повторить попытку"
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2019-09-30T17:29:46.182155.jpg]
    - do: включить интернет, дождаться соединения и нажать "повторить попытку"
    - assert: файл отправлен

files:
  - tests/hermione/suites/messenger/sending-messages/send.files.desktop.hermione.ts

v-team: Chat

tags:
    - q
    - release
    - yamb
    - y-team
    - desktop-app

browsers:
  notFor:
    - ie11
    - edge-desktop
