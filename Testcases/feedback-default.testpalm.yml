feature: Жалобщик
type: Дефолтный для колдунщиков

aliases:
  - &feedbackBase
    - do: получить выдачу по запросу 'test'
    - assert: у сниппетов присутствует кебаб-меню (три точки)
    - do: кликнуть на кебаб-меню
    - assert: открылось меню
    - do: кликнуть на ссылку "Сообщить об ошибке"
    - assert: появилось модальное окно обратной связи
  - &feedbackMetrics
    - *feedbackBase
    - do: ввести в поле "Расскажите подробнее о проблеме" текст "Тестирование"
    - do: нажать на кнопку "Отправить"
    - tech: сработал счётчик /$page/feedback-submit
    - assert: появился диалог ввода почты

specs:
  Новый жалобщик в ПОО:
    Открытие жалобщика:
      - params:
          foreverdata: '2965893125'
      - *feedbackBase
      - screenshot: внешний вид соответствует скриншоту [plain]
    Закрытие жалобщика:
      - params:
          foreverdata: '2965893125'
      - *feedbackBase
      - do: нажать на кнопку закрытия (крестик)
      - assert: модальное окно обратной связи закрылось
    Логирование baobab-счетчиков:
      Без ввода email:
        - params:
            foreverdata: '2965893125'
        - *feedbackMetrics
        - do: нажать на кнопку "Пропустить"
        - tech: сработал счётчик /$page/feedback-sended
      С вводом email:
        - params:
            foreverdata: '2965893125'
        - *feedbackMetrics
        - do: ввести в поле "Адрес почты" текс "hello@ya.ru"
        - do: нажать на кнопку "Продолжить"
        - assert: появился диалог "Спасибо за обращение. Мы ответим вам на почту hello@ya.ru"
        - tech: сработал счётчик /$page/feedback-sended
      Изменение email:
        - params:
            foreverdata: '2965893125'
        - *feedbackMetrics
        - do: ввести в поле "Адрес почты" текс "hello@ya.ru"
        - do: нажать на кнопку "Продолжить"
        - tech: сработал счётчик /$page/feedback-sended
        - assert: появился диалог "Спасибо за обращение. Мы ответим вам на почту hello@ya.ru"
        - do: нажать на кнопку "Изменить почту"
        - assert: появился диалог "Оставте почту, чтобы получить ответ"
        - tech: сработал счётчик /$page/change-email

files:
  - features/desktop/feedback/feedback-default.hermione.js

tags:
  - skip_e2e_check

tlds:
  - ru

v-team: Freshness
