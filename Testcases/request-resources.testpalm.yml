feature: Ресурсы
type: Страница ресурсов сервиса

specs:
  Положительные:
    1. Запрос ресурсов с автовыдачей из вкладки сервиса:
      - automation: ABC-5987
      - tech: залогиниться под пользователем robot-abc-002
      - do: открыть страницу ресурсов сервиса "Мой тестовый сервис 020" (/services/zanartestservice020/resources/?new-resource-service=2262&new-resource=yes)
      - screenshot: появилась форма для запроса ресурса; поле "Для какого сервиса" предзаполнено значением "Мой тестовый сервис 020 (автотесты)" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-15%2018-29-25.png]
      - do: кликнуть в поле "Выберите тип"
      - assert: появился выпадающий список с ресурсами
      - do: выбрать тип ресурса "Стафф — API"
      - screenshot: появились дополнительные поля формы для запроса ресурса [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-15%2018-35-15.png]
      - do: отметить галочками скоупы "persons", "offices"
      - do: нажать кнопку "Submit"
      - assert: появилось сообщение “Ресурс запрошен”
      - do: закрыть попап
      - do: кликнуть по карточке "Стафф"
      - assert: |
              в URL появились параметры "?view=consuming&layout=table&supplier=303"
              показан список потребляемых ресурсов от поставщика "Стафф"
              в списке появился запрошенный ресурс в статусе "Выдаётся" или "Выдан"
      - screenshot: список ресурсов с запрошенным и автоматически выданным ресурсом Staff API [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-15%2018-40-29.png]

    2. Запрос ресурса и его выдача из вкладки сервиса:
      - automation: ABC-9934
      - do: залогиниться под пользователем robot-abc-002
      - do: открыть вкладку "Ресурсы" на странице сервиса "Автотест фронтенда для сервиса с уникальным названием24" (/services/frontend-test_service-with-parent24/resources/)
      - do: нажать кнопку "Запросить ресурс"
      - screenshot: появилась форма для запроса ресурса; поле "Для какого сервиса" предзаполнено значением "Автотест фронтенда для сервиса с уникальным названием24" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-15%2018-51-05.png]
      - do: кликнуть в поле "Выберите тип"
      - assert: появился выпадающий список из нескольких типов ресурсов
      - do: выбрать "LogBroker — API"
      - assert: |
              ресурс выбрался,
              отобразился переключатель "Запросить/Привязать" с выбранным по умолчанию вариантов "Запросить"
              отобразились поля "Топик" и "Гранты"
              отобразились чек боксы "read – чтение" и "write – запись"
      - do: заполнить поле "Топик" значением "123"
      - do: выбрать грант "read – чтение"
      - do: нажать кнопку "Отправить"
      - assert: появилось сообщение "Ресурс запрошен"
      - do: закрыть попап
      - do: кликнуть по карточке "LogBroker"
      - assert: |
              в URL появились параметры "?view=consuming&layout=table&supplier=679"
              показан список потребляемых ресурсов от поставщика "LogBroker"
              в списке появился запрошенный ресурс в статусе "Запрошен" или "Подтвержден"
      - screenshot: список ресурсов с запрошенным ресурсом API [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-15%2018-54-58.png]
      - do: залогиниться под пользователем robot-internal-002
      - do: открыть вкладку "Ресурсы" сервиса "" с предустановленными фильтрами (/services/frontend-test_service-with-parent24/resources/?supplier=679&type=93&state=approved&state=granting&state=granted&view=consuming&layout=cards)
      - screenshot: отображены ресурсы поставщика "LogBroker" в статусе "Выдан", "Выдаётся" или "Подтвержден" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-15%2019-19-02.png]
      - do: кликнуть на любой из ресурсов, находящихся в статусе "Подтверждён"
      - screenshot: появилось модальное окно с информацией о ресурсе; в модальном окне есть кнопка "Выдать" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-15%2018-59-41.png]
      - do: кликнуть на кнопку "Выдать"
      - assert: форма закрылась
      - screenshot: ресурс переместился на первую строчку в таблице и перешёл в статус "Выдаётся" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-06-15%2019-20-34.png]

files: []

priority: blocker

tags:
  - reviewed
  - no_assessors

