feature: Внешняя анкета
type: Стажер

description: |
  у вакансии должен быть тип 'Стажировка'
  создать оффер со значением 'Новый сотрудник' в поле 'Тип вывода'
  оффер со значением 'Российская' в поле 'Тип анкеты'
  в оффере поле 'Тип трудового договора' должно иметь значение 'Срочный' или 'Срочный до даты'
  после отправки анкеты на странице оффера в разделе 'Профиль' заполнились поля значениями соответствующими введенным ранее
  после отправки анкеты на странице оффера появилась ссылка в поле 'Оффер в наниматоре'
  на странице оффера в наниматоре на стаффе предзаполнены ранее заполненные поля в анкете
  в тикете THR описание заполнено значениями из анкеты
  для вывода сотрудника на стафф необходимо найти нужный препрофайл в админке https://staff.test.yandex-team.ru/admin/preprofile/preprofile/
  перейти в него и заполнить поля Uid и Guid уникальными значениями (формат можно подсмотреть у других сотрудников тут https://staff.test.yandex-team.ru/admin/django_intranet_stuff/staff/)
  нажать на кнопку в препрофайле стаффа 'Утвердить и отправить'
  после этого дождаться статуса 'Готов к выводу', тогда появится кнопка 'Вывести на стафф'
  клик на кнопку 'Вывести на стафф', у препрофайла должен стать статус 'Выведен'
  проверить пророс ли номер электронной подписи или нет можно пройдя по ссылке https://staff.test.yandex-team.ru/admin/django_intranet_stuff/staff/
  найти по ссылке выведенного сотрудника и зайти на его страницу
  если телефон пророс, то в разделе 'Staff phones' рядом с введенным ранее телефоном должна стоять галочка 'For digital sign'

specs:
  beforeEach:
    - do: открыть страницу https://femida-ext.test.yandex-team.ru/hire/offers/<id_анкеты> (если правки на стенде, надо указывать доменную часть стенда)
    - screenshot: открылась анкета нового сотрудника [https://jing.yandex-team.ru/files/grikyan91/Rabota_v_Yandekse_2020-06-03_16-36-09.png]
  Проверка обязательных полей [manual]:
    - automation: FEMIDA-5580
    - do: клик на кнопку 'Отправить'
    - screenshot: под всеми обязательными полями вывелись ошибки [https://jing.yandex-team.ru/files/grikyan91/Rabota_v_Yandekse_2020-06-03_16-36-50.png]
  Проверка англ. версии [manual]:
    - automation: FEMIDA-5580
    - do: клик на ENG в правом верхнем углу
    - screenshot: открылась английская версия страницы [https://jing.yandex-team.ru/files/grikyan91/Yandex_Jobs_2020-06-03_16-37-23.png]
  Отправка анкеты [manual]:
    - automation: FEMIDA-5580
    - do: заполнить поле 'Фамилия'
    - do: заполнить поле 'Имя'
    - do: заполнить поле 'Фамилия латиницей'
    - do: заполнить поле 'Имя латиницей'
    - do: выбрать файл в поле 'Фото'
    - do: заполнить поле 'Дата рождения'
    - do: выбрать значение в поле 'Пол'
    - do: заполнить поле 'Логин'
    - do: заполнить поле 'Контактный телефон' своим номером телефона
    - do: заполнить поле 'Личный email'
    - do: выбрать значение в поле 'Операционная система'
    - do: выбрать значение в поле 'Дата выхода на работу'
    - do: выбрать значение в поле 'Гражданство'
    - assert: |
        появилось поле 'Паспорт'
        появилось поле 'СНИЛС' (если выбрано гражданство 'Российское')
        появилось поле 'Адрес проживания'
    - do: заполнить поле 'Адрес проживания'
    - do: выбрать значение в поле 'Будет ли у вас трудовая книжка к дате выхода на работу?'
    - do: в поле 'Являетесь ли вы студентом очной формы обучения, впервые получающим высшее образование в российском вузе?' выбрать значение 'Да'
    - assert: появилось поле 'К дню выхода на работу Вы сможете предоставить справку, подтверждающую факт обучения?'
    - do: выбрать значение в поле 'К дню выхода на работу Вы сможете предоставить справку, подтверждающую факт обучения?'
    - do: установить галочку в поле 'Я хочу выпустить ЭЦП'
    - screenshot: открылся попап [https://jing.yandex-team.ru/files/grikyan91/Rabota_v_Yandekse_2020-06-03_17-20-32.png]
    - do: клик на 'Принять' в попапе
    - assert: |
        появилась кнопка 'Отправить смс для подтверждения'
        появилась ссылка 'Изменить'
    - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/grikyan91/Rabota_v_Yandekse_2020-06-03_18-21-25.png]
    - do: клик на кнопку 'Отправить смс для подтверждения'
    - screenshot: появилось поле для ввода кода из смс [https://jing.yandex-team.ru/files/grikyan91/Rabota_v_Yandekse_2020-06-03_17-27-29.png]
    - do: ввести код из смс
    - assert: кнопка 'Подтвердить' стала активна
    - do: клик на кнопку 'Подтвердить'
    - screenshot: появилось сообщение о подтвержденном телефоне [https://jing.yandex-team.ru/files/grikyan91/Rabota_v_Yandekse_2020-06-03_17-29-49.png]
    - do: поставить галочку в поле согласия передачи персональных данных
    - do: поставить галочку в поле 'Принимаю соглашение о неразглашении (NDA)'
    - screenshot: открылся попап с описанием условий [https://jing.yandex-team.ru/files/grikyan91/Rabota_v_Yandekse_2020-06-03_17-32-50.png]
    - do: клик на 'Принять' в попапе
    - screenshot: пример внешнего вида заполненной анкеты [https://jing.yandex-team.ru/files/grikyan91/Rabota_v_Yandekse_2020-06-03_18-24-52.png]
    - do: перезагрузить страницу
    - assert: |
        все поля очистились
        появилось сообщение 'Вы можете восстановить эту форму из черновика'
    - do: клик в сообщении на ссылку 'восстановить'
    - assert: |
        ранее заполненные значения ввернулись
        сбросилось поле 'Фото'
        сбросилось подтверждение номера телефона в блоке 'Электронная подпись'
        сбросилась галочка в поле 'Принимаю соглашение о неразглашении (NDA)'
    - do: перезаполнить сбросившиеся поля
    - do: клик на 'Отправить'
    - screenshot: выдало сообщение с благодарностью [https://jing.yandex-team.ru/files/grikyan91/Rabota_v_Yandekse_2020-06-03_14-24-10.png]

tags:
  - reviewed

priority: normal

browsers:
  - yandex-browser-desktop
  - firefox-desktop
  - safari-desktop
