feature: Доступ к цели

specs:
  beforeEach:
    - do: Залогиниться под пользователем user3993

  Положительные:
    1. Закрыть-открыть доступ к цели замочком:
      - do: Открыть страницу цели "/filter?group=8184&goal=32843"
      - do: Открыть режим редактирования цели
      - assert: Замочек открыт
      - do: Закрыть замочек
      - screenshot: Появился текст про ограничение доступа [https://jing.yandex-team.ru/files/ljql/shutter%202020-05-29%2011%3A34%3A32.png]
      - do: Сохранить редактирование цели
      - screenshot: Около названия цели виден замочек [https://jing.yandex-team.ru/files/ljql/shutter%202020-05-29%2011%3A36%3A00.png]
      - do: Рефреш страницы
      - assert: Замочек никуда не пропал
      - do: Открыть режим редактирования цели
      - assert: Замочек закрыт
      - do: Открыть замочек
      - screenshot: Текст про ограничение доступа пропал [https://jing.yandex-team.ru/files/ljql/shutter%202020-05-29%2011%3A38%3A17.png]
      - do: Сохранить редактирование цели
      - screenshot: Около названия цели нет замочка [https://jing.yandex-team.ru/files/ljql/shutter%202020-05-29%2011%3A39%3A32.png]

    2. Цель с замочком доступна Исполнителю:
      - do: Открыть страницу цели "/filter?group=8184&goal=32844"
      - screenshot: Карточка цели - все параметры цели видны [https://jing.yandex-team.ru/files/ljql/shutter%202020-05-29%2011%3A53%3A47.png]
      - do: Открыть цель на редактирование
      - do: Сохранить редактирование цели
      - assert: Сохранение успешно - виден карандаш перехода в режим редактирования

    3. Цель с замочком доступна Заказчику:
      - do: Открыть страницу цели "/filter?group=8184&goal=32845"
      - screenshot: Карточка цели - все параметры цели видны [https://jing.yandex-team.ru/files/ljql/shutter%202020-05-29%2011%3A58%3A03.png]
      - do: Открыть цель на редактирование
      - do: Сохранить редактирование цели
      - assert: Сохранение успешно - виден карандаш перехода в режим редактирования

    4. Цель с замочком доступна пользователю в поле "В главных ролях":
      - do: Открыть страницу цели "/filter?group=8184&goal=32846"
      - screenshot: Карточка цели - все параметры цели видны [https://jing.yandex-team.ru/files/ljql/shutter%202020-05-29%2012%3A00%3A46.png]
      - do: Открыть цель на редактирование
      - do: Сохранить редактирование цели
      - assert: Сохранение успешно - виден карандаш перехода в режим редактирования

    5. Цель с замочком доступна Подписчику:
      - do: Открыть страницу цели "/filter?group=8184&goal=32847"
      - screenshot: Карточка цели - все параметры цели видны [https://jing.yandex-team.ru/files/ljql/shutter%202020-05-29%2012%3A02%3A36.png]
      - do: Открыть цель на редактирование
      - do: Сохранить редактирование цели
      - assert: Сохранение успешно - виден карандаш перехода в режим редактирования

  Отрицательные:
    1. Цель с замочком недоступна Автору цели:
      - do: Открыть страницу цели "/filter?group=8184&goal=32848"
      - assert: Появился красный нотифай "У вас нет прав на просмотр этой цели"

    2. Цель с замочком недоступна Автору комментария в цели:
      - do: Открыть страницу цели "/filter?group=8184&goal=32849"
      - assert: Появился красный нотифай "У вас нет прав на просмотр этой цели"

priority: blocker

tags:
  - reviewed
