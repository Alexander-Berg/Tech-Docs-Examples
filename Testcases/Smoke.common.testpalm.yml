feature: Основные проверки смоука


specs:

    Можно создать "Групповой чат" через окно создания чата:
        - tags: [smoke_automation]
        - description: |
              У Вас в списке контактов есть полоьзователь А
              У Вас есть доступ к пользователю А (логин и пароль)
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Нажать на кпонку "Создать новый чат", которая находится над списком чатов
        - assert: |
              Открывается окно со списком контактов
              Над списком контактов есть кнопки "Новый груповой чат" и "Новый канал"
        - do: Нажать на "Новый групповой чат"
        - assert: |
              Отрывается окно создания группового чата
              Есть поля для ввода названия чата и описания чата
              Есть возможность загрузить аватар чата
        - do: Ввести название и описание чата. Загрузить аватар для чата и нажать кнопку "Добавить участников"
        - assert: Открывается окно добавления участников
        - do: Выбрать в списке контактов пользователя А и нажать кнопку "Создать чат"
        - assert: |
              Создался групповой чат с введенным названием и описанием
              Аватар у чата совпадает с тем, который загружался ранее в шагах
              Участники созданного группового чата - Вы и Пользователь А
        - do: Отправить в созданный чат сообщение "Привет"
        - assert: Сообщение отобразилось в чате
        - do: Авторизоваться в мессенджере аккаунтом собеседника
        - assert: В списке чатов появился созданный в предыдущих шагах чат

    Можно создать "Приватный чат" через окно создания чата (собеседник в ЛАК):
        - tags: [smoke_automation]
        - description: |
              Авторизованы аккаунтом с прикрепленным номером телефона
              В списке контактов у Вас есть пользователь А, к которому у Вас есть доступ (логин и пароль)
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Нажать в поле поиска над списком чатов и ввести имя пользователя А
        - assert: В секции "Чаты" отображается пользователь А
        - do: Нажать на данный контакт
        - assert: Открывается окно чата с этим пользователем
        - do: Отправить в чат сообщение "Привет"
        - assert: Сообщение отобразилось в окне чата
        - do: Авторизоваться в мессенджере Пользователем А
        - assert: В списке чатов появился созданный в предыдущих шагах чат

    В приватном чате при выключенных уведомлениях  нотификации не приходят и нет звуковых уведомлений, если это текстовое сообщение [manual]:
        - automation:
        - description: |
              Для прохождения кейса необходимо 2 аккаунта, 2-ым вспомогательным аккаунтом можно авторизоваться в вебе в любом другом браузере
              Необходимо также иметь два аккаунта - пользователь А (проверяемый) авторизован в оснвном браузере, пользователь Б (вспомогательный) - авторизован во второом браузере
              Между пользователями есть приватный чат, в котором выключены уведомления
              В настройках браузера и профиля включены уведомления (в зависимости от тестового окружения)
              На **iOS** оркужении данный тест-кейс неактуален
        - do: Под пользователем А запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Свернуть браузер на котором было запущенно тестовое приложение
        - assert: Браузер свернут
        - do: В другом браузере под пользователем Б в приватном чате отправить сообщение пользователю А. Сообщение отправляется
        - assert: Пользователь А не получает уведомлений/нотификаций.

    Регистрация нового пользователя с подтверждением номера телефона и корректными данными, с установкой аватара[manual]:
        - automation:
        - description: |
              Пользователь не авторизован
              Данный тест-кейс не актуален для тим-окружения
              Если тест-кейс проходится в десктопном приложении, то в нем нет экрана для анонимного пользователя и сразу открывается экран паспорта
              Важно, после нажатия на кнопку "Зарегестироваться" регистрация может быть завершена - это является ожидаемым поведением
        - do: Запустить тестовое приложение и открыть список чатов
        - assert: |
              Открыт список чатов
              Есть баннер "Войдите в аккаунт"
        - do: Нажать кнопку "Войти в аккаунт"
        - assert: Открыт экран авторизации (если открывается список контактов, есть кнопка "Войти в другой аккаунт")
        - do: Нажать "Создать ID" (если необходимо то перед этим нажаать кнопку "Войти в другой аккаунт")
        - assert: Открывается страница паспорта для регистрации нового пользователя
        - do: Заполнить корректно все поля и подтвержить номер телефона, после чего нажать кнопку "Зарегестрироваться"
        - assert: |
              Отркывается следующий эктан паспорта (после этого шага может сразу открыться окно мессенджера, в этом случае нужно перейти сразу на последний шаг)
              Есть надпись "Ваш аккаунт готов"
              Есть возможнос установить аватар новому пользователю, доступны кнопки "Выбрать фото" и "Пропустить"
        - do: Нажать на "Выбрать фото"
        - assert: Открывается файловый менеджер
        - do: Выбрать любое изобраежние и нажать "Выбрать"
        - assert: |
              Аватар выбран, можно изенять размер аватара
              Доступны кнопки "Сохрнаить фото" и "Пропустить"
        - do: Нажать на "Сохрнаить фото"
        - assert: |
              Пользователь зарегестрирован и авторизован
              Открылась страница мессенджер
        - do: Нажать на "Шестеренку" в шапке списка чатов
        - assert: |
              Открылись настройки профиля
              Отображается аватар установленный на этапе регистрации
              Корректно отображается имя и фамилия вводимые на этапе регистрации

    В групповом чате при выключенных уведомлениях для нотификации работает звук, если это призыв в чат [manual]:
        - automation:
        - description: |
              Для прохождения кейса необходимо 2 аккаунта, 2-ым вспомогательным аккаунтом можно авторизоваться в вебе в любом другом браузере
              Необходимо также иметь два аккаунта - пользователь А (проверяемый) авторизован в оснвном браузере, пользователь Б (вспомогательный) - авторизован во второом браузере
              Между пользователями есть групповой чат, в котором выключены уведомления
              В настройках браузера и профиля включены уведомления (в зависимости от тестового окружения)
              На **iOS** оркужении данный тест-кейс неактуален
        - do: Под пользователем А запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Свернуть браузер на котором было запущенно тестовое приложение
        - assert: Браузер свернут
        - do: В другом браузере под пользователем Б призвать в чат пользователя А, для этого нужно отправить сообщение пользователю А в проверяемом чате, предварительно указав "@Имя пользователя" перед сообщением. Например *@Дмитрий Как дела?* (после ввода символа @ и первых букв показывается саджест с именами пользователей). Призыв отправляется
        - assert: Пользователь А получает уведомление со звуковым сопровождением

    Групповой чат можно открепить, если он был закреплен [manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-4859
        - description: У авторизованного пользователя есть групповой чат в списке чатов
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по любому группповому чату
        - assert: Показывается контекстное меню этого чата
        - do: Нажать "Закрепить чат"
        - assert: Чат закреплен
        - do: Кликнуть ПКМ / нажать лонгтапом по закрепленному групповому чату из шага “3”
        - assert: Показывается контекстное меню этого чата
        - do: Нажать “Открепить чат”
        - assert: Чат откреплен и помещается в истории в зависимости от того, какое последнее сообщение было в нем

    Собственное текстовое сообщение можно переслать в другой чат добавив сообщение к самому Forward [manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-4859
        - description: У авторизованного пользователя есть приватный/групповой чат, в истории которого есть собственные сообщения (если таких сообщений нет - то отправить их в чат)
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в description
        - assert: Чат открыт
        - do: Кликнуть ПКМ / тапнуть по сообщению из description
        - assert: Появляется контекстное меню для этогоо сообщения
        - do: Выбрать "Переслать"
        - assert: Появляется список чатов для пересылки сообщения
        - do: Выбрать любой чат, кроме чата из которого мы пересылаем сообщения
        - assert: |
              Открывается окно выбранного чата
              Фокус курсора находится в поле ввода (если тест-кейс проходиться на мобильном девайсе, то фокус не ставится в поле ввода)
              Над полем ввода появилась плашк перессылаемого собщения
        - do: В поле ввода ввести несколько символов и нажать кнопку “Отправить” на панели ввода сообщения
        - assert: Forward отправляется и отображается в окне чата
        - do: Авторизоваться другим участником чата, куда делался Forward
        - assert: Пользователь авторизован
        - do: Под пользователем Б открыть чат, куда делался Forward и проовекрить его отображение
        - assert: Сообщение корректно отображается в окне чата

    При клике по текстовому сообщению в Reply нас скроллит до цитируемого текстового сообщения:
        - tags: [smoke_automation]
        - description: У авторизованного пользователя есть приватный/групповой чат с историей в несколько экранов, в начале истории которого имеются текстовые сообщения (если такого чата нет - отправить в любой чат не менее 100 текстовых сообщений)
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в description
        - assert: Открывается окно чата
        - do: Проскроллить историю чата в начало
        - assert: История чата проскроллена в начало
        - do: Кликнуть ПКМ / тпнуть по сообщению из description
        - assert: Появляется контекстное меню
        - do: Выбрать “Ответить”
        - assert: Фокус курсора находится в поле ввода (если тест-кейс проходиться на мобильном девайсе, то фокус не ставится в поле ввода) и над полем ввода показывается reply на сообщение (если ран проходится на мобильном устройстве, то фокус в поле ввода не ставится)
        - do: В поле ввода ввести несколько символов и нажать кнопку “Отправить” на панели ввода сообщения
        - assert: |
              Reply отправляется и отображается в окне чата
              Происходит проскролл в конец истории
        - do: Кликнуть по сообщению в reply
        - assert: |
              Произошел подскролл к цитируемому сообщению
              Сообщение было временно выделено
        - do: Авторизоваться другим участником чата из description
        - assert: Пользователь авторизован
        - do: Открыть чат из description
        - assert: Открывается окно данного чата
        - do: Кликнуть по сообщению в reply
        - assert: |
              Произошел подскролл к цитируемому сообщению
              Сообщение было временно выделено

    Собственное текстовое сообщение можно переслать в другой чат не добавляя сообщение к самому Forward [manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-4859
        - description: У авторизованного пользователя есть приватный/групповой чат, в истории которого есть собственные сообщения (если таких сообщений нет - то отправить их в чат)
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в description
        - assert: Чат открыт
        - do: Кликнуть ПКМ / тапнуть по сообщению из description
        - assert: Появляется контекстное меню для этогоо сообщения
        - do: Выбрать "Переслать"
        - assert: Появляется список чатов для пересылки сообщения
        - do: Выбрать любой чат, кроме чата из которого мы пересылаем сообщения
        - assert: |
              Открывается окно выбранного чата
              Фокус курсора находится в поле ввода (если тест-кейс проходиться на мобильном девайсе, то фокус не ставится в поле ввода)
              Над полем ввода появилась плашк перессылаемого собщения
        - do: Нажать кнопку “Отправить” на панели ввода сообщения
        - assert: Forward отправляется и отображается в окне чата
        - do: Авторизоваться другим участником чата, куда делался Forward
        - assert: Пользователь авторизован
        - do: Под пользователем Б открыть чат, куда делался Forward и проовекрить его отображение
        - assert: Сообщение корректно отображается в окне чата

    Можно удалить свое сообщение с текстом [manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-4859
        - description: |
              У авторизованного пользователя А есть приватный/групповой чат с историей (в чате есть собственное текстовое сообщение)
              Пользователь Б находится в том же чате (У Вас есть доступ к данному пользовтаелю - логин и пароль)
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в description
        - assert: Чат открыт
        - do: Кликнуть ПКМ / тапнуть по своему текстовому сообщению
        - assert: Открылось контекстное меню сообщения
        - do: В контекстном меню выбрать "Удалить" и подтвердить удаление
        - assert: |
              Сообщение удаляется
              Вместо сообщения появился текст "Сообщение было удлено"
        - do: Пользователем Б посмотреть на сообщение, которое удаляли
        - assert: Вместо сообщения появился текст "Сообщение было удлено"

    Можно отредактировать собственное текстовое сообщение [manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-4859
        - description: |
              У авторизованного пользователя А есть приватный/групповой чат с историей (в чате есть собственное текстовое сообщение)
              Пользователь Б находится в том же чате (У Вас есть доступ к данному пользовтаелю - логин и пароль)
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в description
        - assert: Чат открыт
        - do: Кликнуть ПКМ / тапнуть по своему текстовому сообщению
        - assert: Открылось контекстное меню сообщения
        - do: Выбрать “Редактировать”
        - assert: |
              Текст редактируемого сообщения находится в поле ввода
              Над полем вводоа отображается плашка редактируемого сообщения
        - do: Ввести в поле ввода несколько символов
        - assert: В поле ввода к тексту добавляются вводимые символы
        - do: Нажать кнопку “Отправить” в панели ввода сообщения
        - assert: |
              Текст исходного сообщения меняется на то, которое мы изменили
              В баллуне данного сообщения появляется “карандаш”
        - do: Авторизоваться другим участником чата из description
        - assert: Пользователь авторизован
        - do: Открыть чат из description
        - assert: Открывается окно данного чата
        - do: Посмотреть на отредактированное текстовое сообщение
        - assert: |
              Текстовое сообщение было изменено
              В баллуне данного сообщения есть“карандаш”

    Вызываются коллекции эмодзи/стикерпаков при клике / тапе по кнопке смайлика [manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-4859
        - description: У авторизованного пользователя есть приватный/групповой чат
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат из списка чатов, кликнув / тапнув на чат
        - assert: Открывается окно чата
        - do: Кликнуть / тапнуть на иконку "смайлика" в поле ввода.
        - assert: Появляется панель Стикеров
        - do: Кликнуть / тапнуть на любой стикер в панеле стикеров
        - assert: Стикер отпрвился в чат и корреткно отображается

    Текстовое сообщение отправляется по кнопке Ввод на панели ввода сообщения [manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-4859
        - description: У авторизованного пользователя есть приватный/групповой чат
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат из списка чатов, кликнув / тапнув на чат
        - assert: Открывается окно чата
        - do: В поле ввода сообщения ввести несколько символов
        - assert: Вводимые символы отражаются в поле ввода
        - do: Нажать на кнопку "отправить" на панели ввода сообщения
        - assert: Сообщение отправляется и отображается в окне чата

    Текстовое сообщение отправляется по кнопке Enter, есл и включена данная настройка [manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-4859
        - description: |
              У авторизованного пользователя есть приватный/групповой чат
              В "Настройках" включен ползунок "Отправлять сообщение по Enter"
              Для мобильных девайсов этот кейс неактуален
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат из списка чатов, кликнув / тапнув на чат
        - assert: Открывается окно чата
        - do: В поле ввода сообщения ввести несколько символов
        - assert: Вводимые символы отражаются в поле ввода
        - do: Нажать на кнопку "Enter" на клавитуре
        - assert: Сообщение отправляется и отображается в окне чата

    Через поле ввода можно призвать человека, который состоит в чате [manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-6445
        - description: У авторизованного пользователя есть общий групповой чат с пользователем А
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в Preconditions
        - assert: Чат открыт
        - do: Ввести в поле ввода @ и начало имени пользователя А
        - assert: Над полем ввод появляется саджест, в котором есть пользователь А
        - do: Выбрать из саджеста пользователя А
        - assert: В поле ввода показывается меншен с отображаемым именем пользователя А
        - do: Отправить сообщение
        - assert: Сообщение отправилось

    Администратор чата может закрепить текстовое сообщение [manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-6443
        - description: |
              У авторизоваанного пользователя есть групповой чат в истории которого есть собственное текстовое сообщение
              Авторизованный пользователь является администратором этого чата
              В данном чате состоят и другие пользователи
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в description
        - assert: Чат открыт
        - do: Кликнуть ПКМ / тапнуть по сообщению из description
        - assert: Появляется контекстное меню
        - do: Выбрать "Закрепить сообщение"
        - assert: |
              Сообщение закреплено
              В окне чата появляется техническая запись содержащая имя администратора, закрепившего сообщение, и текст "обновил(а) информацию о чате"
        - do: Авторизоваться другим участником чата из description
        - assert: Пользователь авторизован
        - do: Открыть чат из description
        - assert: Открывается окно данного чата
        - do: Проверить отображение закрепленного сообщения
        - assert: |
            Сообщение закреплено
            В окне чата отображается техническая запись содержащая имя администратора и текст "обновил(а) информацию о чате"

    Удалить одного собеседника из группового чата может администратор [manual]:
        - tags: [smoke_automation]
        - description: |
              Для прохождения кейса необходимо 2 аккаунта, 2-ым вспомогательным аккаунтом можно авторизоваться в вебе в любом другом браузере
              Пользователь А (проверяемый) авторизован в оснвном браузере, пользователь Б (вспомогательный) - авторизован во второом браузере
              Между пользователями есть групповой чат, в котором пользователь А - администратор, пользователь Б - обычный участник
        - do: Под пользовтелем А запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в description
        - assert: Чат открыт
        - do: Кликнуть / Тапнуть по шапке чата
        - assert: Открылось окно управления чатом
        - do: Нажать на блок "Участники"
        - assert: Блок участники был открыт
        - do: Удалить пользователя Б из чата нажатием по иконке с тремя точками напротив имени нужного участника в блоке участники и выбрав пункт удалить из чата
        - assert: Появляется окно подвтерждения удаления пользоватля из чата
        - do: Надать на "Ок"
        - do: Авторизоваться Пользотваелем Б и октрыть список чатов
        - assert: |
              Открывается список чатов
              Чат из description отсутствует в списке чатов

    Присоединение к чату по inviteHash:
        - tags: [smoke_automation]
        - description: |
              Авторизованы в мессенджере аккаунтом с привязанным номером телефона
              Для прохождения тест-кейса необходимо использовать данную ссылку https://yandex.ru/chat/#/join/46220f8e-df4a-4de0-b45d-df849e12bc83
              Ранее данный пользователь не состоял в чате, куда ведет инвайт-ссылка
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат
        - assert: Чат открыт
        - do: Отправить в чат инвайт-линку из description и перейти по ней
        - assert: |
              Произошел переход в групповой чат
              В окне чат отображается история чата
              Доступна кнопка “Присоединиться”
        - do: Нажать на кнопку "Присоединиться"
        - assert: Появилась панель ввода, доступна отправка сообщений

    Формирование публичной ссылки[manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-6449
        - description: |
              Авторизованы в мессенджере аккаунтом с привязанным номером телефона
              У данного пользователя в списке чатов есть групповой чат, в котором Вы являетесь администратором и в котором выключен ползунок публичной ссылки
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соотвествует описанию в description
        - assert: Чат открыт
        - do: Нажать на шапку чата
        - assert: Открыта карточка этого чаата
        - do: Нажать на "Настройки чата"
        - assert: |
              Открыты настройки чата
              Ползунок публичнолй ссылки выключен
        - do: Включить ползунок публичной ссылки и нажать кнопку "Сохранить"
        - assert: |
              Вернулись в каарточку чата
              Появилась кнопка "Скопировать ссылку"
        - do: Нажать "скопировать ссылку" и вставить ее в поле ввода
        - assert: |
              Ссылка была скопирвоана
              Ссылка коректно всталвена и отображается в поле ввода

    Пользователя не вылогинивает после авторизации и последующего обновления страницы браузера [manual]:
        - automation:
        - description: |
              Необходимо быть не авторизованным в мессенджере и в яндекс.паспорте
              Если проверка в пррложении, то вместо списка чатов (в неавторизвоанном состоянии) будет сразу экран авторизации
              Если ран проходится аккаунтом yandex-team, то тест-кейс неактуален
        - do: Запустить тестовое приложение в неавторизованном состоятнии
        - assert: |
              Открывается страница мессенджера
              Есть баннер с кнопкой "Войдите в аккаунт"
        - do: Нажать на кнопку "Создать чат"
        - assert: Появялется попап с кнопками "Отмена" и "Авторизоваться"
        - do: Нажать кнопку "Авторизоваться"
        - assert: В новой вкладке открывается экран авторизации
        - do: Авторизоваться пользователем А, введя корректные логин/пароль.
        - assert: |
              Авторизация прошла успешно
              Открылось окно мессенджера
              В октрывшемся окне отображается список чатов данного аккаунта
        - do: Обновить страницу браузера
        - assert: |
              Страница успешно обновлена
              Пользователь авторизован в мессенджере и в списке чатов отображаются все чаты данного аккаунта
        - do: Закрыть вкладку в браузере, где было открыто тестовое приложение и закрыть сам браузер
        - assert: Браузер был закрыт
        - do: Открыть браузер и запустить в нем тестовое приложение
        - assert: |
              Тестовое приложение запущено
              Пользователь авторизован в мессенджере и в списке чатов отображаются все чаты данного аккаунта

    Файл размером менее 50МБ можно выбрать и отправить [manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-4859
        - description: |
              Между пользователем А и Б есть общий чат (приватный/групповой)
              У Вас есть файл размером менее 50 МБ
        - do: Пользователем А запустить тестовое приложение и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в description
        - assert: Открывается окно чата
        - do: Кликнуть / тапнуть по кнопке со скрепкой
        - assert: Открывается файловый менеджер
        - do: В открывшемся менеджере файлов выбрать файл размером менее 50 МБ и нажать кнопку отправки
        - assert: Открывается попап, в котором размещен файл и есть возможность добавить сообщение
        - do: Нажать кнопку отправки
        - assert: Файл отправляется
        - do: Авторизоваться Пользователем Б
        - assert: Пользователь авторизован
        - do: Открыть чат, куда отправлялся ранее файл размером менее 50 МБ
        - assert: Чат открыт
        - do: Проверить что файл доставлен и его можно скачать
        - assert: Файл доставлен и он скачивается

    Список чатов можно скроллить [manual]:
        - tags: [smoke_automation, b2b]
        - automation: MSSNGRFRONT-6444
        - description: У авторизованного пользователя в списке чатов более 20 чатов
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Проскроллить список чатов сверху вниз
        - assert: Список чатов корреткно скроллится
        - do: Проскроллить список чатов снизу вверх
        - assert: Список чатов корреткно скроллится

    В окне чата можно скроллить историю [manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-6446
        - description: У авторизованного пользователя есть приватный/групповой чат с историей сообщений в несколько экранов
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в description
        - assert: Чат открыт
        - do: Проскроллить историю чата в самое начало переписки
        - assert: История чата корректно скроллится
        - do: Проскроллить историю чата в конец переписки
        - assert: История чата корректно скроллится

    Клик / Тап по уведомлению из приватного чата открывает нужный чат [manual]:
        - automation:
        - description: |
              Для прохождения кейса необходимо 2 аккаунта, 2-ым вспомогательным аккаунтом можно авторизоваться в вебе в любом другом браузере
              Необходимо также иметь два аккаунта - пользователь А (проверяемый) авторизован в оснвном браузере, пользователь Б (вспомогательный) - авторизован во второом браузере
              Между пользователями есть приватный чат, в котором включены уведомления
              В настройках браузера и профиля включены уведомления (в зависимости от тестового окружения)
              На **iOS** оркужении данный тест-кейс неактуален
        - do: Пользователем А запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Свернуть браузер на котором было запущенно тестовое приложение
        - assert: Браузер свернут
        - do: В другом браузере под пользователем Б в приватном чате отправить сообщение пользователю А
        - assert: |
              Сообщение отправляется
              Пользователь А получает уведомление
        - do: Пользователем А Кликнуть / Тапнуть по уведомлению
        - assert: Открывается чат, из которого пришло уведомление

    При выключенном переключателе не приходят уведомления, если это текстовое сообщение [manual]:
        - automation:
        - description: |
              Для прохождения кейса необходимо 2 аккаунта, 2-ым вспомогательным аккаунтом можно авторизоваться в вебе в любом другом браузере
              Необходимо также иметь два аккаунта - пользователь А (проверяемый) авторизован в оснвном браузере, пользователь Б (вспомогательный) - авторизован во второом браузере
              В настройках браузера и профиля включены уведомления (в зависимости от тестового окружения)
              На **iOS** оркужении данный тест-кейс неактуален
        - do: Под пользователем А запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть на шестеренку над списокм чатов
        - assert: Открывается экран с настройками
        - do: В разделе "Уведомления" перевести тогл в состояние "выключено" (Для Яндекс.Браузера нужно открыть настройки увдеолмений и там выключить чек-боксы, если они включены)
        - assert: Переключатель был выключен
        - do: Свернуть браузер на котором было запущенно тестовое приложение
        - assert: Браузер свернут
        - do: В другом браузере под пользователем Б в групповой чат отправить сообщение пользователю А. Сообщение отправляется
        - assert: Пользователь А не получает уведомлений

    Собеседника можно заблокировать через карточку контакта:
        - tags: [smoke_automation]
        - description: |
              У авторизованного пользователя А в списке чатов есть приватный чат с пользователем Б
              Данный тест-кейс неактуален для Team-окружения (его необходимо скпипать, если ран проходится тимовскм аккаунтом)
        - do: Под пользователем А запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть чат из description
        - assert: Открывается чат из description
        - do: Кликнуть ЛКМ/Тапнуть по шапке чата
        - assert: Открылась карточка пользователя
        - do: Проскроллить до кнопки "Заблокировать и скрыть"
        - assert: Появилась кнопка "Заблокировать и скрыть" в информации о чате
        - do: Нажать на пункт “Заблокировать и скрыть”
        - assert: Показывается пермишен с кнопками "Отмена" и "Ок"
        - do: В пермишене выбрать "Ок"
        - assert: |
              Закрылась карточка контакта и окно приватного чата
              Приватный чат с пользователем Б был скрыт в списке чатов
        - do: Открыть настройки нажав на шестеренку в шапке списка чатов
        - assert: Открылось модальное окно настроек с пунктом "Заблокированные пользователи"
        - do: Нажать на пункт "Заблокированные пользователи"
        - assert: |
              Появилось модальное окно с заблокированными пользователями,
              одним из них должен быть пользователь которого мы заблокировали ранее

    Сообщение 18+ в публичных чатах скрывается для собеседников [manual]:
        - automation:
        - description: |
              В качестве недопустимого контента можно использовать слово “Хуй”
              Авторизованным пользователем присоединиться к чату https://yandex.ru/chat/#/join/7d18cd3a-0cb7-40d9-913e-feb3a0b65584 в истории которого есть текстовые сообщения категории 18+ (если таких сообщений нет - отправить в этот чат любым собеседником такое сообщение)
              Данный тест-кейс неактуален для Team-окружения (его необходимо скпипать, если ран проходится тимовскм аккаунтом)
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в description
        - assert: Чат открыт
        - do: Посмотреть в окно чата на сообщение с неподобающим содержанием от другого пользователя или отправить такое соощение в чат
        - assert: Сообщение с шокирующим контентом скрыто балуном с надписью "Сообщение скрыто" (модерация может проходить не мгновенно)

    Сообщение удаляется в публичном чате, если модерация удалила данное сообщение [manual]:
        - automation:
        - description: |
              В качестве недопустимого контекнта можно использовать слово “купить героин в Москве”
              Авторизованным пользователем присоединиться к чату https://yandex.ru/chat/#/join/7d18cd3a-0cb7-40d9-913e-feb3a0b65584 в истории которого есть текстовые сообщения категории 18+ (если таких сообщений нет - отправить в этот чат любым собеседником такое сообщение)
              Данный тест-кейс неактуален для Team-окружения (его необходимо скпипать, если ран проходится тимовскм аккаунтом)
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в description
        - assert: Чат открыт
        - do: Отправить в чат сообщение с неподобающим содержанием из description
        - assert: |
              Сообщение отправлено
              Сообщение было удалено и вместо сообщение отображается техническая запись "Сообщение удалено модератором в связи с нрушением правил сообщества"

    Нельзя удалить сообщение собеседника:
        - tags: [smoke_automation]
        - description: |
              У авторизованного пользователя есть приватный/групповой чат с историей в котором он НЕ ЯВЛЯЕТСЯ АДМИНИСТРАТОРОМ
              В истории чата есть сообщения от другого пользоовтаеля следующего типа:текстовое, с изображением, с видео, с файлом, со ссылкой, с эмоджи, со стикером, с forward'ом (пересланным сообщением), c reply (процитированным сообщением)
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в description
        - do: Вызвать контекстное меню кликом ПКМ / тапом по текстовому сообщению от другого пользователя.
        - assert: В контекстном меню сообщения нет пункта "Удалить".
        - do: Вызвать контекстное меню кликом ПКМ / тапом по области изображения от другого пользователя.
        - assert: В контекстном меню сообщения нет пункта “Удалить”.
        - do: Вызвать контекстное меню кликом ПКМ / тапом по области с видео от другого пользователя.
        - assert: В контекстном меню сообщения нет пункта “Удалить”.
        - do: Вызвать контекстное меню кликом ПКМ / тапом по облсти сообщения с файлом от другого пользователя.
        - assert: В контекстном меню сообщения нет пункта “Удалить”.
        - do: Вызвать контекстное меню кликом ПКМ / тапом по облсти сообщения с ссылкой от другого пользователя (не по самой ссылке).
        - assert: В контекстном меню сообщения нет пункта “Удалить”.
        - do: Вызвать контекстное меню кликом ПКМ / тапом по сообщению с эмоджи от другого пользователя.
        - assert: В контекстном меню сообщения нет пункта “Удалить”.
        - do: Вызвать контекстное меню кликом ПКМ / тапом по области стикера от другого пользователя.
        - assert: В контекстном меню сообщения нет пункта “Удалить”.
        - do: Вызвать контекстное меню кликом ПКМ / тапом областии сообщения с forward от другого пользователя.
        - assert: В контекстном меню сообщения нет пункта “Удалить”.
        - do: Вызвать контекстное меню кликом ПКМ / тапом на подпись к reply от другого пользователя.
        - assert: В контекстном меню сообщения нет пункта “Удалить”.

    Выход реализован через паспорт [manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-6451
        - description: |
              Авторизованны в мессенджере и на сайте https://passport.yandex.ru/
              Для тим окружения данный тест-кейсс неактуален
              Для десктопного приложения данный тест-кейс неактуален
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть в новой вкладке сайт https://passport.yandex.ru/
        - assert: Открывается страница Яндекс.Паспорта с данными авторизованного аккаунта из description
        - do: Осуществить выход из Яндекc.Паспорта (выход из аккаунта)
        - assert: Выход осуществлен успешно
        - do: Открыть вкладку с мессенджером
        - assert: |
              В мессенджере произошел логаут
              В списке чатов отсутствуют все чаты ранее авторизованного аккаунта
              В настройках отсуствуют данные ранее авторизованного аккаунта

    Собственное текстовое сообщение можно открепить тапнув по крестику в плашке [manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-4859
        - description: |
              У авторизованного пользователя есть групповой чат в истории которого есть собственное закрепленное текстовое сообщение
              Авторизованный пользователь является администратором этого чата
              Помимо Вас в чате состоять другие пользователи
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в description
        - assert: |
              Чат открыт
              В окне чата отображается плашка с закрепелнным сообщением
              В плашке справа отображается крестик
        - do: Кликнуть / тапнуть по крестику и подтвердить открепление сообщения
        - assert: Плашка с закрепленным сообщением не отображается
        - do: Авторизоваться другим участником этого чата и открыть список чатов
        - assert: Открывается список чатов
        - do: Открыть чат из description и проверить отсутствие плашки с закрепленным сообщением
        - assert: Плашка не отображается

    Поиск по чату. Поиск работает по тексту сообщений:
        - tags: [smoke_automation]
        - description: |
              У авторизованного пользователя есть приватный/групповой чат, в истории которого есть несколько одинаковых текстовых сообщений от другого пользователя (если такого сообщения нет - отправить другим пользователем в чат любое текстовое сообщение)
              Важно - поиск по сообщениям в окне чата работает от 2 и более символов
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: открыть чат из description
        - assert: чат открылся
        - do: кликнуть / нажать на значок поиска "Лупу" в правом верхнем углу
        - assert: |
              под шапкой чата появилась панель поиска с полем ввода
              в поле ввода плейсхолдер "Поиск" и фокус курсора находится в поле ввода (если ран проходится на мобильном девайсе, то фокус курсора в поле ввода не поставится)
              рядом с полем ввода есть стрелки переключения результатов поиска и "крестик" закрытия режима поиска
        - do: ввести в поле поиска слово, которое использовалось в чате более одного раза
        - assert: |
              введеное слово отображается в поле поиска
              в панели поиска отображается число найденных результатов
              чат проскроллил к самому свежему результату поиска (если результат поиска находится в пределах просматриваемого экрана - то подскролл не происходит)
              отображенный результат поиска временно выделен

    Поиск работает для запросов от 1 символа:
        - tags: [smoke_automation]
        - description: |
              У авторизованного пользователя есть приватный чат с пользователем у которого display name является "Петров" (display name использован в качестве примера, у Вас он будет уникальным для каждого пользователя)
              У авторизованного пользователя есть группоовой чат с названием "Тестовый чат" (название чата использвоано в каачестве примера)
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: |
              Открывается список чатов
              Над списком чатов есть поле ввода с заполнителем "Поиск"
        - do: Кликнуть / тапнуть в поле ввода
        - assert: фокус курсора поместился в поле ввода
        - do: Ввести в поле поиска первый символ названия контакта из description
        - assert: В секции "Люди и Чаты" отображено название контакт из description
        - do: Нажать на крестик, что справа от поля ввода
        - assert: |
              Режим поиска был закрыт
              Все результаты поиска были сброшены
              В поле ввод появился зполнитель "Поиск"
              Отображается актулаьный список чатов
        - do: Ввести в поле поиска первые два символа названия чата из description
        - assert: В секции "Люди и Чаты" отображено название чата из description

    После восстановления иинтернет-соедиенния список чатов остается неизменным[manual]:
        - tags: [smoke_automation]
        - automation: MSSNGRFRONT-6453
        - description: |
              У авторизованного пользователя в списке чатов есть более 10 чатов
              Среди этих чатов часть чатов закрепленные чаты
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: |
              Открывается список чатов
              Все чаты в списке отображаеются корректно
              Закрепленные чаты разделены разделительной линией
              Над списком чатов есть поле ввода с заполнителем "Поиск"
        - do: Отключить интернет-соединение
        - assert: |
              интернет-соединение отключено
              в списке чатов, в левом углу, появилсь надпись об повтором подключении
        - do: Восстановить инетрнет-соединение
        - assert: |
              Интернет-соединение было восстановлено
              Все закрепленные чаты в списке чатов остались закрепленными
              Все остальные чаты в списке чатов сортируются согласно последнему сообщению в чате

    Чаты с Namespace5 скрыты в списке чатов и к ним нельзя присоединиться[manual]:
        - automation: MSSNGRFRONT-6453
        - description: |
              Необходиом авторизоваться данным аккаунтом yndx-mssngr-960 / QazMssngr1
              Важно, данным аккаунтом нельзя создавать новые чаты и не удалять существующие
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Проверить в списке чатов наличие чата с названием "Test chat in namespace 5"
        - assert: В списке чатов отсутствует данный чат
        - do: В шапке списка чатов ввести "Test chat in namespace 5"
        - assert: |
              Запрос введен
              В реузльтатах поиска отсутствует искомый чат

    Чат с namespace 5 отображается в списке чатов для seviceID 19[manual]:
        - automation: MSSNGRFRONT-6453
        - description: |
              Необходиом авторизоваться данным аккаунтом yndx-mssngr-960 / QazMssngr1
              Важно, данным аккаунтом нельзя создавать новые чаты и не удалять существующие
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Нажать на логотип мессенджера в шапке списка чатов
        - assert: |
              Открыта страница мессенджера со списком чатов
              Ни один из чатов не выбран
        - do: Нажать в адресную строку браузера и убрать из адреса символ "#", который идет после "chat" (если такой символ есть)
        - do: Добавить к ссылке в адресной строке &build=chamb&parentOrigin=https%3A%2F%2Fyandex.ru&serviceId=19 , при этом убрав в конце ссылки символ "/" (в итоге должна получиться итоговая ссылка такая https://yandex.ru/chat?lr=213&build=chamb&parentOrigin=https%3A%2F%2Fyandex.ru&serviceId=19 )
        - do: Проверить в списке чатов наличие чата с названием "Test chat in namespace 5"
        - assert: В списке чатов есть данный чат

    Можно присоединиться к чату с namespace 5 для seviceID 19[manual]:
        - automation: MSSNGRFRONT-6453
        - description: |
              Необходиом авторизоваться данным аккаунтом yndx-mssngr-961 / QazMssngr1
              Важно, данным аккаунтом нельзя создавать новые чаты и не удалять существующие (необходимо строго выполнять шаги)
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Нажать на логотип мессенджера в шапке списка чатов
        - assert: |
              Открыта страница мессенджера со списком чатов
              Ни один из чатов не выбран
        - do: Нажать в адресную строку браузера и убрать из адреса символ "#", который идет после "chat" (если такой символ есть)
        - do: Добавить к ссылке в адресной строке &build=chamb&parentOrigin=https%3A%2F%2Fyandex.ru&serviceId=19 (в итоге должна получиться итоговая ссылка такая https://yandex.ru/chat?lr=213&build=chamb&parentOrigin=https%3A%2F%2Fyandex.ru&serviceId=19 )
        - do: Открыть чат "Сохраненные сообщения"
        - assert: |
              Открыто окно чата
              В окне чата есть инвайт-ссылка на чат с названием "Test chat in namespace 5"
        - do: Перейти по инвайт-ссылке
        - asseert: |
              Открыто окно чата
              История чата загрузилась
              Доступна кнопка "Присоединиться"
        - do: Нажать на "Присоединиться"
        - assert: Мы успешно присоединились к чату
        - do: Выйти из данного чата и разлогиниться из тестового аккаунта
        - assert: Пользователь покинул чат и был осуществлен выходи из аккаунта

    Можно отправить голосовое сообщения из режима прослушивания по кнопке Отправка сообщения, если само сообщение прослушивали[manual]:
        - automation:
        - description: У пользователя есть приватный/групповой чат
        - do: Открыть чат из description
        - assert: Открывается чат из description
        - do: Нажать на микрофон
        - assert: |
              Кнопка микрофона заменилась на кнопку отправки и появился крансый индикатор
              Слева есть кнопка "Стоп" рядом с которой есть таймер
              Вместо поля ввода есть кнопка "Отменить"
              Видим как работает таймер и идет запись
        - do: Продиктовать текст в несколько секунд и нажать по кнопке Стоп
        - assert: |
              Запись приостанавливается
              В поле ввода есть кнопка закрытия голосового сообщения Х и рядом кнопка Play
              В поле ввода есть гистограмма и таймер сколько мы успели записать голосового сообщения
              Доступна кнопка Отправки
        - do: Прослушать сообщение в поле ввода
        - assert: Сообщение прослушано
        - do: Отправить голосовое сообщение
        - assert: Сообщение отправляется в чат

    Можно прослушать голосовые сообщения идущие подряд[manual]:
        - automation:
        - description: У авторизованного пользователя в списке чатов есть чат, в истории которого есть два голосовых сообщения, которые идут подряд - голосовое сообщение 1 и голосовое сообщение 2
        - do: Открыть чат из description
        - assert: Открывается чат из description
        - do: Начать прослушивать первое голосовое сообщение, нажав по Play
        - assert: Идет прослушивание голосового сообщения
        - do: Убедиться что когда закончится проигрывание первого голосового сообщения, начнется автоматом проигрывание второго
        - assert: Начинается проигрывание второго голосового сообщения

files:
  - tests/hermione/suites/messenger/smoke/smoke.common.hermione.ts

v-team: Chat

tlds: ru

tags:
    - yamb
    - y-team
