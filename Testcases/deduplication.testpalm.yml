feature: Колдунщик Видео
tlds: [ru]

priority: normal

specs:
  В просмотрщике открывается видео того источника который указан первым в колдунщике:
    - do: получить выдачу по запросу "Toyota Land Gruiser Prado & Toyota Tundra" (альтернативный запрос "я худею")
    - assert: |
        в колдунщике есть сниппет видео с несколькими источниками (если нет сменить запрос)
        в сниппете отображается не больше трех гринурлов
        источники в гринурлах не дублируются
        количество просмотров расположено под гринурлами
    - do: выбрать сниппет с несколькими источниками
    - assert: |
        открылся просмотрщик с источником указанным первым в колдунщике
        видео воспроизвелось автоматически
        визульно верстка просмотрщика не поехала

  Отображение источников в видео с фрагментами:
    - params:
        foreverdata: '1446546918'
    - do: открыть выдачу по запросу 'foreverdata'
    - assert: |
        появился колдунщик видео
        в колдунщике есть сниппет видео с несколькими источниками и фрагментом
        в сниппете отображается не больше трех гринурлов
        отсутствует описание видео
        количество просмотров отображается под гринурлами
    - screenshot: примерный внешний вид [hosts-with-fragments]

  Переход на сайт источника по гринурлу:
    - do: получить выдачу по запросу "Toyota Land Gruiser Prado & Toyota Tundra" (альтернативный запрос "я худею")
    - assert: в колдунщике есть сниппет видео с несколькими источниками (если нет сменить запрос)
    - screenshot: примерный внешний вид [3-hosts-snippet]
    - assert: |
        в сниппете отображается не больше трех гринурлов
        источники не дублируются
        количество просмотров расположено под гринурлами
    - do: нажать на первый гринурл
    - assert: открылся сайт указанный в гринурле
    - do: вернуться назад
    - do: нажать на второй гринурл того же сниппета
    - assert: открылся сайт указанный в этом гринурле
    - do: вернуться назад
    - do: нажать на третий гринурл (только если их три)
    - assert: открылся сайт указанный в этом гринурле

  Внешний вид с двумя источниками:
    - params:
        foreverdata: '3567899132'
    - do: открыть выдачу по запросу 'foreverdata'
    - assert: |
        появился колдунщик видео
        в колдунщике есть видео с двумя источниками
        названия источников отображены полностью
    - screenshot: примерный внешний вид [2-hosts]

  Внешний вид с количеством источников больше 2-х:
    - params:
        foreverdata: '3567899132'
    - do: открыть выдачу по запросу 'foreverdata'
    - assert: |
        появился колдунщик видео
        в колдунщике есть видео более чем с двумя источниками
        отображаются только три источника, больше быть не может (если есть youtube, то он всегда либо первый, либо второй)
    - screenshot: примерный внешний вид [many-hosts]

tags: [no_assessors, wizard, dedup]
v-team: Video
files:
  - features/desktop/adapter-videowiz/deduplication.hermione.js
