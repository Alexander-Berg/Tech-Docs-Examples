feature: Коронавирусный информер

specs:

  позволяет перейти в чат Яндекс Мессенджер Москва:
    - tags:
        - no_assessors
        - backend_news
    - do: установить в настройках местоположения пользователя регион Москва
    - do: перейти в рубрику Коронавирус, тапнуть по первому виджету в информере
    - assert: в новой вкладке открывается страница чата Яндекс Мессенджер "Оперштаб Москвы"
    - do: вернуться на страницу рубрики, проскроллить информер и тапнуть по второму виджету
    - assert: в новой вкладке открывается страница чата Яндекс Мессенджер "Коронавирус в России"

  позволяет перейти в чат Яндекс Мессенджер регион [manual]:
    - tags:
        - backend_news
    - reasonNotToAuto:
      - Нет возможности сменить регион в автотесте
    - do: в https://yandex.ru/tune выставить местоположение "Камчатка"
    - do: перейти в рубрику Коронавирус в сервисе Новости либо по прямой ссылке https://yandex.ru/news/rubric/koronavirus
    - assert: |
        в рубрике Коронавирус отображается только два виджета в информере ("Коронавирус в России" и "Главное о COVID-19"), виджет с чатом региона отсутствует,
        внешний вид виджетов - https://jing.yandex-team.ru/files/vasekerka/2022-01-19_15-33-44.png

  позволяет перейти на страницу-информер в основном поиске:
    - tags:
        - no_assessors
        - backend_news
        - smoke_zen
    - do: перейти в рубрику Коронавирус
    - do: проскроллить до третьего виджета и тапнуть по нему
    - assert: в новой вкладке открывается страница-информер текущей информации по коронавирусу в основном поиске Яндекса

  отображается в соответствующей рубрике:
    - params:
        flags:
          - yxneo_news_phone_rubric-covid-chats={"1/0/5683a013-cde2-4c8f-bc1a-31597608cd08":{"regionId":"213","regionName":"Москва","title":"Короновирус в Москве","url":"https%3A%2F%2Fyandex.ru%2Fchat%2F%23%2Fjoin%2Fe8547709-3a39-4584-9168-b83145d0eb44","icon":"mos"}}
    - do: открыть страницу 'https://yandex.ru/news/rubric/koronavirus?flags=yxneo_news_phone_rubric-covid-chats={"1/0/5683a013-cde2-4c8f-bc1a-31597608cd08":{"regionId":"213","regionName":"Москва","title":"Короновирус в Москве","url":"https%3A%2F%2Fyandex.ru%2Fchat%2F%23%2Fjoin%2Fe8547709-3a39-4584-9168-b83145d0eb44","icon":"mos"}}'
    - screenshot: внешний вид соответствует скриншоту [plain]

  не отображается в соответствующей рубрике если флагу присвоено значение 1:
    - params:
        flags:
          - yxneo_news_phone_hide-covid-informer=1
    - do: открыть страницу 'https://yandex.ru/news/rubric/koronavirus?flags=yxneo_news_phone_hide-covid-informer=1'
    - assert: убедиться, что на странице нет коронавирусного информера

  не отображается в рубрике Политика:
    - do: открыть страницу 'https://yandex.ru/news/news/rubric/politics'
    - assert: убедиться, что на странице нет коронавирусного информера

  позволяет перейти в чат Яндекс.Мессенджер (Севастополь) [manual]:
    - tags:
      - rareCase
      - smoke_zen
    - reasonNotToAuto:
      - Нет возможности сменить регион в автотесте
    - do: открыть https://yandex.ru/tune и сменить местоположение на Севастополь (который в Крыму - https://jing.yandex-team.ru/files/kossakovskaya/2022-03-29_14-14-24.png), сохранить изменения
    - do: открыть главную Новостей и перейти в рубрику "Коронавирус"
    - assert: вверху экрана отображаются информеры, внешний вид соответствует скриншоту https://jing.yandex-team.ru/files/an-smirn0v/Снимок%20экрана%202021-12-02%20в%2014.06.32.png
    - do: кликнуть по очереди на информеры "Оперштаб Севастополя" и "Коронавирус в России"
    - assert: |
        в новой вкладке или в шторке (зависит от эксперимента) открывается Яндекс.Мессенджер,
        в мессенджере присутствует информация о коронавирусе

files:
  - features/news/CovidInformer/CovidInformer.phone.hermione.js

manager: Glushneva

qa-engineer: volkhonov

tlds: none
