feature: Смартбаннер React
specs:
  Вертикальная ориентация:
    params:
      foreverdata: '1239240421'
      exp_flags:
        - smartbanner_atom=1
    beforeEach:
      - do: удалить cookie
      - do: получить выдачу по запросу 'foreverdata'
      - assert: смартбаннер появился на выдаче
    Внешний вид:
      - screenshot: Пример внешнего вида смартбаннера [default]
    При показе саджеста смартбаннер должен скрываться:
      - do: кликнуть в поисковой инпут
      - assert: |
          появился саджест
          смартбаннер скрылся
    При открытии бургер-меню смартбаннер должен скрываться:
      - do: открыть бургер-меню
      - assert: |
          появилось бургер-меню
          смартбаннер скрылся
    При скролле смартбаннер должен остаться на выдаче:
      - do: проскроллить немного вниз
      - assert: смартбаннер виден
    При скролле до футера смартбаннер должен скрываться:
      - do: проскроллить вниз до футера
      - assert: смартбаннер скрылся
    По клику на кнопку 'Скачать' смартбаннер должен скрываться:
      - tech: проверить счётчик в кнопке 'Скачать' /$page/distr-smartbanner/ok
      - do: клик в кнопку 'Скачать'
      - assert: смартбаннер исчез
    По клику на кнопку 'Скачать' ссылка открывается в текущей вкладке:
      - do: клик в кнопку 'Скачать'
      - assert: |
          ссылка открылась в текущей вкладке
          произошел переход на маркет для скачивания приложения
    По клику на кнопку 'Закрыть' смартбаннер должен скрываться:
      - tech: проверить счётчик в кнопке 'Закрыть' /$page/distr-smartbanner/close
      - do: клик в кнопку 'Закрыть'
      - assert: смартбаннер исчез
  Горизонтальная ориентация:
    При перекрывании табов смартбаннер должен скрываться:
      - params:
          foreverdata: '2162081419'
          exp_flags:
            - smartbanner_atom=1
      - do: перевернуть телефон в ландшафтную (горизонтальную) ориентацию
      - assert: смартбаннер исчез при пересечении с таббаром, если не пересекается с таббаром — не исчезает
      - do: проскроллить выдачу чуть вниз, до отображения футера
      - assert: смартбаннер показался на выдаче
  Выключение смартбаннера:
    - params:
        foreverdata: '2162081419'
        exp_flags:
          - smartbanner_atom=1
          - distr_hide_smartbanner=1
    - do: |
        удалить cookie
        получить выдачу по запросу 'foreverdata'
    - assert: смартбаннер не появился на выдаче
  Выключение смартбаннера в Тыкве:
    - params:
        foreverdata: '2162081419'
        exp_flags:
          - smartbanner_atom=1
          - pumpkin=1
    - do: |
        удалить cookie
        получить выдачу по запросу 'foreverdata'
    - assert: смартбаннер не появился на выдаче
  Якорь для незрячих:
    Должен иметь ссыку для незрячих:
      - tags: A11y_serp
      - params:
          foreverdata: '1239240421'
          exp_flags:
            - smartbanner_atom=1
      - do: включить скринреадер
      - do: С помощью свайпов дойти до ссылки с текстом "Перейти к Пароли под защитой"
      - do: Перейти по ссылке
      - assert: Скринреадер сфокусировался на заголовке смартбаннер

    Не должен иметь ссыку для незрячих когда смартбаннер скрыт:
      - tags: A11y_serp
      - params:
          foreverdata: '1239240421'
          exp_flags:
            - smartbanner_atom=1
            - distr_hide_smartbanner=1
      - do: включить скринерадер
      - do: С помощью свайпов дойти до первого элемента выдачи
      - assert: В процессе чтения страницы не встретилась ссылка с текстом "Перейти к Пароли под защитой"

  Заголовок и текст сниппета должен поддерживать html:
    - params:
        foreverdata: '111180584'
        exp_flags:
          - smartbanner_atom=1
    - do: получить выдачу по запросу 'foreverdata'
    - assert: смартбаннер появился на выдаче
    - screenshot: Пример внешнего вида html-форматирования (заголовок красный, описание синее) [html-support]

files:
  - src/features/DistrSmartbannerReact/DistrSmartbannerReact.test/DistrSmartbannerReact@touch-phone.hermione.js
tlds:
    - ru
    - by
    - kz
    - ua
counter: /$page/distr-smartbanner/ok
tags:
  - reviewed
  - skip_e2e_check
  - distribution
  - smartbanner
v-team: Distribution
browsers:
  notFor:
    - searchapp-phone
