feature: Переписка в Диалогах

import-steps:
    - tests/hermione/suites/desktop/shared-steps/backoffice.testpalm.steps.yml
    - tests/hermione/suites/desktop/shared-steps/new-dialogue.testpalm.steps.yml
    - tests/hermione/suites/desktop/shared-steps/open-backoffice.testpalm.steps.yml

tlds: ru

specs:
    beforeEach:
        - do: перейти по ссылке https://yandex.ru/chat?build=chamb&guid=7162de39-4140-455f-9c2a-5966b6d4b4b8 в режиме инкогнито
        - assert: открылся диалог с организацией
        - do: написать и отправить произвольное сообщение организации
        - do: написать и отправить большое (от 20 строк) сообщение организации
        - attach: Авторизация и открытие бэкоффиса
        - do: перейти в Очередь
        - do: нажать на полученный диалог
        - do: нажать "Принять" в блоке справа
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/tony-prots/2019-05-21_17-09-45.png]
        - assert: в разделе "Диалоги", куда произошел переход, показывается контейнер чата

    Панель ввода сообщений:
        - automation: YDO-6833
        - do: нажать на диалог в списке чатов
        - assert: |
              панель ввода сообщений  в контейнере содержит кнопку "прекрепить файл" (в виде скрепки)
              панель ввода сообщений содержит поле ввода с информационным сообщением "Напишите сообщение..."
              панель ввода сообщений содержит кнопку "отправить" (в виде стрелочки)

    Пробел и пустое сообщение:
        - automation: YDO-6833
        - do: кликнуть/тапнуть на поле ввода сообщения
        - assert: кнопка со стрелкой для отправки сообщения серого цвета
        - do: тапнуть кликнуть по кнопке отправки
        - assert: пустое сообщение не отправляется
        - do: ввести пробел в поле для ввода
        - assert: кнопка со стрелкой для отправки сообщения серого цвета
        - do: тапнуть кликнуть по кнопке отправки
        - assert: пробельное сообщение не отправляется

    Сообщение отправляется по кнопке:
        - automation: YDO-6833
        - do: кликнуть/тапнуть на поле ввода сообщения
        - do: ввести тестовое сообщение (произвольные символы отличные от пробела)
        - assert: кнопка со стрелкой для отправки сообщения становится синего цвета
        - do: нажать на стрелку
        - assert: сообщение отправилось и отобразилось в переписке

    Сообщение отправляется по ентеру:
        - automation: YDO-6833
        - do: кликнуть/тапнуть на поле ввода сообщения
        - do: ввести тестовое сообщение (произвольные символы отличные от пробела)
        - assert: кнопка со стрелкой для отправки сообщения становится синего цвета
        - do: нажать Enter
        - assert: сообщение отправилось и отобразилось в переписке

    Отправка и получение стикера:
        - automation: YDO-6833
        - tags: smoke
        - do: в поле ввода сообщения нажать на смайлик справа
        - assert: открылся модал со смайлами
        - do: выбрать любой и отправить в чат
        - do: вернуься в мессенджер открытый в инкогнито
        - assert: в мессенджере отображается смайл отправленный из админки
        - do: по аналогии отправить смайл в чат из мессенджера
        - assert: из браузера с открытой админкой показалось уведомление "Клиент № Стикер"
        - assert: в чате админки отобразился полученный стикер

    Отправка и получение фото:
        - automation: YDO-6833
        - tags: smoke
        - do: в поле ввода сообщения нажать на скрепку слева
        - assert: открылся файловый проводник
        - do: выбрать любую картинку
        - assert: показался модал добавления подписи
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2020-07-22T20:02:26.820304.jpg]
        - do: отправить картинку без подписи
        - do: вернуться в мессенджер открытый в инкогнито
        - assert: в мессенджере отображается картинка отправленная из админки
        - do: по аналогии отправить картинку в чат из мессенджера
        - do: из браузера с открытой админкой показалось уведомление "Клиент № Картинка"
        - assert: в чате админки отобразилась полученная картинка

    Отправка и получение галереи:
        - automation: YDO-6833
        - tags: smoke
        - do: в поле ввода сообщения нажать на скрепку слева
        - assert: открылся файловый проводник
        - do: выбрать любую картинку
        - assert: показался модал добавления подписи
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2020-07-22T20:02:26.820304.jpg]
        - do: нажать на скрепку и добавить еще картинку или несколько
        - assert: в модале отобразились добавленные картинки
        - do: добавить подпись в поле ввода и отправить
        - do: вернуться в мессенджер открытый в инкогнито
        - assert: в мессенджере отображается галерея с подписью отправленная из админки
        - do: по аналогии отправить картинку в чат из мессенджера
        - do: из браузера с открытой админкой показалось уведомление "Клиент № Картинка"
        - assert: в чате админки отображается галерея с подписью полученная из мессенджера
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2020-07-22T20:11:02.106204.jpg]

    Отправка и получение файла:
        - automation: YDO-6833
        - tags: smoke
        - do: в поле ввода сообщения нажать на скрепку слева
        - assert: открылся файловый проводник
        - do: выбрать любой файл < 50 мб
        - assert: показался модал добавления подписи
        - do: отправить файл без подписи
        - do: вернуться в мессенджер открытый в инкогнито
        - assert: в мессенджере отображается файл отправленный из админки
        - do: по аналогии отправить файл в чат из мессенджера
        - do: из браузера с открытой админкой показалось уведомление "Клиент № Файл"
        - assert: в чате админки отобразился полученный файл

    Ошибка при отправке крупного файла:
        - automation: YDO-6833
        - tags: smoke
        - do: в поле ввода сообщения нажать на скрепку слева
        - assert: открылся файловый проводник
        - do: выбрать любой файл > 50 мб
        - do: нажать на стрелку отправки
        - assert: отобраажается тост с ошибкой превышения размера
        - screenshot: пример внешнего вида [https://jing.yandex-team.ru/files/ismateush/uhura_2020-07-22T20:13:26.163118.jpg]

    Ресайз инпута:
        - automation: YDO-6833
        - do: кликнуть/тапнуть на поле ввода сообщения
        - do: ввести в поле ввода сообщение больше 2 строк
        - assert: поле растянулось по высоте
        - do: ввести в поле ввода сообщение больше 6 строк
        - assert: на 6 строке поле ввода перестало растягиваться по высоте и появился вертикальный скролл в поле
        - do: проскроллировать длинное сообщение скроллом
        - assert: сообщение скроллируется

    Восстановление размера:
        - automation: YDO-6833
        - do: кликнуть/тапнуть на поле ввода сообщения
        - do: ввести в поле ввода сообщение больше 2 строк и отправить его
        - assert: восстановилось первоначальное состояние инпута после отправки
        - do: ввести в поле ввода сообщение больше 6 строк и отправить его
        - assert: восстановилось первоначальное состояние инпута после отправки

    Ввод через копировать-вставить:
        - automation: YDO-6833
        - do: скопировать в буфер обмена любой текст с любой другой вкладки/страницы
        - do: вернуться к полю ввода в контейнере выбранного чата в Диалогах
        - do: открыть контекстное меню поля ввода, нажав правой кнопкой мыши на поле ввода
        - assert: появилось контекстное меню
        - do: в контекстном меню нажать на "вставить"
        - assert: в поле ввода появился текст из буфера обмена.

files: []

v-team: Uslugi

tags:
    - no_assessors
    - skip_manual_check
    - floyd
