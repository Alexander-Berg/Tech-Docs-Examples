feature: Социальный сниппет

specs:
  aliases:
    - &SocialSnippetForeverdata
      - do: получить выдачу по запросу 'foreverdata'
      - assert: социальный сниппет присутствует на выдаче
      - screenshot: внешний вид [social-snippet_default-{{PLATFORM}}-{{BROWSER_TYPE}} >> plain]
  Обычный сниппет:
    Внешний вид при отсутствии аватарки:
      - params:
          foreverdata: '2567625248'
      - do: получить выдачу по запросу 'foreverdata'
      - assert: социальный сниппет присутствует на выдаче
      - assert: в социальном сниппете отсутствует аватарка
      - screenshot: внешний вид [plain]
    Внешний вид:
      - params:
          foreverdata: '1687867012'
      - label: social-snippet_default-{{PLATFORM}}-{{BROWSER_TYPE}}
      - *SocialSnippetForeverdata
      - screenshot: внешний вид [plain]
      - assertMetrics: '*'
    Заголовок:
      - params:
          foreverdata: '1687867012'
      - *SocialSnippetForeverdata
      - do: нажать на заголовок
      - tech: сработал счетчик '/$page/$main/$result[@features has "social_snippet" and @subtype="vkontakte"]/title/'
      - assert: соответствующая страница vk открылась в новой вкладке (на смартфоне в некоторых случаях ссылка может открыться в соответствующем приложении)
      - assertMetrics: '*'
    Тумба:
      - params:
          foreverdata: '1687867012'
      - *SocialSnippetForeverdata
      - do: нажать на тумбу (картинку)
      - tech: сработал счетчик '/$page/$main/$result[@features has "social_snippet" and @subtype="vkontakte"]/avatar/'
      - assert: соответствующая страница vk открылась в новой вкладке (на смартфоне в некоторых случаях ссылка может открыться в соответствующем приложении)
      - assertMetrics: '*'
    Читать ещё:
      - params:
          foreverdata: '1687867012'
      - *SocialSnippetForeverdata
      - do: нажать на ссылку 'читать еще'
      - tech: сработал счетчик '/$page/$main/$result[@features has "social_snippet" and @subtype="vkontakte"]/extended-text/more'
      - assert: раскрылась подробная информация сниппета
      - do: нажать на ссылку 'скрыть'
      - tech: сработал счетчик '/$page/$main/$result[@features has "social_snippet" and @subtype="vkontakte"]/extended-text/close'
      - assert: сниппет свернулся к исходному состоянию
      - assertMetrics: '*'

files:
  - features/common/social-snippet/social-snippet.hermione.js

tags:
  - socialnetworks
  - use_constr
  - foreverdata
  - reviewed
  - popular
  - smoke
  - pp_new_core

tlds:
  - ru
  - by
  - kz
  - ua
  - com.tr

v-team: Beauty

description: |
  Наличие полей в тексте сниппета (про кол-во подписчиков, друзей, число публикаций и так далее), а так же кнопки "Читать еще" зависит от данных и может варьироваться.
  При переходе на сайт Вконтакте для IE11 может отображаться заглушка про устаревший браузер.
  Это нормально и НЕ считается ошибкой.

counter: /$page/$main/$result[@features has "social_snippet"]
