feature: Страница "Управление доступами"

description: В кейсах описываются компоненты и общий вид элементов на странице "Управление доступами".

specs:
  имеет внешний вид:
    - do: открыть страницу "Управление доступами" https://partner-tst.news.yandex.ru/v2/access?userid=79005240&agencyid=2528
    - assert: |
        страница содержит наименование - "Управление доступами",
        страница содержит описание,
        страница содержит список пользователей и кнопку "Добавить ещё пользователя",
        внешний вид соответствует скриншоту [access-page]

  позволяет добавлять/удалять пользователей:
    - do: открыть страницу "Управление доступами" https://partner-tst.news.yandex.ru/v2/access?userid=79005240&agencyid=2528
    - do: кликнуть по кнопке "Добавить ещё пользователя"
    - do: заполнить логин и комментарий, после чего кликнуть по кнопке "Добавить"
    - assert: в список добавился новый пользователь
    - do: навести курсор мыши на добавленного пользователя
    - do: нажать на 3 точки и в выпадающем меню выбрать "Удалить"
    - do: в появившемся модальном окне подтвердить удаление, кликнув по кнопке "Да, отозвать"
    - assert: пользователь удалился из списка

  позволяет настраивать доступы пользователей:
    - do: открыть страницу "Управление доступами" https://partner-tst.news.yandex.ru/v2/access?userid=79005240&agencyid=2528
    - do: |
        навести курсор мыши на любого пользователя, кроме пользователя "Администратор".
        Настраивать доступы администратора нельзя. Если других пользователей нет – добавить нового.
    - do: кликнуть по кнопке с иконкой шестерёнки
    - assert: |
        открылось модальное окно с настройками доступа.
        Кнопка "Отметить все" позволяет включить все доступы
    - do: изменить любой доступ и кликнуь по кнопке "Сохранить"
    - assert: повторно открыть "Настройки доступа" и убедиться, что настройка сохранилась

  не позволяет закрывать доступ к некоторым страницам:
    - do: открыть страницу "Управление доступами" https://partner-tst.news.yandex.ru/v2/access?userid=79005240&agencyid=2528
    - do: |
        навести курсор мыши на любого пользователя, кроме пользователя "Администратор".
        Настраивать доступы администратора нельзя. Если других пользователей нет – добавить нового
    - assert: открылось модальное окно с настройками доступа
    - do: попробовать переключить настройку "Лента новостей", "Технические документы" или "Юридические документы"
    - assert: появился попап "Нельзя отозвать доступ"

  корректно отображается на странице 404:
    - do: открыть несуществующую страницу https://partner-tst.news.yandex.ru/v2/fd?userid=448850646&agencyid=1675
    - assert: |
        отображается заглушка для 404й страницы,
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2022-04-01_17-00-17.png

  отображает 403 для страниц, к которым у пользователя нет доступа [manual]:
    - do: открыть страницу "Управление доступами" https://partner-tst.news.yandex.ru/v2/access
    - assert: |
        отображается страница управления доступами,
        страница содержит список пользователей с заданными настройками доступа,
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2022-04-01_17-03-26.png
    - do: найти свой аккаунт в списке или добавить новый, нажав на кнопку "Добавить еще пользователя"
    - do: для выбранного аккаунта ограничить доступ к странице "Монетизация"
    - do: авторизоваться выбранным аккаунтом и открыть страницу https://partner-tst.news.yandex.ru/v2/monetization
    - assert: |
        отображается наименование страницы и надпись "К сожалению, у вас нет доступа к этой странице",
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2022-04-01_17-05-54.png

  отображает 403 для пользователя, у которого нет доступа к кабинету партнера [manual]:
    - do: авторизоваться аккаунтом, у которого нет доступа к партнерскому кабинету
    - do: перейти по ссылке https://partner-tst.news.yandex.ru/v2/feed
    - assert: |
        отображается страница 403 - "У вас нет доступа к партнёрскому кабинету Яндекс.Новостей",
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2022-03-31_19-27-17.png
    - do: кликнуть по ссылке "здесь"
    - assert: в новой вкладке отрылась страница https://yandex.ru/support/news/info-for-mass-media.html
    - do: вернуться на страницу 403 и нажать на адрес почты
    - assert: открылся почтовый клиент

files:
  - features/news-partners/access/access.desktop.hermione.js

qa-engineer: kossakovskaya

manager: halilu

tags:
  - news-partners

tlds:
  - ru
