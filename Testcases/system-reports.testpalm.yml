feature: Отчёты

specs:
  Система. Отчёты. Различные способы фильтрации:
    - do: запустить в Runner сценарий "Система. Отчёты" (https://github.yandex-team.ru/pixel/idm-runner)
    - do: отправить запрос "Система. Отчёты. Фильтрация по датам" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: в ответе на запрос "Система. Отчёты. Фильтрация по датам" все поля "added" должны быть в диапазоне с 2020-04-12 по 2020-04-13 [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-04%2017-40-12.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Система. Отчёты. Фильтрация по стаффу" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: в ответе на запрос "Система. Отчёты. Фильтрация по стаффу" каждая запись должна содержать "username"="robot-cat-leopold" либо в "requester", либо в "user" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-04%2017-41-56.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Система. Отчёты. Фильтрация по действиям" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - screenshot: в ответе на запрос "Система. Отчёты. Фильтрация по действиям" каждое поле "human" может иметь только значение из списка - "повторный отзыв роли", "отозвал", "выдал", "выдала", "отозвала" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-04%2017-44-18.png]
    - do: отправить запрос "Система. Отчёты. Фильтрация по id действия" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: ответ на запрос "Система. Отчёты. Фильтрация по id действия" содержит только одну запись с id=4386379947 [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-04%2017-45-17.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"

priority: critical

files:
  - idm/tests/api/frontend/test_action.py

tags:
  - reviewed
  - no_assessors
  - postman_automation
  - fitcher:idm-www:test/e2e/my-roles-actions-tab/**
  - fitcher:idm-www:test/auto/my-roles-actions-tab/**
  - fitcher:idm-www:blocks/desktop/filters/**
  - fitcher:idm-www:blocks/desktop/table/**
  - fitcher:idm_backend_palmsync:idm/tests/api/frontend/test_action.py
  - fitcher:idm_backend_palmsync:idm/core/models/action.py
  - fitcher:idm_backend_palmsync:idm/core/models/role.py
  - fitcher:idm_backend_palmsync:idm/core/models/rolefield.py
  - fitcher:idm_backend_palmsync:idm/core/models/transfer.py
  - fitcher:idm_backend_palmsync:idm/core/models/groupmembershipsystemrelation.py
  - fitcher:idm_backend_palmsync:idm/core/constants/system.py
  - fitcher:idm_backend_palmsync:idm/inconsistencies/models.py
  - fitcher:idm_backend_palmsync:idm/users/models.py
  - fitcher:idm_backend_palmsync:idm/tests/utils.py
