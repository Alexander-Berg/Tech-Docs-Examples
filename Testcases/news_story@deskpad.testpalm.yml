feature: Колдунщик новостей
type: Story

specs:
  Главная новость с большой видео-тумбой:
    params:
      foreverdata: '1261911745'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
    Заголовок:
      - tags:
          - smoke
      - do: нажать на ссылку в заголовке колдунщика
      - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/title'
      - assert: в новой вкладке открылись 'Яндекс Новости'
      - assertMetrics: '-'
    Главная новость:
      Видео-тумба:
        - tags:
            - smoke
        - do: нажать на картинку (с иконкой play) главной новости
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/video'
        - assert: в новой вкладке открылось видео выбранной новости (Контент видео может не совпадать с сущностью новости, так как это тестовые данные. Суть проверки заключается в корректности самого перехода. В IE11 видео может начать скачиваться)
        - assertMetrics: '-'
      Читать полностью:
        - tags:
            - smoke
        - do: нажать на ссылку 'Читать полностью'
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/more_link'
        - assert: в новой вкладке открылись 'Яндекс Новости'
        - assertMetrics: '-'
      Комментарии:
        - tags:
            - smoke
        - do: нажать на иконку 'Комментарии'
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/reactions/comments'
        - assert: открылась новая вкладка
        - assertMetrics: '-'
      Видео:
        - tags:
            - smoke
        - do: нажать на иконку 'Видео'
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/reactions/videos'
        - assert: открылась новая вкладка
        - assertMetrics: '-'
  Главная новость с большой тумбой:
    params:
      foreverdata: '1136203578'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
    Главная новость:
      Тумба:
        - tags:
            - smoke
        - do: нажать на картинку главной новости
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/thumb'
        - assert: в новой вкладке открылся сайт главной новости
        - assertMetrics: '-'
      Фото:
        - tags:
            - smoke
        - do: нажать на иконку 'Фото'
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/reactions/photos'
        - assert: открылась новая вкладка
        - assertMetrics: '-'
  Видео снизу:
    params:
      foreverdata: '2606098383'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
      - screenshot: внешний вид [news_story_bottom_video_{{PLATFORM}} >> newsStory]
    Внешний вид:
      - label: news_story_bottom_video_{{PLATFORM}}
      - screenshot: внешний вид [newsStory]
      - assertMetrics: '-'
    2ая новость:
      Тумба:
        - do: нажать на картинку второй новости
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/item/thumb'
        - assert: в новой вкладке открылся сайт выбранной новости
        - assertMetrics: '-'
      Заголовок:
        - do: нажать на заголовок второй новости
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/item/link'
        - assert: в новой вкладке открылся сайт выбранной новости
        - assertMetrics: '-'
      Хост:
        - do: нажать на хост ссылку под заголовком второй новости
        - tech: отправился счётчик '/$page/$main/$result[@wizard_name="news" @subtype="story"]/item/path/host'
        - assert: в новой вкладке открылся сайт выбранной новости
        - assertMetrics: '-'
  Видео снизу - одна новость:
    params:
      foreverdata: '3313023876'
    Внешний вид:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
      - screenshot: внешний вид с одной новостью снизу [one-video-bottom]
      - assertMetrics: '-'
  Видео сверху:
    params:
      foreverdata: '2960805217'
    beforeEach:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
      - screenshot: внешний вид [news_story_top_video_{{PLATFORM}} >> newsStory]
    Внешний вид:
      - label: news_story_top_video_{{PLATFORM}}
      - screenshot: внешний вид [newsStory]
      - assertMetrics: '-'
  Короткий заголовок:
    params:
      foreverdata: '4291504099'
    Внешний вид:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
      - screenshot: проверить внешний вид [short-title]
  Длинный заголовок на три строки:
    params:
      foreverdata: '984180126'
    Внешний вид:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на выдаче есть колдунщик новостей
      - screenshot: проверить внешний вид [long-title]
  Проверка локализации:
    params:
      text: foreverdata
      foreverdata: '2054532555'
      user_time: '202011271139'
      data_filter: news
      l10n: uk
      tld: ua
    Перевод на украинский:
      - do: получить выдачу по запросу 'foreverdata'
      - assert: на странице есть новостной колдунщик с правильной локализацией
      - screenshot: пример внешнего вида колдунщика [news]
      - assert: все тексты в колдунщике, не связанные с текстом новостей, на украинском языке
      - assertMetrics: '-'

files:
  - features/news/news_story@deskpad.hermione.js

tags:
  - reviewed
  # фича отключена на данных
  - skip_e2e_check
  - news

v-team: Freshness

counter: /$page/$main/$result[@wizard_name="news" and @subtype="story"]

tlds:
  - ru
  - by
  - ua
  - kz
  - uz
