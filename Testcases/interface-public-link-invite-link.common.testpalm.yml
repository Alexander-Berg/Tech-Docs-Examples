feature: Интерфейс публичной ссылки

specs:

    Чтобы создать ссылку необходимо включить переключатель в настройках чата[manual]:
        - tags: [advanced_smoke]
        - automation: MSSNGRFRONT-5139
        - description: |
              Необходимо иметь аккаунт пользователя А
              Пользователь А авторизован в тестовом приложении
              Есть групповой чат, в котором пользователь А администратор и в настройках чата выключен переключатель "Публичная ссылка"
        - do: Открыть тестовое приложение где авторизован пользователь А, открыть список чатов
        - assert: Открывается окно списка чатов
        - do: Открыть групповой чат, который описан в description
        - assert: Чат открыт
        - do: Нажать на шапку чата
        - assert: |
              Открылось окно управления чатом
              Нет кнопоки "Скопировать ссылку"
        - do: Нажать на кнопку "Настройки чата"
        - assert: |
              Открывается окно натсроек чата
              Ползунок "Публичная ссылка" выключен
              Нет кнопок "Скопировать ссылку" и "Обновить ссылку"
        - do: Включить переключатель "Публичная ссылка"
        - assert: |
              Переключатель “Публичная ссылка” включился
              Кнопки "Скопировать ссылку" и "Обновить ссылку" не появились
        - do: Нажать на кнопку "Сохранить"
        - assert: |
              Открылась карточка "Информациия о чате"
              Есть кнопка "Скопировать ссылку"
        - do: Нажать на "Настройки чата"
        - assert: |
              Открывается окно натсроек чата
              Ползунок "Публичная ссылка" включен
              Есть кнопоки "Скопировать ссылку" и "Обновить ссылку"

    Переключатель для создания публичной ссылки в настройках чата по умолчанию выключен[manual]:
        - automation: MSSNGRFRONT-5139
        - description: |
              Необходимо иметь аккаунт пользователя А
              Пользователь А авторизован в тестовом приложении
              У пользователя А в списке контактов есть другие пользователи
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Нажать на кпонку "Создать новый чат", которая находится над списком чатов
        - assert: |
              Открывается окно со списком контактов
              Над списком контактов есть кнопки "Новый груповой чат" и "Новый канал"
        - do: Нажать на "Новый групповой чат"
        - assert: |
              Отрывается окно создания группового чата
              Есть поля для ввода названия чата и описания чата
              Есть возможность загрузить аватар чата
        - do: Ввести название и описание чата. Загрузить аватар для чата и нажать кнопку "Добавить участников"
        - assert: Открывается окно добавления участников
        - do: Выбрать в списке контактов пользователя Б и нажать кнопку "Создать чат"
        - assert: |
              Создался групповой чат с введенным названием и описанием
              Аватар у чата совпадает с тем, который загружался ранее в шагах
              Участники созданного группового чата - Вы и Пользователь Б
        - do: Нажать на шапку чата
        - assert: |
              Открылось окно управления чатом
              Нет кнопоки "Скопировать ссылку"
        - do: Нажать на кнопку "Настройки чата"
        - assert: |
              Открывается окно натсроек чата
              Ползунок "Публичная ссылка" выключен
              Нет кнопок "Скопировать ссылку" и "Обновить ссылку"

    При включении переключателя "Публичная ссылка" появляется кнопка "Скопировать ссылку" у администратора[manual]:
        - automation: MSSNGRFRONT-5139
        - description: |
              Необходимо иметь аккаунт пользователя А
              Пользователь А авторизован в тестовом приложении
              Есть групповой чат, в котором пользователь А администратор и в настройках чата выключен переключатель "Публичная ссылка"
        - do: Открыть групповой чат, который описан в description
        - assert: Чат открыт
        - do: Нажать на шапку чата
        - assert: |
              Открылось окно управления чатом
              Нет кнопоки "Скопировать ссылку"
        - do: Нажать на кнопку "Настройки чата"
        - assert: |
              Открывается окно натсроек чата
              Ползунок "Публичная ссылка" выключен
              Нет кнопок "Скопировать ссылку" и "Обновить ссылку"
        - do: Включить переключатель "Публичная ссылка"
        - assert: |
              Переключатель “Публичная ссылка” включился
              Кнопки "Скопировать ссылку" и "Обновить ссылку" не появились
        - do: Нажать на кнопку "Сохранить"
        - assert: |
              Открылась карточка "Информациия о чате"
              Есть кнопка "Скопировать ссылку"
        - do: Нажать на "Настройки чата"
        - assert: |
              Открывается окно натсроек чата
              Ползунок "Публичная ссылка" включен
              Есть кнопоки "Скопировать ссылку" и "Обновить ссылку"

    Обновить публичную ссылку может администратор[manual]:
        - automation: MSSNGRFRONT-5139
        - description: |
              Пользователь А авторизован в тестовом приложении
              Есть групповой чат, в котором пользователь А администратор и в настройках чата включен переключатель "Публичная ссылка"
        - do: Открыть групповой чат, который описан в description
        - assert: Чат открыт
        - do: Нажать на шапку чата
        - assert: |
              Открылось окно управления чатом
              Есть кнопка "Скопировать ссылку"
        - do: Нажать на "Настройки чата"
        - assert: |
              Открывается окно натсроек чата
              Ползунок "Публичная ссылка" включен
              Есть кнопоки "Скопировать ссылку" и "Обновить ссылку"
        - do: Нажать на кнопку "Обновить ссылку"
        - assert: На экране появилась надпись "Ссылка обновлена"
        - do: Нажать кнопку "Сохранить"
        - assert: |
              Изменения сохранены
              Ссылка на чат обновилась

    Вкл/Выкл переключатель  для создания публичной ссылки может администратор чата[manual]:
        - automation: MSSNGRFRONT-5139
        - description: |
              Пользователь А авторизован в тестовом приложении
              Есть групповой чат, в котором пользователь А администратор и в настройках чата включен переключатель "Публичная ссылка"
              У пользователя А в списке контактов есть другие пользователи
        - do: Открыть список чатов
        - assert: Открывается окно списка чатов
        - do: Нажать на кпонку "Создать новый чат", которая находится над списком чатов
        - assert: |
              Открывается окно со списком контактов
              Над списком контактов есть кнопки "Новый груповой чат" и "Новый канал"
        - do: Нажать на "Новый групповой чат"
        - assert: |
              Отрывается окно создания группового чата
              Есть поля для ввода названия чата и описания чата
              Есть возможность загрузить аватар чата
        - do: Ввести название и описание чата. Загрузить аватар для чата и нажать кнопку "Добавить участников"
        - assert: Открывается окно добавления участников
        - do: Выбрать в списке контактов пользователя Б и нажать кнопку "Создать чат"
        - assert: |
              Создался групповой чат с введенным названием и описанием
              Аватар у чата совпадает с тем, который загружался ранее в шагах
              Участники созданного группового чата - Вы и Пользователь Б
        - do: Нажать на шапку чата
        - assert: |
              Открылось окно "Информация о чате"
              Нет кнопоки “Скопировать ссылку” и ссылки на чат
        - do: Нажать на кнопку "Настройки чата"
        - assert: |
              Открывается окно натсроек чата
              Ползунок "Публичная ссылка" выключен
              Нет кнопок "Скопировать ссылку" и "Обновить ссылку"
        - do: Включить переключатель "Публичная ссылка"
        - assert: |
              Переключатель “Публичная ссылка” включился
              Кнопки "Скопировать ссылку" и "Обновить ссылку" не появились
        - do: Нажать на кнопку "Сохранить"
        - assert: |
              Открылась карточка "Информациия о чате"
              Есть кнопка "Скопировать ссылку"
        - do: Нажать на кнопку "Настройки чата"
        - assert: |
              Открывается окно натсроек чата
              Ползунок "Публичная ссылка" включен
              Есть кнопоки "Скопировать ссылку" и "Обновить ссылку"
        - do: Нажать на переключатель "Публичная ссылка"
        - assert: |
              Переключатель “Публичная ссылка” выключился
              Пропали кнопки “Скопировать ссылку” и "Обновить ссылку"
        - do: Нажать кнопку "Сохрнаить"
        - assert: |
              Открылась карточка "Информациия о чате"
              Отсутствует кнопка "Скопировать ссылку"

    Кнопка Скопировать доступна всем, если администратор включил переключатель "Публичная ссылка"[manual]:
        - automation: MSSNGRFRONT-5139
        - description: |
              Необходимо иметь два аккаунта - пользователь А (проверяемый) - в браузере, пользователь Б (дополнительный, можно авторизоваться в другом браузере\инкогнито-окне)
              Есть групповой чат, в котором пользователь Б администратор, и есть пользователь А - не администратор
              В настройках данного чата выключен переключатель "Публичная ссылка"
        - do: Под пользователем Б открыть список чатов
        - assert: Открывается окно списка чатов
        - do: Открыть групповой чат, который описан в description
        - assert: Чат открыт
        - do: Нажать на шапку чата
        - assert: |
              Открылось окно "Информация о чате"
              Нет кнопоки “Скопировать ссылку” и ссылки на чат
        - do: Нажать на кнопку "Настройки чата"
        - assert: |
              Открывается окно натсроек чата
              Ползунок "Публичная ссылка" выключен
              Нет кнопок "Скопировать ссылку" и "Обновить ссылку"
        - do: Нажать на переключатель "Публичная ссылка"
        - assert: |
              Переключатель “Публичная ссылка” включился
              Кнопки “Скопировать ссылку” и "Обновить ссылку" не появились
        - do:  Нажать кнопку "Сохранить"
        - assert: |
              Открылась карточка "Информация о чате"
              Изменения были сохранены
              В карточке появилась кнопка "Скопировать ссылку"
        - do: Под пользователем А открыть групповой чат, который описан в description
        - assert: Чат открыт
        - do: Нажать на шапке чата
        - assert: |
              Открылось окно информации о чате
              Есть кнопка "Скопировать ссылку" и ссылка на чат
              Нет переключателя "Публичная ссылка"
        - do: Нажать на кнопке "Скопировать ссылку"
        - assert: Появилось сообщение "Ссылка скопирована"

    В карточке приватного чата нет секции для инвайт-линки:
        - tags: [advanced_smoke]
        - description: |
              Необходимо иметь аккаунт пользователя - А
              Пользователь А авторизован в тестовом приложении
              У авторизованного пользователя в списке чатов есть приватный чат;
        - do: Пользователем А открыть любой чат, который соответствует описанию указанному в description
        - assert: Чат открыт
        - do: Нажать на шапку чата
        - assert: |
              Открылось меню "О пользователе"
              Есть пункти выключатель "Уведомления"
              Нет пункта "Скопировать ссылку" и ссылки на чат

    Окно присоединения к чату по публичной ссылке имеет определенный вид[manual]:
        - automation: MSSNGRFRONT-5139
        - description: |
              Необходимо иметь два аккаунта - пользователь А (проверяемый) - в браузере, пользователь Б (дополнительный, можно авторизоваться в другом браузере\инкогнито-окне)
              Есть групповой чат, в котором пользователь Б администратор, и нет пользователя А
              В настройках данного чата включен переключатель "Публичная ссылка"
              Между пользователем А и Б есть чат, куда пользователем Б отправлена инвайт ссылка на групповой чат из description
        - do: Пользователем А зайти в чат с инвайт ссылкой от пользователя Б
        - assert: Открылось окно чата, в нем отображается сообщение с инвайт ссылкой от пользователя Б
        - do: Нажать на инвайт ссылке в сообщении
        - assert: |
              Произошел переход в групповой чат, созданный пользователем Б
              Доступна кнопка “Присоединиться”

    В карточке группового чата  у участника чата нет кнопки "Скопировать ссылку", если админ запретил доступ[manual]:
        - automation: MSSNGRFRONT-5139
        - description: |
              Необходимо иметь два аккаунта - пользователь А (проверяемый) - в браузере, пользователь Б (дополнительный, можно авторизоваться в другом браузере\инкогнито-окне)
              Есть групповой чат, в котором пользователь Б администратор, и есть пользователь А - не администратор
              В настройках данного чата включен переключатель "Публичная ссылка"
        - do: Под пользователем Б открыть групповой чат из description
        - assert: Открывается окно чата
        - do: Нажать на шапку чата
        - assert: Открывается окно "Информация о чате"
        - do: Нажать на кнопку "Настройки чата"
        - assert: |
              Открывается окно натсроек чата
              Есть кнопка "Скопировать ссылку"
              Есть кнопка "Обновить ссылку"
        - do: Выключить переключатель “Публичная ссылка”
        - assert: |
              Переключатель “Публичная ссылка” выключился
              Пропали Кнопка "Скопировать ссылку" и кнопка "Обновить ссылку"
        - do: Нажать кнопку "Сохранить"
        - assert: |
              Открылось окно "Информация о чате"
              Отсутствует кнопка "Скопировать ссылку"
        - do: Открыть чат из description пользователем А
        - assert: Чат открыт
        - do: Нажать на шапку чата
        - assert: Открывается окно "Информация о чате"
        - do: Убедиться в том, что нет кнопки "Скопировать ссылку"
        - assert: Кнопка "Скопировать ссылку" и ссылка на чат отсутствуют

files:
    - tests/hermione/suites/messenger/invite-links/interface-public-link-invite-link.common.hermione.ts

v-team: Chat

tlds: ru

tags:
        - yamb
        - y-team
