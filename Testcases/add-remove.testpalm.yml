feature: Управление правами администратора

specs:
  Положительные:
    1. Админ добавляет и удаляет админские права у пользователя в разделе Администраторы:
      - do: авторизоваться под администратором организации "kimberly.mcgregor@cap.auto.connect-test.tk"
      - do: перейти по ссылке {{CONNECT_HOST}}/portal/admin/customization/admins
      - do: нажать на кнопку "+ Добавить" в подвале списка админов
      - screenshot: открылось модальное окно с формой добавления админа [add-admin-form]
      - do: ввести в поле ввода имя пользователя-неадмина "Jesper Cooper"
      - do: выбрать "Jesper Cooper" во всплывающей подсказке
      - screenshot: в поле ввода появилась плашка с выбранным пользователем [filled-add-admin-form]
      - do: нажать на кнопку "Добавить" в модальном окне
      - assert: модальное окно закрылось
      - screenshot: появилось сообщение "Состав администраторов организации обновлён" [add-success]
      - do: нажать на крестик во всплывающем сообщении
      - assert: в списке админов появился "Jesper Cooper"
      - do: нажать на карандаш в правом верхнем углу списка админов
      - do: нажать на чекбокс рядом с "Jesper Cooper"
      - do: нажать на кнопку с мусорным баком в подвале списка админов
      - screenshot: открылось модальное окно с формой удаления админа [remove-admin-form]
      - do: нажать на кнопку "Удалить" в модальном окне
      - assert: модальное окно закрылось
      - screenshot: появилось сообщение "Состав администраторов организации обновлён" [remove-success]
      - do: нажать на крестик во всплывающем сообщении
      - assert: в списке админов больше нет "Jesper Cooper"
    2. Админ добавляет и удаляет админские права у пользователя в карточке пользователя:
      - do: авторизоваться под администратором организации "kimberly.mcgregor@cap.auto.connect-test.tk"
      - do: открыть карточку сотрудника "Diaz Florence" по ссылке {{CONNECT_HOST}}/portal/admin/users/1130000002100008
      - do: нажать на "..." в правом верхнем углу карточки пользователя
      - assert: открылось меню
      - assert: в меню есть пункт "Сделать администратором"
      - do: нажать на пункт меню "Сделать администратором"
      - screenshot: появилось сообщение "Готово" [add-success]
      - do: нажать на крестик во всплывающем сообщении
      - do: нажать на "..." в правом верхнем углу карточки пользователя
      - assert: открылось меню
      - assert: в меню есть пункт "Отозвать права администратора"
      - do: нажать на пункт меню "Отозвать права администратора"
      - screenshot: появилось сообщение "Готово" [remove-success]

  Отрицательные:
    1. Админ нажимает на крестик при добавлении админских прав пользователю в разделе Администраторы:
      - do: авторизоваться под администратором организации "kimberly.mcgregor@cap.auto.connect-test.tk"
      - do: перейти по ссылке {{CONNECT_HOST}}/portal/admin/customization/admins
      - do: нажать на кнопку "+ Добавить" в подвале списка админов
      - assert: открылось модальное окно с формой добавления админа
      - do: нажать на крестик в правом верхнем углу модального окна
      - assert: модальное окно закрылось
    2. Админ нажимает на кнопку "Отменить" при добавлении админских прав пользователю в разделе Администраторы:
      - do: авторизоваться под администратором организации "kimberly.mcgregor@cap.auto.connect-test.tk"
      - do: перейти по ссылке {{CONNECT_HOST}}/portal/admin/customization/admins
      - do: нажать на кнопку "+ Добавить" в подвале списка админов
      - assert: открылось модальное окно с формой добавления админа
      - do: нажать на кнопку "Отменить" в модальном окне
      - assert: модальное окно закрылось
    3. Админ не может удалить владельца организации в разделе Администраторы:
      - do: авторизоваться под администратором организации "kimberly.mcgregor@cap.auto.connect-test.tk"
      - do: перейти по ссылке {{CONNECT_HOST}}/portal/admin/customization/admins
      - do: нажать на карандаш в правом верхнем углу списка админов
      - do: нажать на чекбокс рядом с "Edwards Henrik"
      - do: нажать на кнопку с мусорным баком в подвале списка админов
      - screenshot: открылось модальное окно с формой удаления админа [remove-admin-form]
      - do: нажать на кнопку "Удалить" в модальном окне
      - assert: модальное окно не закрылось
      - screenshot: в модальном окне появилось красное сообщение "Произошла ошибка — не удалось обновить состав администраторов команды" [remove-admin-form-error]
    4. Админ не может удалить владельца организации в карточке пользователя:
      - do: авторизоваться под администратором организации "kimberly.mcgregor@cap.auto.connect-test.tk"
      - do: открыть карточку владельца организации "Henrik Edwards" по ссылке {{CONNECT_HOST}}/portal/admin/users/4028852408
      - do: нажать на "..." в правом верхнем углу карточки пользователя
      - assert: открылось меню
      - do: нажать на пункт меню "Отозвать права администратора"
      - assert: появилось сообщение "Произошла ошибка"

priority: blocker

files:
  - tests/hermione/suites/admin/add-remove.js

tlds:
  - ru
  - com

tags:
  - smoke_test_assessors
  - regression
  - smoke_test
  - reviewed
