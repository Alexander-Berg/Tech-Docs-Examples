feature: Все системы

specs:
  Все системы:
    - do: запустить в Runner сценарий "Все системы" (https://github.yandex-team.ru/pixel/idm-runner)
    - do: отправить запрос "Все системы. Дефолтный вид" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: в ответе на запрос "Все системы. Дефолтный вид" у каждой записи поле "is_active" должно иметь значение "true" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-12%2020-50-04.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Все системы. Только sox-овые" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: в ответе на запрос "Все системы. Только sox-овые" у каждой записи поле "is_sox" должно иметь значение "true" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-12%2020-50-50.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Все системы. Сломанные системы" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: в ответе на запрос "Все системы. Сломанные системы" у каждой записи поле "state" должно иметь значение "Сломана" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-12%2020-52-24.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Все системы. Выключенные системы" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: в ответе на запрос "Все системы. Выключенные системы" у каждой записи поле "state" должно иметь значение "Выключена" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-12%2020-53-14.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Все системы. Только избранные" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: в ответе на запрос "Все системы. Только избранные" у каждой записи поле "is_favorite" должно иметь значение "true" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-12%2020-54-21.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Все системы. Поиск по названию системы. Кириллица" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: ответ на запрос "Все системы. Поиск по названию системы. Кириллица" должен содержать поля [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-12%2020-54-57.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Все системы. Поиск по названию системы. Латиница" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: ответ на запрос "Все системы. Поиск по названию системы. Латиница" должен содержать поля [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-12%2020-55-26.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Все системы. Фильтрация по сервисам АВС" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: в ответе на запрос "Все системы. Фильтрация по сервисам АВС" у каждой записи id в блоке service должен иметь значение или 483, или 577 [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-12%2020-56-36.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Все системы. Фильтрация по сотруднику. Поле 1. Ответственный в системе" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: ответ на запрос "Все системы. Фильтрация по сотруднику. Поле 1. Ответственный в системе" должен содержать поля [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-12%2020-58-07.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Все системы. Фильтрация по сотруднику. Поле 2. Член команды" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: ответ на запрос "Все системы. Фильтрация по сотруднику. Поле 2. Член команды" должен содержать поля [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-12%2020-58-53.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"

priority: critical

files:
  - idm/tests/api/frontend/test_system.py

tags:
  - reviewed
  - no_assessors
  - postman_automation
  - fitcher:idm-www:test/auto/systems/**
  - fitcher:idm-www:blocks/desktop/filters/**
  - fitcher:idm-www:blocks/desktop/table/**
  - fitcher:idm_backend_palmsync:idm/tests/api/frontend/test_system.py
  - fitcher:idm_backend_palmsync:idm/core/constants/groupmembership.py
  - fitcher:idm_backend_palmsync:idm/core/constants/role.py
  - fitcher:idm_backend_palmsync:idm/core/constants/rolefield.py
  - fitcher:idm_backend_palmsync:idm/core/constants/system.py
  - fitcher:idm_backend_palmsync:idm/core/models/favorite_system.py
  - fitcher:idm_backend_palmsync:idm/core/models/rolenode.py
  - fitcher:idm_backend_palmsync:idm/core/models/action.py
  - fitcher:idm_backend_palmsync:idm/core/models/system.py
  - fitcher:idm_backend_palmsync:idm/core/models/systemrolepush.py
  - fitcher:idm_backend_palmsync:idm/core/models/role.py
  - fitcher:idm_backend_palmsync:idm/services/models.py
  - fitcher:idm_backend_palmsync:idm/tests/utils.py
  - fitcher:idm_backend_palmsync:idm/users/constants/group.py
  - fitcher:idm_backend_palmsync:idm/users/models.py
