feature: Hotels / Карусель
type: Отель в попапе

specs:
  beforeEach:
    - do: получить выдачу по запросу 'отели в москве'
    - assert: над поисковой выдачей появилась карусель отелей во всю ширину экарана
    - do: кликнуть в первый отель в карусели
    - assert: показался попап, в который загрузилась подробная информация о выбранном отеле
  Переход в таб "На карте" кликом по карте из основного таба:
    - tags:
        - carousel
        - popup
        - map
        - tabs
    - do: кликнуть по карте
    - tech: |
        сработал счетчик на карте
        path='/parallel/result/wiz/companies/map/upper/showcase/item/object-badge/map',
        vars='pos=upper,wizard=true,-source=fake,-adapters=companies,popup=inside'
    - assert: |
        открылся таб с картой,
        на карте отображается пин, обозначающий расположение отеля
    - assertMetrics: '*'
  Переход в таб "На карте" кликом по иконке на карте из основного таба:
    - tags:
        - popup
        - map
    - do: кликнуть по иконке, расположенной в правом верхнем углу на карте
    - tech: |
        сработал счетчик на иконке
        path='/parallel/result/wiz/companies/map/upper/showcase/item/object-badge/map/open',
        vars='pos=upper,wizard=true,-source=fake,-adapters=companies,popup=inside'
    - assert: |
        открылся таб с картой,
        на карте отображается пин, обозначающий расположение отеля
    - assertMetrics: '*'
  Таб "На карте":
    - tags:
        - popup
        - button
        - map
    - do: кликнуть в таб "На карте"
    - tech: |
        сработал счетчик на заголовке таба
        path='/parallel/result/wiz/companies/map/upper/showcase/item/tabs',
        vars='pos=upper,wizard=true,-source=fake,-adapters=companies,popup=inside,action=dynamic_click,-item=*'
    - assert: |
        открылся таб с картой,
        на карте отображается пин, обозначающий расположение отеля
    - screenshot: содержимое таба с картой [map-tab]
    - do: кликнуть на кнопку увеличения масштаба
    - tech: сработал счетчик на кнопке увеличения масштаба path='/parallel/result/wiz/companies/map/upper/showcase/item/zoom/plus', vars='pos=upper,wizard=true,-source=fake,-adapters=companies,popup=inside,action=dynamic_click'
    - assert: масштаб карты увеличился
    - do: кликнуть на кнопку уменьшения масштаба
    - tech: сработал счетчик на кнопке уменьшения масштаба path='/parallel/result/wiz/companies/map/upper/showcase/item/zoom/minus', vars='pos=upper,wizard=true,-source=fake,-adapters=companies,popup=inside,action=dynamic_click'
    - assert: масштаб карты уменьшился
    - do: кликнуть на кнопку определения местоположения пользователя (возможно потребуется разрешить определять местоположение браузеру)
    - tech: сработал счетчик на кнопке геолокации path='/parallel/result/wiz/companies/map/upper/showcase/item/location', vars='pos=upper,wizard=true,-source=fake,-adapters=companies,popup=inside,action=dynamic_click'
    - assert: на карте отображается красная иконка "Я"
    - do: зажать курсором карту и немного передвинуть ее
    - tech: сработал счетчик драга карты path='/parallel/result/wiz/companies/map/upper/showcase/item/drag', vars='pos=upper,wizard=true,-source=fake,-adapters=companies,popup=inside,action=dynamic_click'
    - assert: карта сдвинулась в нужном направлении
    - assertMetrics: '*'

files:
  - features/companies/hotels/hotels-popup/hotels-carousel-popup-map-tab@desktop.hermione.js

counter: /parallel/result/snippet/companies/travel_company/object-badge/popup/form/submit

tags:
  - skip_e2e_check

v-team: KotTeam

tlds: none
