feature: Колдунщик 1орг

counter: /parallel/result/snippet/companies/company/object-badge/map

specs:
  Проверяем описание:
    - do: получить выдачу по запросу 'ква ква парк'
    - assert: |
        примерный внешний вид [https://jing.yandex-team.ru/files/sladex/2021-09-14T12:11:18Z.5640c1f.png]
        в блоке справа от выдачи отобразились название, кнопки, рейтинг, контактные данные, часы работы,
        в блоке справа от выдачи показывается фотогалерея и карта с отмеченным местонахождением организации,
        в блоке справа от выдачи содержится описание организации из запроса
    - assertMetrics: '*'
  Ссылка на карту:
    - tags:
        - maps
    - do: получить выдачу по запросу 'кафе пушкин' и кликнуть по превью карты
    - assert: открылась страница профилей в новой вкладке
    - tech: сработал счетччик path='/$page/$parallel/$result/composite/tabs/about/gallery/scroller/row/map/thumb'
    - assertMetrics: '*'
  Главная тумба:
    - do: получить выдачу по запросу 'кафе пушкин'
    - assert: показался колдунщик организации справа
    - do: кликнуть на первую картинку в галерее
    - assert: |
        открылся попап организации на вкладке "фото",
        с картинкой в полный размер
    - tech: сработал счетчик /parallel/result/snippet/companies/company/gallery/rows/thumb
    - assertMetrics:
        - feature.web.wizards_common.wizard_companies_right.total.shows
        - feature.web.wizards_common.wizard_companies_right.total.external_clicks
        - feature.web.wizards_common.wizard_companies_right.total.dynamic_clicks
        - web.tech_part_misc_click
        - web.total_all_click
  Проверяем ссылки в блоке key-value:
    - tags:
        - key-value
    - do: получить выдачу по запросу 'ква ква парк' и перейти по гринурлу организации в текстовом колдунщике Яндекс.Карты (в центральной колонке)
    - assert: произошёл переход на сервис Яндекс.Карты с указанием местонахождения и карточкой организации
    - tech: сработал счетчик path='/snippet/companies/company/greenurl/request/'
    - do: вернуться на страницу выдачи результатов и перейти по ссылке на адресе в правом блоке
    - assert: открылась страница профилей в новой вкладке
    - tech: сработал счетчик path='/$page/$parallel/$result[@wizard_name="companies"]/composite/tabs/about/contacts/address'
    - do: вернуться на страницу выдачи результатов и перейти по зеленой ссылке на сайт в правом блоке
    - assert: произошёл переход на официальный сайт организации
    - tech: сработал счетчик /$page/$parallel/$result/composite/tabs/about/contacts/site[@action = "site"]
    - assertMetrics: '*'
  Проверка работы ката фичей:
    - tags:
        - cut
    - do: получить выдачу по запросу 'кафе пушкин'
    - assert: в правом блоке в описании присутствует ссылка-многоточие
    - do: нажать на ссылку-многоточие
    - assert: описание организации отобразилось полностью
    - tech: сработал счетчик path='/parallel/result/snippet/companies/company/cut/'
    - assertMetrics: '*'
  Проверка корректного закрытия попапа:
    - do: получить выдачу по запросу 'кафе пушкин'
    - do: кликнуть в картинку рядом с картой
    - assert: открылся попап организации на вкладке "фото",
    - do: закрыть попап
    - assert: попап закрыся
    - do: кликнуть в тумбу
    - assert: открылся попап организации на вкладке "фото"
    - assertMetrics: '*'
  Без WizardPos в данных:
    - params:
        foreverdata: '4074841978'
    - do: получить выдачу по запросу 'кафе пушкин'
    - assert: |
        на странице присутствует карточка организации
        в шапке карточки нет лишних ссылок на карты
        (внешний вид лишних ссылок https://jing.yandex-team.ru/files/melnikovatm/Лишние%20ссылки%20в%201орг.png)


files:
  - features/companies/one/companies-one@desktop.hermione.js

tlds: all

v-team: VanillaGeo

tags:
  - reviewed
  - skip_e2e_check
