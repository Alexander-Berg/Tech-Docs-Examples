feature: Страница Темы

description: Данная функциональность позволяет пользователю узнавать предысторию события и следить за темой, если она развивается на протяжении длительного времени.

specs-integration:
  должна открываться:
      - do: перейти по ссылке https://yandex.ru/news/theme/Novyj_koronavirus_v_Kitae--522
      - assert: открылась страница темы
      - assert: страница темы содержит виджет тем и карточки новостей
  с малым количеством сюжетов и с мелкой аннотацией должна открываться:
      - do: перейти по ссылке https://yandex.ru/news/theme/Snos_pamyatnikov--577
      - assert: открылась страница темы
      - assert: страница темы содержит виджет тем и карточки новостей

  должна открываться на нацдоменах:
    - do: перейти по ссылке https://yandex.kz/news/theme/Pandemiya_koronavirusa--522
    - assert: нет 500х ошибок, открылась страница темы

specs:
  содержит карточку темы:
    с заголовком и аннотацией:
      - tags:
        - smoke
        - backend_news
      - do: перейти на страницу темы по ссылке https://yandex.ru/news/theme/Covid--522
      - assert: |
          отображается карточка темы,
          карточка содержит заголовок,
          аннотацию (если аннотация длинная, она заточивается, есть кнопка Читать дальше,
          если аннотация короткая, она отображается полностью, есть ссылка В источнике),
          список источников с названиями и иконками,
          внешний вид https://jing.yandex-team.ru/files/a-groza/2020-04-02_16.39.56-1dlkh.png
    без аннотации:
      - tags:
        - smoke
        - backend_news
        - smoke_zen
      - do: перейти на страницу темы по ссылке https://yandex.ru/news/theme/Vojna_v_Sirii--136
      - assert: |
          отображается карточка темы,
          карточка содержит заголовок и список источников с названиями и иконками,
          внешний вид https://jing.yandex-team.ru/files/a-groza/2020-04-02_16.39.13-h5wuq.png

  содержит ссылку на источник в аннотации:
    - tags:
      - smoke
    - do: перейти на страницу темы по ссылке https://yandex.ru/news/theme/Covid--522
    - do: тапнуть по кнопке Читать дальше (если кнопки нет, пропустить этот шаг)
    - assert: аннотация разворачивается, кнопка Читать дальше меняется на ссылку В источнике
    - do: тапнуть В источнике
    - assert: |
        источник открывается в новой вкладке,
        в урле прокинуты параметры utm_source=yxnews&utm_medium=mobile

  открывает источники в новой вкладке:
    - tags:
      - smoke
    - do: перейти на страницу темы по ссылке https://yandex.ru/news/theme/Vojna_v_Sirii--136
    - do: тап по первому источнику
    - assert: |
        источник открывается в новой вкладке,
        в урле прокинуты параметры utm_source=yxnews&utm_medium=mobile

  не скрывает источники после тапа по кнопке Еще:
      - tags:
        - smoke
      - do: перейти на страницу темы по ссылке https://yandex.ru/news/theme/Severnyj_potok__2--195
      - assert: |
          отображается карточка темы,
          карточка содержит заголовок и список источников с названиями и иконками
      - do: проскроллить источники до конца вправо
      - assert: отображается кнопка Еще N со стрелочкой
      - do: тапнуть по кнопке Еще N и развернуть источники до конца
      - assert: |
          последняя порция подгружает оставшиеся источники (их может быть меньше 6),
          пропадает кнопка Еще N,
          бабблы источников не пропадают

  c лентой новостей по теме и рекламой:
    - tags:
      - smoke
      - backend_news
      - smoke_zen
    - do: перейти на страницу темы по ссылке https://yandex.ru/news/theme/Vakcinaciya_ot_koronavirusa--981
    - assert: |
        отображается страница темы,
        над карточкой темы отображается реклама,
        под карточкой темы присутствует лента новостей с заголовком Новости по теме
    - do: поскроллить страницу вниз
    - assert: лента новостей скроллится, cодержит рекламные блоки
    - do: тапнуть по любому сюжету новостей
    - assert: в той же вкладке происходит переход на соответствующий сюжет

  не ломается при попытке перейти на несуществующую тему:
    - do: перейти на страницу темы по ссылке https://yandex.ru/news/theme/Vojna_v_Sirii--1a
    - assert: открывается страница c текстом "Не удалось отобразить сюжет" https://jing.yandex-team.ru/files/kossakovskaya/2021-01-29_17-54-12.png

  отображается даже без ленты новостей:
    - tags:
      - no_assessors
    - do: перейти на страницу темы по ссылке https://yandex.ru/news/theme/N--566 или https://yandex.ru/news/theme/Postavki_rossijskoj_nefti_na_NPZ_Belorussii--567(или подставить другой id, если темы больше нет или по ней появились новости)
    - assert: отображается карточка темы и ниже сразу реклама

#   TODO: добавить автотест для шагов
#     - do: тапнуть по кнопке Еще N
#     - assert: отобразились еще 6 источников и кнопка Еще N (N = предыдущая N-6)

  корректно отображается в темной теме:
    - do: перейти на страницу темы по ссылке https://yandex.ru/news/theme/Severnyj_potok__2--195?flags=yxneo_news_phone_theme_service-theme=dark
    - assert: отображается карточка темы и новости по теме

  не должна содержать рекламу, если в теме есть флаг отключения рекламы:
    - do: перейти в любую тему с флагом yxneo_news_theme_tragic-ids
    - assert: нет рекламы под рубрикатором и в ленте новостей

files:
  - features/news/theme/theme.phone.hermione.js
  - features/news/theme/theme.phone.hermione.e2e.js
# несколько автотестов тут:
# src/components/news/Theme/__tests__/Theme.phone.hermione.js

tags:
  - neo
  - theme

manager: glushneva

qa-engineer: a-groza

tlds:
  - ru
  - by
  - kz
  - uz
  - ua
  - com
