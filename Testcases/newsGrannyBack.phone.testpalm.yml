feature: Бабуля сервиса Яндекс.Новости

description:
  Сценарий описывает верстку сервиса Яндекс.Новости для старых устройств.

specs:
  позволяет сравнивать версии статики [manual]:
    - tags:
      - news_granny
      - backend_news
      - smoke_zen
    - do: авторизоваться личным аккаунтом, прикрепленным к Стаффу
    - assert: в правом нижнем углу отобразилась божья коровка https://jing.yandex-team.ru/files/weberxks/Screen%20Shot%202022-03-16%20at%2015.50.58.png
    - do: нажать на божью коровку и открыть вкладку 'Инфо'
    - assert: | 
        показана нужная версия статики сервиса StaticVersion @yandex-int/news/1.1182.0,
        внешний вид - скрин https://jing.yandex-team.ru/files/weberxks/Screen%20Shot%202022-03-17%20at%2010.53.26.png

  может содержать медиаблок с видео, который имеет внешний вид [manual]:
        - tags:
            - news_granny
            - backend_news
            - smoke_zen
        - do: открыть выдачу сервиса на странице рубрики 'Главное'
        - do: перейти в нетраурный сюжет с видео тапом по заголовку в новостной карточке
        - assert: |
            сюжет содержит медиаблок с видео (если в сюжете нет медиаблока с видео, открыть другой сюжет),
            под основным видео может быть карусель превью видео (если карусели с превью нет, открыть другой сюжет),
            карусель превью скроллится по горизонтали,
            каждое превью видео содержит иконку плей и название источника видео,
            если иконки плей нет, значит - это превью фото, это ок,
            по умолчанию активен медиаблок с видео, видео не воспроизводится автоматически,
            в левом нижнем углу отображается название источника видео,
            внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2021-07-01_12-57-37.png
        - do: перевернуть устройство в ландшафтную ориентацию
        - assert: медиаблок с видео отображается корректно, карусель скроллится по горизонтали
        - do: вернуть устройство обратно в портретную ориентацию
        - do: поскроллить ленту сюжетов, найти сюжет с одним видео в медиаблоке
        - assert: |
            видео не воспроизводится автоматически,
            под основным видео отсуствует карусель с превью,
            в левом нижнем углу отображается название источника видео,
            внешний вид -https://jing.yandex-team.ru/files/kossakovskaya/2021-07-01_12-57-52.png

  выделяет для авторизованного пользователя иконку-индикатор над заголовком в сюжете и в рубрике [manual]:
    - tags:
        - news_granny
        - backend_news
        - smoke_zen
    - do: авторизоваться на сервисе
    - do: кликнуть на аватарку пользователя, выбрать в меню 'Настройка источников'
    - assert: |
        открылось модальное окно настроек,
        отображаются описание, поле поиска 'Найти источник', список источников,
        напротив источников имеются кнопки добавления в избранные, и в нежелательные,
        внешний вид https://jing.yandex-team.ru/files/an-smirn0v/shot_210412_165939.png (набор источников может отличаться)
    - do: если есть добавленные источники - тапнуть на каждую желтую звездочку
    - assert: отображается всплывающие сообщение 'Удалено из избранного', звездочки больше не желтые
    - do: нажать на поле поиска 'Найти источник'
    - assert: появилась строка инпута для ввода названия источника https://jing.yandex-team.ru/files/an-smirn0v/shot_210412_170722.png
    - do: ввести название 'Lenta.ru'
    - assert: появляется саджест с похожими названиями источников
    - do: кликнуть по звездочке возле источника 'Lenta.ru'
    - assert: отображается всплывающие сообщение 'Добавлено в избранное', звездочка прокрашена желтым
    - do: нажать на кнопку стрелочки (назад) в поле поиска 'Найти источник'
    - assert: отображается модальное окно настроек, звездочка напротив источника 'Lenta.ru' прокрашена желтым
    - do: закрыть окно настроек и перейти в любую рубрику, например, в Общество
    - do: скроллить ленту рубрики
    - assert: |
        в ленте рубрики есть карточки от источника 'Lenta.ru' (весь топ-5 может быть от этого источника),
        в каждой карточке от источника 'Lenta.ru' отображается желтая точка у иконки источника,
        внешний вид https://jing.yandex-team.ru/files/an-smirn0v/shot_210414_164521.png
    - do: перейти в любой неспортивный сюжет от источника 'Lenta.ru' кликом по заголовку в карточке
    - assert: |
        в сюжете над заголовком источник - 'Lenta.ru',
        возле иконки источника отображается желтая точка,
        внешний вид https://jing.yandex-team.ru/files/an-smirn0v/shot_210414_164610.png
    - do: тапнуть по источнику с точкой у иконки
    - assert: в новой странице открывается статья в источнике 'Lenta.ru'

  корректно отображает шапку для залогиненного и разлогиненного пользователя [manual]:
    - tags:
      - news_granny
      - backend_news
    - do: открыть главную страницу сервиса Яндекс.Новости
    - do: разлогиниться, если был залогин
    - assert: |
        отображается шапка сервиса Яндекс.Новости,
        шапка содержит логотип Яндекса, иконку Яндекс.Плюс, кнопку Войти,
        шапка содержит поисковую строку, табы сервисов и рубрикатор
        внешний вид https://jing.yandex-team.ru/files/kossakovskaya/2021-09-07_13-30-43.png
    - do: авторизоваться под пользователем с подпиской Яндекс.Плюс (логин и пароль для пользователя с плюсом можно взять тут - https://wiki.yandex-team.ru/eva/testing/projects/nerpa/#loginyiparolidljatestovyxpolzovatelejjspodpiskojjpljusa)
    - assert: |
        отображается шапка сервиса Яндекс.Новости,
        шапка содержит логотип Яндекса,
        шапка содержит колокольчик уведомлений, аватарку пользователя с количеством непрочтенных писем и разноцветной обводкой,
        шапка содержит поисковую строку и табы сервисов
        внешний вид https://jing.yandex-team.ru/files/kossakovskaya/2021-09-07_13-29-56.png
    - do: разлогиниться из плюсового аккаунта
    - do: авторизоваться под пользователем без подписки Яндекс.Плюс
    - assert: |
        отображается шапка сервиса Яндекс.Новости,
        шапка содержит логотип Яндекса,
        шапка содержит иконку Яндекс.Плюс, колокольчик уведомлений, аватарку пользователя с количеством непрочтенных писем,
        шапка содержит поисковую строку и табы сервисов
        внешний вид https://jing.yandex-team.ru/files/kossakovskaya/2021-09-07_13-29-24.png

  подгружает выдачу по кнопке "Больше результатов" на странице инстори [manual]:
    - tags:
      - news_granny
      - backend_news
      - smoke_zen
    - do: Открыть Новости на странице рубрики "Главная"
    - do: Перейти на сюжет с большим количеством источников (такой сюжет можно найти, как правило, в топ-5 - это должно быть не самое свежее событие, о котором с большой вероятностью написали все сми. Обратите внимание! Сюжет не должен быть траурным, а также сюжет не должен быть спортивным!)
    - do: Тапнуть на заголовок "Подробнее о событии" (https://jing.yandex-team.ru/files/weberxks/Screen%20Shot%202022-03-14%20at%2015.47.34.png)
    - assert: |
        в той же вкладке открывается страница, которая содержит 'instory' (без кавычек) в адресной строке,
        у каждого источника на странице есть иконка, название и дата/время публикации
    - do: проскроллить страницу вниз до конца
    - assert: перед футером присутствует кнопка "Больше результатов" (если кнопки нет найти другой сюжет)
    - do: тапнуть на кнопку "Больше результатов"
    - assert: |
        загружается вторая страница выдачи,
        страница отделена от первой номером и разделителем,
        внешний вид - https://jing.yandex-team.ru/files/weberxks/Screen%20Shot%202022-03-14%20at%2015.51.07.png
    - do: проскроллить вторую страницу выдачи и тапнуть на кнопку "Больше результатов" (если кнопки нет - пропустить шаг)
    - assert: |
        загружается третья страница выдачи,
        страница отделена от второй номером и разделителем,
        нет бесконечного спиннера при попытке загрузить страницу,
        все карточки загружаются сразу, карточки третьей страницы не дублируют карточки второй страницы

  позволяет открыть график котировок, который имеет внешний вид [manual]:
    - tags:
        - news_granny
        - backend_news
    - do: перейти на бета-стенд, а затем открыть страницу котировок по прямой ссылке https://yandex.ru/news/quotes
    - assert: отобразилась главная страница котировок
    - do: тапнуть по любому названию котировок из раздела Сырьё
    - assert: |
          отобразился график с заголовком, соотвествующим выбранным котировкам,
          внизу под графиком отображается таблица 'За последние 10 дней' со столбцами Дата, Курс, Изменения,
          в конце столбца Изменение может отображаться стрелочка, обозначающая падение или рост курса,
          отображается подрубрикатор котировок с баббликами, выделен раздел Сырьё,
          отображается наименование объекта котировок,
          отображается линия графика стоимости, значения на графике обозначены горизонтальными линиями,
          нижняя ось графика отображает временные промежутки (по датам),
          боковая ось графика отображает шкалу стоимости валюты/ресурса/акции,
          под графиком отображаются ссылки 'неделя', 'месяц' (стоит по умолчанию), 'квартал', 'год' и 'всё время',
          под таблицей "За последние 10 дней" отображается надпись 'По состоянию на 10:00 Мск'
    - assert: внешний вид https://jing.yandex-team.ru/files/weberxks/Screen%20Shot%202022-03-14%20at%2016.00.28.png

  отображает персональную ленту под блоком котировок [manual]:
      - tags:
        - backend_news
        - news_granny
        - smoke_zen
      - do:
          залогиниться на сервисе под пользователем Александр Овечкин (логин и пароль взять со страницы-инструкции на вики - https://wiki.yandex-team.ru/eva/testing/projects/nerpa/#loginyiparolidljatestovyxpolzovatelejj)
          если возникла проблема с авторизацией - залогиниться под любым другим пользователем из таблицы - Ольга Бузова или Стив Джобс
      - do: перейти на https://yandex.ru/quotes
      - do: проскроллить ниже блока котировок
      - assert:
          отобразилась лента новостей,
          если вы залогинены под пользователем Александр Овечкин - в ленте большинство сюжетов - спортивные сюжеты
          если вы залогинены под пользователем Ольга Бузова - в ленте большинство сюжетов про шоу-бизнес
          если вы залогинены под пользователем Стив Джобс - в ленте большинство сюжетов про технологии
      - do: перейти на любой график котировок
      - assert:
          если вы залогинены под пользователем Александр Овечкин - под блоком графиков так же большинство сюжетов - о спорте
          если вы залогинены под пользователем Ольга Бузова - под блоком графиков так же большинство сюжетов про шоу-бизнес
          если вы залогинены под пользователем Стив Джобс - под блоком графиков так же большинство сюжетов про технологии
      - do: ОБЯЗАТЕЛЬНО выйти из тестового аккаунта

  позволяют авторизованному пользователю изменить реакцию [manual]:
      - tags:
        - news_granny
        - backend_news
        - smoke_zen
      - do: авторизоваться на сервисе
      - do: перейти в неспортивный сюжет БЕЗ ПОСТАВЛЕННЫХ ЭМОДЖИ (не из топа новостей), как выглядит сюжет без эмоджи - https://jing.yandex-team.ru/files/weberxks/Screen%20Shot%202022-03-14%20at%2016.14.22.png
      - assert: |
          под аннотацией есть кнопки 'Оценить' со значком смайла,
          справа от кнопки расположены иконка поделения и меню троеточия,
          элементы расположены в одну строку, не наезжают друг на друга
      - do: тапнуть на кнопку 'Оценить' и тапнуть по любой эмоджи в появившемся блоке
      - assert: |
          блок с доступными эмоджи пропадает,
          выбранная эмоджи появляется на месте смайла,
          'Оценить' меняется на 'Вы оценили',
          блок с доступными эмоджи не появляется
      - do: тапнуть по 'Вы оценили'
      - assert: |
          выбранная эмоджи пропала,
          'Вы оценили' меняется на 'Оценить' с иконкой смайла
      - do: тапнуть по кнопке 'Оценить' и кликнуть по любой другой эмоджи в появившемся блоке
      - assert: |
          блок с доступными эмоджи пропадает,
          выбранная другая эмоджи появляется на месте смайла,
          'Оценить' меняется на 'Вы оценили'
      - do: обновить страницу
      - assert: отображается только последняя выбранная эмоджи и черная надпись "Вы оценили"

  загружает новые карточки при скролле в обычной и ландшафтной ориентации [manual]:
      - tags:
        - news_granny
        - backend_news
        - smoke_zen
      - do: перейти в любую рубрику, кроме рубрик 'Главное', 'Коронавирус', 'Спорт' и региональной рубрики
      - do: скроллить страницу вниз, пока не закончатся карточки
      - assert: |
          под карточками отображается спиннер (при быстром интернете спиннер может быть не заметен),
          загружается новая пачка карточек,
          карточки отображаются корректно 
      - do: перевести устройство в альбомную ориентацию
      - do: скроллить страницу вниз, пока не закончатся карточки
      - assert: |
          под карточками отображается спиннер (при быстром интернете спиннер может быть не заметен),
          загружается новая пачка карточек,
          карточки отображаются корректно

  содержит рекламу при открытии рубрики [manual]:
    - tags:
      - news_granny
      - backend_news
      - smoke_zen
    - do: перейти в любую неспортивную и нетраурную рубрику (например https://yandex.ru/news/rubric/society)
    - assert: |
        под рубрикатором отображается реклама,
        внешний вид соответствует скриншоту - https://jing.yandex-team.ru/files/weberxks/Screen%20Shot%202022-03-14%20at%2016.25.03.png
    - do: проскроллить страницу ниже 5 новости
    - assert: |
        после пятой новости отображается рекламный блок, который отделен от новости отступами сверху и снизу,
        все карточки загружаются сразу и не дублируются
    - do: поскроллить страницу вниз
    - assert: |
        следующая рекламная карточка отображается через 5 новостей от первого рекламного блока,
        последующие рекламные блоки отображаются после каждой шестой новости

  содержит сюжеты, документы по запросу и рекламу в результатах выдачи [manual]:
    - tags:
        - news_granny
        - backend_news
        - smoke_zen
    - do: в поисковой строке ввести "котики" и кликнуть "Найти"
    - assert: |
          происходит переход на страницу поиска по новостям,
          домен поисковой страницы https://newssearch.yandex.ru/news,
          присутствует шапка новостей, общепортальный рубрикатор,
          ниже отображается выдача по поисковому запросу,
          под рубрикатором отображается реклама,
          под рекламой отображается блок с фильтрами "За все время", "Сегодня", "3 дня", "Неделя", "Период",
          в блоке фильтров присутствует 2 вкладки "Релевантность" и "Хронология",
          в поиске могут встречаться карточки сюжетов и карточки документов,
          карточка документа содержит иконку источника, заголовок, аннотацию, название источника и время обновления,
          карточка сюжета содержит заголовок, название источника и время обновления,
          ниже отображается документ (или несколько) по сюжету и ссылка "Посмотреть еще",
          подсвечиваются совпадения по словам в заголовках и аннотациях,
          внешний вид - https://jing.yandex-team.ru/files/weberxks/Screen%20Shot%202022-03-14%20at%2018.00.46.png
    - do: поскроллить страницу до кнопки "Больше результатов"
    - do: нажать на кнопку "Больше результатов"
    - assert: |
          загружается вторая страница выдачи,
          страница отделена от первой номером и разделителем

  позволяет открыть окно настройки избранных источников [manual]:
    - tags:
        - news_granny
        - backend_news
    - do: зайти на сервис без авторизации
    - do: перейти по ссылке https://yandex.ru/news?favid=1048
    - assert: |
        раскрылось модальное окно с предложением авторизации для добавления источника в избранные,
        внешний вид https://jing.yandex-team.ru/files/kossakovskaya/2021-09-08_14-23-06.png
    - do: нажать на кнопку Войти и авторизоваться на сервисе
    - assert: |
          после авторизации автоматически раскрывается модальное окно с предложением добавления источника в избранные,
          внешний вид https://jing.yandex-team.ru/files/kossakovskaya/2021-09-08_14-21-00.png
    - do: нажать по кнопке Добавить источник
    - assert:
        появилась надпись - '«Коммерсантъ» в избранном'
        отображаются кнопки "Готово" и "Настроить другие источники"
    - do: тапнуть по кнопке "Настроить другие источники"
    - assert: открылось модальное окно настройки источников https://jing.yandex-team.ru/files/weberxks/Screen%20Shot%202022-03-14%20at%2018.21.47.png

  должен содержать ссылки на источник в сюжете [manual]:
    - tags:
      - news_granny
      - backend_news
      - smoke_zen
    - do: открыть выдачу сервиса на странице рубрики "Главное" в авторизованном состоянии
    - do: перейти в любой неспортивный сюжет кликом по заголовку в новостной карточке
    - assert: |
        в той же вкладке открылся сюжет,
        на странице сюжета отображается заголовок с источником над ним,
        присутствует суммаризация в сюжете, соответствующая заголовку,
        сюжет может содержать медиаблок с фото и/или видео,
        ниже находится блок "Подробнее о событии", он скроллится горизонтально, у каждой новости в блоке присутствует название и иконка источника
        далее расположен социальный блок с иконками "Оценить", иконкой "Поделиться" и настройкой-троеточием с выпадающим меню
    - do: кликнуть на название источника над заголовком
    - assert: |
        в новой вкладке открывается новость от источника
    - do: вернуться на страницу сюжета Яндекс.Новости
    - do: кликнуть на заголовок сюжета
    - assert: |
        в новой вкладке открывается та же новость от источника

  архивный сюжет отображается корректно [manual]:
    - tags:
      - news_granny
      - backend_news
      - smoke_zen
    - do: открыть архивный сюжет (например, https://yandex.ru/news/story/a--a84a4edbf9cae6a9cd7ea71b63883423 )
    - assert: |
        сюжет отображается корректно,
        присутствуют заголовок, аннотация сюжета и ссылка В источнике
        над заголовком присутствует источник,
        фото в архивном сюжете не содержат ссылки на источник,
        присутствует иконка поделения и три точки с выпадающим меню,
        внешний вид - https://jing.yandex-team.ru/files/weberxks/Screen%20Shot%202022-03-14%20at%2018.26.56.png

  содержит рекламный блок при проскролле под траурным сюжетом [manual]:
      - tags:
        - news_granny
        - backend_news
        - smoke_zen
      - do: открыть выдачу сервиса на странице рубрики 'Происшествия'
      - assert: на странице сюжета нет рекламного блока под рубрикатором
      - do: перейти в любой сюжет в рубрике 'Происшествия'
      - do: проскроллить страницу ниже блока 'Подробнее о событии'
      - assert: |
          под сюжетом появляется рекламный блок при проскролле первых карточек в ленте под сюжетом
      - do: поскроллить страницу вниз
      - assert: |
            в ленте под трагичным сюжетом есть рекламные карточки,
            все рекламные карточки содержат рекламу (нет незагружающихся рекламных блоков с лоадером),
            могут встречаться рекламные карточки с надписью "Рекламы нет", но они должны быть единичными

  содержит карточку темы с заголовком и аннотацией [manual]:
      - tags:
        - news_granny
        - backend_news
        - smoke_zen
      - do: перейти на страницу темы по ссылке https://yandex.ru/news/theme/Covid--522
      - assert: |
          отображается карточка темы,
          карточка содержит заголовок, аннотацию, ссылку 'Читать дальше',
          список источников с названиями и иконками,
          внешний вид - https://jing.yandex-team.ru/files/weberxks/Screen%20Shot%202022-03-14%20at%2018.43.42.png
      - do: нажать на ссылку 'Читать дальше'
      - assert: |
          аннотация раскрылась полностью,
          в конце аннотации отображается источник,
          внешний вид - https://jing.yandex-team.ru/files/weberxks/Screen%20Shot%202022-03-14%20at%2018.43.00.png
 
files: []

qa-engineer: weberxks

tlds:
  - ru
