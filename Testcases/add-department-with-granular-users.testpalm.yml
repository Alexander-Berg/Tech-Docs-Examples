feature: Добавление в команду

specs:
  beforeEach:
    - tech: залогиниться под пользователем robot-internal-003
    - do: открыть страницу сервиса "autotest-add-departments" (/services/autotest-add-departments)
    - do: нажать на плюс рядом с надписью "Команда"
    - assert: появилась форма "Добавление новых участников"

  Положительные:
    1. Добавление нового департамента с участниками с ограниченными правами (бессрочное):
      - do: в поле ввода "Добавить сотрудника или департамент" ввести "роботы внутренних"
      - assert: под полем ввода появился выпадающий список с вариантом "Роботы внутренних сервисов"
      - do: кликнуть по варианту "Роботы внутренних сервисов"
      - assert: |
              в форме появился блок "Роли (1)"
              есть подсказка "У некоторых выбранных сотрудников ограничены права в системе «ABC для внешних пользователей». Они получат доступ к информации об этом и других сервисах, которая сейчас им недоступна."
              рубильник срока по умолчанию имеет значение "Бессрочно"
              указан департамент "Роботы внутренних сервисов"
              роль для группы по умолчанию не выбрана
      - screenshot: форма добавления департамента с участниками с ограниченными правами [add-department-form]
      - do: кликнуть в поле "Выберите роль для группы"
      - assert: появился выпадающий список со сгруппированными ролями
      - do: выбрать из выпадающего списка ролей роль "Аналитик" 
      - assert: |
              выпадающий список с ролями скрылся 
              в поле "Выберите роль для группы" подставилось значение "Аналитик"
      - do: нажать кнопку "Добавить"
      - assert: |
              форма добавления ролей исчезла
              появилась плашка "Запрошены роли" с добавленным департаментом "Департамент / Роботы внутренних сервисов"
      - do: (PREPARE) обновить страницу
      - assert: (PREPARE) появилась кнопка "Роботы внутренних сервисов" с количеством участников в скобках
      - do: (PREPARE) кликнуть на иконку корзины рядом с кнопкой
      - assert: (PREAPRE) роль перешла в состояние "Отзывается"

files:
  - test/features/desktop/roles/add-department-with-granular-users.hermione.js

priority: blocker

tags:
  - reviewed
  - no_assessors
