feature: Страница турнира

specs-integration:
  должна открываться:
    - do: открыть страницу футбольного турнира https://yandex.ru/sport/competition/3277
    - assert: |
        страница открылась,
        на странице есть таблица турнира и видеокарусель

  подгружает новостные карточки с рекламными блоками при скролле:
    - do: открыть страницу любой турнирной таблицы, например КХЛ https://yandex.ru/sport/competition/3279
    - do: поскроллить страницу на несколько экранов вниз
    - assert: |
        каждый раз рисуется желтый спиннер и загружается новая порция новостных карточек,
        лента содержит карточки рекламы

  позволяет перейти к календарю и обратно:
    - do: открыть страницу футбольного турнира https://yandex.ru/sport/competition/3279
    - assert: выделена вкладка 'Общее'
    - do: тапнуть на вкладку 'Календарь'
    - assert: |
        открывается вкладка 'Календарь' https://jing.yandex-team.ru/files/kossakovskaya/2021-02-24_20-38-22.png,
        вкладка 'Общее' больше не выделена, выделена вкладка 'Календарь',
        страница содержит селекты месяца и команды,
        по умолчанию в селектах отображаются 'Все команды',
        в селекте месяца - текущий для текущего турнира, последний - для завершившегося; первый - для неначавшегося
        на странице отображаются сгруппированные по дате матчи
    - do: тапнуть на вкладку 'Общее'
    - assert: |
        открывается турнирная таблица, нет бесконечного лоадера на месте таблицы,
        вкладка 'Календарь' больше не выделена, выделена вкладка 'Общее'

  в календаре подгружает матчи по селектам и кнопке Показать еще:
    - do: открыть страницу турнира https://yandex.ru/sport/competition/3275
    - do: тапнуть на вкладку 'Календарь'
    - assert: |
        открывается вкладка 'Календарь' https://jing.yandex-team.ru/files/kossakovskaya/2021-02-24_20-38-22.png,
        вкладка 'Общее' больше не выделена, выделена вкладка 'Календарь',
        страница содержит селекты месяца и команды,
        по умолчанию в селектах отображаются 'Все команды',
        в селекте месяца - текущий для текущего турнира, последний - для завершившегося; первый - для неначавшегося
        на странице отображаются сгруппированные по дате матчи
    - do: тапнуть на селект месяца
    - assert: |
        появляется меню со списком месяцев,
        выбранный месяц отмечен, остальные не отмечены
    - do: тапнуть на пункт "Февраль, 2020"
    - assert: |
        календарь обновляется,
        в календаре указаны все матчи за выбранный месяц
    - do: тапнуть на селект команды
    - assert: |
        появляется меню со списком команд,
        выбранная команда отмечена, остальные не отмечены
    - do: тапнуть на пункт "Бавария"
    - assert: |
        календарь обновляется,
        в календаре указаны матчи Баварии за выбранный месяц
    - do: тапнуть на кнопку Показать еще
    - assert: |
        календарь обновляется,
        в календаре добавляются матчи Баварии за следующий месяц
    # дополнительный обход запросами (такой сценарий проверки использовался при разработке и выявлял последствия багов)
    - do: тапнуть на пункт "Сентябрь, 2019"
    - assert: |
        календарь обновляется,
        в календаре указаны матчи Баварии за выбранный месяц
    - do: тапнуть на кнопку Показать еще
    - assert: |
        календарь обновляется,
        в календаре добавляются матчи Баварии за следующий месяц

  в календаре показывает заглушку при отсутствии матчей:
    - do: открыть страницу турнира https://yandex.ru/sport/competition/3275
    - do: тапнуть на вкладку 'Календарь'
    - assert: |
        открывается вкладка 'Календарь' https://jing.yandex-team.ru/files/kossakovskaya/2021-02-24_20-38-22.png,
        вкладка 'Общее' больше не выделена, выделена вкладка 'Календарь',
        страница содержит селекты месяца и команды,
        по умолчанию в селектах отображаются 'Все команды',
        в селекте месяца - текущий для текущего турнира, последний - для завершившегося; первый - для неначавшегося
        на странице отображаются сгруппированные по дате матчи
    - do: тапнуть на селект команды
    - assert: |
        галочка в названии селекта переворачивается вверх,
        появляется выпадающее меню со списком команд,
        выбранная команда отмечена галочкой, остальные команды без галочки
    - do: тапнуть на пункт "АИК"
    - assert: |
        календарь обновляется,
        в календаре отображается заглушка Событий не найдено

  содержит сюжеты новостей:
    - do: проскролить страницу ниже списка групп
    - assert: отображается блок "Новости"
    - do: проскролить страницу еще ниже
    - assert: |
          среди сюжетов попадаются карточки рекламы

  может содержать выпадашку с датами турнира:
    - do: тапнуть по дате турнира (если справа от даты нет стрелочки вниз - открыть другой турнир)
    - assert: открылся список годов, в которых проводился турнир
    - do: тапнуть на самую последнюю дату
    - assert: |
          открылась страница турнира за выбранную дату
          страница турнира содержит наименование турнира, дату, табы "Общее" и "Календарь" и список групп (если нет табов, откройте другой турнир с ними, например, https://yandex.ru/sport/competition/4277)

  позволяет переключать конференции:
    - do: открыть страницу турнирной таблицы НХЛ https://yandex.ru/sport/competition/3547
    - do: переключиться на несколько других табов конференций
    - assert: |
        каждый раз выделяется нужный таб,
        отображается турнирная таблица для данной конференции

specs:
  aliases:
    &goTo
      - do: открыть главную страницу сервиса Я.Спорт
      - do: тапнуть на Матч-центр в рубрикаторе
      - assert: |
          произошел переход в матч-центр,
          в рубрикаторе выделена рубрика Матч-центр,
          в подрубрикаторе выделена вкладка Футбол и открыт футбольный календарь на вкладке Сегодня,
          в календаре присутствует дата-пикер https://jing.yandex-team.ru/files/nightsonne/2020-04-13_19-17-24.png ,
          обратите внимание! если матчей за какой-то день нет (за вчера/сегодня/завтра) - будет выделена другая вкладка, на которой матчи есть. например, если нет матчей за "Сегодня", будет выделена вкладка "Завтра" или "Вчера", в зависимости от того, когда есть матчи. если мачтей нет ни за один день - не будет выделена ни одна вкладка и будет отображена заглушка о том, что событий не найдено. это ок! заводить на такое баги не нужно!
      - do: тапнуть по наименованию турнира https://jing.yandex-team.ru/files/kossakovskaya/2021-02-24_20-21-33.png
      - assert: |
          произошел переход на страницу турнира,
          страница турнира содержит наименование турнира, дату, табы "Общее" и "Календарь" и список групп (если нет табов, откройте другой турнир с ними, например, https://yandex.ru/sport/competition/4277)
          общий вид страницы https://jing.yandex-team.ru/files/kossakovskaya/2021-02-24_20-22-24.png

  содержит таблицу для каждой группы:
    - *goTo
    - do: проскролить страницу до любой группы
    - do: проскролить страницу горизонтально
    - assert:
          таблица скролится и отображается корректно
          длинные наименования столбцов сокращены до точки (например, "Выигр.", "Проиг.")
          длинные наименования команд заменены троеточием

  содержит таблицу для каждой группы в альбомной ориентации:
    - *goTo
    - do: повернуть телефон в альбомный режим
    - assert: |
          страница отображается корректно
          таблица скролится и отображается без артефактов
          длинные наименования столбцов сокращены до точки (например, "Выигр.", "Проигр.")
          длинные наименования команд заменены троеточием

  содержит список матчей в разделе Календарь:
    - *goTo
    - do: тапнуть на вкладку "Календарь" в футбольном турнире (если нет таба, откройте другой турнир с этим табом, например, https://yandex.ru/sport/competition/4277)
    - assert: |
          отобразились выпадушки с датой и списком команд
          отобразился список матчей за определенную дату
          под списком команд отображается карусель "Последние видео"
          пример страницы - https://jing.yandex-team.ru/files/kossakovskaya/2021-02-24_20-38-22.png
    - do: тапнуть на выпадушку даты и выбрать любую дату
    - assert: |
          отобразился список мачтей за выбранный месяц-год
    - do: проскролить страницу до конца списка матчей и нажать "Показать еще"
    - assert: |
          подгрузилась еще пачка матчей

  может содержать карусель видео:
    - do: открыть страницу любой турнирной таблицы с видеокаруселью, например КХЛ https://yandex.ru/sport/competition/3551
    - assert: |
          открыта страница турнирной таблицы,
          по умолчанию открыта вкладка 'Общее',
          под турнирной таблицей может располагаться карусель с видео (если нет - открыть другой турнир, в двух турнирах не нашлась карусель - можно скипнуть кейс),
          каждое видео содержит название матча (может под названием матча содержать название лиги)
    - do: поскроллить карусель видео в горизонтальном направлении
    - assert: карточки скроллятся вправо-влево
    - do: тапнуть на любое видео
    - assert: |
          в новой вкладке открывается источник видео (video.khl.ru или другие источники),
          видео соответствует превью в карусели

  может содержать конференции:
    - do: открыть страницу турнирной таблицы НХЛ https://yandex.ru/sport/competition/3547
    - assert: |
        открыта страница турнирной таблицы,
        по умолчанию открыта вкладка "Общее",
        на вкладке есть табы конференций, по умолчанию выбрана первая вкладка https://jing.yandex-team.ru/files/nightsonne/2020-04-09_18-01-41.png

files:
  - features/sport/competition/competition.phone.hermione.e2e.js
  - features/sport/competition/competition.phone.hermione.js

tags:
  - sport-neo

manager: mrwhite

qa-engineer: kossakovskaya

tlds:
  - ru
  - by
  - kz
  - uz
  - ua
  - com
