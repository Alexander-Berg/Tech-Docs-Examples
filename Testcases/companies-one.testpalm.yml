feature: Колдунщик 1орг (конструктор)

specs:
  Метка дистанции на карте:
    - do: выставить настройку геолокации в браузере «при использовании» (Инструкция https://yandex.ru/support/common/browsers-settings/geolocation.html)
    - do: внизу в настройках местоположения поисковой страницы выбрать "Определять автоматически"
    - do: осуществить поиск популярного заведения в вашем регионе
    - assert: на странице появился колдунщик 1org
    - screenshot: пример внешнего вида [plain]
  Внешний вид (мало данных):
    - do: получить выдачу Поиска по запросу 'кафе империя пинск'
    - tags:
        - no_assessors
    - assert: |
        на странице появился колдунщик организации,
        в колдунщике отсутствует фото организации, отзывы, рейтинг, сайт и описание заведения
    - screenshot: пример внешнего вида [one-org-without-rating-and-descr]
  Внешний вид:
    - tags:
        - smoke
        - pp_new_core
    - label: companies-one-{{BROWSER_TYPE}}
    - do: получить выдачу по запросу 'европолис санкт-петербург' _ALTERNATIVE_SEARCH_QUERIES_
    - assert: на выдаче есть карточка организации
    - do: кликнуть в таб 'Главное'
    - assert: открылся сайдблок с расширенной карточкой организации
    - screenshot: пример внешнего вида [plain]
  Кнопка "Позвонить":
    - tags:
        - button
        - no_assessors
    - do: получить выдачу Поиска по запросу 'ква ква парк' _ALTERNATIVE_SEARCH_QUERIES_
    - assert: на странице появляется колдунщик 1org
    - tech: проверить счетчик на кнопке 'Вызов'
    - tech: target кнопки 'Вызов' равен '_blank'
    - tech: href кнопки 'Вызов' имеет вид tel:номер_телефона
    - assertMetrics: '*'
  Соцсети:
    - tags:
        - pp_new_core
    - do: получить выдачу Поиска по запросу 'московский зоопарк' _ALTERNATIVE_SEARCH_QUERIES_
    - assert: на странице появляется колдунщик 1org c блоком соцсетей
    - assert: ссылка на первом элементе в блоке соцсетей ведет на правильную страницу Московского зоопарка в соцсети
    - tech: проверить счетчик на первом элементе в списке соцсетей
    - assertMetrics: '*'
  Закрытие всех оверлеев при клике на крестик:
    - tags:
        - button
        - showcase
        - ajax
        - overlay
        - pp_new_core
    - do: получить выдачу Поиска по запросу 'питерлэнд' _ALTERNATIVE_SEARCH_QUERIES_
    - assert: на странице появляется колдунщик 1org
    - do: тапнуть по первой тумбе в разделе колдунщика 'Похожие места'
    - assert: появляется сайдблок с расширенной карточкой объекта (по содержимому похоже на колдунщик 1org)
    - do: тапнуть по кнопке 'Назад' (наверху слева)
    - assert: сайдблок закрылся
    - assertMetrics: '*'
  Проверяем кнопку расхлопа:
    - tags:
        - maps
        - ajax
        - overlay
        - pp_new_core
    - do: получить выдачу Поиска по запросу 'кафе пушкин' _ALTERNATIVE_SEARCH_QUERIES_
    - assert: на странице появляется колдунщик 1org
    - do: тапнуть по кнопке в верхнем правом углу превью карты в колдунщике
    - assert: появляется сайдблок с картой и минибейджем организации
    - tech: должен сработать динамический счетчик
    - assertMetrics: '*'
  Маршрутный попап после перезапроса:
    - browsers:
        notFor:
          - searchapp-phone
    - do: получить выдачу Поиска по запросу 'кафе пушкин' _ALTERNATIVE_SEARCH_QUERIES_
    - assert: |
        на странице появился колдунщик 1org,
        в колдунщике 1org есть кнопка 'маршрут'
    - do: перезапросить выдачу с запросом 'кафе турандот москва'
    - assert: |
        на странице появился колдунщик 1org,
        в колдунщике 1org есть кнопка 'маршрут'
    - do: кликнуть по кнопке 'маршрут'
    - assert: открылся оверлей с маршрутом или форма с заполненным "куда" и пустым "откуда", если выключена геолокация
    - assertMetrics: '*'

files:
  - features/touch-phone/companies/companies-one.hermione.js

v-team: VanillaGeo

counter: /snippet/companies/company/object-badge/map

tags:
  - smoke_extended
  - skip_e2e_check

tlds: all

priority: high
