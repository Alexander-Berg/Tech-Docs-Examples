feature: Опечаточник
type: Исправлена опечатка

specs:
  Переходы по истории браузера:
    - browsers:
        notFor:
          - searchapp-phone
          - searchapp-phone-group
    - tags: smoke
    - do: получить выдачу по запросу "вилосипед"
    - screenshot: внешний вид [reask]
    - assert: получена выдача по запросу "велосипед"
    - assert: под поисковой стрелкой присутствует "сообщение Исправлена опечатка «вилосипед»" и кнопка "Отменить"
    - do: кликнуть в кнопку "Отменить"
    - assert: получена выдача по запросу "вилосипед"
    - assert: опечаточник скрылся
    - tech: сработал счетчик '/$page/$main/misspell/type_misspell/correct[@pos="top"]'
    - do: вернуться к предыдущей выдаче
    - assert: опечаточник отображается
    - assertMetrics: '*'
  Переходы по истории браузера ПП:
    - browsers:
        - searchapp-phone
    - tags: 
      - smoke
      - pp_new_core
    - priority: high
    - do: получить выдачу по запросу "вилосипед"
    - label: misspell_type_reask-{{SET_NAME}}
    - screenshot: внешний вид [reask-seachapp-phone]
    - assert: получена выдача по запросу "велосипед"
    - assert: под поисковой стрелкой присутствует "сообщение Исправлена опечатка «вилосипед»" и кнопка "Отменить"
    - do: кликнуть в кнопку "Отменить"
    - assert: получена выдача по запросу "вилосипед"
    - assert: опечаточник скрылся
    - tech: сработал счетчик '/$page/$main/misspell/type_misspell/correct[@pos="top"]'
    - assertMetrics: '*'

  Интеграционная проверка длинной опечатки и турбо-страницы:
    - browsers:
        - ios-yandex-browser-17-touch
        - android-yandex-browser-17-touch
    - do: получить выдачу по запросу "сколькл остадось дирломатов"
    - assert: получена выдача по запросу "сколько осталось дипломатов"
    - assert: под поисковой стрелкой присутствует "Исправлена опечатка «сколькл остадось дирломатов»" и кнопка "Отменить"
    - do: нажать в минисниппет новости
    - assert: выбранная новость откроет турбо-слайдер (если не откроется турбо-слайдер, то нужно выбрать другой новостной сниппет)
    - do: нажать "Крестик" в турбо-странице
    - assert: сайд блок турбо страницы закрылся
    - assert: отображается исходная выдача по запросу "сколько осталось дипломатов"
    - assertMetrics: '*'
  Поиск по опечатке - сокращенный запрос:
    - params:
        foreverdata: '340180411'
    - do: получить выдачу по запросу "foreverdata"
    - assert: на странице присутствует сообщение "Исправлена опечатка в слове «сабаку»"
    - assert: справа от сообщения присутствует кнопка "Отменить"
    - assertMetrics: '-'

specs-integration:
  Обязательные проверки:
    - counter: /$page/$main/misspell/type_misspell/correct[@pos="top"]
    - do: получить выдачу по запросу "купить сабаку"
    - assert: на выдаче присутствует опечаточник с сообщением "Исправлена опечатка в слове «сабаку»"
    - assert: справа от сообщения присутствует кнопка "Отменить"
    - do: нажать кнопку "Отменить"
    - assert: выдача обновлена
    - assert: на выдаче отсутствует сообщение "Исправлена опечатка в слове «сабаку»"
    - assert: в url'e страницы в адресной строке присутствует параметр &noreask=1 (отсутствуют в ПП, это не является ошибкой)
    - tech: сработал счетчик '/$page/$main/misspell/type_misspell/correct[@pos="top"]'

files:
  - features/touch-phone/misspell/misspell_type_reask.hermione.js
  - features/touch-phone/misspell/misspell_type_reask.hermione.e2e.js

v-team: Freshness

tags:
  - reviewed

counter: /$page/$main/misspell/type_misspell/correct[@pos="top"]

tlds:
  - ru
  - by
  - kz
  - uz
  - ua
