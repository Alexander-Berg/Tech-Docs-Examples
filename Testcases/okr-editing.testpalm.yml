feature: Редактирование ОКР цели

specs:
  beforeEach:
    - do: Залогиниться под собственной учетной записью yandex-team
  Положительные:
    1. Редактирование VS:
      - automation: GOALS-715
      - do: Перейти на страницу "/okr?importance=all&periods=2020Q4%2C2021Q1&statuses=5%2C0%2C1%2C2%2C435%2C433%2C434%2C432%2C0%2C1%2C2%2C173&selectedItem=6&goal=6"
      - assert: Открылась страница Value stream
      - screenshot: Внешний вид страницы VS [todo plain-vs]
      - do: Кликнуть на кнопку "Редактировать цель"
      - assert: Открылась карточка редактирования Value stream
      - do: Ввести в поле "Название" значение "ValueStream"
      - do: Очистить поле "Ответственный", нажав на крестик в правой части поля
      - do: Ввести в поле "Ответственный" значение "zomb-prj-204", выбрать в саджесте The Kitty
      - do: Ввести в поле "Заказчики" значение "user3370", выбрать в саджесте Оксана Мидори
      - do: Ввести в поле "Заказчики" значение "user3993", выбрать в саджесте Марат Январев
      - do: Ввести в поле "В главных ролях" значение "user3993", выбрать в саджесте Марат Январев
      - do: Ввести в поле "В главных ролях" значение "zomb-prj-204", выбрать в саджесте The Kitty
      - do: Ввести в поле "Сервис в ABC" значение "goal", выбрать в саджесте Яндекс.Мастер
      - do: Ввести в поле "Описание" значение "Описание ValueStream"
      - do: Ввести в поле "Теги" значения "tag1", "tag2", "tag3"
      - do: Поставить курсор в поле "Теги", нажать Backspace
      - do: Нажать на кнопку "Сохранить"
      - assert: |
          - Карточка редактирования цели закрылась, открылась карточка Value stream
          - Название - ValueStream
          - Ответственный - The Kitty
          - Заказчики - Оксана Мидори, Марат Январев
          - В главных ролях - Марат Январев, The Kitty
          - Описание - Описание ValueStream
          - Теги - tag1, tag2
      - screenshot: Внешний вид страницы измененного Value stream [todo changed-vs]
      - do: Кликнуть на кнопку "Редактировать цель"
      - assert: Открылась карточка редактирования Value stream
      - do: Очистить поля "Заказчики", "В главных ролях", "Сервис в ABC", "Описание", "Теги"
      - assert: Поля очистились
      - do: Нажать на кнопку "Сохранить"
      - assert: |
          - Карточка редактирования цели закрылась, открылась страница Value stream
          - "В главных ролях" не отображается на карточке цели
          - "Заказчики" не отображается на карточке цели
          - "В главных ролях" не отображается на карточке цели
          - Вместо описания отображается серый текст курсивом "Описание"
          - "Теги" не отображаются на карточке цели
      - screenshot: Внешний вид страницы очищенного Value stream [todo empty-vs]

    2. Редактирование UMB:
      - automation: GOALS-715
      - do: Перейти на страницу "/okr?importance=all&periods=2020Q4%2C2021Q1&statuses=5%2C0%2C1%2C2%2C435%2C433%2C434%2C432%2C0%2C1%2C2%2C173&selectedItem=6&goal=8"
      - assert: Открылась страница Зонтика
      - screenshot: Внешний вид страницы Зонтика [todo plain-umb]
      - do: Кликнуть на кнопку "Редактировать цель"
      - assert: Открылась карточка редактирования Зонтика
      - do: Ввести в поле "Название" значение "UMBRELLA"
      - do: Очистить поле "Ответственный", нажав на крестик в правой части поля
      - do: Ввести в поле "Ответственный" значение "zomb-prj-204", выбрать в саджесте The Kitty
      - do: Ввести в поле "Заказчики" значение "user3370", выбрать в саджесте Оксана Мидори
      - do: Ввести в поле "Заказчики" значение "user3993", выбрать в саджесте Марат Январев
      - do: Ввести в поле "В главных ролях" значение "user3993", выбрать в саджесте Марат Январев
      - do: Ввести в поле "В главных ролях" значение "zomb-prj-204", выбрать в саджесте The Kitty
      - do: В поле "VS (Value stream)" ввести "vs 2", выбрать в саджесте "VS 2"
      - do: В поле "Тип занятости" выбрать значения "i4i", "run"
      - do: В поле "Сценарий" выбрать значение "90"
      - do: Ввести в поле "HeadCount" значение "14,3"
      - do: Ввести в поле "Чего хотим добиться (Objective)" значение "Objective"
      - do: Из списка "Key Result" удалить пункт "KR2"
      - do: Добавить в список "Key Result" пункт "KR3"
      - do: Ввести в поле "Описание" значение "Описание UMBRELLA"
      - do: Ввести в поле "Теги" значение "tag1", нажать Enter
      - do: Ввести в поле "Теги" значение "tag2", нажать Enter
      - do: Ввести в поле "Теги" значение "tag3", нажать Enter
      - do: Поставить курсор в поле "Теги", нажать Backspace
      - do: Нажать на кнопку "Сохранить"
      - assert: |
          - Карточка редактирования цели закрылась, открылась карточка Зонтика
          - Название - UMBRELLA
          - Ответственный - The Kitty
          - Заказчики - Оксана Мидори, Марат Январев
          - В главных ролях - Марат Январев, The Kitty
          - Под заголовком "Основная информация" отображаются баджи "Хедкаунт: 14.3", "Сценарий: 90", "i4i", "run"
          - Чего хотим добиться (Objective) - Objective
          - Key Result - KR1, KR2
          - Описание - Описание UMBRELLA
          - Теги - tag1, tag2
          - В хлебных крошках над названием отображается "VS 2"
      - screenshot: Внешний вид страницы измененного Зонтика [todo changed-umb]
      - do: Кликнуть на кнопку "Редактировать цель"
      - assert: Открылась карточка редактирования Зонтика
      - do: Очистить поля "Заказчики", "В главных ролях", "Описание", "VS (Value stream)", "Тип занятости", "HeadCount для реализации", "Чего хотим добиться (Objective)", "Теги"
      - do: В поле "Сценарий" выбрать значение "-"
      - do: Удалить все элементы в блоке "Как определить успешность (Key Result)"
      - do: Нажать на кнопку "Сохранить"
      - assert: |
          - Карточка редактирования цели закрылась, открылась страница Зонтика
          - "В главных ролях" не отображается на карточке цели
          - "Заказчики" не отображается на карточке цели
          - "В главных ролях" не отображается на карточке цели
          - Вместо описания отображается серый текст курсивом "Описание"
          - "Теги" не отображаются на карточке цели
          - Под заголовком "Основная информация" нет баджей
          - Нет блока "Key Result"
          - Нет блока "Чего хотим добиться (Objective)"
          - Нет хлебных крошек над названием Зонтика
      - screenshot: Внешний вид страницы очищенного Зонтика [todo empty-umb]

    3. Редактирование OUTLINE:
      - automation: GOALS-715
      - do: Перейти на страницу "/okr?importance=all&periods=2020Q4%2C2021Q1&statuses=5%2C0%2C1%2C2%2C435%2C433%2C434%2C432%2C0%2C1%2C2%2C173&selectedItem=6&goal=10"
      - assert: Открылась страница Контура
      - screenshot: Внешний вид страницы Контура [todo plain-outline]
      - do: Кликнуть на кнопку "Редактировать цель"
      - assert: Открылась карточка редактирования Контура
      - do: Ввести в поле "Название" значение "контур"
      - do: Очистить поле "Ответственный", нажав на крестик в правой части поля
      - do: Ввести в поле "Ответственный" значение "zomb-prj-204", выбрать в саджесте The Kitty
      - do: Ввести в поле "Заказчики" значение "user3370", выбрать в саджесте Оксана Мидори
      - do: Ввести в поле "Заказчики" значение "user3993", выбрать в саджесте Марат Январев
      - do: Ввести в поле "В главных ролях" значение "user3993", выбрать в саджесте Марат Январев
      - do: Ввести в поле "В главных ролях" значение "zomb-prj-204", выбрать в саджесте The Kitty
      - do: В поле "Зонтик" ввести "umb 1", выбрать в саджесте "UMB 1"
      - do: В поле "Тип занятости" выбрать значения "i4i", "run"
      - do: В поле "Сценарий" выбрать значение "90"
      - do: Ввести в поле "HeadCount" значение "14,3"
      - do: Ввести в поле "Чего хотим добиться (Objective)" значение "Objective"
      - do: Из списка "Key Result" удалить пункт "KR2"
      - do: Добавить в список "Key Result" пункт "KR3"
      - do: Ввести в поле "Описание" значение "Описание OUTLINE"
      - do: Ввести в поле "Теги" значения "tag1", "tag2", "tag3"
      - do: Поставить курсор в поле "Теги", нажать Backspace
      - do: Нажать на кнопку "Сохранить"
      - assert: |
          - Карточка редактирования цели закрылась, открылась карточка Контура
          - Название - контур
          - Ответственный - The Kitty
          - Заказчики - Оксана Мидори, Марат Январев
          - В главных ролях - Марат Январев, The Kitty
          - Под заголовком "Основная информация" отображаются баджи "Хедкаунт: 14.3", "Сценарий: 90", "i4i", "run"
          - Чего хотим добиться (Objective) - Objective
          - Key Result - KR1, KR2
          - Описание - Описание OUTLINE
          - Теги - tag1, tag2
          - В хлебных крошках над названием отображается "VS 1 / UMB 1"
      - screenshot: Внешний вид страницы измененного Контура [todo changed-outline]
      - do: Кликнуть на кнопку "Редактировать цель"
      - assert: Открылась карточка редактирования Контура
      - do: Очистить поля "Заказчики", "В главных ролях", "Описание", "Зонтик", "Тип занятости"
      - assert: Поля очистились
      - do: В поле "Сценарий" выбрать значение "-"
      - do: Очистить поле "HeadCount для реализации"
      - do: Очистить поле "Чего хотим добиться (Objective)"
      - do: Удалить все элементы в блоке "Как определить успешность (Key Result)"
      - do: Очистить поле "Теги"
      - do: Нажать на кнопку "Сохранить"
      - assert: |
          - Карточка редактирования цели закрылась, открылась страница Контура
          - "В главных ролях" не отображается на карточке цели
          - "Заказчики" не отображается на карточке цели
          - "В главных ролях" не отображается на карточке цели
          - Вместо описания отображается серый текст курсивом "Описание"
          - "Теги" не отображаются на карточке цели
          - Под заголовком "Основная информация" нет баджей
          - Нет блока "Key Result"
          - Нет блока "Чего хотим добиться (Objective)"
      - screenshot: Внешний вид страницы очищенного Контура [todo empty-outline]

    4. Смена типа ОКР цели:
      - automation: GOALS-715
      - do: Перейти на страницу "/okr?importance=all&periods=2020Q4%2C2021Q1&statuses=5%2C0%2C1%2C2%2C435%2C433%2C434%2C432%2C0%2C1%2C2%2C173&selectedItem=9&goal=11"
      - assert: Открылась страница Value stream
      - do: Кликнуть на кнопку "Редактировать цель"
      - assert: Открылась карточка редактирования Value stream
      - do: Изменить значение поля "Структурный уровень Градиента" на "Зонтик"
      - assert: |
          - Исчезло поле "Сервис в ABC"
          - Появились поля "VS (Value stream)", "Тип занятости", "HeadCount для реализации", "Чего хотим добиться (Objective)", "Как определить успешность (Key Result)", "Сценарий"
      - do: Ввести в поле "HeadCount" значение "14,3"
      - do: Ввести в поле "Чего хотим добиться (Objective)" значение "Objective"
      - do: Нажать на кнопку "Сохранить"
      - assert: |
          - Карточка редактирования цели закрылась, открылась карточка Зонтика
          - Название - VS 3
          - Под заголовком "Основная информация" отображаются баджи "Хедкаунт: 14.3"
          - Чего хотим добиться (Objective) - Objective
      - screenshot: Внешний вид страницы Зонтика из VS [todo umb-from-vs]
      - do: Кликнуть на кнопку "Редактировать цель"
      - assert: Открылась карточка редактирования Зонтика
      - do: Изменить значение поля "Структурный уровень Градиента" на "VS (Value stream)"
      - assert: |
          - Появилось поле "Сервис в ABC"
          - Исчезли поля "VS (Value stream)", "Тип занятости", "HeadCount для реализации", "Чего хотим добиться (Objective)", "Как определить успешность (Key Result)", "Сценарий"
      - do: Нажать на кнопку "Сохранить"
      - assert: |
          - Карточка редактирования цели закрылась, открылась карточка Value stream
          - Название - VS 3
          - Под заголовком "Основная информация" нет баджей
          - Нет блока "Objective"
      - screenshot: Внешний вид страницы Value stream из Зонтика [todo vs-from-umb]

    5. Смена статуса ОКР цели:
      - automation: GOALS-715
      - do: Перейти на страницу "/okr?importance=all&periods=2020Q4%2C2021Q1&statuses=5%2C0%2C1%2C2%2C435%2C433%2C434%2C432%2C0%2C1%2C2%2C173&selectedItem=9&goal=11"
      - assert: Открылась страница Value stream
      - do: Кликнуть на кнопку "Редактировать цель"
      - assert: Открылась карточка редактирования Value stream
      - do: Изменить значение поля "Статус" на "Не делаем"
      - do: Нажать на кнопку "Сохранить"
      - assert: |
          - Карточка редактирования цели закрылась, открылась карточка Зонтика
          - Статус сменился на "Не делаем"
      - screenshot: Внешний вид страницы измененного статуса [todo vs-changed-status]
      - do: Кликнуть на кнопку "Редактировать цель"
      - assert: Открылась карточка редактирования Value stream
      - assert: В поле "Статус" возможные значения "Черновик", "Не делаем"
      - do: Изменить значение поля "Статус" на "Черновик"
      - do: Нажать на кнопку "Сохранить"
      - assert: |
          - Карточка редактирования цели закрылась, открылась карточка Зонтика
          - Статус сменился на "Черновик"

  Отрицательные:
    1. Уже добавленных людей нельзя добавить повторно:
      - automation: GOALS-715
      - do: Перейти на страницу "/okr?importance=all&periods=2020Q4%2C2021Q1&statuses=5%2C0%2C1%2C2%2C435%2C433%2C434%2C432%2C0%2C1%2C2%2C173&selectedItem=6&goal=6"
      - assert: Открылась страница Value stream
      - do: Кликнуть на кнопку "Редактировать цель"
      - assert: Открылась карточка редактирования Value stream
      - do: Ввести в поле "В главных ролях" значение "user3371", выбрать в саджесте Арнольд Снеговой
      - do: Ввести в поле "В главных ролях" значение "user3371"
      - assert: |
          - Саджест не появился
          - При нажатии на Enter ничего не меняется, пользователь в поле "В главных ролях" не дублируется

    2. Цель не сохраняется без названия:
      - automation: GOALS-715
      - do: Перейти на страницу "/okr?importance=all&periods=2020Q4%2C2021Q1&statuses=5%2C0%2C1%2C2%2C435%2C433%2C434%2C432%2C0%2C1%2C2%2C173&selectedItem=6&goal=6"
      - assert: Открылась страница Value stream
      - do: Кликнуть на кнопку "Редактировать цель"
      - assert: Открылась карточка редактирования Value stream
      - do: Очистить поле "Название"
      - do: Нажать на кнопку "Сохранить"
      - assert: |
          - Карточка редактирования не закрылась
          - Границы поля "Название" красные
          - Под полем "Название" отображено сообщение об ошибке "Обязательное поле"

    3. Цель не сохраняется без ответственного:
      - automation: GOALS-715
      - do: Перейти на страницу "/okr?importance=all&periods=2020Q4%2C2021Q1&statuses=5%2C0%2C1%2C2%2C435%2C433%2C434%2C432%2C0%2C1%2C2%2C173&selectedItem=6&goal=6"
      - assert: Открылась страница Value stream
      - do: Кликнуть на кнопку "Редактировать цель"
      - assert: Открылась карточка редактирования Value stream
      - do: Очистить поле "Ответственный"
      - do: Нажать на кнопку "Сохранить"
      - assert: |
          - Карточка редактирования не закрылась
          - Границы поля "Ответственный" красные



priority: blocker

tags:
  - reviewed
