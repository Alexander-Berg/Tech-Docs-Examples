feature: Явная смена контекста

aliases:
  - &auth_user_with_orgs
    - do: залогиниться пользователем, у которого больше одной организации
  - &auth_user_without_orgs
    - do: залогиниться пользователем, у которого нет организаций

specs:
  Положительные:
    1. Переключение контекста без переданной организации:
      - *auth_user_with_orgs
      - do: перейти на страницу "{{CONNECT_HOST}}/portal/context?silent=0&retpath=%2Fportal%2Fdownloads"
      - screenshot: внешний вид блока [plain]
      - do: нажать на переключатель организаций
      - assert: открылся выпадающий список организаций
      - screenshot: выпадающий список организаций [dropdown]
      - do: выбрать из списка не текущую организацию
      - do: нажать на кнопку "Перейти"
      - assert: выполнился переход на страницу "Скачайте приложения" {{CONNECT_HOST}}/portal/downloads
      - assert: организация сменилась на выбранную

    2. Отображение страницы c сервисом Трекер:
      - *auth_user_with_orgs
      - do: перейти на страницу "{{CONNECT_HOST}}/portal/context?silent=0&source=tracker"
      - screenshot: внешний вид страницы [plain]

    3. Переключение контекста с переданной организацией:
      - *auth_user_with_orgs
      - do: перейти на страницу "{{CONNECT_HOST}}/portal/context?silent=0&org_id={id организации пользователя}"
      - screenshot: внешний вид страницы [plain]
      - do: нажать на кнопку "Перейти"
      - assert: выполнился переход на страницу "Дашборда" {{CONNECT_HOST}}/portal/home
      - assert: организация сменилась на выбранную

    4. Отображение страницы для пользователя без организаций:
      - *auth_user_without_orgs
      - do: перейти на страницу "{{CONNECT_HOST}}/portal/context?silent=0"
      - screenshot: внешний вид страницы [plain]

files:
  - tests/hermione/suites/organization/context.js

priority: normal

tlds:
 - ru
 - com

tags:
  - regression
  - smoke_test
  - reviewed
  - smoke_test_mini
