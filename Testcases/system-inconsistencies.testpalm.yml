feature: Расхождения

specs:
  Отчёт по расхождениям системы. Различные фильтрации:
    - do: запустить в Runner сценарий "Система. Расхождения" (https://github.yandex-team.ru/pixel/idm-runner)
    - do: отправить запрос "Система. Расхождения. Дефолт" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: ответ на запрос "Система. Расхождения. Дефолт" должен содержать поля [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-04%2017-02-14.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Система. Расхождения. Все состояния" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: в ответе на запрос "Система. Расхождения. Все состояния" все поля "human_state" имеют значения из списка - "Создана", "Активна", "Совпадение", "Разрешена", "Устарела" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-04%2017-05-33.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Система. Расхождения. Фильтрация по типу" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: в ответе на запрос "Система. Расхождения. Фильтрация по типу" все поля "human_type" имеют значение "В системе есть роль, у нас – нет" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-04%2017-07-20.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"
    - do: отправить запрос "Система. Расхождения. Фильтрация по логину" с токеном "robot-cat-leopold"
    - assert: пришёл ответ со статусом "200"
    - screenshot: в ответе на запрос "Система. Расхождения. Фильтрация по логину" все поля "username" имеют значение "robot-internal-9" [https://jing.yandex-team.ru/files/pixel/Screenshot%20from%202021-02-04%2017-17-29.png]
    - do: кликнуть по табе "Test Results" в Response части postman UI
    - assert: на табе "Test Results" все тесты со статусом "PASS"

priority: normal

files:
  - idm/tests/api/frontend/test_inconsistency.py

tags:
  - reviewed
  - no_assessors
  - postman_automation
  - fitcher:idm-www:test/auto/07-inconsistencies/**
  - fitcher:idm-www:blocks/desktop/filters/**
  - fitcher:idm-www:blocks/desktop/table/**
  - fitcher:idm_backend_palmsync:idm/tests/api/frontend/test_inconsistency.py
  - fitcher:idm_backend_palmsync:idm/core/models/role.py
  - fitcher:idm_backend_palmsync:idm/inconsistencies/models.py
  - fitcher:idm_backend_palmsync:idm/tests/utils.py
