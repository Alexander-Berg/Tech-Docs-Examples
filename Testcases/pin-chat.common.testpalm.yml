feature: Закрепление чатов

specs:

    Приватный чат можно закрепить[manual]:
        - automation:
        - description: У авторизованного пользователя в списке чатов есть приватный чат
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по любому приватному чату
        - assert: Показывается контекстное меню этого чата
        - do: Выбрать "Закрепить чат"
        - assert: |
              Чат закрепляется
              Чат находится вверху и отделяется от других не закрепленных чатов разделительной линией

    Приватный чат можно открепить, если он был закреплен[manual]:
        - tags: [advanced_smoke]
        - automation:
        - description: У авторизованного пользователя в списке чатов есть приватный чат
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по любому приватному чату
        - assert: Показывается контекстное меню этого чата
        - do: Выбрать "Закрепить чат"
        - assert: |
              Чат закрепляется
              Чат находится вверху и отделяется от других не закрепленных чатов разделительной линией
        - do: Кликнуть ПКМ / нажать лонгтапом по приватному чату, который был только что закреплен
        - assert: Показывается контекстное меню этого чата
        - do: Нажать "Открепить чат"
        - assert: Чат откреплен и помещается в истории в зависимости от того, какое последнее сообщение было в нем

    Закрепленный чат закрепляется в верхней части списков:
        - tags: [advanced_smoke, b2b]
        - description: У авторизованного пользователя в списке чатов есть приватный чат и групповой чат
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по любому приватному или групповому чату А
        - assert: Показывается контекстное меню этого чата
        - do: Выбрать "Закрепить чат"
        - assert: |
              Чат закрепляется
              Чат находится вверху и отделяется от других не закрепленных чатов разделительной линией
        - do: Кликнуть ПКМ / нажать лонгтапом по любому не закрепленному приватному или групповому чату Б
        - assert: Показывается контекстное меню этого чата
        - do: Выбрать "Закрепить чат"
        - assert: |
              Чат закрепляется
              Под закрепленным чатом А располагается закрепленный чат Б
              Под закрепленным чатом Б распологается разделительная линия

    Групповой чат можно закрепить[manual]:
        - automation:
        - description: У авторизованного пользователя в списке чатов есть групповой чат
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по групповому чату
        - assert: Показывается контекстное меню этого чата
        - do: Выбрать "Закрепить чат"
        - assert: |
              Чат закрепляется
              Чат находится вверху и отделяется от других не закрепленных чатов разделительной линией

    Групповой чат можно открепить, если он был закреплен[manual]:
        - tags: [advanced_smoke]
        - automation:
        - description: У авторизованного пользователя в списке чатов есть групповой чат
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по любому групповому чату
        - assert: Показывается контекстное меню этого чата
        - do: Выбрать "Закрепить чат"
        - assert: |
              Чат закрепляется
              Чат находится вверху и отделяется от других не закрепленных чатов разделительной линией
        - do: Кликнуть ПКМ / нажать лонгтапом по групповому чату, который был только что закреплен
        - assert: Показывается контекстное меню этого чата
        - do: Нажать "Открепить чат"
        - assert: Чат откреплен и помещается в истории в зависимости от того, какое последнее сообщение было в нем

    При получении новых сообщений закрепленные чаты отображаются в порядке закрепления в верхней части списка чатов:
        - description: |
              У авторизованного пользователя в списке чатов должно быть минимум 3 чата - чат1, чат2, чат3
              Данные чаты не закреплены
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по чату1
        - assert: Показывается контекстное меню этого чата
        - do: Выбрать “Закрепить чат”
        - assert: Чат закреплен и от остальных отделен разделительной линией
        - do: Кликнуть ПКМ / нажать лонгтапом по чату2
        - assert: Появляется контекстное меню для этого чата
        - do: Выбрать “Закрепить чат”
        - assert: Чат закреплен и он размещен ниже чата1 и от остальных отделен разделительной линией
        - do: Кликнуть ПКМ / нажать лонгтапом по чату3
        - assert: Появляется контекстное меню для этого чата
        - do: Выбрать “Закрепить чат”
        - assert: Чат закреплен и он размещен ниже чата1 и чата2 и от остальных отделен разделительной линией
        - do: Открыть чат3
        - assert: Чат открыт
        - do: В поле ввода сообщения ввести несколько символов
        - assert: Вводимые символы отражаются в поле ввода
        - do: Тапнуть по кнопке “Отправить чат”
        - assert: Сообщение отправилось и отображается в окне чата
        - do: Посмотреть на отображение закрепленных чатов в списке чатов
        - assert: |
              Чат3 расположен на том же месте где и был - ниже чата1 и чата2
              Чат3 разделен с остальными не закрепленными чатами линией

    Между разделами закрепленных чатов и обычными есть отступ[manual]:
        - automation:
        - description: У авторизованного пользователя в списке чатов есть чат с jivosite, приватный чат или групповой чат
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по любому незкрепленному чату
        - assert: Показывается контекстное меню этого чата
        - do: Выбрать “Закрепить чат”
        - assert: Чат закреплен и от остальных отделен разделительной линией
        - do: Кликнуть ПКМ / нажать лонгтапом по любому незкрепленному чату
        - assert: Показывается контекстное меню этого чата
        - do: Выбрать “Закрепить чат”
        - assert: |
              Чат закреплен и находится под закрпленным на шаге 3 чатом
              От остальных отделен разделительной линией

    При откреплении чат ранжируется в общем порядке, если в него ничего не отправляли:
        - description: У авторизованного пользователя в списке чатов есть Чат1, Чат2, Чат3, расположенные в таком же порядке в списке чатов
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по чату2
        - assert: Показывается контекстное меню этого чата
        - do: Выбрать “Закрепить чат”
        - assert: |
              Чат закреплен и перемещается на позицию №1
              От остальных чатов отделен разделителем
        - do: Кликнуть ПКМ / нажать лонгтапом по чату2
        - assert: Показывается контекстное меню этого чата
        - do: Выбрать “Открепить чат"
        - assert: Открепленный чат в списке чатов перемещается на место №2

    После перезагрузки браузера закрепленные чаты остаются на своих местах и в том же порядке[manual]:
        - automation:
        - description: |
              У авторизованного пользователя в списке чатов есть приватный чат и групповой чат
              Для приложения данный тест-кейс неактуален
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по любому приватному или групповому чату А
        - assert: Показывается контекстное меню этого чата
        - do: Нажать “Закрепить чат"
        - assert: Чат закрепляется
        - do: Кликнуть ПКМ / нажать лонгтапом по любому не закрепленному приватному или групповому чату Б
        - assert: Показывается контекстное меню этого чата
        - do: Нажать “Закрепить чат”
        - assert: |
              Чат закрепляется
              Под закрепленным чатом А располагается закрепленный чат Б
              Под закрепленным чатом Б есть разделительная линия
        - do: Закрыть браузер, где открыто окно мессенджера
        - assert: Окно браузера закрыто
        - do: Открыть тестовый браузер и запустить в нем мессенджер
        - assert: |
              Открыто окно мессенджер
              Закрепленные чаты остались прежними и расположены в том же порядке

    После восстановления интернет-соединения закрепленные чаты остаются на своих местах и в том же порядке[manual]:
        - automation:
        - description: У авторизованного пользователя в списке чатов есть приватный чат и групповой чат
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по любому приватному или групповому чату А
        - assert: Показывается контекстное меню этого чата
        - do: Нажать “Закрепить чат"
        - assert: Чат закрепляется
        - do: Кликнуть ПКМ / нажать лонгтапом по любому не закрепленному приватному или групповому чату Б
        - assert: Показывается контекстное меню этого чата
        - do: Нажать “Закрепить чат”
        - assert: |
              Чат закрепляется
              Под закрепленным чатом А располагается закрепленный чат Б
              Под закрепленным чатом Б есть разделительная линия
        - do: Отключить на устройстве интернет-соединение
        - assert: Интернет-соединенеие отключено
        - do: Восстановить интернет-соединение
        - assert: |
              Интернет-соединение восстановлено
              Закрепленные чаты остались прежними и расположены в том же порядке

    Скроллиться список чатов, где уже есть закрепленные чаты[manual]:
        - automation:
        - description: У авторизованного пользователя в списке чатов есть более 20 закрепленных и более 10 не зкрепленных чатов
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Проскроллить список чатов в самый низ
        - assert: |
              Список чатов скроллится вниз
              Скролл проходит плавный и корректный
        - do: Проскроллить список чатов вверх
        - assert: |
              Список чатов скроллится вверх
              Скролл проходит плавный и корректный.

    При смене аккаунта подгружаются  закрепленные чаты другого аккаунта[manual]:
        - tags: [advanced_smoke]
        - automation:
        - description: |
              У авторизованного пользователя А в списке чатов есть закрепленные чаты N1, N2, N3
              Есть дотступ к пользователю Б, которым изначально и авторизованы в тестовом приложении
        - do: Авторизоваться пользователем А
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Посмотреть на закрепленные чаты в списке чатов
        - assert: |
              Закрепленные чаты находятся сверху и разделены линией с остальными чатами
              Закрепленные чаты расположены в следующем порядке - Чат N1, Чат N2, Чат N3
        - do: Разлогиниться пользователем А
        - do: Авторизоваться пользователем Б
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по любому приватному или групповому чату
        - assert: Показывается контекстное меню этого чата
        - do: Нажать “Закрепить чат”
        - assert: Чат закрепляется
        - do: Разлогиниться пользователем Б
        - do: Авторизоваться пользователем А
        - do: Проверить, что в списке чатов все закрепленные чаты остались в прежнем порядке
        - assert: Все закрепленные чаты остались закрепленными и расположены в том порядке, в котором и были -  Чат N1, Чат N2, Чат N3

    Чат остается закрепленным после добавления/удаления собеседника из чата[manual]:
        - automation:
        - description: |
              У авторизованного пользователя в списке чатов есть групповой чат, в котором он является администратором
              В данном чате есть еще участники
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по групповому чату из description
        - assert: Показывается контекстное меню этого чата
        - do: Нажать “Закрепить чат”
        - assert: |
              Чат закрепляется
              Чат находится вверху и отделяется от других чатов разделительной линией
        - do: Открыть групповой чат из description
        - assert: Чат открыт
        - do: Нажать на шапку чата
        - assert: Открывается карточка чата
        - do: Нажать на "Участники"
        - assert: Открывается экран учатсников
        - do: Нажать на "Добавить участников" и выбрать любого пользователя из списка
        - assert: В списке участников чата отображается добавленный пользователь
        - do: Проверить положение группового чата из description в списке чатов
        - assert: В списке чатов групповой чат остался закрепленным
        - do: Удалить любого участника чата
        - assert: Пользователь успешно удален
        - do: Проверить положение в списке чатов группового чата из description
        - assert: В списке чатов групповой чат остался закрепленным

    Чат остается закрепленным после добавления/удаления роли администратора у участника[manual]:
        - automation:
        - description: |
              У авторизованного пользователя в списке чатов есть групповой чат, в котором он является администратором
              В данном чате есть еще участники
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по групповому чату из description
        - assert: Показывается контекстное меню этого чата
        - do: Нажать “Закрепить чат”
        - assert: |
              Чат закрепляется
              Чат находится вверху и отделяется от других чатов разделительной линией
        - do: Открыть групповой чат из description
        - assert: Чат открыт
        - do: Нажать на шапку чата
        - assert: Открывается карточка чата
        - do: Нажать на "Участники"
        - assert: |
              Открывается экран учатсников
              Отображается блок "Администраторы" и блок "Участники"
        - do: Нажать на три точки (контекстное меню контакта) напротив имени пользователя, который находится в блоке "Участники"
        - assert: Появляется контекстное меню
        - do: Выбрать "Сделать администратором"
        - assert: Данный появилась перемещается в блок "Администраторы"
        - do: Проверить положение группового чата из description в списке чатов
        - assert: В списке чатов групповой чат остался закрепленным
        - do: Убрать из администраторов пользователя, которого мы ранее назначали администратором чата
        - assert: Данный пользователь перемещается в блок "Участники"
        - do: Проверить положение группового чата из description в списке чатов
        - assert: В списке чатов групповой чат остался закрепленным

    Чат остается закрепленным, если включит/отключить уведомления[manual]:
        - automation:
        - description: У авторизованного пользователя в списке чатов есть приватный или групповой чат, в котором включены уведомления
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по групповому чату из description
        - assert: Показывается контекстное меню этого чата
        - do: Нажать “Закрепить чат”
        - assert: |
              Чат закрепляется
              Чат находится вверху и отделяется от других чатов разделительной линией
        - do: Кликнуть ПКМ / нажать лонгтапом по групповому чату из description
        - assert: Показывается контекстное меню этого чата
        - do: Нажать на "Отключить уведомления"
        - assert: |
              Уведомления в чате отключены
              В списке чатов в превью этого чата появился значок перечеркнутого колокольчика (или если есть непрочитанные сооб0ения, то счетчик непрочитанных сообещний становится серого цвета)
              Чат остался закрепленным
        - do: Кликнуть ПКМ / нажать лонгтапом по групповому чату из description
        - assert: Показывается контекстное меню этого чата
        - do: Нажать на "Включить уведомления"
        - assert: |
              Уведомления в чате включены
              В списке чатов в превью этого чата пропал значок перечеркнутого колокольчика (или если есть непрочитанные сооб0ения, то счетчик непрочитанных сообещний становится синего цвета)
              Чат остался закрепленным

    Чат остается закрепленным, если изменить название чата[manual]:
        - automation:
        - description: У авторизованного пользователя в списке чатов есть групповой чат, в котором он является администратором
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по групповому чату из description
        - assert: Показывается контекстное меню этого чата
        - do: Нажать “Закрепить чат”
        - assert: |
              Чат закрепляется
              Чат находится вверху и отделяется от других чатов разделительной линией
        - do: Открыть групповой чат А
        - assert: Чат открыт
        - do: Нажать на шапку чата
        - assert: Открывается карточка чата
        - do: Нажать на "Настройки чата"
        - assert: Открывается экран настроек чата
        - do: Изменить существующие название чата на любое другое и нажать кнопку "Сохранить"
        - assert: Название чата было изменено
        - do: Проверить положение группового чата из description в списке чатов
        - assert: В списке чатов групповой чат остался закрепленным

    Групповой чат остается закрепленным , если его поискать в поиске[manual]:
        - automation:
        - description: У авторизованного пользователя в списке чатов есть приватный / групповой чат / чат с jivosite
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по чату из description
        - assert: Показывается контекстное меню этого чата
        - do: Нажать “Закрепить чат”
        - assert: |
              Чат закрепляется
              Чат находится вверху и отделяется от других чатов разделительной линией
        - do: Нажать на кнопку поиска в шапке списка чатов и ввести в поле поиска название закрепленного чата из description
        - assert: В результатах поиска в секции "Люди и чаты" есть данный чат
        - do: Нажать на крестик рядом с полем ввода
        - assert: |
              Режим поиска был отменен
              Открывается список чатов пользователя
              Чат из description остался закрепленным

    Открепленные чаты после открепления ранжируются в общем порядке[manual]:
        - automation:
        - description: У авторизованного пользователя в списке чатов есть Чат1, Чат2, Чат3
        - do: Запустить тестовое приложениие и октрыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по чату1
        - assert: Показывается контекстное меню этого чата
        - do: Выбрать "Закрепить чат"
        - assert: Чат закреплен и от остальных отделен разделительной линией
        - do: В чате под номером 3 получить или отправить сообщение
        - assert: Чат в списке чатов переместился на позицию №2(с учетом  закрепленного)
        - do: Кликнуть ПКМ / нажать лонгтапом по чату1
        - assert: Показывается контекстное меню этого чата
        - do: Выбрать "Открепить чат"
        - assert: Открепленный чат в списке чатов ранжируется и перемещается на место №2
        - do: Кликнуть ПКМ / нажать лонгтапом по чату2, который находиться ниже чата1 и чата3 в списке чатов
        - assert: Появляется контекстное меню для этого чата
        - do: Выбрать "Закрепить чат"
        - assert: |
              Чат закреплен и перемещается в самый вверх
              От остальных чатов отделен разделительной линией
        - do: Получить или отправить в закрепленном чате2 сообщение
        - assert: Сообщение получено или отправлено
        - do: Кликнуть ПКМ / нажать лонгтапом по закрепленному чату2
        - assert: Появляется контекстное меню для этого чата
        - do: Выбрать "Открепить чат"
        - assert: Открепленный чат перемещается на место №1

    Пользователь LU может запинить/распинить чат[manual]:
        - automation:
        - description: Для авторизации пользователем А необходимо использовать данный аккаунт minsktest150/QazMssngr1
        - do: Под пользователем А запустить тестовое приложение и открыть список чатов
        - assert: Открывается список чатов
        - do: Кликнуть ПКМ / нажать лонгтапом по любому незакрепленному чату
        - assert: Показывается контекстное меню этого чата
        - do: Нажать “Закрепить чат”
        - assert: |
              Чат закреплен
              От остальных чатов отделен разделительной линией
        - do: Кликнуть ПКМ / нажать лонгтапом по закрепленному чату из  предыдущего шаг
        - assert: Показывается контекстное меню этого чата
        - do: Нажать “Открепить чат”
        - assert: Чат откреплен и помещается в истории в зависимости от того, какое последнее сообщение было в нем

files:
  - tests/hermione/suites/messenger/pin-chat/pin-chat.common.hermione.ts

v-team: Chat

tlds: ru

tags:
    - yamb
    - y-team
