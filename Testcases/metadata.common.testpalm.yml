feature: Метаданные чата

specs:

    В чатах 1 на 1 в окне чата отображается плашка с метадатой, если у бота есть метаданные[manual]:
        - automation:
        - description: |
              На тестовом аккаунте нельзя создавать дополнительные чаты и удалять тестовый чат!
              Авторизоваться в приложении данным аккаунтом  yndx-mssngr-870 / QazMssngr1
              У Вас в списке чатов есть чат с названием **Тестобот**
        - do: Запустить тестовое приложение
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в **description**
        - assert: Чат открыт
        - do: Посмотреть на отображение плашки с метадатой
        - assert: В окне чата отображается плашка с метадатой

    В чатах 1 на 1 можно изменить метаданные у объекта чата[manual]:
        - tags: [advanced_smoke]
        - automation:
        - description: |
              На тестовом аккаунте нельзя создавать дополнительные чаты и удалять тестовый чат!
              Авторизоваться в приложении данным аккаунтом  yndx-mssngr-870 / QazMssngr1
              У Вас в списке чатов есть чат с названием **Тестобот**
        - do: Запустить тестовое приложение
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в **description**
        - assert: |
              Чат открыт
              В окне чата отображается плашка с метадатой
        - do: Отправить в чат данный запрос:```/set_metadata {"chatbar":{"img":"https://static.tildacdn.com/tild6636-6130-4231-a132-633037383863/2019_02_13_-113.jpg","title":{"i18n_key":"yahealth_finish_consultation","text":"test"},"subtitle":{"i18n_key":"yahealth_finish_consultation","text":"subtitle-fallback-text"},"button":{"text_color":"#8d75dd","bg_color":"#f2d5c9","title":{"i18n_key":"yahealth_finish_consultation","text":"button-text"},"links":["yellowskin://?url=https%3A%2F%2Fhealth.yandex.ru%2Fconsultation%2F123456%2Ffinish&tab=yahealth","https://health.yandex.ru/consultation/123456/finish?token=6d0aa353-36dc-4453-b478-1c02a81d37ef"],"directives":[{"type":"client_action","name":"postmessage","payload":{"origin":"https://health.yandex.ru","type":"postmessageactiontype","params":{}}}]}}}```
        - assert: |
              Пришло сообщение от бота в ответ
              Плашка в окне чата изменила свой вид на значения, которые были отправлены в JSON
        - do: Отправить в чат данный запрос:```/set_metadata {"chatbar":{"img":"https://static.tildacdn.com/tild6636-6130-4231-a132-633037383863/2019_02_13_-113.jpg","title":{"i18n_key":"yahealth_finish_consultation","text":"привет"},"subtitle":{"i18n_key":"yahealth_finish_consultation","text":"привет=привет"},"button":{"text_color":"#dd7591","bg_color":"#dbdd75","title":{"i18n_key":"yahealth_finish_consultation","text":"Кнопка"},"links":["yellowskin://?url=https%3A%2F%2Fhealth.yandex.ru%2Fconsultation%2F123456%2Ffinish&tab=yahealth","https://health.yandex.ru/consultation/123456/finish?token=6d0aa353-36dc-4453-b478-1c02a81d37ef"],"directives":[{"type":"client_action","name":"postmessage","payload":{"origin":"https://health.yandex.ru","type":"postmessageactiontype","params":{}}}]}}}```
        - assert: |
              Пришло сообщение от бота в ответ
              Плашка в окне чата изменила свой вид на значения, которые были отправлены в JSON

    В чатах 1 на 1 после перелогина полученная метадата в чате сохраняется и отображается в окне чата[manual]:
        - automation:
        - description: |
              На тестовом аккаунте нельзя создавать дополнительные чаты и удалять тестовый чат!
              Авторизоваться в приложении данным аккаунтом  yndx-mssngr-870 / QazMssngr1
              У Вас в списке чатов есть чат с названием **Тестобот**
        - do: Запустить тестовое приложение
        - assert: Открывается список чатов
        - do: Открыть любой чат, который соответствует описанию указанному в **description**
        - assert: |
              Чат откры
              В окне чата отображается плашка с метадатой
        - do: Обновить страницу браузера
        - assert: |
              Чат открыт
              В окне чата отображается плашка с метадатой
        - do: Сделать перелогин в мессенджере (авторизовываться необходимо тем же аккааунтом) и открыть чат из **description**
        - assert: Чат открыт* В окне чата отображается плашка с метадатой

    В чатах 1 на 1 можно перейти по кнопке в плашке с метадатой[manual]:
        - automation:
        - description: |
              На тестовом аккаунте нельзя создавать дополнительные чаты и удалять тестовый чат!
              Авторизоваться в приложении данным аккаунтом  yndx-mssngr-870 / QazMssngr1
              У Вас в списке чатов есть чат с названием **Тестобот**
        - do: Запустить тестовое приложение
        - do: Открыть любой чат, который соответствует описанию указанному в **description**
        - assert: |
              Чат откры
              В окне чата отображается плашка с метадатой
        - do: Нажать по кнопке в плашке
        - assert: Осуществялется переход по ссылке

files: []

v-team: Chat

tlds: ru

tags:
    - yamb
    - y-team

