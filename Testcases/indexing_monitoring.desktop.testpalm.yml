feature: Страница "Мониторинг индексирования"

description: В кейсах описываются компоненты и общий вид элементов на странице мониторинга индексирования.

specs-integration:
  отображает плашку приостановленного мониторинга:
    - do: открыть страницу настройки мониторинга https://partner-tst.news.yandex.ru/v2/indexing_monitoring?userid=521917854&agencyid=1310
    - assert: |
        вверху страницы отображается плашка "Мониторинг приостановлен"

  отображает плашку активного мониторинга:
    - do: открыть страницу настройки мониторинга https://partner-tst.news.yandex.ru/v2/indexing_monitoring?userid=74171732
    - assert: |
        вверху страницы отображается плашка "Мониторинг активен"

specs:
  отображает плашку ненастроеного мониторинга, если он не включен [manual]:
    - do: открыть страницу настройки мониторинга https://partner-tst.news.yandex.ru/v2/indexing_monitoring?userid=74171732
    - do: найти агентство с ненастроенным мониторингом
    - assert: |
        вверху страницы отображается плашка "Мониторинг еще не настроен",
        внешний вид - https://jing.yandex-team.ru/files/kossakovskaya/2021-11-29_14-19-13.png

  позволяет добавить и удалить e-mail для уведомлений:
    - do: открыть страницу настройки мониторинга https://partner-tst.news.yandex.ru/v2/indexing_monitoring?userid=521917854&agencyid=1310
    - assert: |
        страница содержит блок "Адреса для уведомлений"
        внешний вид - https://jing.yandex-team.ru/files/nightsonne/2022-03-05_14-23-32.png
    - do: кликнуть на кнопку "Добавить еще E-mail"
    - assert: |
        по ховеру шрифт кнопки становится более темным,
        после клика появляется новое поле ввода е-мэйла,
        поле содержит плейсхолдер "E-mail адрес N" (где N - порядковый номер добавленного емейла),
        кнопка "Сохранить" становится активной
    - do: навести курсор на добавленное поле
    - assert: |
        по ховеру рядом с полем появляется иконка удаления,
        внешний вид https://jing.yandex-team.ru/files/nightsonne/2022-03-10_13-36-37.png
    - do: навести курсор на иконку удаления
    - assert: по ховеру рядом с иконкой удаления появляется тултип "Удалить E-mail"
    - do: кликнуть на иконку удаления
    - assert: |
        добавленное ранее поле исчезло,
        кнопка "Сохранить" задисейблена      

  содержит раздел "Чувствительность мониторинга":
    - do: открыть страницу настройки мониторинга https://partner-tst.news.yandex.ru/v2/indexing_monitoring?userid=521917854&agencyid=1310
    - assert: |
        страница содержит блок "Чувствительность мониторинга",
        внешний вид - https://jing.yandex-team.ru/files/nightsonne/2022-03-10_15-36-21.png

  позволяет переключать интервал мониторинга:
    - do: открыть страницу настройки мониторинга https://partner-tst.news.yandex.ru/v2/indexing_monitoring?userid=521917854&agencyid=1310
    - assert: |
        страница содержит блок "Чувствительность мониторинга",
        если для агентства выбран пункт "Количество материалов за два часа",
        то присутствует чекбокс "Указать временной интервал для отправки уведомлений",
        внешний вид - https://jing.yandex-team.ru/files/nightsonne/2022-03-10_15-36-21.png
    - do: кликнуть на пункт "Количество материалов за сутки"
    - assert: |
        выбран пункт "Количество материалов за сутки",
        чекбокс "Указать временной интервал для отправки уведомлений" отсутствует,
        кнопка "Сохранить" становится активной,
        внешний вид https://jing.yandex-team.ru/files/nightsonne/2022-03-10_15-58-42.png

  позволяет указать временной интервал для отправки уведомлений:
    - do: открыть страницу настройки мониторинга https://partner-tst.news.yandex.ru/v2/indexing_monitoring?userid=521917854&agencyid=1310
    - assert: |
        страница содержит блок "Чувствительность мониторинга",
        если для агентства выбран пункт "Количество материалов за два часа",
        то присутствует чекбокс "Указать временной интервал для отправки уведомлений",
        внешний вид - https://jing.yandex-team.ru/files/nightsonne/2022-03-10_15-36-21.png
    - do: кликнуть на чекбокс "Указать временной интервал для отправки уведомлений"
    - assert: |
        чекбокс выделен,
        разворачиваются поля выбора временных интервалов с кнопками "Начало" и "Окончание",
        кнопка "Сохранить" становится активной
    - do: кликнуть кнопку "Начало"
    - assert: |
        появляется выпадающий список с выбором интервала даты,
        выпадающий список отображается поверх остальных элементов
    - do: поскроллить список и выбрать в выпадающем списке  начало интервала "18-00"
    - assert: |
        выпадающий список сворачивается,
        в поле выбора начала интервала отображается выбранное время,
        под полями появляется уведомление валидации "Необходимо заполнить начало и конец"
    - do: кликнуть на кнопку "Окончание"
    - assert: |
        появляется выпадающий список с выбором интервала даты,
        выпадающий список отображается поверх остальных элементов
    - do: поскроллить список и выбрать в выпадающем списке окончания интервала "19-00"
    - assert: |
        выпадающий список сворачивается,
        в поле выбора окончания интервала отображается выбранное время,
        под полями исчезает уведомление валидации "Необходимо заполнить начало и конец"
    - do: кликнуть еще раз на кнопку окончания интервала
    - assert: |
        появляется выпадающий список с выбором интервала даты,
        выбранное время в списке некликабельно

  запрашивает подтверждение изменения статуса мониторинга:
    - do: открыть страницу настройки мониторинга https://partner-tst.news.yandex.ru/v2/indexing_monitoring?userid=521917854&agencyid=1310
    - assert: |
        страница содержит пояснение "Уведомления от мониторинга оперативно укажут на возможные проблемы с экспортом.",
        ниже есть переключатель статуса мониторинга,
        если мониторинг приостановлен, переключатель выключен
        внешний вид - https://jing.yandex-team.ru/files/nightsonne/2022-03-10_17-59-12.png
    - do: кликнуть на переключатель
    - assert: |
        появляется модальное окно с кнопками "Да" и "Отмена",
        внешний вид https://jing.yandex-team.ru/files/nightsonne/2022-03-10_18-04-08.png
    - do: навести курсор мыши на обе кнопки
    - assert: по ховеру меняется стиль кнопок
    - do: в окне кликнуть на кнопку "Отмена"
    - assert: окно закрылось

  позволяет включить и отключить мониторинг [manual]:
    - do: открыть страницу настройки мониторинга https://partner-tst.news.yandex.ru/v2/indexing_monitoring?userid=521917854&agencyid=1310
    - assert: |
        страница содержит пояснение "Уведомления от мониторинга оперативно укажут на возможные проблемы с экспортом.",
        ниже есть переключатель статуса мониторинга,
        если мониторинг приостановлен, переключатель выключен
        внешний вид - https://jing.yandex-team.ru/files/nightsonne/2022-03-10_17-59-12.png
    - do: кликнуть на переключатель
    - assert: |
        появляется модальное окно с кнопками "Да" и "Отмена",
        внешний вид https://jing.yandex-team.ru/files/nightsonne/2022-03-10_18-04-08.png
    - do: в окне кликнуть на кнопку "Да"
    - assert: |
        окно закрылось,
        в правом верхнем углу появляется тултип,
        переключатель становится желтым, 
        переключатель меняет надпись на "Мониторинг активен"
    - do: кликнуть еще раз на переключатель "Мониторинг активен" для приостановки мониторинга
    - assert: |
        появляется модальное окно с кнопками "Да" и "Отмена",
        внешний вид https://jing.yandex-team.ru/files/nightsonne/2022-03-10_18-12-56.png
    - do: в окне кликнуть на кнопку "Да"
    - assert: |
        окно закрылось,
        в правом верхнем углу появляется тултип,
        переключатель становится серым, 
        переключатель меняет надпись на "Мониторинг приостановлен"
    - do: (Важно! агентство обязательно должно быть с приостановленным мониторингом в конце кейса, тк его статус проверяется в е2е тесте)

files:
  - features/news-partners/indexing_monitoring/indexing_monitoring.desktop.hermione.js
  - features/news-partners/indexing_monitoring/indexing_monitoring.desktop.hermione.e2e.js

qa-engineer: nightsonne

manager: halilu

tags:
  - news-partners

tlds:
  - ru
